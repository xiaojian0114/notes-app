/*! For license information please see graphs.min.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react-dom"),require("lodash"),require("react")):"function"==typeof define&&define.amd?define(["react-dom","lodash","react"],e):"object"==typeof exports?exports.Graphs=e(require("react-dom"),require("lodash"),require("react")):t.Graphs=e(t.ReactDOM,t._,t.React)}(self,((t,e,n)=>(()=>{var r={422:(t,e,n)=>{function r(t,e){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r(t,e)}var i=n(4893),a=n(9525),o=n(6060),s=n(7791),u=function(t){function e(){return t.apply(this,arguments)||this}return i=t,(n=e).prototype=Object.create(i.prototype),n.prototype.constructor=n,r(n,i),e.prototype.execute=function(){return o(this.rootNode,this.options,a)},e;var n,i}(i),c={};t.exports=function(t,e){return e=s.assign({},c,e),new u(t,e).execute()}},2282:(t,e,n)=>{function r(t,e){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r(t,e)}var i=n(4893),a=n(1725),o=n(6060),s=n(7791),u=function(t){function e(){return t.apply(this,arguments)||this}return i=t,(n=e).prototype=Object.create(i.prototype),n.prototype.constructor=n,r(n,i),e.prototype.execute=function(){var t=this;return t.rootNode.width=0,o(t.rootNode,t.options,a)},e;var n,i}(i),c={};t.exports=function(t,e){return e=s.assign({},c,e),new u(t,e).execute()}},5760:(t,e,n)=>{function r(t,e){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r(t,e)}var i=n(4893),a=n(9579),o=n(6470),s=n(7791),u=["LR","RL","H"],c=u[0],l=function(t){function e(){return t.apply(this,arguments)||this}return i=t,(n=e).prototype=Object.create(i.prototype),n.prototype.constructor=n,r(n,i),e.prototype.execute=function(){var t=this.options,e=this.rootNode;t.isHorizontal=!0;var n=t.indent,r=void 0===n?20:n,i=t.dropCap,s=void 0===i||i,l=t.direction,h=void 0===l?c:l,d=t.align;if(h&&-1===u.indexOf(h))throw new TypeError("Invalid direction: "+h);if(h===u[0])a(e,r,s,d);else if(h===u[1])a(e,r,s,d),e.right2left();else if(h===u[2]){var f=o(e,t),v=f.left,p=f.right;a(v,r,s,d),v.right2left(),a(p,r,s,d);var g=v.getBoundingBox();p.translate(g.width,0),e.x=p.x-e.width/2}return e},e;var n,i}(i),h={};t.exports=function(t,e){return e=s.assign({},h,e),new l(t,e).execute()}},1423:(t,e,n)=>{var r={compactBox:n(422),dendrogram:n(2282),indented:n(5760),mindmap:n(1333)};t.exports=r},4893:(t,e,n)=>{var r=n(4341),i=function(){function t(t,e){void 0===e&&(e={}),this.options=e,this.rootNode=r(t,e)}return t.prototype.execute=function(){throw new Error("please override this method")},t}();t.exports=i},1725:(t,e,n)=>{var r=n(7791);function i(t,e){void 0===t&&(t=0),void 0===e&&(e=[]);var n=this;n.x=n.y=0,n.leftChild=n.rightChild=null,n.height=0,n.children=e}var a={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function o(t,e,n){n?(e.x=t.x,e.y=t.y):(e.x=t.y,e.y=t.x),t.children.forEach((function(t,r){o(t,e.children[r],n)}))}t.exports=function(t,e){void 0===e&&(e={}),e=r.assign({},a,e);var n,s=0,u=function t(e){if(!e)return null;e.width=0,e.depth&&e.depth>s&&(s=e.depth);var n=e.children,r=n.length,a=new i(e.height,[]);return n.forEach((function(e,n){var i=t(e);a.children.push(i),0===n&&(a.leftChild=i),n===r-1&&(a.rightChild=i)})),a.originNode=e,a.isLeaf=e.isLeaf(),a}(t);return function t(e){if(e.isLeaf||0===e.children.length)e.drawingDepth=s;else{var n=e.children.map((function(e){return t(e)})),r=Math.min.apply(null,n);e.drawingDepth=r-1}return e.drawingDepth}(u),function t(r){r.x=r.drawingDepth*e.rankSep,r.isLeaf?(r.y=0,n&&(r.y=n.y+n.height+e.nodeSep,r.originNode.parent!==n.originNode.parent&&(r.y+=e.subTreeSep)),n=r):(r.children.forEach((function(e){t(e)})),r.y=(r.leftChild.y+r.rightChild.y)/2)}(u),o(u,t,e.isHorizontal),t}},6060:(t,e,n)=>{var r=n(6470),i=["LR","RL","TB","BT","H","V"],a=["LR","RL","H"],o=i[0];t.exports=function(t,e,n){var s=e.direction||o;if(e.isHorizontal=function(t){return a.indexOf(t)>-1}(s),s&&-1===i.indexOf(s))throw new TypeError("Invalid direction: "+s);if(s===i[0])n(t,e);else if(s===i[1])n(t,e),t.right2left();else if(s===i[2])n(t,e);else if(s===i[3])n(t,e),t.bottom2top();else if(s===i[4]||s===i[5]){var u=r(t,e),c=u.left,l=u.right;n(c,e),n(l,e),e.isHorizontal?c.right2left():c.bottom2top(),l.translate(c.x-l.x,c.y-l.y),t.x=c.x,t.y=l.y;var h=t.getBoundingBox();e.isHorizontal?h.top<0&&t.translate(0,-h.top):h.left<0&&t.translate(-h.left,0)}var d=e.fixedRoot;return void 0===d&&(d=!0),d&&t.translate(-(t.x+t.width/2+t.hgap),-(t.y+t.height/2+t.vgap)),function(t,e){if(e.radial){var n=e.isHorizontal?["x","y"]:["y","x"],r=n[0],i=n[1],a={x:1/0,y:1/0},o={x:-1/0,y:-1/0},s=0;t.DFTraverse((function(t){s++;var e=t.x,n=t.y;a.x=Math.min(a.x,e),a.y=Math.min(a.y,n),o.x=Math.max(o.x,e),o.y=Math.max(o.y,n)}));var u=o[i]-a[i];if(0===u)return;var c=2*Math.PI/s;t.DFTraverse((function(e){var n=(e[i]-a[i])/u*(2*Math.PI-c)+c,o=e[r]-t[r];e.x=Math.cos(n)*o,e.y=Math.sin(n)*o}))}}(t,e),t}},4341:(t,e,n)=>{var r=n(7791),i={getId:function(t){return t.id||t.name},getPreH:function(t){return t.preH||0},getPreV:function(t){return t.preV||0},getHGap:function(t){return t.hgap||18},getVGap:function(t){return t.vgap||18},getChildren:function(t){return t.children},getHeight:function(t){return t.height||36},getWidth:function(t){var e=t.label||" ";return t.width||18*e.split("").length}};function a(t,e){var n=this;if(n.vgap=n.hgap=0,t instanceof a)return t;n.data=t;var r=e.getHGap(t),i=e.getVGap(t);return n.preH=e.getPreH(t),n.preV=e.getPreV(t),n.width=e.getWidth(t),n.height=e.getHeight(t),n.width+=n.preH,n.height+=n.preV,n.id=e.getId(t),n.x=n.y=0,n.depth=0,n.children||(n.children=[]),n.addGap(r,i),n}r.assign(a.prototype,{isRoot:function(){return 0===this.depth},isLeaf:function(){return 0===this.children.length},addGap:function(t,e){var n=this;n.hgap+=t,n.vgap+=e,n.width+=2*t,n.height+=2*e},eachNode:function(t){for(var e,n=[this];e=n.shift();)t(e),n=e.children.concat(n)},DFTraverse:function(t){this.eachNode(t)},BFTraverse:function(t){for(var e,n=[this];e=n.shift();)t(e),n=n.concat(e.children)},getBoundingBox:function(){var t={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode((function(e){t.left=Math.min(t.left,e.x),t.top=Math.min(t.top,e.y),t.width=Math.max(t.width,e.x+e.width),t.height=Math.max(t.height,e.y+e.height)})),t},translate:function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.eachNode((function(n){n.x+=t,n.y+=e,n.x+=n.preH,n.y+=n.preV}))},right2left:function(){var t=this,e=t.getBoundingBox();t.eachNode((function(t){t.x=t.x-2*(t.x-e.left)-t.width})),t.translate(e.width,0)},bottom2top:function(){var t=this,e=t.getBoundingBox();t.eachNode((function(t){t.y=t.y-2*(t.y-e.top)-t.height})),t.translate(0,e.height)}}),t.exports=function(t,e,n){void 0===e&&(e={});var o,s=new a(t,e=r.assign({},i,e)),u=[s];if(!n&&!t.collapsed)for(;o=u.shift();)if(!o.data.collapsed){var c=e.getChildren(o.data),l=c?c.length:0;if(o.children=new Array(l),c&&l)for(var h=0;h<l;h++){var d=new a(c[h],e);o.children[h]=d,u.push(d),d.parent=o,d.depth=o.depth+1}}return s}},9579:(t,e,n)=>{var r=n(7791);t.exports=function(t,e,n,i){var a=null;t.eachNode((function(t){!function(t,e,n,i,a){var o=("function"==typeof n?n(t):n)*t.depth;if(!i)try{if(t.id===t.parent.children[0].id)return t.x+=o,void(t.y=e?e.y:0)}catch(t){}if(t.x+=o,e){if(t.y=e.y+r.getHeight(e,t,a),e.parent&&t.parent.id!==e.parent.id){var s=e.parent,u=s.y+r.getHeight(s,t,a);t.y=u>t.y?u:t.y}}else t.y=0}(t,a,e,n,i),a=t}))}},2972:(t,e,n)=>{var r=n(7791);function i(t,e){var n=0;return t.children.length?t.children.forEach((function(t){n+=i(t,e)})):n=t.height,t._subTreeSep=e.getSubTreeSep(t.data),t.totalHeight=Math.max(t.height,n)+2*t._subTreeSep,t.totalHeight}function a(t){var e=t.children,n=e.length;if(n){e.forEach((function(t){a(t)}));var r=e[0],i=e[n-1],o=i.y-r.y+i.height,s=0;if(e.forEach((function(t){s+=t.totalHeight})),o>t.height)t.y=r.y+o/2-t.height/2;else if(1!==e.length||t.height>s){var u=t.y+(t.height-o)/2-r.y;e.forEach((function(t){t.translate(0,u)}))}else t.y=(r.y+r.height/2+i.y+i.height/2)/2-t.height/2}}var o={getSubTreeSep:function(){return 0}};t.exports=function(t,e){void 0===e&&(e={}),e=r.assign({},o,e),t.parent={x:0,width:0,height:0,y:0},t.BFTraverse((function(t){t.x=t.parent.x+t.parent.width})),t.parent=null,i(t,e),t.startY=0,t.y=t.totalHeight/2-t.height/2,t.eachNode((function(t){var e=t.children,n=e.length;if(n){var r=e[0];if(r.startY=t.startY+t._subTreeSep,1===n)r.y=t.y+t.height/2-r.height/2;else{r.y=r.startY+r.totalHeight/2-r.height/2;for(var i=1;i<n;i++){var a=e[i];a.startY=e[i-1].startY+e[i-1].totalHeight,a.y=a.startY+a.totalHeight/2-a.height/2}}}})),a(t)}},9525:t=>{function e(t,e,n,r){void 0===r&&(r=[]);var i=this;i.w=t||0,i.h=e||0,i.y=n||0,i.x=0,i.c=r||[],i.cs=r.length,i.prelim=0,i.mod=0,i.shift=0,i.change=0,i.tl=null,i.tr=null,i.el=null,i.er=null,i.msel=0,i.mser=0}function n(t,e,r){r?t.y+=e:t.x+=e,t.children.forEach((function(t){n(t,e,r)}))}function r(t,e){var n=e?t.y:t.x;return t.children.forEach((function(t){n=Math.min(r(t,e),n)})),n}function i(t,e){n(t,-r(t,e),e)}function a(t,e,n){n?e.y=t.x:e.x=t.x,t.c.forEach((function(t,r){a(t,e.children[r],n)}))}function o(t,e,n){void 0===n&&(n=0),e?(t.x=n,n+=t.width):(t.y=n,n+=t.height),t.children.forEach((function(t){o(t,e,n)}))}e.fromNode=function(t,n){if(!t)return null;var r=[];return t.children.forEach((function(t){r.push(e.fromNode(t,n))})),n?new e(t.height,t.width,t.x,r):new e(t.width,t.height,t.y,r)},t.exports=function(t,n){void 0===n&&(n={});var r=n.isHorizontal;function s(t){0===t.cs?(t.el=t,t.er=t,t.msel=t.mser=0):(t.el=t.c[0].el,t.msel=t.c[0].msel,t.er=t.c[t.cs-1].er,t.mser=t.c[t.cs-1].mser)}function u(t,e,n){for(var r=t.c[e-1],i=r.mod,a=t.c[e],o=a.mod;null!==r&&null!==a;){d(r)>n.low&&(n=n.nxt);var s=i+r.prelim+r.w-(o+a.prelim);s>0&&(o+=s,c(t,e,n.index,s));var u=d(r),f=d(a);u<=f&&null!==(r=h(r))&&(i+=r.mod),u>=f&&null!==(a=l(a))&&(o+=a.mod)}!r&&a?function(t,e,n,r){var i=t.c[0].el;i.tl=n;var a=r-n.mod-t.c[0].msel;i.mod+=a,i.prelim-=a,t.c[0].el=t.c[e].el,t.c[0].msel=t.c[e].msel}(t,e,a,o):r&&!a&&function(t,e,n,r){var i=t.c[e].er;i.tr=n;var a=r-n.mod-t.c[e].mser;i.mod+=a,i.prelim-=a,t.c[e].er=t.c[e-1].er,t.c[e].mser=t.c[e-1].mser}(t,e,r,i)}function c(t,e,n,r){t.c[e].mod+=r,t.c[e].msel+=r,t.c[e].mser+=r,function(t,e,n,r){if(n!==e-1){var i=e-n;t.c[n+1].shift+=r/i,t.c[e].shift-=r/i,t.c[e].change-=r-r/i}}(t,e,n,r)}function l(t){return 0===t.cs?t.tl:t.c[0]}function h(t){return 0===t.cs?t.tr:t.c[t.cs-1]}function d(t){return t.y+t.h}function f(t,e,n){for(;null!==n&&t>=n.low;)n=n.nxt;return{low:t,index:e,nxt:n}}o(t,r);var v=e.fromNode(t,r);return function t(e){if(0!==e.cs){t(e.c[0]);for(var n=f(d(e.c[0].el),0,null),r=1;r<e.cs;++r){t(e.c[r]);var i=d(e.c[r].er);u(e,r,n),n=f(i,r,n)}!function(t){t.prelim=(t.c[0].prelim+t.c[0].mod+t.c[t.cs-1].mod+t.c[t.cs-1].prelim+t.c[t.cs-1].w)/2-t.w/2}(e),s(e)}else s(e)}(v),function t(e,n){n+=e.mod,e.x=e.prelim+n,function(t){for(var e=0,n=0,r=0;r<t.cs;r++)n+=(e+=t.c[r].shift)+t.c[r].change,t.c[r].mod+=n}(e);for(var r=0;r<e.cs;r++)t(e.c[r],n)}(v,0),a(v,t,r),i(t,r),t}},6470:(t,e,n)=>{var r=n(4341);t.exports=function(t,e){for(var n=r(t.data,e,!0),i=r(t.data,e,!0),a=t.children.length,o=Math.round(a/2),s=e.getSide||function(t,e){return e<o?"right":"left"},u=0;u<a;u++){var c=t.children[u];"right"===s(c,u)?i.children.push(c):n.children.push(c)}return n.eachNode((function(t){t.isRoot()||(t.side="left")})),i.eachNode((function(t){t.isRoot()||(t.side="right")})),{left:n,right:i}}},1333:(t,e,n)=>{function r(t,e){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r(t,e)}var i=n(4893),a=n(2972),o=n(6060),s=n(7791),u=function(t){function e(){return t.apply(this,arguments)||this}return i=t,(n=e).prototype=Object.create(i.prototype),n.prototype.constructor=n,r(n,i),e.prototype.execute=function(){return o(this.rootNode,this.options,a)},e;var n,i}(i),c={};t.exports=function(t,e){return e=s.assign({},c,e),new u(t,e).execute()}},7791:t=>{t.exports={assign:Object.assign,getHeight:function(t,e,n,r){return void 0===r&&(r="height"),"center"===n?(t[r]+e[r])/2:t.height}}},3506:t=>{"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},7485:(t,e,n)=>{var r=n(3506),i=n(7450),a=Object.hasOwnProperty,o=Object.create(null);for(var s in r)a.call(r,s)&&(o[r[s]]=s);var u=t.exports={to:{},get:{}};function c(t,e,n){return Math.min(Math.max(e,t),n)}function l(t){var e=Math.round(t).toString(16).toUpperCase();return e.length<2?"0"+e:e}u.get=function(t){var e,n;switch(t.substring(0,3).toLowerCase()){case"hsl":e=u.get.hsl(t),n="hsl";break;case"hwb":e=u.get.hwb(t),n="hwb";break;default:e=u.get.rgb(t),n="rgb"}return e?{model:n,value:e}:null},u.get.rgb=function(t){if(!t)return null;var e,n,i,o=[0,0,0,1];if(e=t.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(i=e[2],e=e[1],n=0;n<3;n++){var s=2*n;o[n]=parseInt(e.slice(s,s+2),16)}i&&(o[3]=parseInt(i,16)/255)}else if(e=t.match(/^#([a-f0-9]{3,4})$/i)){for(i=(e=e[1])[3],n=0;n<3;n++)o[n]=parseInt(e[n]+e[n],16);i&&(o[3]=parseInt(i+i,16)/255)}else if(e=t.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)){for(n=0;n<3;n++)o[n]=parseInt(e[n+1],0);e[4]&&(e[5]?o[3]=.01*parseFloat(e[4]):o[3]=parseFloat(e[4]))}else{if(!(e=t.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(e=t.match(/^(\w+)$/))?"transparent"===e[1]?[0,0,0,0]:a.call(r,e[1])?((o=r[e[1]])[3]=1,o):null:null;for(n=0;n<3;n++)o[n]=Math.round(2.55*parseFloat(e[n+1]));e[4]&&(e[5]?o[3]=.01*parseFloat(e[4]):o[3]=parseFloat(e[4]))}for(n=0;n<3;n++)o[n]=c(o[n],0,255);return o[3]=c(o[3],0,1),o},u.get.hsl=function(t){if(!t)return null;var e=t.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(e){var n=parseFloat(e[4]);return[(parseFloat(e[1])%360+360)%360,c(parseFloat(e[2]),0,100),c(parseFloat(e[3]),0,100),c(isNaN(n)?1:n,0,1)]}return null},u.get.hwb=function(t){if(!t)return null;var e=t.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(e){var n=parseFloat(e[4]);return[(parseFloat(e[1])%360+360)%360,c(parseFloat(e[2]),0,100),c(parseFloat(e[3]),0,100),c(isNaN(n)?1:n,0,1)]}return null},u.to.hex=function(){var t=i(arguments);return"#"+l(t[0])+l(t[1])+l(t[2])+(t[3]<1?l(Math.round(255*t[3])):"")},u.to.rgb=function(){var t=i(arguments);return t.length<4||1===t[3]?"rgb("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+")":"rgba("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+", "+t[3]+")"},u.to.rgb.percent=function(){var t=i(arguments),e=Math.round(t[0]/255*100),n=Math.round(t[1]/255*100),r=Math.round(t[2]/255*100);return t.length<4||1===t[3]?"rgb("+e+"%, "+n+"%, "+r+"%)":"rgba("+e+"%, "+n+"%, "+r+"%, "+t[3]+")"},u.to.hsl=function(){var t=i(arguments);return t.length<4||1===t[3]?"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)":"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+t[3]+")"},u.to.hwb=function(){var t=i(arguments),e="";return t.length>=4&&1!==t[3]&&(e=", "+t[3]),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+e+")"},u.to.keyword=function(t){return o[t.slice(0,3)]}},1681:(t,e,n)=>{t.exports={graphlib:n(3802),layout:n(8843),debug:n(5862),util:{time:n(2017).time,notime:n(2017).notime},version:n(6982)}},33:(t,e,n)=>{"use strict";var r=n(680),i=n(2306);t.exports={run:function(t){var e="greedy"===t.graph().acyclicer?i(t,function(t){return function(e){return t.edge(e).weight}}(t)):function(t){var e=[],n={},i={};return r.forEach(t.nodes(),(function a(o){r.has(i,o)||(i[o]=!0,n[o]=!0,r.forEach(t.outEdges(o),(function(t){r.has(n,t.w)?e.push(t):a(t.w)})),delete n[o])})),e}(t);r.forEach(e,(function(e){var n=t.edge(e);t.removeEdge(e),n.forwardName=e.name,n.reversed=!0,t.setEdge(e.w,e.v,n,r.uniqueId("rev"))}))},undo:function(t){r.forEach(t.edges(),(function(e){var n=t.edge(e);if(n.reversed){t.removeEdge(e);var r=n.forwardName;delete n.reversed,delete n.forwardName,t.setEdge(e.w,e.v,n,r)}}))}}},5372:(t,e,n)=>{var r=n(680),i=n(2017);function a(t,e,n,r,a,o){var s={width:0,height:0,rank:o,borderType:e},u=a[e][o-1],c=i.addDummyNode(t,"border",s,n);a[e][o]=c,t.setParent(c,r),u&&t.setEdge(u,c,{weight:1})}t.exports=function(t){r.forEach(t.children(),(function e(n){var i=t.children(n),o=t.node(n);if(i.length&&r.forEach(i,e),r.has(o,"minRank")){o.borderLeft=[],o.borderRight=[];for(var s=o.minRank,u=o.maxRank+1;s<u;++s)a(t,"borderLeft","_bl",n,o,s),a(t,"borderRight","_br",n,o,s)}}))}},6722:(t,e,n)=>{"use strict";var r=n(680);function i(t){r.forEach(t.nodes(),(function(e){a(t.node(e))})),r.forEach(t.edges(),(function(e){a(t.edge(e))}))}function a(t){var e=t.width;t.width=t.height,t.height=e}function o(t){t.y=-t.y}function s(t){var e=t.x;t.x=t.y,t.y=e}t.exports={adjust:function(t){var e=t.graph().rankdir.toLowerCase();"lr"!==e&&"rl"!==e||i(t)},undo:function(t){var e=t.graph().rankdir.toLowerCase();"bt"!==e&&"rl"!==e||function(t){r.forEach(t.nodes(),(function(e){o(t.node(e))})),r.forEach(t.edges(),(function(e){var n=t.edge(e);r.forEach(n.points,o),r.has(n,"y")&&o(n)}))}(t),"lr"!==e&&"rl"!==e||(function(t){r.forEach(t.nodes(),(function(e){s(t.node(e))})),r.forEach(t.edges(),(function(e){var n=t.edge(e);r.forEach(n.points,s),r.has(n,"x")&&s(n)}))}(t),i(t))}}},468:t=>{function e(){var t={};t._next=t._prev=t,this._sentinel=t}function n(t){t._prev._next=t._next,t._next._prev=t._prev,delete t._next,delete t._prev}function r(t,e){if("_next"!==t&&"_prev"!==t)return e}t.exports=e,e.prototype.dequeue=function(){var t=this._sentinel,e=t._prev;if(e!==t)return n(e),e},e.prototype.enqueue=function(t){var e=this._sentinel;t._prev&&t._next&&n(t),t._next=e._next,e._next._prev=t,e._next=t,t._prev=e},e.prototype.toString=function(){for(var t=[],e=this._sentinel,n=e._prev;n!==e;)t.push(JSON.stringify(n,r)),n=n._prev;return"["+t.join(", ")+"]"}},5862:(t,e,n)=>{var r=n(680),i=n(2017),a=n(3802).Graph;t.exports={debugOrdering:function(t){var e=i.buildLayerMatrix(t),n=new a({compound:!0,multigraph:!0}).setGraph({});return r.forEach(t.nodes(),(function(e){n.setNode(e,{label:e}),n.setParent(e,"layer"+t.node(e).rank)})),r.forEach(t.edges(),(function(t){n.setEdge(t.v,t.w,{},t.name)})),r.forEach(e,(function(t,e){var i="layer"+e;n.setNode(i,{rank:"same"}),r.reduce(t,(function(t,e){return n.setEdge(t,e,{style:"invis"}),e}))})),n}}},3802:(t,e,n)=>{var r;try{r=n(835)}catch(t){}r||(r=window.graphlib),t.exports=r},2306:(t,e,n)=>{var r=n(680),i=n(3802).Graph,a=n(468);t.exports=function(t,e){if(t.nodeCount()<=1)return[];var n=function(t,e){var n=new i,o=0,s=0;r.forEach(t.nodes(),(function(t){n.setNode(t,{v:t,in:0,out:0})})),r.forEach(t.edges(),(function(t){var r=n.edge(t.v,t.w)||0,i=e(t),a=r+i;n.setEdge(t.v,t.w,a),s=Math.max(s,n.node(t.v).out+=i),o=Math.max(o,n.node(t.w).in+=i)}));var c=r.range(s+o+3).map((function(){return new a})),l=o+1;return r.forEach(n.nodes(),(function(t){u(c,l,n.node(t))})),{graph:n,buckets:c,zeroIdx:l}}(t,e||o),c=function(t,e,n){for(var r,i=[],a=e[e.length-1],o=e[0];t.nodeCount();){for(;r=o.dequeue();)s(t,e,n,r);for(;r=a.dequeue();)s(t,e,n,r);if(t.nodeCount())for(var u=e.length-2;u>0;--u)if(r=e[u].dequeue()){i=i.concat(s(t,e,n,r,!0));break}}return i}(n.graph,n.buckets,n.zeroIdx);return r.flatten(r.map(c,(function(e){return t.outEdges(e.v,e.w)})),!0)};var o=r.constant(1);function s(t,e,n,i,a){var o=a?[]:void 0;return r.forEach(t.inEdges(i.v),(function(r){var i=t.edge(r),s=t.node(r.v);a&&o.push({v:r.v,w:r.w}),s.out-=i,u(e,n,s)})),r.forEach(t.outEdges(i.v),(function(r){var i=t.edge(r),a=r.w,o=t.node(a);o.in-=i,u(e,n,o)})),t.removeNode(i.v),o}function u(t,e,n){n.out?n.in?t[n.out-n.in+e].enqueue(n):t[t.length-1].enqueue(n):t[0].enqueue(n)}},8843:(t,e,n)=>{"use strict";var r=n(680),i=n(33),a=n(9482),o=n(1460),s=n(2017).normalizeRanks,u=n(427),c=n(2017).removeEmptyRanks,l=n(9538),h=n(5372),d=n(6722),f=n(6222),v=n(8645),p=n(2017),g=n(3802).Graph;t.exports=function(t,e){var n=e&&e.debugTiming?p.time:p.notime;n("layout",(function(){var e=n("  buildLayoutGraph",(function(){return function(t){var e=new g({multigraph:!0,compound:!0}),n=O(t.graph());return e.setGraph(r.merge({},m,S(n,y),r.pick(n,b))),r.forEach(t.nodes(),(function(n){var i=O(t.node(n));e.setNode(n,r.defaults(S(i,x),w)),e.setParent(n,t.parent(n))})),r.forEach(t.edges(),(function(n){var i=O(t.edge(n));e.setEdge(n,r.merge({},k,S(i,E),r.pick(i,M)))})),e}(t)}));n("  runLayout",(function(){!function(t,e){e("    makeSpaceForEdgeLabels",(function(){!function(t){var e=t.graph();e.ranksep/=2,r.forEach(t.edges(),(function(n){var r=t.edge(n);r.minlen*=2,"c"!==r.labelpos.toLowerCase()&&("TB"===e.rankdir||"BT"===e.rankdir?r.width+=r.labeloffset:r.height+=r.labeloffset)}))}(t)})),e("    removeSelfEdges",(function(){!function(t){r.forEach(t.edges(),(function(e){if(e.v===e.w){var n=t.node(e.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e,label:t.edge(e)}),t.removeEdge(e)}}))}(t)})),e("    acyclic",(function(){i.run(t)})),e("    nestingGraph.run",(function(){l.run(t)})),e("    rank",(function(){o(p.asNonCompoundGraph(t))})),e("    injectEdgeLabelProxies",(function(){!function(t){r.forEach(t.edges(),(function(e){var n=t.edge(e);if(n.width&&n.height){var r=t.node(e.v),i={rank:(t.node(e.w).rank-r.rank)/2+r.rank,e};p.addDummyNode(t,"edge-proxy",i,"_ep")}}))}(t)})),e("    removeEmptyRanks",(function(){c(t)})),e("    nestingGraph.cleanup",(function(){l.cleanup(t)})),e("    normalizeRanks",(function(){s(t)})),e("    assignRankMinMax",(function(){!function(t){var e=0;r.forEach(t.nodes(),(function(n){var i=t.node(n);i.borderTop&&(i.minRank=t.node(i.borderTop).rank,i.maxRank=t.node(i.borderBottom).rank,e=r.max(e,i.maxRank))})),t.graph().maxRank=e}(t)})),e("    removeEdgeLabelProxies",(function(){!function(t){r.forEach(t.nodes(),(function(e){var n=t.node(e);"edge-proxy"===n.dummy&&(t.edge(n.e).labelRank=n.rank,t.removeNode(e))}))}(t)})),e("    normalize.run",(function(){a.run(t)})),e("    parentDummyChains",(function(){u(t)})),e("    addBorderSegments",(function(){h(t)})),e("    order",(function(){f(t)})),e("    insertSelfEdges",(function(){!function(t){var e=p.buildLayerMatrix(t);r.forEach(e,(function(e){var n=0;r.forEach(e,(function(e,i){var a=t.node(e);a.order=i+n,r.forEach(a.selfEdges,(function(e){p.addDummyNode(t,"selfedge",{width:e.label.width,height:e.label.height,rank:a.rank,order:i+ ++n,e:e.e,label:e.label},"_se")})),delete a.selfEdges}))}))}(t)})),e("    adjustCoordinateSystem",(function(){d.adjust(t)})),e("    position",(function(){v(t)})),e("    positionSelfEdges",(function(){!function(t){r.forEach(t.nodes(),(function(e){var n=t.node(e);if("selfedge"===n.dummy){var r=t.node(n.e.v),i=r.x+r.width/2,a=r.y,o=n.x-i,s=r.height/2;t.setEdge(n.e,n.label),t.removeNode(e),n.label.points=[{x:i+2*o/3,y:a-s},{x:i+5*o/6,y:a-s},{x:i+o,y:a},{x:i+5*o/6,y:a+s},{x:i+2*o/3,y:a+s}],n.label.x=n.x,n.label.y=n.y}}))}(t)})),e("    removeBorderNodes",(function(){!function(t){r.forEach(t.nodes(),(function(e){if(t.children(e).length){var n=t.node(e),i=t.node(n.borderTop),a=t.node(n.borderBottom),o=t.node(r.last(n.borderLeft)),s=t.node(r.last(n.borderRight));n.width=Math.abs(s.x-o.x),n.height=Math.abs(a.y-i.y),n.x=o.x+n.width/2,n.y=i.y+n.height/2}})),r.forEach(t.nodes(),(function(e){"border"===t.node(e).dummy&&t.removeNode(e)}))}(t)})),e("    normalize.undo",(function(){a.undo(t)})),e("    fixupEdgeLabelCoords",(function(){!function(t){r.forEach(t.edges(),(function(e){var n=t.edge(e);if(r.has(n,"x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}}))}(t)})),e("    undoCoordinateSystem",(function(){d.undo(t)})),e("    translateGraph",(function(){!function(t){var e=Number.POSITIVE_INFINITY,n=0,i=Number.POSITIVE_INFINITY,a=0,o=t.graph(),s=o.marginx||0,u=o.marginy||0;function c(t){var r=t.x,o=t.y,s=t.width,u=t.height;e=Math.min(e,r-s/2),n=Math.max(n,r+s/2),i=Math.min(i,o-u/2),a=Math.max(a,o+u/2)}r.forEach(t.nodes(),(function(e){c(t.node(e))})),r.forEach(t.edges(),(function(e){var n=t.edge(e);r.has(n,"x")&&c(n)})),e-=s,i-=u,r.forEach(t.nodes(),(function(n){var r=t.node(n);r.x-=e,r.y-=i})),r.forEach(t.edges(),(function(n){var a=t.edge(n);r.forEach(a.points,(function(t){t.x-=e,t.y-=i})),r.has(a,"x")&&(a.x-=e),r.has(a,"y")&&(a.y-=i)})),o.width=n-e+s,o.height=a-i+u}(t)})),e("    assignNodeIntersects",(function(){!function(t){r.forEach(t.edges(),(function(e){var n,r,i=t.edge(e),a=t.node(e.v),o=t.node(e.w);i.points?(n=i.points[0],r=i.points[i.points.length-1]):(i.points=[],n=o,r=a),i.points.unshift(p.intersectRect(a,n)),i.points.push(p.intersectRect(o,r))}))}(t)})),e("    reversePoints",(function(){!function(t){r.forEach(t.edges(),(function(e){var n=t.edge(e);n.reversed&&n.points.reverse()}))}(t)})),e("    acyclic.undo",(function(){i.undo(t)}))}(e,n)})),n("  updateInputGraph",(function(){!function(t,e){r.forEach(t.nodes(),(function(n){var r=t.node(n),i=e.node(n);r&&(r.x=i.x,r.y=i.y,e.children(n).length&&(r.width=i.width,r.height=i.height))})),r.forEach(t.edges(),(function(n){var i=t.edge(n),a=e.edge(n);i.points=a.points,r.has(a,"x")&&(i.x=a.x,i.y=a.y)})),t.graph().width=e.graph().width,t.graph().height=e.graph().height}(t,e)}))}))};var y=["nodesep","edgesep","ranksep","marginx","marginy"],m={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},b=["acyclicer","ranker","rankdir","align"],x=["width","height"],w={width:0,height:0},E=["minlen","weight","width","height","labeloffset"],k={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},M=["labelpos"];function S(t,e){return r.mapValues(r.pick(t,e),Number)}function O(t){var e={};return r.forEach(t,(function(t,n){e[n.toLowerCase()]=t})),e}},680:(t,e,n)=>{var r;try{r={cloneDeep:n(8388),constant:n(4739),defaults:n(2589),each:n(3293),filter:n(3013),find:n(2792),flatten:n(7417),forEach:n(2385),forIn:n(2779),has:n(8127),isUndefined:n(235),last:n(8847),map:n(9553),mapValues:n(227),max:n(6089),merge:n(4635),min:n(8043),minBy:n(3866),now:n(4679),pick:n(9170),range:n(2982),reduce:n(2633),sortBy:n(9842),uniqueId:n(7157),values:n(1793),zipObject:n(1059)}}catch(t){}r||(r=window._),t.exports=r},9538:(t,e,n)=>{var r=n(680),i=n(2017);function a(t,e,n,o,s,u,c){var l=t.children(c);if(l.length){var h=i.addBorderNode(t,"_bt"),d=i.addBorderNode(t,"_bb"),f=t.node(c);t.setParent(h,c),f.borderTop=h,t.setParent(d,c),f.borderBottom=d,r.forEach(l,(function(r){a(t,e,n,o,s,u,r);var i=t.node(r),l=i.borderTop?i.borderTop:r,f=i.borderBottom?i.borderBottom:r,v=i.borderTop?o:2*o,p=l!==f?1:s-u[c]+1;t.setEdge(h,l,{weight:v,minlen:p,nestingEdge:!0}),t.setEdge(f,d,{weight:v,minlen:p,nestingEdge:!0})})),t.parent(c)||t.setEdge(e,h,{weight:0,minlen:s+u[c]})}else c!==e&&t.setEdge(e,c,{weight:0,minlen:n})}t.exports={run:function(t){var e=i.addDummyNode(t,"root",{},"_root"),n=function(t){var e={};function n(i,a){var o=t.children(i);o&&o.length&&r.forEach(o,(function(t){n(t,a+1)})),e[i]=a}return r.forEach(t.children(),(function(t){n(t,1)})),e}(t),o=r.max(r.values(n))-1,s=2*o+1;t.graph().nestingRoot=e,r.forEach(t.edges(),(function(e){t.edge(e).minlen*=s}));var u=function(t){return r.reduce(t.edges(),(function(e,n){return e+t.edge(n).weight}),0)}(t)+1;r.forEach(t.children(),(function(r){a(t,e,s,u,o,n,r)})),t.graph().nodeRankFactor=s},cleanup:function(t){var e=t.graph();t.removeNode(e.nestingRoot),delete e.nestingRoot,r.forEach(t.edges(),(function(e){t.edge(e).nestingEdge&&t.removeEdge(e)}))}}},9482:(t,e,n)=>{"use strict";var r=n(680),i=n(2017);t.exports={run:function(t){t.graph().dummyChains=[],r.forEach(t.edges(),(function(e){!function(t,e){var n,r,a,o=e.v,s=t.node(o).rank,u=e.w,c=t.node(u).rank,l=e.name,h=t.edge(e),d=h.labelRank;if(c!==s+1){for(t.removeEdge(e),a=0,++s;s<c;++a,++s)h.points=[],r={width:0,height:0,edgeLabel:h,edgeObj:e,rank:s},n=i.addDummyNode(t,"edge",r,"_d"),s===d&&(r.width=h.width,r.height=h.height,r.dummy="edge-label",r.labelpos=h.labelpos),t.setEdge(o,n,{weight:h.weight},l),0===a&&t.graph().dummyChains.push(n),o=n;t.setEdge(o,u,{weight:h.weight},l)}}(t,e)}))},undo:function(t){r.forEach(t.graph().dummyChains,(function(e){var n,r=t.node(e),i=r.edgeLabel;for(t.setEdge(r.edgeObj,i);r.dummy;)n=t.successors(e)[0],t.removeNode(e),i.points.push({x:r.x,y:r.y}),"edge-label"===r.dummy&&(i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height),e=n,r=t.node(e)}))}}},6981:(t,e,n)=>{var r=n(680);t.exports=function(t,e,n){var i,a={};r.forEach(n,(function(n){for(var r,o,s=t.parent(n);s;){if((r=t.parent(s))?(o=a[r],a[r]=s):(o=i,i=s),o&&o!==s)return void e.setEdge(o,s);s=r}}))}},1409:(t,e,n)=>{var r=n(680);t.exports=function(t,e){return r.map(e,(function(e){var n=t.inEdges(e);if(n.length){var i=r.reduce(n,(function(e,n){var r=t.edge(n),i=t.node(n.v);return{sum:e.sum+r.weight*i.order,weight:e.weight+r.weight}}),{sum:0,weight:0});return{v:e,barycenter:i.sum/i.weight,weight:i.weight}}return{v:e}}))}},7323:(t,e,n)=>{var r=n(680),i=n(3802).Graph;t.exports=function(t,e,n){var a=function(t){for(var e;t.hasNode(e=r.uniqueId("_root")););return e}(t),o=new i({compound:!0}).setGraph({root:a}).setDefaultNodeLabel((function(e){return t.node(e)}));return r.forEach(t.nodes(),(function(i){var s=t.node(i),u=t.parent(i);(s.rank===e||s.minRank<=e&&e<=s.maxRank)&&(o.setNode(i),o.setParent(i,u||a),r.forEach(t[n](i),(function(e){var n=e.v===i?e.w:e.v,a=o.edge(n,i),s=r.isUndefined(a)?0:a.weight;o.setEdge(n,i,{weight:t.edge(e).weight+s})})),r.has(s,"minRank")&&o.setNode(i,{borderLeft:s.borderLeft[e],borderRight:s.borderRight[e]}))})),o}},3004:(t,e,n)=>{"use strict";var r=n(680);function i(t,e,n){for(var i=r.zipObject(n,r.map(n,(function(t,e){return e}))),a=r.flatten(r.map(e,(function(e){return r.sortBy(r.map(t.outEdges(e),(function(e){return{pos:i[e.w],weight:t.edge(e).weight}})),"pos")})),!0),o=1;o<n.length;)o<<=1;var s=2*o-1;o-=1;var u=r.map(new Array(s),(function(){return 0})),c=0;return r.forEach(a.forEach((function(t){var e=t.pos+o;u[e]+=t.weight;for(var n=0;e>0;)e%2&&(n+=u[e+1]),u[e=e-1>>1]+=t.weight;c+=t.weight*n}))),c}t.exports=function(t,e){for(var n=0,r=1;r<e.length;++r)n+=i(t,e[r-1],e[r]);return n}},6222:(t,e,n)=>{"use strict";var r=n(680),i=n(5427),a=n(3004),o=n(2295),s=n(7323),u=n(6981),c=n(3802).Graph,l=n(2017);function h(t,e,n){return r.map(e,(function(e){return s(t,e,n)}))}function d(t,e){var n=new c;r.forEach(t,(function(t){var i=t.graph().root,a=o(t,i,n,e);r.forEach(a.vs,(function(e,n){t.node(e).order=n})),u(t,n,a.vs)}))}function f(t,e){r.forEach(e,(function(e){r.forEach(e,(function(e,n){t.node(e).order=n}))}))}t.exports=function(t){var e=l.maxRank(t),n=h(t,r.range(1,e+1),"inEdges"),o=h(t,r.range(e-1,-1,-1),"outEdges"),s=i(t);f(t,s);for(var u,c=Number.POSITIVE_INFINITY,v=0,p=0;p<4;++v,++p){d(v%2?n:o,v%4>=2),s=l.buildLayerMatrix(t);var g=a(t,s);g<c&&(p=0,u=r.cloneDeep(s),c=g)}f(t,u)}},5427:(t,e,n)=>{"use strict";var r=n(680);t.exports=function(t){var e={},n=r.filter(t.nodes(),(function(e){return!t.children(e).length})),i=r.max(r.map(n,(function(e){return t.node(e).rank}))),a=r.map(r.range(i+1),(function(){return[]})),o=r.sortBy(n,(function(e){return t.node(e).rank}));return r.forEach(o,(function n(i){if(!r.has(e,i)){e[i]=!0;var o=t.node(i);a[o.rank].push(i),r.forEach(t.successors(i),n)}})),a}},9940:(t,e,n)=>{"use strict";var r=n(680);t.exports=function(t,e){var n={};return r.forEach(t,(function(t,e){var i=n[t.v]={indegree:0,in:[],out:[],vs:[t.v],i:e};r.isUndefined(t.barycenter)||(i.barycenter=t.barycenter,i.weight=t.weight)})),r.forEach(e.edges(),(function(t){var e=n[t.v],i=n[t.w];r.isUndefined(e)||r.isUndefined(i)||(i.indegree++,e.out.push(n[t.w]))})),function(t){var e=[];function n(t){return function(e){var n,i,a,o;e.merged||(r.isUndefined(e.barycenter)||r.isUndefined(t.barycenter)||e.barycenter>=t.barycenter)&&(i=e,a=0,o=0,(n=t).weight&&(a+=n.barycenter*n.weight,o+=n.weight),i.weight&&(a+=i.barycenter*i.weight,o+=i.weight),n.vs=i.vs.concat(n.vs),n.barycenter=a/o,n.weight=o,n.i=Math.min(i.i,n.i),i.merged=!0)}}function i(e){return function(n){n.in.push(e),0==--n.indegree&&t.push(n)}}for(;t.length;){var a=t.pop();e.push(a),r.forEach(a.in.reverse(),n(a)),r.forEach(a.out,i(a))}return r.map(r.filter(e,(function(t){return!t.merged})),(function(t){return r.pick(t,["vs","i","barycenter","weight"])}))}(r.filter(n,(function(t){return!t.indegree})))}},2295:(t,e,n)=>{var r=n(680),i=n(1409),a=n(9940),o=n(4012);t.exports=function t(e,n,s,u){var c=e.children(n),l=e.node(n),h=l?l.borderLeft:void 0,d=l?l.borderRight:void 0,f={};h&&(c=r.filter(c,(function(t){return t!==h&&t!==d})));var v=i(e,c);r.forEach(v,(function(n){if(e.children(n.v).length){var i=t(e,n.v,s,u);f[n.v]=i,r.has(i,"barycenter")&&(a=n,o=i,r.isUndefined(a.barycenter)?(a.barycenter=o.barycenter,a.weight=o.weight):(a.barycenter=(a.barycenter*a.weight+o.barycenter*o.weight)/(a.weight+o.weight),a.weight+=o.weight))}var a,o}));var p=a(v,s);!function(t,e){r.forEach(t,(function(t){t.vs=r.flatten(t.vs.map((function(t){return e[t]?e[t].vs:t})),!0)}))}(p,f);var g=o(p,u);if(h&&(g.vs=r.flatten([h,g.vs,d],!0),e.predecessors(h).length)){var y=e.node(e.predecessors(h)[0]),m=e.node(e.predecessors(d)[0]);r.has(g,"barycenter")||(g.barycenter=0,g.weight=0),g.barycenter=(g.barycenter*g.weight+y.order+m.order)/(g.weight+2),g.weight+=2}return g}},4012:(t,e,n)=>{var r=n(680),i=n(2017);function a(t,e,n){for(var i;e.length&&(i=r.last(e)).i<=n;)e.pop(),t.push(i.vs),n++;return n}t.exports=function(t,e){var n,o=i.partition(t,(function(t){return r.has(t,"barycenter")})),s=o.lhs,u=r.sortBy(o.rhs,(function(t){return-t.i})),c=[],l=0,h=0,d=0;s.sort((n=!!e,function(t,e){return t.barycenter<e.barycenter?-1:t.barycenter>e.barycenter?1:n?e.i-t.i:t.i-e.i})),d=a(c,u,d),r.forEach(s,(function(t){d+=t.vs.length,c.push(t.vs),l+=t.barycenter*t.weight,h+=t.weight,d=a(c,u,d)}));var f={vs:r.flatten(c,!0)};return h&&(f.barycenter=l/h,f.weight=h),f}},427:(t,e,n)=>{var r=n(680);t.exports=function(t){var e=function(t){var e={},n=0;return r.forEach(t.children(),(function i(a){var o=n;r.forEach(t.children(a),i),e[a]={low:o,lim:n++}})),e}(t);r.forEach(t.graph().dummyChains,(function(n){for(var r=t.node(n),i=r.edgeObj,a=function(t,e,n,r){var i,a,o=[],s=[],u=Math.min(e[n].low,e[r].low),c=Math.max(e[n].lim,e[r].lim);i=n;do{i=t.parent(i),o.push(i)}while(i&&(e[i].low>u||c>e[i].lim));for(a=i,i=r;(i=t.parent(i))!==a;)s.push(i);return{path:o.concat(s.reverse()),lca:a}}(t,e,i.v,i.w),o=a.path,s=a.lca,u=0,c=o[u],l=!0;n!==i.w;){if(r=t.node(n),l){for(;(c=o[u])!==s&&t.node(c).maxRank<r.rank;)u++;c===s&&(l=!1)}if(!l){for(;u<o.length-1&&t.node(c=o[u+1]).minRank<=r.rank;)u++;c=o[u]}t.setParent(n,c),n=t.successors(n)[0]}}))}},4958:(t,e,n)=>{"use strict";var r=n(680),i=n(3802).Graph,a=n(2017);function o(t,e){var n={};return r.reduce(e,(function(e,i){var a=0,o=0,s=e.length,c=r.last(i);return r.forEach(i,(function(e,l){var h=function(t,e){if(t.node(e).dummy)return r.find(t.predecessors(e),(function(e){return t.node(e).dummy}))}(t,e),d=h?t.node(h).order:s;(h||e===c)&&(r.forEach(i.slice(o,l+1),(function(e){r.forEach(t.predecessors(e),(function(r){var i=t.node(r),o=i.order;!(o<a||d<o)||i.dummy&&t.node(e).dummy||u(n,r,e)}))})),o=l+1,a=d)})),i})),n}function s(t,e){var n={};function i(e,i,a,o,s){var c;r.forEach(r.range(i,a),(function(i){c=e[i],t.node(c).dummy&&r.forEach(t.predecessors(c),(function(e){var r=t.node(e);r.dummy&&(r.order<o||r.order>s)&&u(n,e,c)}))}))}return r.reduce(e,(function(e,n){var a,o=-1,s=0;return r.forEach(n,(function(r,u){if("border"===t.node(r).dummy){var c=t.predecessors(r);c.length&&(a=t.node(c[0]).order,i(n,s,u,o,a),s=u,o=a)}i(n,s,n.length,a,e.length)})),n})),n}function u(t,e,n){if(e>n){var r=e;e=n,n=r}var i=t[e];i||(t[e]=i={}),i[n]=!0}function c(t,e,n){if(e>n){var i=e;e=n,n=i}return r.has(t[e],n)}function l(t,e,n,i){var a={},o={},s={};return r.forEach(e,(function(t){r.forEach(t,(function(t,e){a[t]=t,o[t]=t,s[t]=e}))})),r.forEach(e,(function(t){var e=-1;r.forEach(t,(function(t){var u=i(t);if(u.length){u=r.sortBy(u,(function(t){return s[t]}));for(var l=(u.length-1)/2,h=Math.floor(l),d=Math.ceil(l);h<=d;++h){var f=u[h];o[t]===t&&e<s[f]&&!c(n,t,f)&&(o[f]=t,o[t]=a[t]=a[f],e=s[f])}}}))})),{root:a,align:o}}function h(t,e,n,a,o){var s={},u=function(t,e,n,a){var o=new i,s=t.graph(),u=function(t,e,n){return function(i,a,o){var s,u=i.node(a),c=i.node(o),l=0;if(l+=u.width/2,r.has(u,"labelpos"))switch(u.labelpos.toLowerCase()){case"l":s=-u.width/2;break;case"r":s=u.width/2}if(s&&(l+=n?s:-s),s=0,l+=(u.dummy?e:t)/2,l+=(c.dummy?e:t)/2,l+=c.width/2,r.has(c,"labelpos"))switch(c.labelpos.toLowerCase()){case"l":s=c.width/2;break;case"r":s=-c.width/2}return s&&(l+=n?s:-s),s=0,l}}(s.nodesep,s.edgesep,a);return r.forEach(e,(function(e){var i;r.forEach(e,(function(e){var r=n[e];if(o.setNode(r),i){var a=n[i],s=o.edge(a,r);o.setEdge(a,r,Math.max(u(t,e,i),s||0))}i=e}))})),o}(t,e,n,o),c=o?"borderLeft":"borderRight";function l(t,e){for(var n=u.nodes(),r=n.pop(),i={};r;)i[r]?t(r):(i[r]=!0,n.push(r),n=n.concat(e(r))),r=n.pop()}return l((function(t){s[t]=u.inEdges(t).reduce((function(t,e){return Math.max(t,s[e.v]+u.edge(e))}),0)}),u.predecessors.bind(u)),l((function(e){var n=u.outEdges(e).reduce((function(t,e){return Math.min(t,s[e.w]-u.edge(e))}),Number.POSITIVE_INFINITY),r=t.node(e);n!==Number.POSITIVE_INFINITY&&r.borderType!==c&&(s[e]=Math.max(s[e],n))}),u.successors.bind(u)),r.forEach(a,(function(t){s[t]=s[n[t]]})),s}function d(t,e){return r.minBy(r.values(e),(function(e){var n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return r.forIn(e,(function(e,r){var a=function(t,e){return t.node(e).width}(t,r)/2;n=Math.max(e+a,n),i=Math.min(e-a,i)})),n-i}))}function f(t,e){var n=r.values(e),i=r.min(n),a=r.max(n);r.forEach(["u","d"],(function(n){r.forEach(["l","r"],(function(o){var s,u=n+o,c=t[u];if(c!==e){var l=r.values(c);(s="l"===o?i-r.min(l):a-r.max(l))&&(t[u]=r.mapValues(c,(function(t){return t+s})))}}))}))}function v(t,e){return r.mapValues(t.ul,(function(n,i){if(e)return t[e.toLowerCase()][i];var a=r.sortBy(r.map(t,i));return(a[1]+a[2])/2}))}t.exports={positionX:function(t){var e,n=a.buildLayerMatrix(t),i=r.merge(o(t,n),s(t,n)),u={};r.forEach(["u","d"],(function(a){e="u"===a?n:r.values(n).reverse(),r.forEach(["l","r"],(function(n){"r"===n&&(e=r.map(e,(function(t){return r.values(t).reverse()})));var o=("u"===a?t.predecessors:t.successors).bind(t),s=l(0,e,i,o),c=h(t,e,s.root,s.align,"r"===n);"r"===n&&(c=r.mapValues(c,(function(t){return-t}))),u[a+n]=c}))}));var c=d(t,u);return f(u,c),v(u,t.graph().align)},findType1Conflicts:o,findType2Conflicts:s,addConflict:u,hasConflict:c,verticalAlignment:l,horizontalCompaction:h,alignCoordinates:f,findSmallestWidthAlignment:d,balance:v}},8645:(t,e,n)=>{"use strict";var r=n(680),i=n(2017),a=n(4958).positionX;t.exports=function(t){(function(t){var e=i.buildLayerMatrix(t),n=t.graph().ranksep,a=0;r.forEach(e,(function(e){var i=r.max(r.map(e,(function(e){return t.node(e).height})));r.forEach(e,(function(e){t.node(e).y=a+i/2})),a+=i+n}))})(t=i.asNonCompoundGraph(t)),r.forEach(a(t),(function(e,n){t.node(n).x=e}))}},7768:(t,e,n)=>{"use strict";var r=n(680),i=n(3802).Graph,a=n(7798).slack;function o(t,e){return r.forEach(t.nodes(),(function n(i){r.forEach(e.nodeEdges(i),(function(r){var o=r.v,s=i===o?r.w:o;t.hasNode(s)||a(e,r)||(t.setNode(s,{}),t.setEdge(i,s,{}),n(s))}))})),t.nodeCount()}function s(t,e){return r.minBy(e.edges(),(function(n){if(t.hasNode(n.v)!==t.hasNode(n.w))return a(e,n)}))}function u(t,e,n){r.forEach(t.nodes(),(function(t){e.node(t).rank+=n}))}t.exports=function(t){var e,n,r=new i({directed:!1}),c=t.nodes()[0],l=t.nodeCount();for(r.setNode(c,{});o(r,t)<l;)e=s(r,t),n=r.hasNode(e.v)?a(t,e):-a(t,e),u(r,t,n);return r}},1460:(t,e,n)=>{"use strict";var r=n(7798).longestPath,i=n(7768),a=n(3021);t.exports=function(t){switch(t.graph().ranker){case"network-simplex":default:!function(t){a(t)}(t);break;case"tight-tree":!function(t){r(t),i(t)}(t);break;case"longest-path":o(t)}};var o=r},3021:(t,e,n)=>{"use strict";var r=n(680),i=n(7768),a=n(7798).slack,o=n(7798).longestPath,s=n(3802).alg.preorder,u=n(3802).alg.postorder,c=n(2017).simplify;function l(t){t=c(t),o(t);var e,n=i(t);for(f(n),h(n,t);e=p(n);)y(n,t,e,g(n,t,e))}function h(t,e){var n=u(t,t.nodes());n=n.slice(0,n.length-1),r.forEach(n,(function(n){!function(t,e,n){var r=t.node(n).parent;t.edge(n,r).cutvalue=d(t,e,n)}(t,e,n)}))}function d(t,e,n){var i=t.node(n).parent,a=!0,o=e.edge(n,i),s=0;return o||(a=!1,o=e.edge(i,n)),s=o.weight,r.forEach(e.nodeEdges(n),(function(r){var o,u,c=r.v===n,l=c?r.w:r.v;if(l!==i){var h=c===a,d=e.edge(r).weight;if(s+=h?d:-d,o=n,u=l,t.hasEdge(o,u)){var f=t.edge(n,l).cutvalue;s+=h?-f:f}}})),s}function f(t,e){arguments.length<2&&(e=t.nodes()[0]),v(t,{},1,e)}function v(t,e,n,i,a){var o=n,s=t.node(i);return e[i]=!0,r.forEach(t.neighbors(i),(function(a){r.has(e,a)||(n=v(t,e,n,a,i))})),s.low=o,s.lim=n++,a?s.parent=a:delete s.parent,n}function p(t){return r.find(t.edges(),(function(e){return t.edge(e).cutvalue<0}))}function g(t,e,n){var i=n.v,o=n.w;e.hasEdge(i,o)||(i=n.w,o=n.v);var s=t.node(i),u=t.node(o),c=s,l=!1;s.lim>u.lim&&(c=u,l=!0);var h=r.filter(e.edges(),(function(e){return l===m(0,t.node(e.v),c)&&l!==m(0,t.node(e.w),c)}));return r.minBy(h,(function(t){return a(e,t)}))}function y(t,e,n,i){var a=n.v,o=n.w;t.removeEdge(a,o),t.setEdge(i.v,i.w,{}),f(t),h(t,e),function(t,e){var n=r.find(t.nodes(),(function(t){return!e.node(t).parent})),i=s(t,n);i=i.slice(1),r.forEach(i,(function(n){var r=t.node(n).parent,i=e.edge(n,r),a=!1;i||(i=e.edge(r,n),a=!0),e.node(n).rank=e.node(r).rank+(a?i.minlen:-i.minlen)}))}(t,e)}function m(t,e,n){return n.low<=e.lim&&e.lim<=n.lim}t.exports=l,l.initLowLimValues=f,l.initCutValues=h,l.calcCutValue=d,l.leaveEdge=p,l.enterEdge=g,l.exchangeEdges=y},7798:(t,e,n)=>{"use strict";var r=n(680);t.exports={longestPath:function(t){var e={};r.forEach(t.sources(),(function n(i){var a=t.node(i);if(r.has(e,i))return a.rank;e[i]=!0;var o=r.min(r.map(t.outEdges(i),(function(e){return n(e.w)-t.edge(e).minlen})));return o!==Number.POSITIVE_INFINITY&&null!=o||(o=0),a.rank=o}))},slack:function(t,e){return t.node(e.w).rank-t.node(e.v).rank-t.edge(e).minlen}}},2017:(t,e,n)=>{"use strict";var r=n(680),i=n(3802).Graph;function a(t,e,n,i){var a;do{a=r.uniqueId(i)}while(t.hasNode(a));return n.dummy=e,t.setNode(a,n),a}function o(t){return r.max(r.map(t.nodes(),(function(e){var n=t.node(e).rank;if(!r.isUndefined(n))return n})))}t.exports={addDummyNode:a,simplify:function(t){var e=(new i).setGraph(t.graph());return r.forEach(t.nodes(),(function(n){e.setNode(n,t.node(n))})),r.forEach(t.edges(),(function(n){var r=e.edge(n.v,n.w)||{weight:0,minlen:1},i=t.edge(n);e.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})})),e},asNonCompoundGraph:function(t){var e=new i({multigraph:t.isMultigraph()}).setGraph(t.graph());return r.forEach(t.nodes(),(function(n){t.children(n).length||e.setNode(n,t.node(n))})),r.forEach(t.edges(),(function(n){e.setEdge(n,t.edge(n))})),e},successorWeights:function(t){var e=r.map(t.nodes(),(function(e){var n={};return r.forEach(t.outEdges(e),(function(e){n[e.w]=(n[e.w]||0)+t.edge(e).weight})),n}));return r.zipObject(t.nodes(),e)},predecessorWeights:function(t){var e=r.map(t.nodes(),(function(e){var n={};return r.forEach(t.inEdges(e),(function(e){n[e.v]=(n[e.v]||0)+t.edge(e).weight})),n}));return r.zipObject(t.nodes(),e)},intersectRect:function(t,e){var n,r,i=t.x,a=t.y,o=e.x-i,s=e.y-a,u=t.width/2,c=t.height/2;if(!o&&!s)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(s)*u>Math.abs(o)*c?(s<0&&(c=-c),n=c*o/s,r=c):(o<0&&(u=-u),n=u,r=u*s/o),{x:i+n,y:a+r}},buildLayerMatrix:function(t){var e=r.map(r.range(o(t)+1),(function(){return[]}));return r.forEach(t.nodes(),(function(n){var i=t.node(n),a=i.rank;r.isUndefined(a)||(e[a][i.order]=n)})),e},normalizeRanks:function(t){var e=r.min(r.map(t.nodes(),(function(e){return t.node(e).rank})));r.forEach(t.nodes(),(function(n){var i=t.node(n);r.has(i,"rank")&&(i.rank-=e)}))},removeEmptyRanks:function(t){var e=r.min(r.map(t.nodes(),(function(e){return t.node(e).rank}))),n=[];r.forEach(t.nodes(),(function(r){var i=t.node(r).rank-e;n[i]||(n[i]=[]),n[i].push(r)}));var i=0,a=t.graph().nodeRankFactor;r.forEach(n,(function(e,n){r.isUndefined(e)&&n%a!=0?--i:i&&r.forEach(e,(function(e){t.node(e).rank+=i}))}))},addBorderNode:function(t,e,n,r){var i={width:0,height:0};return arguments.length>=4&&(i.rank=n,i.order=r),a(t,"border",i,e)},maxRank:o,partition:function(t,e){var n={lhs:[],rhs:[]};return r.forEach(t,(function(t){e(t)?n.lhs.push(t):n.rhs.push(t)})),n},time:function(t,e){var n=r.now();try{return e()}finally{console.log(t+" time: "+(r.now()-n)+"ms")}},notime:function(t,e){return e()}}},6982:t=>{t.exports="0.8.5"},1668:t=>{"use strict";var e=Object.prototype.hasOwnProperty,n="~";function r(){}function i(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function a(t,e,r,a,o){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new i(r,a||t,o),u=n?n+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],s]:t._events[u].push(s):(t._events[u]=s,t._eventsCount++),t}function o(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var t,r,i=[];if(0===this._eventsCount)return i;for(r in t=this._events)e.call(t,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},s.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,a=r.length,o=new Array(a);i<a;i++)o[i]=r[i].fn;return o},s.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},s.prototype.emit=function(t,e,r,i,a,o){var s=n?n+t:t;if(!this._events[s])return!1;var u,c,l=this._events[s],h=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),h){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,r),!0;case 4:return l.fn.call(l.context,e,r,i),!0;case 5:return l.fn.call(l.context,e,r,i,a),!0;case 6:return l.fn.call(l.context,e,r,i,a,o),!0}for(c=1,u=new Array(h-1);c<h;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var d,f=l.length;for(c=0;c<f;c++)switch(l[c].once&&this.removeListener(t,l[c].fn,void 0,!0),h){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,e);break;case 3:l[c].fn.call(l[c].context,e,r);break;case 4:l[c].fn.call(l[c].context,e,r,i);break;default:if(!u)for(d=1,u=new Array(h-1);d<h;d++)u[d-1]=arguments[d];l[c].fn.apply(l[c].context,u)}}return!0},s.prototype.on=function(t,e,n){return a(this,t,e,n,!1)},s.prototype.once=function(t,e,n){return a(this,t,e,n,!0)},s.prototype.removeListener=function(t,e,r,i){var a=n?n+t:t;if(!this._events[a])return this;if(!e)return o(this,a),this;var s=this._events[a];if(s.fn)s.fn!==e||i&&!s.once||r&&s.context!==r||o(this,a);else{for(var u=0,c=[],l=s.length;u<l;u++)(s[u].fn!==e||i&&!s[u].once||r&&s[u].context!==r)&&c.push(s[u]);c.length?this._events[a]=1===c.length?c[0]:c:o(this,a)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&o(this,e)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,t.exports=s},835:(t,e,n)=>{var r=n(5219);t.exports={Graph:r.Graph,json:n(2181),alg:n(7754),version:r.version}},7924:(t,e,n)=>{var r=n(634);t.exports=function(t){var e,n={},i=[];function a(i){r.has(n,i)||(n[i]=!0,e.push(i),r.each(t.successors(i),a),r.each(t.predecessors(i),a))}return r.each(t.nodes(),(function(t){e=[],a(t),e.length&&i.push(e)})),i}},4281:(t,e,n)=>{var r=n(634);function i(t,e,n,a,o,s){r.has(a,e)||(a[e]=!0,n||s.push(e),r.each(o(e),(function(e){i(t,e,n,a,o,s)})),n&&s.push(e))}t.exports=function(t,e,n){r.isArray(e)||(e=[e]);var a=(t.isDirected()?t.successors:t.neighbors).bind(t),o=[],s={};return r.each(e,(function(e){if(!t.hasNode(e))throw new Error("Graph does not have node: "+e);i(t,e,"post"===n,s,a,o)})),o}},7100:(t,e,n)=>{var r=n(7490),i=n(634);t.exports=function(t,e,n){return i.transform(t.nodes(),(function(i,a){i[a]=r(t,a,e,n)}),{})}},7490:(t,e,n)=>{var r=n(634),i=n(4352);t.exports=function(t,e,n,r){return function(t,e,n,r){var a,o,s={},u=new i,c=function(t){var e=t.v!==a?t.v:t.w,r=s[e],i=n(t),c=o.distance+i;if(i<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+i);c<r.distance&&(r.distance=c,r.predecessor=a,u.decrease(e,c))};for(t.nodes().forEach((function(t){var n=t===e?0:Number.POSITIVE_INFINITY;s[t]={distance:n},u.add(t,n)}));u.size()>0&&(a=u.removeMin(),(o=s[a]).distance!==Number.POSITIVE_INFINITY);)r(a).forEach(c);return s}(t,String(e),n||a,r||function(e){return t.outEdges(e)})};var a=r.constant(1)},7811:(t,e,n)=>{var r=n(634),i=n(1500);t.exports=function(t){return r.filter(i(t),(function(e){return e.length>1||1===e.length&&t.hasEdge(e[0],e[0])}))}},9221:(t,e,n)=>{var r=n(634);t.exports=function(t,e,n){return function(t,e,n){var r={},i=t.nodes();return i.forEach((function(t){r[t]={},r[t][t]={distance:0},i.forEach((function(e){t!==e&&(r[t][e]={distance:Number.POSITIVE_INFINITY})})),n(t).forEach((function(n){var i=n.v===t?n.w:n.v,a=e(n);r[t][i]={distance:a,predecessor:t}}))})),i.forEach((function(t){var e=r[t];i.forEach((function(n){var a=r[n];i.forEach((function(n){var r=a[t],i=e[n],o=a[n],s=r.distance+i.distance;s<o.distance&&(o.distance=s,o.predecessor=i.predecessor)}))}))})),r}(t,e||i,n||function(e){return t.outEdges(e)})};var i=r.constant(1)},7754:(t,e,n)=>{t.exports={components:n(7924),dijkstra:n(7490),dijkstraAll:n(7100),findCycles:n(7811),floydWarshall:n(9221),isAcyclic:n(5093),postorder:n(3836),preorder:n(1539),prim:n(9628),tarjan:n(1500),topsort:n(45)}},5093:(t,e,n)=>{var r=n(45);t.exports=function(t){try{r(t)}catch(t){if(t instanceof r.CycleException)return!1;throw t}return!0}},3836:(t,e,n)=>{var r=n(4281);t.exports=function(t,e){return r(t,e,"post")}},1539:(t,e,n)=>{var r=n(4281);t.exports=function(t,e){return r(t,e,"pre")}},9628:(t,e,n)=>{var r=n(634),i=n(2507),a=n(4352);t.exports=function(t,e){var n,o=new i,s={},u=new a;function c(t){var r=t.v===n?t.w:t.v,i=u.priority(r);if(void 0!==i){var a=e(t);a<i&&(s[r]=n,u.decrease(r,a))}}if(0===t.nodeCount())return o;r.each(t.nodes(),(function(t){u.add(t,Number.POSITIVE_INFINITY),o.setNode(t)})),u.decrease(t.nodes()[0],0);for(var l=!1;u.size()>0;){if(n=u.removeMin(),r.has(s,n))o.setEdge(n,s[n]);else{if(l)throw new Error("Input graph is not connected: "+t);l=!0}t.nodeEdges(n).forEach(c)}return o}},1500:(t,e,n)=>{var r=n(634);t.exports=function(t){var e=0,n=[],i={},a=[];function o(s){var u=i[s]={onStack:!0,lowlink:e,index:e++};if(n.push(s),t.successors(s).forEach((function(t){r.has(i,t)?i[t].onStack&&(u.lowlink=Math.min(u.lowlink,i[t].index)):(o(t),u.lowlink=Math.min(u.lowlink,i[t].lowlink))})),u.lowlink===u.index){var c,l=[];do{c=n.pop(),i[c].onStack=!1,l.push(c)}while(s!==c);a.push(l)}}return t.nodes().forEach((function(t){r.has(i,t)||o(t)})),a}},45:(t,e,n)=>{var r=n(634);function i(t){var e={},n={},i=[];if(r.each(t.sinks(),(function o(s){if(r.has(n,s))throw new a;r.has(e,s)||(n[s]=!0,e[s]=!0,r.each(t.predecessors(s),o),delete n[s],i.push(s))})),r.size(e)!==t.nodeCount())throw new a;return i}function a(){}t.exports=i,i.CycleException=a,a.prototype=new Error},4352:(t,e,n)=>{var r=n(634);function i(){this._arr=[],this._keyIndices={}}t.exports=i,i.prototype.size=function(){return this._arr.length},i.prototype.keys=function(){return this._arr.map((function(t){return t.key}))},i.prototype.has=function(t){return r.has(this._keyIndices,t)},i.prototype.priority=function(t){var e=this._keyIndices[t];if(void 0!==e)return this._arr[e].priority},i.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},i.prototype.add=function(t,e){var n=this._keyIndices;if(t=String(t),!r.has(n,t)){var i=this._arr,a=i.length;return n[t]=a,i.push({key:t,priority:e}),this._decrease(a),!0}return!1},i.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},i.prototype.decrease=function(t,e){var n=this._keyIndices[t];if(e>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[n].priority+" New: "+e);this._arr[n].priority=e,this._decrease(n)},i.prototype._heapify=function(t){var e=this._arr,n=2*t,r=n+1,i=t;n<e.length&&(i=e[n].priority<e[i].priority?n:i,r<e.length&&(i=e[r].priority<e[i].priority?r:i),i!==t&&(this._swap(t,i),this._heapify(i)))},i.prototype._decrease=function(t){for(var e,n=this._arr,r=n[t].priority;0!==t&&!(n[e=t>>1].priority<r);)this._swap(t,e),t=e},i.prototype._swap=function(t,e){var n=this._arr,r=this._keyIndices,i=n[t],a=n[e];n[t]=a,n[e]=i,r[a.key]=t,r[i.key]=e}},2507:(t,e,n)=>{"use strict";var r=n(634);t.exports=a;var i="\0";function a(t){this._isDirected=!r.has(t,"directed")||t.directed,this._isMultigraph=!!r.has(t,"multigraph")&&t.multigraph,this._isCompound=!!r.has(t,"compound")&&t.compound,this._label=void 0,this._defaultNodeLabelFn=r.constant(void 0),this._defaultEdgeLabelFn=r.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[i]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function o(t,e){t[e]?t[e]++:t[e]=1}function s(t,e){--t[e]||delete t[e]}function u(t,e,n,i){var a=""+e,o=""+n;if(!t&&a>o){var s=a;a=o,o=s}return a+""+o+""+(r.isUndefined(i)?"\0":i)}function c(t,e){return u(t,e.v,e.w,e.name)}a.prototype._nodeCount=0,a.prototype._edgeCount=0,a.prototype.isDirected=function(){return this._isDirected},a.prototype.isMultigraph=function(){return this._isMultigraph},a.prototype.isCompound=function(){return this._isCompound},a.prototype.setGraph=function(t){return this._label=t,this},a.prototype.graph=function(){return this._label},a.prototype.setDefaultNodeLabel=function(t){return r.isFunction(t)||(t=r.constant(t)),this._defaultNodeLabelFn=t,this},a.prototype.nodeCount=function(){return this._nodeCount},a.prototype.nodes=function(){return r.keys(this._nodes)},a.prototype.sources=function(){var t=this;return r.filter(this.nodes(),(function(e){return r.isEmpty(t._in[e])}))},a.prototype.sinks=function(){var t=this;return r.filter(this.nodes(),(function(e){return r.isEmpty(t._out[e])}))},a.prototype.setNodes=function(t,e){var n=arguments,i=this;return r.each(t,(function(t){n.length>1?i.setNode(t,e):i.setNode(t)})),this},a.prototype.setNode=function(t,e){return r.has(this._nodes,t)?(arguments.length>1&&(this._nodes[t]=e),this):(this._nodes[t]=arguments.length>1?e:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]=i,this._children[t]={},this._children[i][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount,this)},a.prototype.node=function(t){return this._nodes[t]},a.prototype.hasNode=function(t){return r.has(this._nodes,t)},a.prototype.removeNode=function(t){var e=this;if(r.has(this._nodes,t)){var n=function(t){e.removeEdge(e._edgeObjs[t])};delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],r.each(this.children(t),(function(t){e.setParent(t)})),delete this._children[t]),r.each(r.keys(this._in[t]),n),delete this._in[t],delete this._preds[t],r.each(r.keys(this._out[t]),n),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this},a.prototype.setParent=function(t,e){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(r.isUndefined(e))e=i;else{for(var n=e+="";!r.isUndefined(n);n=this.parent(n))if(n===t)throw new Error("Setting "+e+" as parent of "+t+" would create a cycle");this.setNode(e)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=e,this._children[e][t]=!0,this},a.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]},a.prototype.parent=function(t){if(this._isCompound){var e=this._parent[t];if(e!==i)return e}},a.prototype.children=function(t){if(r.isUndefined(t)&&(t=i),this._isCompound){var e=this._children[t];if(e)return r.keys(e)}else{if(t===i)return this.nodes();if(this.hasNode(t))return[]}},a.prototype.predecessors=function(t){var e=this._preds[t];if(e)return r.keys(e)},a.prototype.successors=function(t){var e=this._sucs[t];if(e)return r.keys(e)},a.prototype.neighbors=function(t){var e=this.predecessors(t);if(e)return r.union(e,this.successors(t))},a.prototype.isLeaf=function(t){return 0===(this.isDirected()?this.successors(t):this.neighbors(t)).length},a.prototype.filterNodes=function(t){var e=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});e.setGraph(this.graph());var n=this;r.each(this._nodes,(function(n,r){t(r)&&e.setNode(r,n)})),r.each(this._edgeObjs,(function(t){e.hasNode(t.v)&&e.hasNode(t.w)&&e.setEdge(t,n.edge(t))}));var i={};function a(t){var r=n.parent(t);return void 0===r||e.hasNode(r)?(i[t]=r,r):r in i?i[r]:a(r)}return this._isCompound&&r.each(e.nodes(),(function(t){e.setParent(t,a(t))})),e},a.prototype.setDefaultEdgeLabel=function(t){return r.isFunction(t)||(t=r.constant(t)),this._defaultEdgeLabelFn=t,this},a.prototype.edgeCount=function(){return this._edgeCount},a.prototype.edges=function(){return r.values(this._edgeObjs)},a.prototype.setPath=function(t,e){var n=this,i=arguments;return r.reduce(t,(function(t,r){return i.length>1?n.setEdge(t,r,e):n.setEdge(t,r),r})),this},a.prototype.setEdge=function(){var t,e,n,i,a=!1,s=arguments[0];"object"==typeof s&&null!==s&&"v"in s?(t=s.v,e=s.w,n=s.name,2===arguments.length&&(i=arguments[1],a=!0)):(t=s,e=arguments[1],n=arguments[3],arguments.length>2&&(i=arguments[2],a=!0)),t=""+t,e=""+e,r.isUndefined(n)||(n=""+n);var c=u(this._isDirected,t,e,n);if(r.has(this._edgeLabels,c))return a&&(this._edgeLabels[c]=i),this;if(!r.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(e),this._edgeLabels[c]=a?i:this._defaultEdgeLabelFn(t,e,n);var l=function(t,e,n,r){var i=""+e,a=""+n;if(!t&&i>a){var o=i;i=a,a=o}var s={v:i,w:a};return r&&(s.name=r),s}(this._isDirected,t,e,n);return t=l.v,e=l.w,Object.freeze(l),this._edgeObjs[c]=l,o(this._preds[e],t),o(this._sucs[t],e),this._in[e][c]=l,this._out[t][c]=l,this._edgeCount++,this},a.prototype.edge=function(t,e,n){var r=1===arguments.length?c(this._isDirected,arguments[0]):u(this._isDirected,t,e,n);return this._edgeLabels[r]},a.prototype.hasEdge=function(t,e,n){var i=1===arguments.length?c(this._isDirected,arguments[0]):u(this._isDirected,t,e,n);return r.has(this._edgeLabels,i)},a.prototype.removeEdge=function(t,e,n){var r=1===arguments.length?c(this._isDirected,arguments[0]):u(this._isDirected,t,e,n),i=this._edgeObjs[r];return i&&(t=i.v,e=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],s(this._preds[e],t),s(this._sucs[t],e),delete this._in[e][r],delete this._out[t][r],this._edgeCount--),this},a.prototype.inEdges=function(t,e){var n=this._in[t];if(n){var i=r.values(n);return e?r.filter(i,(function(t){return t.v===e})):i}},a.prototype.outEdges=function(t,e){var n=this._out[t];if(n){var i=r.values(n);return e?r.filter(i,(function(t){return t.w===e})):i}},a.prototype.nodeEdges=function(t,e){var n=this.inEdges(t,e);if(n)return n.concat(this.outEdges(t,e))}},5219:(t,e,n)=>{t.exports={Graph:n(2507),version:n(3675)}},2181:(t,e,n)=>{var r=n(634),i=n(2507);function a(t){return r.map(t.nodes(),(function(e){var n=t.node(e),i=t.parent(e),a={v:e};return r.isUndefined(n)||(a.value=n),r.isUndefined(i)||(a.parent=i),a}))}function o(t){return r.map(t.edges(),(function(e){var n=t.edge(e),i={v:e.v,w:e.w};return r.isUndefined(e.name)||(i.name=e.name),r.isUndefined(n)||(i.value=n),i}))}t.exports={write:function(t){var e={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:a(t),edges:o(t)};return r.isUndefined(t.graph())||(e.value=r.clone(t.graph())),e},read:function(t){var e=new i(t.options).setGraph(t.value);return r.each(t.nodes,(function(t){e.setNode(t.v,t.value),t.parent&&e.setParent(t.v,t.parent)})),r.each(t.edges,(function(t){e.setEdge({v:t.v,w:t.w,name:t.name},t.value)})),e}}},634:(t,e,n)=>{var r;try{r={clone:n(6950),constant:n(4739),each:n(3293),filter:n(3013),has:n(8127),isArray:n(9998),isEmpty:n(322),isFunction:n(1967),isUndefined:n(235),keys:n(8547),map:n(9553),reduce:n(2633),size:n(1698),transform:n(4707),union:n(7596),values:n(1793)}}catch(t){}r||(r=window._),t.exports=r},3675:t=>{t.exports="2.1.8"},9577:t=>{function e(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}t.exports=function(t){var n=function(t){for(var n=[],r=0;r<t.length;r++){for(;n.length>=2&&e(n[n.length-2],n[n.length-1],t[r])<=0;)n.pop();n.push(t[r])}return n.pop(),n}(t),r=function(t){for(var n=t.reverse(),r=[],i=0;i<n.length;i++){for(;r.length>=2&&e(r[r.length-2],r[r.length-1],n[i])<=0;)r.pop();r.push(n[i])}return r.pop(),r}(t).concat(n);return r.push(t[0]),r}},4081:t=>{t.exports={toXy:function(t,e){return void 0===e?t.slice():t.map((function(t){return new Function("pt","return [pt"+e[0]+",pt"+e[1]+"];")(t)}))},fromXy:function(t,e){return void 0===e?t.slice():t.map((function(t){return new Function("pt","const o = {}; o"+e[0]+"= pt[0]; o"+e[1]+"= pt[1]; return o;")(t)}))}}},758:t=>{function e(t,e){this._cells=[],this._cellSize=e,this._reverseCellSize=1/e;for(var n=0;n<t.length;n++){var r=t[n],i=this.coordToCellNum(r[0]),a=this.coordToCellNum(r[1]);if(this._cells[i])this._cells[i][a]?this._cells[i][a].push(r):this._cells[i][a]=[r];else{var o=[];o[a]=[r],this._cells[i]=o}}}e.prototype={cellPoints:function(t,e){return void 0!==this._cells[t]&&void 0!==this._cells[t][e]?this._cells[t][e]:[]},rangePoints:function(t){for(var e=this.coordToCellNum(t[0]),n=this.coordToCellNum(t[1]),r=this.coordToCellNum(t[2]),i=this.coordToCellNum(t[3]),a=[],o=e;o<=r;o++)for(var s=n;s<=i;s++)for(var u=0;u<this.cellPoints(o,s).length;u++)a.push(this.cellPoints(o,s)[u]);return a},removePoint:function(t){for(var e,n=this.coordToCellNum(t[0]),r=this.coordToCellNum(t[1]),i=this._cells[n][r],a=0;a<i.length;a++)if(i[a][0]===t[0]&&i[a][1]===t[1]){e=a;break}return i.splice(e,1),i},trunc:Math.trunc||function(t){return t-t%1},coordToCellNum:function(t){return this.trunc(t*this._reverseCellSize)},extendBbox:function(t,e){return[t[0]-e*this._cellSize,t[1]-e*this._cellSize,t[2]+e*this._cellSize,t[3]+e*this._cellSize]}},t.exports=function(t,n){return new e(t,n)}},5037:(t,e,n)=>{"use strict";var r=n(9549),i=n(758),a=n(4081),o=n(9577);function s(t,e){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function u(t,e,n){var r=[e[0]-t[0],e[1]-t[1]],i=[n[0]-t[0],n[1]-t[1]],a=s(t,e),o=s(t,n);return(r[0]*i[0]+r[1]*i[1])/Math.sqrt(a*o)}function c(t,e){for(var n=0;n<e.length-1;n++){var i=[e[n],e[n+1]];if(!(t[0][0]===i[0][0]&&t[0][1]===i[0][1]||t[0][0]===i[1][0]&&t[0][1]===i[1][1])&&r(t,i))return!0}return!1}function l(t){return[Math.min(t[0][0],t[1][0]),Math.min(t[0][1],t[1][1]),Math.max(t[0][0],t[1][0]),Math.max(t[0][1],t[1][1])]}function h(t,e,n){for(var r,i,a=null,o=f,s=f,l=0;l<e.length;l++)r=u(t[0],t[1],e[l]),i=u(t[1],t[0],e[l]),r>o&&i>s&&!c([t[0],e[l]],n)&&!c([t[1],e[l]],n)&&(o=r,s=i,a=e[l]);return a}function d(t,e,n,r,i){for(var a=!1,o=0;o<t.length-1;o++){var u=[t[o],t[o+1]],c=u[0][0]+","+u[0][1]+","+u[1][0]+","+u[1][1];if(!(s(u[0],u[1])<e||i.has(c))){var f=0,v=l(u),p=void 0,g=void 0,y=void 0;do{p=(v=r.extendBbox(v,f))[2]-v[0],g=v[3]-v[1],y=h(u,r.rangePoints(v),t),f++}while(null===y&&(n[0]>p||n[1]>g));p>=n[0]&&g>=n[1]&&i.add(c),null!==y&&(t.splice(o+1,0,y),r.removePoint(y),a=!0)}}return a?d(t,e,n,r,i):t}var f=Math.cos(90/(180/Math.PI));t.exports=function(t,e,n){var r=e||20,s=function(t){for(var e=[t[0]],n=t[0],r=1;r<t.length;r++){var i=t[r];n[0]===i[0]&&n[1]===i[1]||e.push(i),n=i}return e}(function(t){return t.sort((function(t,e){return t[0]-e[0]||t[1]-e[1]}))}(a.toXy(t,n)));if(s.length<4){var u=s.concat([s[0]]);return n?a.fromXy(u,n):u}var c=function(t){for(var e=1/0,n=1/0,r=-1/0,i=-1/0,a=t.length-1;a>=0;a--)t[a][0]<e&&(e=t[a][0]),t[a][1]<n&&(n=t[a][1]),t[a][0]>r&&(r=t[a][0]),t[a][1]>i&&(i=t[a][1]);return[r-e,i-n]}(s),l=[.6*c[0],.6*c[1]],h=o(s),f=s.filter((function(t){return h.indexOf(t)<0})),v=Math.ceil(1/(s.length/(c[0]*c[1]))),p=d(h,Math.pow(r,2),l,i(f,v),new Set);return n?a.fromXy(p,n):p}},9549:t=>{function e(t,e,n,r,i,a){var o=(a-e)*(n-t)-(r-e)*(i-t);return o>0||!(o<0)}t.exports=function(t,n){var r=t[0][0],i=t[0][1],a=t[1][0],o=t[1][1],s=n[0][0],u=n[0][1],c=n[1][0],l=n[1][1];return e(r,i,s,u,c,l)!==e(a,o,s,u,c,l)&&e(r,i,a,o,s,u)!==e(r,i,a,o,c,l)}},4249:(t,e,n)=>{"use strict";n.r(e),n.d(e,{isAnyArray:()=>i});var r=Object.prototype.toString;function i(t){var e=r.call(t);return e.endsWith("Array]")&&!e.includes("Big")}},9587:t=>{t.exports=function(t){return!(!t||"string"==typeof t)&&(t instanceof Array||Array.isArray(t)||t.length>=0&&(t.splice instanceof Function||Object.getOwnPropertyDescriptor(t,t.length-1)&&"String"!==t.constructor.name))}},6903:(t,e,n)=>{var r=n(2627)(n(3766),"DataView");t.exports=r},8466:(t,e,n)=>{var r=n(4881),i=n(7705),a=n(1504),o=n(4116),s=n(9636);function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=a,u.prototype.has=o,u.prototype.set=s,t.exports=u},7746:(t,e,n)=>{var r=n(6721),i=n(9529),a=n(5712),o=n(8324),s=n(7492);function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=a,u.prototype.has=o,u.prototype.set=s,t.exports=u},3218:(t,e,n)=>{var r=n(2627)(n(3766),"Map");t.exports=r},4162:(t,e,n)=>{var r=n(1361),i=n(8105),a=n(7696),o=n(1300),s=n(5044);function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=a,u.prototype.has=o,u.prototype.set=s,t.exports=u},4765:(t,e,n)=>{var r=n(2627)(n(3766),"Promise");t.exports=r},4200:(t,e,n)=>{var r=n(2627)(n(3766),"Set");t.exports=r},6484:(t,e,n)=>{var r=n(4162),i=n(4669),a=n(6974);function o(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new r;++e<n;)this.add(t[e])}o.prototype.add=o.prototype.push=i,o.prototype.has=a,t.exports=o},1556:(t,e,n)=>{var r=n(7746),i=n(1983),a=n(3979),o=n(586),s=n(8734),u=n(870);function c(t){var e=this.__data__=new r(t);this.size=e.size}c.prototype.clear=i,c.prototype.delete=a,c.prototype.get=o,c.prototype.has=s,c.prototype.set=u,t.exports=c},7514:(t,e,n)=>{var r=n(3766).Symbol;t.exports=r},5711:(t,e,n)=>{var r=n(3766).Uint8Array;t.exports=r},4766:(t,e,n)=>{var r=n(2627)(n(3766),"WeakMap");t.exports=r},7688:t=>{t.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},744:t=>{t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}},7407:t=>{t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,a=[];++n<r;){var o=t[n];e(o,n,t)&&(a[i++]=o)}return a}},3508:(t,e,n)=>{var r=n(5110);t.exports=function(t,e){return!(null==t||!t.length)&&r(t,e,0)>-1}},1180:t=>{t.exports=function(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}},4414:(t,e,n)=>{var r=n(3409),i=n(3435),a=n(9998),o=n(8549),s=n(5416),u=n(8338),c=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n=a(t),l=!n&&i(t),h=!n&&!l&&o(t),d=!n&&!l&&!h&&u(t),f=n||l||h||d,v=f?r(t.length,String):[],p=v.length;for(var g in t)!e&&!c.call(t,g)||f&&("length"==g||h&&("offset"==g||"parent"==g)||d&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,p))||v.push(g);return v}},7295:t=>{t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}},8913:t=>{t.exports=function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}},4451:t=>{t.exports=function(t,e,n,r){var i=-1,a=null==t?0:t.length;for(r&&a&&(n=t[++i]);++i<a;)n=e(n,t[i],i,t);return n}},7337:t=>{t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}},8114:(t,e,n)=>{var r=n(4850)("length");t.exports=r},786:(t,e,n)=>{var r=n(5753),i=n(9893);t.exports=function(t,e,n){(void 0!==n&&!i(t[e],n)||void 0===n&&!(e in t))&&r(t,e,n)}},694:(t,e,n)=>{var r=n(5753),i=n(9893),a=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){var o=t[e];a.call(t,e)&&i(o,n)&&(void 0!==n||e in t)||r(t,e,n)}},5506:(t,e,n)=>{var r=n(9893);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},866:(t,e,n)=>{var r=n(1824),i=n(8547);t.exports=function(t,e){return t&&r(e,i(e),t)}},5349:(t,e,n)=>{var r=n(1824),i=n(1184);t.exports=function(t,e){return t&&r(e,i(e),t)}},5753:(t,e,n)=>{var r=n(3852);t.exports=function(t,e,n){"__proto__"==e&&r?r(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}},9182:(t,e,n)=>{var r=n(1556),i=n(744),a=n(694),o=n(866),s=n(5349),u=n(1299),c=n(602),l=n(2162),h=n(9653),d=n(5889),f=n(3994),v=n(2193),p=n(6846),g=n(2112),y=n(9620),m=n(9998),b=n(8549),x=n(4073),w=n(5828),E=n(1167),k=n(8547),M=n(1184),S="[object Arguments]",O="[object Function]",N="[object Object]",A={};A[S]=A["[object Array]"]=A["[object ArrayBuffer]"]=A["[object DataView]"]=A["[object Boolean]"]=A["[object Date]"]=A["[object Float32Array]"]=A["[object Float64Array]"]=A["[object Int8Array]"]=A["[object Int16Array]"]=A["[object Int32Array]"]=A["[object Map]"]=A["[object Number]"]=A[N]=A["[object RegExp]"]=A["[object Set]"]=A["[object String]"]=A["[object Symbol]"]=A["[object Uint8Array]"]=A["[object Uint8ClampedArray]"]=A["[object Uint16Array]"]=A["[object Uint32Array]"]=!0,A["[object Error]"]=A[O]=A["[object WeakMap]"]=!1,t.exports=function t(e,n,T,P,C,R){var L,D=1&n,_=2&n,I=4&n;if(T&&(L=C?T(e,P,C,R):T(e)),void 0!==L)return L;if(!w(e))return e;var j=m(e);if(j){if(L=p(e),!D)return c(e,L)}else{var F=v(e),B=F==O||"[object GeneratorFunction]"==F;if(b(e))return u(e,D);if(F==N||F==S||B&&!C){if(L=_||B?{}:y(e),!D)return _?h(e,s(L,e)):l(e,o(L,e))}else{if(!A[F])return C?e:{};L=g(e,F,D)}}R||(R=new r);var z=R.get(e);if(z)return z;R.set(e,L),E(e)?e.forEach((function(r){L.add(t(r,n,T,r,e,R))})):x(e)&&e.forEach((function(r,i){L.set(i,t(r,n,T,i,e,R))}));var G=j?void 0:(I?_?f:d:_?M:k)(e);return i(G||e,(function(r,i){G&&(r=e[i=r]),a(L,i,t(r,n,T,i,e,R))})),L}},3579:(t,e,n)=>{var r=n(5828),i=Object.create,a=function(){function t(){}return function(e){if(!r(e))return{};if(i)return i(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();t.exports=a},3106:(t,e,n)=>{var r=n(6586),i=n(7442)(r);t.exports=i},9252:(t,e,n)=>{var r=n(4923);t.exports=function(t,e,n){for(var i=-1,a=t.length;++i<a;){var o=t[i],s=e(o);if(null!=s&&(void 0===u?s==s&&!r(s):n(s,u)))var u=s,c=o}return c}},6269:(t,e,n)=>{var r=n(3106);t.exports=function(t,e){var n=[];return r(t,(function(t,r,i){e(t,r,i)&&n.push(t)})),n}},8234:t=>{t.exports=function(t,e,n,r){for(var i=t.length,a=n+(r?1:-1);r?a--:++a<i;)if(e(t[a],a,t))return a;return-1}},8193:(t,e,n)=>{var r=n(8913),i=n(7938);t.exports=function t(e,n,a,o,s){var u=-1,c=e.length;for(a||(a=i),s||(s=[]);++u<c;){var l=e[u];n>0&&a(l)?n>1?t(l,n-1,a,o,s):r(s,l):o||(s[s.length]=l)}return s}},4828:(t,e,n)=>{var r=n(716)();t.exports=r},6586:(t,e,n)=>{var r=n(4828),i=n(8547);t.exports=function(t,e){return t&&r(t,e,i)}},9195:(t,e,n)=>{var r=n(7886),i=n(7872);t.exports=function(t,e){for(var n=0,a=(e=r(e,t)).length;null!=t&&n<a;)t=t[i(e[n++])];return n&&n==a?t:void 0}},5068:(t,e,n)=>{var r=n(8913),i=n(9998);t.exports=function(t,e,n){var a=e(t);return i(t)?a:r(a,n(t))}},9451:(t,e,n)=>{var r=n(7514),i=n(4302),a=n(4613),o=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":o&&o in Object(t)?i(t):a(t)}},6672:t=>{t.exports=function(t,e){return t>e}},2135:t=>{var e=Object.prototype.hasOwnProperty;t.exports=function(t,n){return null!=t&&e.call(t,n)}},156:t=>{t.exports=function(t,e){return null!=t&&e in Object(t)}},5110:(t,e,n)=>{var r=n(8234),i=n(6390),a=n(2914);t.exports=function(t,e,n){return e==e?a(t,e,n):r(t,i,n)}},4147:(t,e,n)=>{var r=n(9451),i=n(1579);t.exports=function(t){return i(t)&&"[object Arguments]"==r(t)}},5735:(t,e,n)=>{var r=n(7033),i=n(1579);t.exports=function t(e,n,a,o,s){return e===n||(null==e||null==n||!i(e)&&!i(n)?e!=e&&n!=n:r(e,n,a,o,t,s))}},7033:(t,e,n)=>{var r=n(1556),i=n(3430),a=n(3509),o=n(7910),s=n(2193),u=n(9998),c=n(8549),l=n(8338),h="[object Arguments]",d="[object Array]",f="[object Object]",v=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,p,g,y){var m=u(t),b=u(e),x=m?d:s(t),w=b?d:s(e),E=(x=x==h?f:x)==f,k=(w=w==h?f:w)==f,M=x==w;if(M&&c(t)){if(!c(e))return!1;m=!0,E=!1}if(M&&!E)return y||(y=new r),m||l(t)?i(t,e,n,p,g,y):a(t,e,x,n,p,g,y);if(!(1&n)){var S=E&&v.call(t,"__wrapped__"),O=k&&v.call(e,"__wrapped__");if(S||O){var N=S?t.value():t,A=O?e.value():e;return y||(y=new r),g(N,A,n,p,y)}}return!!M&&(y||(y=new r),o(t,e,n,p,g,y))}},7505:(t,e,n)=>{var r=n(2193),i=n(1579);t.exports=function(t){return i(t)&&"[object Map]"==r(t)}},8530:(t,e,n)=>{var r=n(1556),i=n(5735);t.exports=function(t,e,n,a){var o=n.length,s=o,u=!a;if(null==t)return!s;for(t=Object(t);o--;){var c=n[o];if(u&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++o<s;){var l=(c=n[o])[0],h=t[l],d=c[1];if(u&&c[2]){if(void 0===h&&!(l in t))return!1}else{var f=new r;if(a)var v=a(h,d,l,t,e,f);if(!(void 0===v?i(d,h,3,a,f):v))return!1}}return!0}},6390:t=>{t.exports=function(t){return t!=t}},3552:(t,e,n)=>{var r=n(1967),i=n(8671),a=n(5828),o=n(7402),s=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,l=u.toString,h=c.hasOwnProperty,d=RegExp("^"+l.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!a(t)||i(t))&&(r(t)?d:s).test(o(t))}},9239:(t,e,n)=>{var r=n(2193),i=n(1579);t.exports=function(t){return i(t)&&"[object Set]"==r(t)}},9930:(t,e,n)=>{var r=n(9451),i=n(6947),a=n(1579),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,t.exports=function(t){return a(t)&&i(t.length)&&!!o[r(t)]}},2126:(t,e,n)=>{var r=n(6854),i=n(2175),a=n(5645),o=n(9998),s=n(170);t.exports=function(t){return"function"==typeof t?t:null==t?a:"object"==typeof t?o(t)?i(t[0],t[1]):r(t):s(t)}},3819:(t,e,n)=>{var r=n(4906),i=n(1953),a=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return i(t);var e=[];for(var n in Object(t))a.call(t,n)&&"constructor"!=n&&e.push(n);return e}},232:(t,e,n)=>{var r=n(5828),i=n(4906),a=n(5674),o=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return a(t);var e=i(t),n=[];for(var s in t)("constructor"!=s||!e&&o.call(t,s))&&n.push(s);return n}},6871:t=>{t.exports=function(t,e){return t<e}},2857:(t,e,n)=>{var r=n(3106),i=n(2265);t.exports=function(t,e){var n=-1,a=i(t)?Array(t.length):[];return r(t,(function(t,r,i){a[++n]=e(t,r,i)})),a}},6854:(t,e,n)=>{var r=n(8530),i=n(6215),a=n(1096);t.exports=function(t){var e=i(t);return 1==e.length&&e[0][2]?a(e[0][0],e[0][1]):function(n){return n===t||r(n,t,e)}}},2175:(t,e,n)=>{var r=n(5735),i=n(5235),a=n(8756),o=n(5963),s=n(4459),u=n(1096),c=n(7872);t.exports=function(t,e){return o(t)&&s(e)?u(c(t),e):function(n){var o=i(n,t);return void 0===o&&o===e?a(n,t):r(e,o,3)}}},3603:(t,e,n)=>{var r=n(1556),i=n(786),a=n(4828),o=n(5901),s=n(5828),u=n(1184),c=n(1715);t.exports=function t(e,n,l,h,d){e!==n&&a(n,(function(a,u){if(d||(d=new r),s(a))o(e,n,u,l,t,h,d);else{var f=h?h(c(e,u),a,u+"",e,n,d):void 0;void 0===f&&(f=a),i(e,u,f)}}),u)}},5901:(t,e,n)=>{var r=n(786),i=n(1299),a=n(8064),o=n(602),s=n(9620),u=n(3435),c=n(9998),l=n(8582),h=n(8549),d=n(1967),f=n(5828),v=n(5200),p=n(8338),g=n(1715),y=n(8167);t.exports=function(t,e,n,m,b,x,w){var E=g(t,n),k=g(e,n),M=w.get(k);if(M)r(t,n,M);else{var S=x?x(E,k,n+"",t,e,w):void 0,O=void 0===S;if(O){var N=c(k),A=!N&&h(k),T=!N&&!A&&p(k);S=k,N||A||T?c(E)?S=E:l(E)?S=o(E):A?(O=!1,S=i(k,!0)):T?(O=!1,S=a(k,!0)):S=[]:v(k)||u(k)?(S=E,u(E)?S=y(E):f(E)&&!d(E)||(S=s(k))):O=!1}O&&(w.set(k,S),b(S,k,m,x,w),w.delete(k)),r(t,n,S)}}},8958:(t,e,n)=>{var r=n(7295),i=n(9195),a=n(2126),o=n(2857),s=n(810),u=n(3036),c=n(5327),l=n(5645),h=n(9998);t.exports=function(t,e,n){e=e.length?r(e,(function(t){return h(t)?function(e){return i(e,1===t.length?t[0]:t)}:t})):[l];var d=-1;e=r(e,u(a));var f=o(t,(function(t,n,i){return{criteria:r(e,(function(e){return e(t)})),index:++d,value:t}}));return s(f,(function(t,e){return c(t,e,n)}))}},7162:(t,e,n)=>{var r=n(9231),i=n(8756);t.exports=function(t,e){return r(t,e,(function(e,n){return i(t,n)}))}},9231:(t,e,n)=>{var r=n(9195),i=n(4863),a=n(7886);t.exports=function(t,e,n){for(var o=-1,s=e.length,u={};++o<s;){var c=e[o],l=r(t,c);n(l,c)&&i(u,a(c,t),l)}return u}},4850:t=>{t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},4104:(t,e,n)=>{var r=n(9195);t.exports=function(t){return function(e){return r(e,t)}}},78:t=>{var e=Math.ceil,n=Math.max;t.exports=function(t,r,i,a){for(var o=-1,s=n(e((r-t)/(i||1)),0),u=Array(s);s--;)u[a?s:++o]=t,t+=i;return u}},3841:t=>{t.exports=function(t,e,n,r,i){return i(t,(function(t,i,a){n=r?(r=!1,t):e(n,t,i,a)})),n}},2241:(t,e,n)=>{var r=n(5645),i=n(4218),a=n(9812);t.exports=function(t,e){return a(i(t,e,r),t+"")}},4863:(t,e,n)=>{var r=n(694),i=n(7886),a=n(5416),o=n(5828),s=n(7872);t.exports=function(t,e,n,u){if(!o(t))return t;for(var c=-1,l=(e=i(e,t)).length,h=l-1,d=t;null!=d&&++c<l;){var f=s(e[c]),v=n;if("__proto__"===f||"constructor"===f||"prototype"===f)return t;if(c!=h){var p=d[f];void 0===(v=u?u(p,f,d):void 0)&&(v=o(p)?p:a(e[c+1])?[]:{})}r(d,f,v),d=d[f]}return t}},9555:(t,e,n)=>{var r=n(4739),i=n(3852),a=n(5645),o=i?function(t,e){return i(t,"toString",{configurable:!0,enumerable:!1,value:r(e),writable:!0})}:a;t.exports=o},810:t=>{t.exports=function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}},3409:t=>{t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},1595:(t,e,n)=>{var r=n(7514),i=n(7295),a=n(9998),o=n(4923),s=r?r.prototype:void 0,u=s?s.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(a(e))return i(e,t)+"";if(o(e))return u?u.call(e):"";var n=e+"";return"0"==n&&1/e==-1/0?"-0":n}},5787:(t,e,n)=>{var r=n(761),i=/^\s+/;t.exports=function(t){return t?t.slice(0,r(t)+1).replace(i,""):t}},3036:t=>{t.exports=function(t){return function(e){return t(e)}}},4742:(t,e,n)=>{var r=n(6484),i=n(3508),a=n(1180),o=n(2200),s=n(8888),u=n(444);t.exports=function(t,e,n){var c=-1,l=i,h=t.length,d=!0,f=[],v=f;if(n)d=!1,l=a;else if(h>=200){var p=e?null:s(t);if(p)return u(p);d=!1,l=o,v=new r}else v=e?[]:f;t:for(;++c<h;){var g=t[c],y=e?e(g):g;if(g=n||0!==g?g:0,d&&y==y){for(var m=v.length;m--;)if(v[m]===y)continue t;e&&v.push(y),f.push(g)}else l(v,y,n)||(v!==f&&v.push(y),f.push(g))}return f}},8569:(t,e,n)=>{var r=n(7295);t.exports=function(t,e){return r(e,(function(e){return t[e]}))}},9515:t=>{t.exports=function(t,e,n){for(var r=-1,i=t.length,a=e.length,o={};++r<i;){var s=r<a?e[r]:void 0;n(o,t[r],s)}return o}},2200:t=>{t.exports=function(t,e){return t.has(e)}},7813:(t,e,n)=>{var r=n(5645);t.exports=function(t){return"function"==typeof t?t:r}},7886:(t,e,n)=>{var r=n(9998),i=n(5963),a=n(2149),o=n(179);t.exports=function(t,e){return r(t)?t:i(t,e)?[t]:a(o(t))}},4714:(t,e,n)=>{var r=n(5711);t.exports=function(t){var e=new t.constructor(t.byteLength);return new r(e).set(new r(t)),e}},1299:(t,e,n)=>{t=n.nmd(t);var r=n(3766),i=e&&!e.nodeType&&e,a=i&&t&&!t.nodeType&&t,o=a&&a.exports===i?r.Buffer:void 0,s=o?o.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,r=s?s(n):new t.constructor(n);return t.copy(r),r}},3960:(t,e,n)=>{var r=n(4714);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}},412:t=>{var e=/\w*$/;t.exports=function(t){var n=new t.constructor(t.source,e.exec(t));return n.lastIndex=t.lastIndex,n}},5517:(t,e,n)=>{var r=n(7514),i=r?r.prototype:void 0,a=i?i.valueOf:void 0;t.exports=function(t){return a?Object(a.call(t)):{}}},8064:(t,e,n)=>{var r=n(4714);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}},4601:(t,e,n)=>{var r=n(4923);t.exports=function(t,e){if(t!==e){var n=void 0!==t,i=null===t,a=t==t,o=r(t),s=void 0!==e,u=null===e,c=e==e,l=r(e);if(!u&&!l&&!o&&t>e||o&&s&&c&&!u&&!l||i&&s&&c||!n&&c||!a)return 1;if(!i&&!o&&!l&&t<e||l&&n&&a&&!i&&!o||u&&n&&a||!s&&a||!c)return-1}return 0}},5327:(t,e,n)=>{var r=n(4601);t.exports=function(t,e,n){for(var i=-1,a=t.criteria,o=e.criteria,s=a.length,u=n.length;++i<s;){var c=r(a[i],o[i]);if(c)return i>=u?c:c*("desc"==n[i]?-1:1)}return t.index-e.index}},602:t=>{t.exports=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}},1824:(t,e,n)=>{var r=n(694),i=n(5753);t.exports=function(t,e,n,a){var o=!n;n||(n={});for(var s=-1,u=e.length;++s<u;){var c=e[s],l=a?a(n[c],t[c],c,n,t):void 0;void 0===l&&(l=t[c]),o?i(n,c,l):r(n,c,l)}return n}},2162:(t,e,n)=>{var r=n(1824),i=n(5683);t.exports=function(t,e){return r(t,i(t),e)}},9653:(t,e,n)=>{var r=n(1824),i=n(6832);t.exports=function(t,e){return r(t,i(t),e)}},6342:(t,e,n)=>{var r=n(3766)["__core-js_shared__"];t.exports=r},8192:(t,e,n)=>{var r=n(2241),i=n(4559);t.exports=function(t){return r((function(e,n){var r=-1,a=n.length,o=a>1?n[a-1]:void 0,s=a>2?n[2]:void 0;for(o=t.length>3&&"function"==typeof o?(a--,o):void 0,s&&i(n[0],n[1],s)&&(o=a<3?void 0:o,a=1),e=Object(e);++r<a;){var u=n[r];u&&t(e,u,r,o)}return e}))}},7442:(t,e,n)=>{var r=n(2265);t.exports=function(t,e){return function(n,i){if(null==n)return n;if(!r(n))return t(n,i);for(var a=n.length,o=e?a:-1,s=Object(n);(e?o--:++o<a)&&!1!==i(s[o],o,s););return n}}},716:t=>{t.exports=function(t){return function(e,n,r){for(var i=-1,a=Object(e),o=r(e),s=o.length;s--;){var u=o[t?s:++i];if(!1===n(a[u],u,a))break}return e}}},589:(t,e,n)=>{var r=n(2126),i=n(2265),a=n(8547);t.exports=function(t){return function(e,n,o){var s=Object(e);if(!i(e)){var u=r(n,3);e=a(e),n=function(t){return u(s[t],t,s)}}var c=t(e,n,o);return c>-1?s[u?e[c]:c]:void 0}}},3149:(t,e,n)=>{var r=n(78),i=n(4559),a=n(7309);t.exports=function(t){return function(e,n,o){return o&&"number"!=typeof o&&i(e,n,o)&&(n=o=void 0),e=a(e),void 0===n?(n=e,e=0):n=a(n),o=void 0===o?e<n?1:-1:a(o),r(e,n,o,t)}}},8888:(t,e,n)=>{var r=n(4200),i=n(1303),a=n(444),o=r&&1/a(new r([,-0]))[1]==1/0?function(t){return new r(t)}:i;t.exports=o},3852:(t,e,n)=>{var r=n(2627),i=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=i},3430:(t,e,n)=>{var r=n(6484),i=n(7337),a=n(2200);t.exports=function(t,e,n,o,s,u){var c=1&n,l=t.length,h=e.length;if(l!=h&&!(c&&h>l))return!1;var d=u.get(t),f=u.get(e);if(d&&f)return d==e&&f==t;var v=-1,p=!0,g=2&n?new r:void 0;for(u.set(t,e),u.set(e,t);++v<l;){var y=t[v],m=e[v];if(o)var b=c?o(m,y,v,e,t,u):o(y,m,v,t,e,u);if(void 0!==b){if(b)continue;p=!1;break}if(g){if(!i(e,(function(t,e){if(!a(g,e)&&(y===t||s(y,t,n,o,u)))return g.push(e)}))){p=!1;break}}else if(y!==m&&!s(y,m,n,o,u)){p=!1;break}}return u.delete(t),u.delete(e),p}},3509:(t,e,n)=>{var r=n(7514),i=n(5711),a=n(9893),o=n(3430),s=n(3646),u=n(444),c=r?r.prototype:void 0,l=c?c.valueOf:void 0;t.exports=function(t,e,n,r,c,h,d){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!h(new i(t),new i(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return a(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var f=s;case"[object Set]":var v=1&r;if(f||(f=u),t.size!=e.size&&!v)return!1;var p=d.get(t);if(p)return p==e;r|=2,d.set(t,e);var g=o(f(t),f(e),r,c,h,d);return d.delete(t),g;case"[object Symbol]":if(l)return l.call(t)==l.call(e)}return!1}},7910:(t,e,n)=>{var r=n(5889),i=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,a,o,s){var u=1&n,c=r(t),l=c.length;if(l!=r(e).length&&!u)return!1;for(var h=l;h--;){var d=c[h];if(!(u?d in e:i.call(e,d)))return!1}var f=s.get(t),v=s.get(e);if(f&&v)return f==e&&v==t;var p=!0;s.set(t,e),s.set(e,t);for(var g=u;++h<l;){var y=t[d=c[h]],m=e[d];if(a)var b=u?a(m,y,d,e,t,s):a(y,m,d,t,e,s);if(!(void 0===b?y===m||o(y,m,n,a,s):b)){p=!1;break}g||(g="constructor"==d)}if(p&&!g){var x=t.constructor,w=e.constructor;x==w||!("constructor"in t)||!("constructor"in e)||"function"==typeof x&&x instanceof x&&"function"==typeof w&&w instanceof w||(p=!1)}return s.delete(t),s.delete(e),p}},6999:(t,e,n)=>{var r=n(7417),i=n(4218),a=n(9812);t.exports=function(t){return a(i(t,void 0,r),t+"")}},2751:(t,e,n)=>{var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;t.exports=r},5889:(t,e,n)=>{var r=n(5068),i=n(5683),a=n(8547);t.exports=function(t){return r(t,a,i)}},3994:(t,e,n)=>{var r=n(5068),i=n(6832),a=n(1184);t.exports=function(t){return r(t,a,i)}},9268:(t,e,n)=>{var r=n(1587);t.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}},6215:(t,e,n)=>{var r=n(4459),i=n(8547);t.exports=function(t){for(var e=i(t),n=e.length;n--;){var a=e[n],o=t[a];e[n]=[a,o,r(o)]}return e}},2627:(t,e,n)=>{var r=n(3552),i=n(8915);t.exports=function(t,e){var n=i(t,e);return r(n)?n:void 0}},3160:(t,e,n)=>{var r=n(433)(Object.getPrototypeOf,Object);t.exports=r},4302:(t,e,n)=>{var r=n(7514),i=Object.prototype,a=i.hasOwnProperty,o=i.toString,s=r?r.toStringTag:void 0;t.exports=function(t){var e=a.call(t,s),n=t[s];try{t[s]=void 0;var r=!0}catch(t){}var i=o.call(t);return r&&(e?t[s]=n:delete t[s]),i}},5683:(t,e,n)=>{var r=n(7407),i=n(6610),a=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,s=o?function(t){return null==t?[]:(t=Object(t),r(o(t),(function(e){return a.call(t,e)})))}:i;t.exports=s},6832:(t,e,n)=>{var r=n(8913),i=n(3160),a=n(5683),o=n(6610),s=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)r(e,a(t)),t=i(t);return e}:o;t.exports=s},2193:(t,e,n)=>{var r=n(6903),i=n(3218),a=n(4765),o=n(4200),s=n(4766),u=n(9451),c=n(7402),l="[object Map]",h="[object Promise]",d="[object Set]",f="[object WeakMap]",v="[object DataView]",p=c(r),g=c(i),y=c(a),m=c(o),b=c(s),x=u;(r&&x(new r(new ArrayBuffer(1)))!=v||i&&x(new i)!=l||a&&x(a.resolve())!=h||o&&x(new o)!=d||s&&x(new s)!=f)&&(x=function(t){var e=u(t),n="[object Object]"==e?t.constructor:void 0,r=n?c(n):"";if(r)switch(r){case p:return v;case g:return l;case y:return h;case m:return d;case b:return f}return e}),t.exports=x},8915:t=>{t.exports=function(t,e){return null==t?void 0:t[e]}},3731:(t,e,n)=>{var r=n(7886),i=n(3435),a=n(9998),o=n(5416),s=n(6947),u=n(7872);t.exports=function(t,e,n){for(var c=-1,l=(e=r(e,t)).length,h=!1;++c<l;){var d=u(e[c]);if(!(h=null!=t&&n(t,d)))break;t=t[d]}return h||++c!=l?h:!!(l=null==t?0:t.length)&&s(l)&&o(d,l)&&(a(t)||i(t))}},273:t=>{var e=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");t.exports=function(t){return e.test(t)}},4881:(t,e,n)=>{var r=n(8697);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},7705:t=>{t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},1504:(t,e,n)=>{var r=n(8697),i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(e,t)?e[t]:void 0}},4116:(t,e,n)=>{var r=n(8697),i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:i.call(e,t)}},9636:(t,e,n)=>{var r=n(8697);t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?"__lodash_hash_undefined__":e,this}},6846:t=>{var e=Object.prototype.hasOwnProperty;t.exports=function(t){var n=t.length,r=new t.constructor(n);return n&&"string"==typeof t[0]&&e.call(t,"index")&&(r.index=t.index,r.input=t.input),r}},2112:(t,e,n)=>{var r=n(4714),i=n(3960),a=n(412),o=n(5517),s=n(8064);t.exports=function(t,e,n){var u=t.constructor;switch(e){case"[object ArrayBuffer]":return r(t);case"[object Boolean]":case"[object Date]":return new u(+t);case"[object DataView]":return i(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(t,n);case"[object Map]":case"[object Set]":return new u;case"[object Number]":case"[object String]":return new u(t);case"[object RegExp]":return a(t);case"[object Symbol]":return o(t)}}},9620:(t,e,n)=>{var r=n(3579),i=n(3160),a=n(4906);t.exports=function(t){return"function"!=typeof t.constructor||a(t)?{}:r(i(t))}},7938:(t,e,n)=>{var r=n(7514),i=n(3435),a=n(9998),o=r?r.isConcatSpreadable:void 0;t.exports=function(t){return a(t)||i(t)||!!(o&&t&&t[o])}},5416:t=>{var e=/^(?:0|[1-9]\d*)$/;t.exports=function(t,n){var r=typeof t;return!!(n=null==n?9007199254740991:n)&&("number"==r||"symbol"!=r&&e.test(t))&&t>-1&&t%1==0&&t<n}},4559:(t,e,n)=>{var r=n(9893),i=n(2265),a=n(5416),o=n(5828);t.exports=function(t,e,n){if(!o(n))return!1;var s=typeof e;return!!("number"==s?i(n)&&a(e,n.length):"string"==s&&e in n)&&r(n[e],t)}},5963:(t,e,n)=>{var r=n(9998),i=n(4923),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;t.exports=function(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!i(t))||o.test(t)||!a.test(t)||null!=e&&t in Object(e)}},1587:t=>{t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},8671:(t,e,n)=>{var r,i=n(6342),a=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";t.exports=function(t){return!!a&&a in t}},4906:t=>{var e=Object.prototype;t.exports=function(t){var n=t&&t.constructor;return t===("function"==typeof n&&n.prototype||e)}},4459:(t,e,n)=>{var r=n(5828);t.exports=function(t){return t==t&&!r(t)}},6721:t=>{t.exports=function(){this.__data__=[],this.size=0}},9529:(t,e,n)=>{var r=n(5506),i=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0||(n==e.length-1?e.pop():i.call(e,n,1),--this.size,0))}},5712:(t,e,n)=>{var r=n(5506);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},8324:(t,e,n)=>{var r=n(5506);t.exports=function(t){return r(this.__data__,t)>-1}},7492:(t,e,n)=>{var r=n(5506);t.exports=function(t,e){var n=this.__data__,i=r(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}},1361:(t,e,n)=>{var r=n(8466),i=n(7746),a=n(3218);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(a||i),string:new r}}},8105:(t,e,n)=>{var r=n(9268);t.exports=function(t){var e=r(this,t).delete(t);return this.size-=e?1:0,e}},7696:(t,e,n)=>{var r=n(9268);t.exports=function(t){return r(this,t).get(t)}},1300:(t,e,n)=>{var r=n(9268);t.exports=function(t){return r(this,t).has(t)}},5044:(t,e,n)=>{var r=n(9268);t.exports=function(t,e){var n=r(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}},3646:t=>{t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}},1096:t=>{t.exports=function(t,e){return function(n){return null!=n&&n[t]===e&&(void 0!==e||t in Object(n))}}},1421:(t,e,n)=>{var r=n(8779);t.exports=function(t){var e=r(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}},8697:(t,e,n)=>{var r=n(2627)(Object,"create");t.exports=r},1953:(t,e,n)=>{var r=n(433)(Object.keys,Object);t.exports=r},5674:t=>{t.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},7290:(t,e,n)=>{t=n.nmd(t);var r=n(2751),i=e&&!e.nodeType&&e,a=i&&t&&!t.nodeType&&t,o=a&&a.exports===i&&r.process,s=function(){try{return a&&a.require&&a.require("util").types||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=s},4613:t=>{var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},433:t=>{t.exports=function(t,e){return function(n){return t(e(n))}}},4218:(t,e,n)=>{var r=n(7688),i=Math.max;t.exports=function(t,e,n){return e=i(void 0===e?t.length-1:e,0),function(){for(var a=arguments,o=-1,s=i(a.length-e,0),u=Array(s);++o<s;)u[o]=a[e+o];o=-1;for(var c=Array(e+1);++o<e;)c[o]=a[o];return c[e]=n(u),r(t,this,c)}}},3766:(t,e,n)=>{var r=n(2751),i="object"==typeof self&&self&&self.Object===Object&&self,a=r||i||Function("return this")();t.exports=a},1715:t=>{t.exports=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}},4669:t=>{t.exports=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}},6974:t=>{t.exports=function(t){return this.__data__.has(t)}},444:t=>{t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}},9812:(t,e,n)=>{var r=n(9555),i=n(6492)(r);t.exports=i},6492:t=>{var e=Date.now;t.exports=function(t){var n=0,r=0;return function(){var i=e(),a=16-(i-r);if(r=i,a>0){if(++n>=800)return arguments[0]}else n=0;return t.apply(void 0,arguments)}}},1983:(t,e,n)=>{var r=n(7746);t.exports=function(){this.__data__=new r,this.size=0}},3979:t=>{t.exports=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}},586:t=>{t.exports=function(t){return this.__data__.get(t)}},8734:t=>{t.exports=function(t){return this.__data__.has(t)}},870:(t,e,n)=>{var r=n(7746),i=n(3218),a=n(4162);t.exports=function(t,e){var n=this.__data__;if(n instanceof r){var o=n.__data__;if(!i||o.length<199)return o.push([t,e]),this.size=++n.size,this;n=this.__data__=new a(o)}return n.set(t,e),this.size=n.size,this}},2914:t=>{t.exports=function(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}},3130:(t,e,n)=>{var r=n(8114),i=n(273),a=n(458);t.exports=function(t){return i(t)?a(t):r(t)}},2149:(t,e,n)=>{var r=n(1421),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,o=r((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(i,(function(t,n,r,i){e.push(r?i.replace(a,"$1"):n||t)})),e}));t.exports=o},7872:(t,e,n)=>{var r=n(4923);t.exports=function(t){if("string"==typeof t||r(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}},7402:t=>{var e=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return e.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},761:t=>{var e=/\s/;t.exports=function(t){for(var n=t.length;n--&&e.test(t.charAt(n)););return n}},458:t=>{var e="\\ud800-\\udfff",n="["+e+"]",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",i="\\ud83c[\\udffb-\\udfff]",a="[^"+e+"]",o="(?:\\ud83c[\\udde6-\\uddff]){2}",s="[\\ud800-\\udbff][\\udc00-\\udfff]",u="(?:"+r+"|"+i+")?",c="[\\ufe0e\\ufe0f]?",l=c+u+"(?:\\u200d(?:"+[a,o,s].join("|")+")"+c+u+")*",h="(?:"+[a+r+"?",r,o,s,n].join("|")+")",d=RegExp(i+"(?="+i+")|"+h+l,"g");t.exports=function(t){for(var e=d.lastIndex=0;d.test(t);)++e;return e}},6950:(t,e,n)=>{var r=n(9182);t.exports=function(t){return r(t,4)}},8388:(t,e,n)=>{var r=n(9182);t.exports=function(t){return r(t,5)}},4739:t=>{t.exports=function(t){return function(){return t}}},2589:(t,e,n)=>{var r=n(2241),i=n(9893),a=n(4559),o=n(1184),s=Object.prototype,u=s.hasOwnProperty,c=r((function(t,e){t=Object(t);var n=-1,r=e.length,c=r>2?e[2]:void 0;for(c&&a(e[0],e[1],c)&&(r=1);++n<r;)for(var l=e[n],h=o(l),d=-1,f=h.length;++d<f;){var v=h[d],p=t[v];(void 0===p||i(p,s[v])&&!u.call(t,v))&&(t[v]=l[v])}return t}));t.exports=c},3293:(t,e,n)=>{t.exports=n(2385)},9893:t=>{t.exports=function(t,e){return t===e||t!=t&&e!=e}},3013:(t,e,n)=>{var r=n(7407),i=n(6269),a=n(2126),o=n(9998);t.exports=function(t,e){return(o(t)?r:i)(t,a(e,3))}},2792:(t,e,n)=>{var r=n(589)(n(2514));t.exports=r},2514:(t,e,n)=>{var r=n(8234),i=n(2126),a=n(1010),o=Math.max;t.exports=function(t,e,n){var s=null==t?0:t.length;if(!s)return-1;var u=null==n?0:a(n);return u<0&&(u=o(s+u,0)),r(t,i(e,3),u)}},7417:(t,e,n)=>{var r=n(8193);t.exports=function(t){return null!=t&&t.length?r(t,1):[]}},2385:(t,e,n)=>{var r=n(744),i=n(3106),a=n(7813),o=n(9998);t.exports=function(t,e){return(o(t)?r:i)(t,a(e))}},2779:(t,e,n)=>{var r=n(4828),i=n(7813),a=n(1184);t.exports=function(t,e){return null==t?t:r(t,i(e),a)}},5235:(t,e,n)=>{var r=n(9195);t.exports=function(t,e,n){var i=null==t?void 0:r(t,e);return void 0===i?n:i}},8127:(t,e,n)=>{var r=n(2135),i=n(3731);t.exports=function(t,e){return null!=t&&i(t,e,r)}},8756:(t,e,n)=>{var r=n(156),i=n(3731);t.exports=function(t,e){return null!=t&&i(t,e,r)}},5645:t=>{t.exports=function(t){return t}},3435:(t,e,n)=>{var r=n(4147),i=n(1579),a=Object.prototype,o=a.hasOwnProperty,s=a.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(t){return i(t)&&o.call(t,"callee")&&!s.call(t,"callee")};t.exports=u},9998:t=>{var e=Array.isArray;t.exports=e},2265:(t,e,n)=>{var r=n(1967),i=n(6947);t.exports=function(t){return null!=t&&i(t.length)&&!r(t)}},8582:(t,e,n)=>{var r=n(2265),i=n(1579);t.exports=function(t){return i(t)&&r(t)}},8549:(t,e,n)=>{t=n.nmd(t);var r=n(3766),i=n(4572),a=e&&!e.nodeType&&e,o=a&&t&&!t.nodeType&&t,s=o&&o.exports===a?r.Buffer:void 0,u=(s?s.isBuffer:void 0)||i;t.exports=u},322:(t,e,n)=>{var r=n(3819),i=n(2193),a=n(3435),o=n(9998),s=n(2265),u=n(8549),c=n(4906),l=n(8338),h=Object.prototype.hasOwnProperty;t.exports=function(t){if(null==t)return!0;if(s(t)&&(o(t)||"string"==typeof t||"function"==typeof t.splice||u(t)||l(t)||a(t)))return!t.length;var e=i(t);if("[object Map]"==e||"[object Set]"==e)return!t.size;if(c(t))return!r(t).length;for(var n in t)if(h.call(t,n))return!1;return!0}},1967:(t,e,n)=>{var r=n(9451),i=n(5828);t.exports=function(t){if(!i(t))return!1;var e=r(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},6947:t=>{t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},4073:(t,e,n)=>{var r=n(7505),i=n(3036),a=n(7290),o=a&&a.isMap,s=o?i(o):r;t.exports=s},5828:t=>{t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},1579:t=>{t.exports=function(t){return null!=t&&"object"==typeof t}},5200:(t,e,n)=>{var r=n(9451),i=n(3160),a=n(1579),o=Function.prototype,s=Object.prototype,u=o.toString,c=s.hasOwnProperty,l=u.call(Object);t.exports=function(t){if(!a(t)||"[object Object]"!=r(t))return!1;var e=i(t);if(null===e)return!0;var n=c.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&u.call(n)==l}},1167:(t,e,n)=>{var r=n(9239),i=n(3036),a=n(7290),o=a&&a.isSet,s=o?i(o):r;t.exports=s},2226:(t,e,n)=>{var r=n(9451),i=n(9998),a=n(1579);t.exports=function(t){return"string"==typeof t||!i(t)&&a(t)&&"[object String]"==r(t)}},4923:(t,e,n)=>{var r=n(9451),i=n(1579);t.exports=function(t){return"symbol"==typeof t||i(t)&&"[object Symbol]"==r(t)}},8338:(t,e,n)=>{var r=n(9930),i=n(3036),a=n(7290),o=a&&a.isTypedArray,s=o?i(o):r;t.exports=s},235:t=>{t.exports=function(t){return void 0===t}},8547:(t,e,n)=>{var r=n(4414),i=n(3819),a=n(2265);t.exports=function(t){return a(t)?r(t):i(t)}},1184:(t,e,n)=>{var r=n(4414),i=n(232),a=n(2265);t.exports=function(t){return a(t)?r(t,!0):i(t)}},8847:t=>{t.exports=function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}},9553:(t,e,n)=>{var r=n(7295),i=n(2126),a=n(2857),o=n(9998);t.exports=function(t,e){return(o(t)?r:a)(t,i(e,3))}},227:(t,e,n)=>{var r=n(5753),i=n(6586),a=n(2126);t.exports=function(t,e){var n={};return e=a(e,3),i(t,(function(t,i,a){r(n,i,e(t,i,a))})),n}},6089:(t,e,n)=>{var r=n(9252),i=n(6672),a=n(5645);t.exports=function(t){return t&&t.length?r(t,a,i):void 0}},8779:(t,e,n)=>{var r=n(4162);function i(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=t.apply(this,r);return n.cache=a.set(i,o)||a,o};return n.cache=new(i.Cache||r),n}i.Cache=r,t.exports=i},4635:(t,e,n)=>{var r=n(3603),i=n(8192)((function(t,e,n){r(t,e,n)}));t.exports=i},8043:(t,e,n)=>{var r=n(9252),i=n(6871),a=n(5645);t.exports=function(t){return t&&t.length?r(t,a,i):void 0}},3866:(t,e,n)=>{var r=n(9252),i=n(2126),a=n(6871);t.exports=function(t,e){return t&&t.length?r(t,i(e,2),a):void 0}},1303:t=>{t.exports=function(){}},4679:(t,e,n)=>{var r=n(3766);t.exports=function(){return r.Date.now()}},9170:(t,e,n)=>{var r=n(7162),i=n(6999)((function(t,e){return null==t?{}:r(t,e)}));t.exports=i},170:(t,e,n)=>{var r=n(4850),i=n(4104),a=n(5963),o=n(7872);t.exports=function(t){return a(t)?r(o(t)):i(t)}},2982:(t,e,n)=>{var r=n(3149)();t.exports=r},2633:(t,e,n)=>{var r=n(4451),i=n(3106),a=n(2126),o=n(3841),s=n(9998);t.exports=function(t,e,n){var u=s(t)?r:o,c=arguments.length<3;return u(t,a(e,4),n,c,i)}},1698:(t,e,n)=>{var r=n(3819),i=n(2193),a=n(2265),o=n(2226),s=n(3130);t.exports=function(t){if(null==t)return 0;if(a(t))return o(t)?s(t):t.length;var e=i(t);return"[object Map]"==e||"[object Set]"==e?t.size:r(t).length}},9842:(t,e,n)=>{var r=n(8193),i=n(8958),a=n(2241),o=n(4559),s=a((function(t,e){if(null==t)return[];var n=e.length;return n>1&&o(t,e[0],e[1])?e=[]:n>2&&o(e[0],e[1],e[2])&&(e=[e[0]]),i(t,r(e,1),[])}));t.exports=s},6610:t=>{t.exports=function(){return[]}},4572:t=>{t.exports=function(){return!1}},7309:(t,e,n)=>{var r=n(1160),i=1/0;t.exports=function(t){return t?(t=r(t))===i||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}},1010:(t,e,n)=>{var r=n(7309);t.exports=function(t){var e=r(t),n=e%1;return e==e?n?e-n:e:0}},1160:(t,e,n)=>{var r=n(5787),i=n(5828),a=n(4923),o=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,u=/^0o[0-7]+$/i,c=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(a(t))return NaN;if(i(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=i(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=r(t);var n=s.test(t);return n||u.test(t)?c(t.slice(2),n?2:8):o.test(t)?NaN:+t}},8167:(t,e,n)=>{var r=n(1824),i=n(1184);t.exports=function(t){return r(t,i(t))}},179:(t,e,n)=>{var r=n(1595);t.exports=function(t){return null==t?"":r(t)}},4707:(t,e,n)=>{var r=n(744),i=n(3579),a=n(6586),o=n(2126),s=n(3160),u=n(9998),c=n(8549),l=n(1967),h=n(5828),d=n(8338);t.exports=function(t,e,n){var f=u(t),v=f||c(t)||d(t);if(e=o(e,4),null==n){var p=t&&t.constructor;n=v?f?new p:[]:h(t)&&l(p)?i(s(t)):{}}return(v?r:a)(t,(function(t,r,i){return e(n,t,r,i)})),n}},7596:(t,e,n)=>{var r=n(8193),i=n(2241),a=n(4742),o=n(8582),s=i((function(t){return a(r(t,1,o,!0))}));t.exports=s},7157:(t,e,n)=>{var r=n(179),i=0;t.exports=function(t){var e=++i;return r(t)+e}},1793:(t,e,n)=>{var r=n(8569),i=n(8547);t.exports=function(t){return null==t?[]:r(t,i(t))}},1059:(t,e,n)=>{var r=n(694),i=n(9515);t.exports=function(t,e){return i(t||[],e||[],r)}},8236:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});var r=n(4249);function i(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,r.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==n.output){if(!(0,r.isAnyArray)(n.output))throw new TypeError("output option must be an array if specified");e=n.output}else e=new Array(t.length);var i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,r.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,i=void 0===n?0:n,a=e.toIndex,o=void 0===a?t.length:a;if(i<0||i>=t.length||!Number.isInteger(i))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=i||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[i],u=i+1;u<o;u++)t[u]<s&&(s=t[u]);return s}(t),a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,r.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,i=void 0===n?0:n,a=e.toIndex,o=void 0===a?t.length:a;if(i<0||i>=t.length||!Number.isInteger(i))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=i||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[i],u=i+1;u<o;u++)t[u]>s&&(s=t[u]);return s}(t);if(i===a)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=n.min,s=void 0===o?n.autoMinMax?i:0:o,u=n.max,c=void 0===u?n.autoMinMax?a:1:u;if(s>=c)throw new RangeError("min option must be smaller than max option");for(var l=(c-s)/(a-i),h=0;h<t.length;h++)e[h]=(t[h]-i)*l+s;return e}},9547:(t,e,n)=>{"use strict";var r=n(1975).default,i=n(585).default,a=n(4258).default,o=n(6374).default,s=n(1046).default,u=n(1105).default,c=n(1386).default,l=n(9599).default,h=n(3030).default,d=n(7161).default,f=n(385).default,v=n(5551).default,p=(n(29).default,n(1201).default),g=n(6585).default,y=n(4249),m=n(8236),b=" ".repeat(2),x=" ".repeat(4);function w(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.maxRows,r=void 0===n?15:n,i=e.maxColumns,a=void 0===i?10:i,o=e.maxNumSize,s=void 0===o?8:o,u=e.padMinus,c=void 0===u?"auto":u;return"".concat(t.constructor.name," {\n").concat(b,"[\n").concat(x).concat(function(t,e,n,r,i){var a=t.rows,o=t.columns,s=Math.min(a,e),u=Math.min(o,n),c=[];if("auto"===i){i=!1;t:for(var l=0;l<s;l++)for(var h=0;h<u;h++)if(t.get(l,h)<0){i=!0;break t}}for(var d=0;d<s;d++){for(var f=[],v=0;v<u;v++)f.push(E(t.get(d,v),r,i));c.push("".concat(f.join(" ")))}return u!==o&&(c[c.length-1]+=" ... ".concat(o-n," more columns")),s!==a&&c.push("... ".concat(a-e," more rows")),c.join("\n".concat(x))}(t,r,a,s,c),"\n").concat(b,"]\n").concat(b,"rows: ").concat(t.rows,"\n").concat(b,"columns: ").concat(t.columns,"\n}")}function E(t,e,n){return(t>=0&&n?" ".concat(k(t,e-1)):k(t,e)).padEnd(e)}function k(t,e){var n=t.toString();if(n.length<=e)return n;var r=t.toFixed(e);if(r.length>e&&(r=t.toFixed(Math.max(0,e-(r.length-e)))),r.length<=e&&!r.startsWith("0.000")&&!r.startsWith("-0.000"))return r;var i=t.toExponential(e);return i.length>e&&(i=t.toExponential(Math.max(0,e-(i.length-e)))),i.slice(0)}function M(t,e,n){var r=n?t.rows:t.rows-1;if(e<0||e>r)throw new RangeError("Row index out of range")}function S(t,e,n){var r=n?t.columns:t.columns-1;if(e<0||e>r)throw new RangeError("Column index out of range")}function O(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function N(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function A(t,e){if(!y.isAnyArray(e))throw new TypeError("row indices must be an array");for(var n=0;n<e.length;n++)if(e[n]<0||e[n]>=t.rows)throw new RangeError("row indices are out of range")}function T(t,e){if(!y.isAnyArray(e))throw new TypeError("column indices must be an array");for(var n=0;n<e.length;n++)if(e[n]<0||e[n]>=t.columns)throw new RangeError("column indices are out of range")}function P(t,e,n,r,i){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(R("startRow",e),R("endRow",n),R("startColumn",r),R("endColumn",i),e>n||r>i||e<0||e>=t.rows||n<0||n>=t.rows||r<0||r>=t.columns||i<0||i>=t.columns)throw new RangeError("Submatrix indices are out of range")}function C(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[],r=0;r<t;r++)n.push(e);return n}function R(t,e){if("number"!=typeof e)throw new TypeError("".concat(t," must be a number"))}function L(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}var D=function(){function t(){p(this,t)}return g(t,[{key:"size",get:function(){return this.rows*this.columns}},{key:"apply",value:function(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.call(this,e,n);return this}},{key:"to1DArray",value:function(){for(var t=[],e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.push(this.get(e,n));return t}},{key:"to2DArray",value:function(){for(var t=[],e=0;e<this.rows;e++){t.push([]);for(var n=0;n<this.columns;n++)t[e].push(this.get(e,n))}return t}},{key:"toJSON",value:function(){return this.to2DArray()}},{key:"isRowVector",value:function(){return 1===this.rows}},{key:"isColumnVector",value:function(){return 1===this.columns}},{key:"isVector",value:function(){return 1===this.rows||1===this.columns}},{key:"isSquare",value:function(){return this.rows===this.columns}},{key:"isEmpty",value:function(){return 0===this.rows||0===this.columns}},{key:"isSymmetric",value:function(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}},{key:"isDistance",value:function(){if(!this.isSymmetric())return!1;for(var t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}},{key:"isEchelonForm",value:function(){for(var t=0,e=0,n=-1,r=!0,i=!1;t<this.rows&&r;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(i=!0,n=e):(r=!1,i=!0);t++}return r}},{key:"isReducedEchelonForm",value:function(){for(var t=0,e=0,n=-1,r=!0,i=!1;t<this.rows&&r;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(i=!0,n=e):(r=!1,i=!0);for(var a=e+1;a<this.rows;a++)0!==this.get(t,a)&&(r=!1);t++}return r}},{key:"echelonForm",value:function(){for(var t=this.clone(),e=0,n=0;e<t.rows&&n<t.columns;){for(var r=e,i=e;i<t.rows;i++)t.get(i,n)>t.get(r,n)&&(r=i);if(0===t.get(r,n))n++;else{t.swapRows(e,r);for(var a=t.get(e,n),o=n;o<t.columns;o++)t.set(e,o,t.get(e,o)/a);for(var s=e+1;s<t.rows;s++){var u=t.get(s,n)/t.get(e,n);t.set(s,n,0);for(var c=n+1;c<t.columns;c++)t.set(s,c,t.get(s,c)-t.get(e,c)*u)}e++,n++}}return t}},{key:"reducedEchelonForm",value:function(){for(var t=this.echelonForm(),e=t.columns,n=t.rows,r=n-1;r>=0;)if(0===t.maxRow(r))r--;else{for(var i=0,a=!1;i<n&&!1===a;)1===t.get(r,i)?a=!0:i++;for(var o=0;o<r;o++)for(var s=t.get(o,i),u=i;u<e;u++){var c=t.get(o,u)-s*t.get(r,u);t.set(o,u,c)}r--}return t}},{key:"set",value:function(){throw new Error("set method is unimplemented")}},{key:"get",value:function(){throw new Error("get method is unimplemented")}},{key:"repeat",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!=typeof t)throw new TypeError("options must be an object");var e=t.rows,n=void 0===e?1:e,r=t.columns,i=void 0===r?1:r;if(!Number.isInteger(n)||n<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(i)||i<=0)throw new TypeError("columns must be a positive integer");for(var a=new j(this.rows*n,this.columns*i),o=0;o<n;o++)for(var s=0;s<i;s++)a.setSubMatrix(this,this.rows*o,this.columns*s);return a}},{key:"fill",value:function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,t);return this}},{key:"neg",value:function(){return this.mulS(-1)}},{key:"getRow",value:function(t){M(this,t);for(var e=[],n=0;n<this.columns;n++)e.push(this.get(t,n));return e}},{key:"getRowVector",value:function(t){return j.rowVector(this.getRow(t))}},{key:"setRow",value:function(t,e){M(this,t),e=O(this,e);for(var n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}},{key:"swapRows",value:function(t,e){M(this,t),M(this,e);for(var n=0;n<this.columns;n++){var r=this.get(t,n);this.set(t,n,this.get(e,n)),this.set(e,n,r)}return this}},{key:"getColumn",value:function(t){S(this,t);for(var e=[],n=0;n<this.rows;n++)e.push(this.get(n,t));return e}},{key:"getColumnVector",value:function(t){return j.columnVector(this.getColumn(t))}},{key:"setColumn",value:function(t,e){S(this,t),e=N(this,e);for(var n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}},{key:"swapColumns",value:function(t,e){S(this,t),S(this,e);for(var n=0;n<this.rows;n++){var r=this.get(n,t);this.set(n,t,this.get(n,e)),this.set(n,e,r)}return this}},{key:"addRowVector",value:function(t){t=O(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}},{key:"subRowVector",value:function(t){t=O(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}},{key:"mulRowVector",value:function(t){t=O(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}},{key:"divRowVector",value:function(t){t=O(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}},{key:"addColumnVector",value:function(t){t=N(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}},{key:"subColumnVector",value:function(t){t=N(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}},{key:"mulColumnVector",value:function(t){t=N(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}},{key:"divColumnVector",value:function(t){t=N(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}},{key:"mulRow",value:function(t,e){M(this,t);for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}},{key:"mulColumn",value:function(t,e){S(this,t);for(var n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}},{key:"max",value:function(t){if(this.isEmpty())return NaN;switch(t){case"row":for(var e=new Array(this.rows).fill(Number.NEGATIVE_INFINITY),n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)>e[n]&&(e[n]=this.get(n,r));return e;case"column":for(var i=new Array(this.columns).fill(Number.NEGATIVE_INFINITY),a=0;a<this.rows;a++)for(var o=0;o<this.columns;o++)this.get(a,o)>i[o]&&(i[o]=this.get(a,o));return i;case void 0:for(var s=this.get(0,0),u=0;u<this.rows;u++)for(var c=0;c<this.columns;c++)this.get(u,c)>s&&(s=this.get(u,c));return s;default:throw new Error("invalid option: ".concat(t))}}},{key:"maxIndex",value:function(){L(this);for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}},{key:"min",value:function(t){if(this.isEmpty())return NaN;switch(t){case"row":for(var e=new Array(this.rows).fill(Number.POSITIVE_INFINITY),n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)<e[n]&&(e[n]=this.get(n,r));return e;case"column":for(var i=new Array(this.columns).fill(Number.POSITIVE_INFINITY),a=0;a<this.rows;a++)for(var o=0;o<this.columns;o++)this.get(a,o)<i[o]&&(i[o]=this.get(a,o));return i;case void 0:for(var s=this.get(0,0),u=0;u<this.rows;u++)for(var c=0;c<this.columns;c++)this.get(u,c)<s&&(s=this.get(u,c));return s;default:throw new Error("invalid option: ".concat(t))}}},{key:"minIndex",value:function(){L(this);for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}},{key:"maxRow",value:function(t){if(M(this,t),this.isEmpty())return NaN;for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}},{key:"maxRowIndex",value:function(t){M(this,t),L(this);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r),n[1]=r);return n}},{key:"minRow",value:function(t){if(M(this,t),this.isEmpty())return NaN;for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}},{key:"minRowIndex",value:function(t){M(this,t),L(this);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r),n[1]=r);return n}},{key:"maxColumn",value:function(t){if(S(this,t),this.isEmpty())return NaN;for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}},{key:"maxColumnIndex",value:function(t){S(this,t),L(this);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t),n[0]=r);return n}},{key:"minColumn",value:function(t){if(S(this,t),this.isEmpty())return NaN;for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}},{key:"minColumnIndex",value:function(t){S(this,t),L(this);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t),n[0]=r);return n}},{key:"diag",value:function(){for(var t=Math.min(this.rows,this.columns),e=[],n=0;n<t;n++)e.push(this.get(n,n));return e}},{key:"norm",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"frobenius";switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError("unknown norm type: ".concat(t))}}},{key:"cumulativeSum",value:function(){for(var t=0,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}},{key:"dot",value:function(e){t.isMatrix(e)&&(e=e.to1DArray());var n=this.to1DArray();if(n.length!==e.length)throw new RangeError("vectors do not have the same size");for(var r=0,i=0;i<n.length;i++)r+=n[i]*e[i];return r}},{key:"mmul",value:function(t){t=j.checkMatrix(t);for(var e=this.rows,n=this.columns,r=t.columns,i=new j(e,r),a=new Float64Array(n),o=0;o<r;o++){for(var s=0;s<n;s++)a[s]=t.get(s,o);for(var u=0;u<e;u++){for(var c=0,l=0;l<n;l++)c+=this.get(u,l)*a[l];i.set(u,o,c)}}return i}},{key:"mpow",value:function(t){if(!this.isSquare())throw new RangeError("Matrix must be square");if(!Number.isInteger(t)||t<0)throw new RangeError("Exponent must be a non-negative integer");for(var e=j.eye(this.rows),n=this,r=t;r>=1;r/=2)1&r&&(e=e.mmul(n)),n=n.mmul(n);return e}},{key:"strassen2x2",value:function(t){t=j.checkMatrix(t);var e=new j(2,2),n=this.get(0,0),r=t.get(0,0),i=this.get(0,1),a=t.get(0,1),o=this.get(1,0),s=t.get(1,0),u=this.get(1,1),c=t.get(1,1),l=(n+u)*(r+c),h=(o+u)*r,d=n*(a-c),f=u*(s-r),v=(n+i)*c,p=l+f-v+(i-u)*(s+c),g=d+v,y=h+f,m=l-h+d+(o-n)*(r+a);return e.set(0,0,p),e.set(0,1,g),e.set(1,0,y),e.set(1,1,m),e}},{key:"strassen3x3",value:function(t){t=j.checkMatrix(t);var e=new j(3,3),n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),a=this.get(1,0),o=this.get(1,1),s=this.get(1,2),u=this.get(2,0),c=this.get(2,1),l=this.get(2,2),h=t.get(0,0),d=t.get(0,1),f=t.get(0,2),v=t.get(1,0),p=t.get(1,1),g=t.get(1,2),y=t.get(2,0),m=t.get(2,1),b=t.get(2,2),x=(n-a)*(-d+p),w=(-n+a+o)*(h-d+p),E=(a+o)*(-h+d),k=n*h,M=(-n+u+c)*(h-f+g),S=(-n+u)*(f-g),O=(u+c)*(-h+f),N=(-i+c+l)*(p+y-m),A=(i-l)*(p-m),T=i*y,P=(c+l)*(-y+m),C=(-i+o+s)*(g+y-b),R=(i-s)*(g-b),L=(o+s)*(-y+b),D=k+T+r*v,_=(n+r+i-a-o-c-l)*p+w+E+k+N+T+P,I=k+M+O+(n+r+i-o-s-u-c)*g+T+C+L,F=x+o*(-h+d+v-p-g-y+b)+w+k+T+C+R,B=x+w+E+k+s*m,z=T+C+R+L+a*f,G=k+M+S+c*(-h+f+v-p-g-y+m)+N+A+T,V=N+A+T+P+u*d,W=k+M+S+O+l*b;return e.set(0,0,D),e.set(0,1,_),e.set(0,2,I),e.set(1,0,F),e.set(1,1,B),e.set(1,2,z),e.set(2,0,G),e.set(2,1,V),e.set(2,2,W),e}},{key:"mmulStrassen",value:function(e){e=j.checkMatrix(e);var n=this.clone(),r=n.rows,i=n.columns,a=e.rows,o=e.columns;function s(e,n,r){var i=e.rows,a=e.columns;if(i===n&&a===r)return e;var o=t.zeros(n,r);return o.setSubMatrix(e,0,0)}i!==a&&console.warn("Multiplying ".concat(r," x ").concat(i," and ").concat(a," x ").concat(o," matrix: dimensions do not match."));var u=Math.max(r,a),c=Math.max(i,o);return function e(n,r,i,a){if(i<=512||a<=512)return n.mmul(r);i%2==1&&a%2==1?(n=s(n,i+1,a+1),r=s(r,i+1,a+1)):i%2==1?(n=s(n,i+1,a),r=s(r,i+1,a)):a%2==1&&(n=s(n,i,a+1),r=s(r,i,a+1));var o=parseInt(n.rows/2,10),u=parseInt(n.columns/2,10),c=n.subMatrix(0,o-1,0,u-1),l=r.subMatrix(0,o-1,0,u-1),h=n.subMatrix(0,o-1,u,n.columns-1),d=r.subMatrix(0,o-1,u,r.columns-1),f=n.subMatrix(o,n.rows-1,0,u-1),v=r.subMatrix(o,r.rows-1,0,u-1),p=n.subMatrix(o,n.rows-1,u,n.columns-1),g=r.subMatrix(o,r.rows-1,u,r.columns-1),y=e(t.add(c,p),t.add(l,g),o,u),m=e(t.add(f,p),l,o,u),b=e(c,t.sub(d,g),o,u),x=e(p,t.sub(v,l),o,u),w=e(t.add(c,h),g,o,u),E=e(t.sub(f,c),t.add(l,d),o,u),k=e(t.sub(h,p),t.add(v,g),o,u),M=t.add(y,x);M.sub(w),M.add(k);var S=t.add(b,w),O=t.add(m,x),N=t.sub(y,m);N.add(b),N.add(E);var A=t.zeros(2*M.rows,2*M.columns);return(A=(A=(A=(A=A.setSubMatrix(M,0,0)).setSubMatrix(S,M.rows,0)).setSubMatrix(O,0,M.columns)).setSubMatrix(N,M.rows,M.columns)).subMatrix(0,i-1,0,a-1)}(n=s(n,u,c),e=s(e,u,c),u,c)}},{key:"scaleRows",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!=typeof t)throw new TypeError("options must be an object");var e=t.min,n=void 0===e?0:e,r=t.max,i=void 0===r?1:r;if(!Number.isFinite(n))throw new TypeError("min must be a number");if(!Number.isFinite(i))throw new TypeError("max must be a number");if(n>=i)throw new RangeError("min must be smaller than max");for(var a=new j(this.rows,this.columns),o=0;o<this.rows;o++){var s=this.getRow(o);s.length>0&&m(s,{min:n,max:i,output:s}),a.setRow(o,s)}return a}},{key:"scaleColumns",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!=typeof t)throw new TypeError("options must be an object");var e=t.min,n=void 0===e?0:e,r=t.max,i=void 0===r?1:r;if(!Number.isFinite(n))throw new TypeError("min must be a number");if(!Number.isFinite(i))throw new TypeError("max must be a number");if(n>=i)throw new RangeError("min must be smaller than max");for(var a=new j(this.rows,this.columns),o=0;o<this.columns;o++){var s=this.getColumn(o);s.length&&m(s,{min:n,max:i,output:s}),a.setColumn(o,s)}return a}},{key:"flipRows",value:function(){for(var t=Math.ceil(this.columns/2),e=0;e<this.rows;e++)for(var n=0;n<t;n++){var r=this.get(e,n),i=this.get(e,this.columns-1-n);this.set(e,n,i),this.set(e,this.columns-1-n,r)}return this}},{key:"flipColumns",value:function(){for(var t=Math.ceil(this.rows/2),e=0;e<this.columns;e++)for(var n=0;n<t;n++){var r=this.get(n,e),i=this.get(this.rows-1-n,e);this.set(n,e,i),this.set(this.rows-1-n,e,r)}return this}},{key:"kroneckerProduct",value:function(t){t=j.checkMatrix(t);for(var e=this.rows,n=this.columns,r=t.rows,i=t.columns,a=new j(e*r,n*i),o=0;o<e;o++)for(var s=0;s<n;s++)for(var u=0;u<r;u++)for(var c=0;c<i;c++)a.set(r*o+u,i*s+c,this.get(o,s)*t.get(u,c));return a}},{key:"kroneckerSum",value:function(t){if(t=j.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");var e=this.rows,n=t.rows,r=this.kroneckerProduct(j.eye(n,n)),i=j.eye(e,e).kroneckerProduct(t);return r.add(i)}},{key:"transpose",value:function(){for(var t=new j(this.columns,this.rows),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}},{key:"sortRows",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}},{key:"sortColumns",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}},{key:"subMatrix",value:function(t,e,n,r){P(this,t,e,n,r);for(var i=new j(e-t+1,r-n+1),a=t;a<=e;a++)for(var o=n;o<=r;o++)i.set(a-t,o-n,this.get(a,o));return i}},{key:"subMatrixRow",value:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.columns-1),e>n||e<0||e>=this.columns||n<0||n>=this.columns)throw new RangeError("Argument out of range");for(var r=new j(t.length,n-e+1),i=0;i<t.length;i++)for(var a=e;a<=n;a++){if(t[i]<0||t[i]>=this.rows)throw new RangeError("Row index out of range: ".concat(t[i]));r.set(i,a-e,this.get(t[i],a))}return r}},{key:"subMatrixColumn",value:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.rows-1),e>n||e<0||e>=this.rows||n<0||n>=this.rows)throw new RangeError("Argument out of range");for(var r=new j(n-e+1,t.length),i=0;i<t.length;i++)for(var a=e;a<=n;a++){if(t[i]<0||t[i]>=this.columns)throw new RangeError("Column index out of range: ".concat(t[i]));r.set(a-e,i,this.get(a,t[i]))}return r}},{key:"setSubMatrix",value:function(t,e,n){if((t=j.checkMatrix(t)).isEmpty())return this;P(this,e,e+t.rows-1,n,n+t.columns-1);for(var r=0;r<t.rows;r++)for(var i=0;i<t.columns;i++)this.set(e+r,n+i,t.get(r,i));return this}},{key:"selection",value:function(t,e){A(this,t),T(this,e);for(var n=new j(t.length,e.length),r=0;r<t.length;r++)for(var i=t[r],a=0;a<e.length;a++){var o=e[a];n.set(r,a,this.get(i,o))}return n}},{key:"trace",value:function(){for(var t=Math.min(this.rows,this.columns),e=0,n=0;n<t;n++)e+=this.get(n,n);return e}},{key:"clone",value:function(){return this.constructor.copy(this,new j(this.rows,this.columns))}},{key:"sum",value:function(t){switch(t){case"row":return function(t){for(var e=C(t.rows),n=0;n<t.rows;++n)for(var r=0;r<t.columns;++r)e[n]+=t.get(n,r);return e}(this);case"column":return function(t){for(var e=C(t.columns),n=0;n<t.rows;++n)for(var r=0;r<t.columns;++r)e[r]+=t.get(n,r);return e}(this);case void 0:return function(t){for(var e=0,n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)e+=t.get(n,r);return e}(this);default:throw new Error("invalid option: ".concat(t))}}},{key:"product",value:function(t){switch(t){case"row":return function(t){for(var e=C(t.rows,1),n=0;n<t.rows;++n)for(var r=0;r<t.columns;++r)e[n]*=t.get(n,r);return e}(this);case"column":return function(t){for(var e=C(t.columns,1),n=0;n<t.rows;++n)for(var r=0;r<t.columns;++r)e[r]*=t.get(n,r);return e}(this);case void 0:return function(t){for(var e=1,n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)e*=t.get(n,r);return e}(this);default:throw new Error("invalid option: ".concat(t))}}},{key:"mean",value:function(t){var e=this.sum(t);switch(t){case"row":for(var n=0;n<this.rows;n++)e[n]/=this.columns;return e;case"column":for(var r=0;r<this.columns;r++)e[r]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error("invalid option: ".concat(t))}}},{key:"variance",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");var n=e,r=n.unbiased,i=void 0===r||r,a=n.mean,o=void 0===a?this.mean(t):a;if("boolean"!=typeof i)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!y.isAnyArray(o))throw new TypeError("mean must be an array");return function(t,e,n){for(var r=t.rows,i=t.columns,a=[],o=0;o<r;o++){for(var s=0,u=0,c=0,l=0;l<i;l++)s+=c=t.get(o,l)-n[o],u+=c*c;e?a.push((u-s*s/i)/(i-1)):a.push((u-s*s/i)/i)}return a}(this,i,o);case"column":if(!y.isAnyArray(o))throw new TypeError("mean must be an array");return function(t,e,n){for(var r=t.rows,i=t.columns,a=[],o=0;o<i;o++){for(var s=0,u=0,c=0,l=0;l<r;l++)s+=c=t.get(l,o)-n[o],u+=c*c;e?a.push((u-s*s/r)/(r-1)):a.push((u-s*s/r)/r)}return a}(this,i,o);case void 0:if("number"!=typeof o)throw new TypeError("mean must be a number");return function(t,e,n){for(var r=t.rows,i=t.columns,a=r*i,o=0,s=0,u=0,c=0;c<r;c++)for(var l=0;l<i;l++)o+=u=t.get(c,l)-n,s+=u*u;return e?(s-o*o/a)/(a-1):(s-o*o/a)/a}(this,i,o);default:throw new Error("invalid option: ".concat(t))}}},{key:"standardDeviation",value:function(t,e){"object"==typeof t&&(e=t,t=void 0);var n=this.variance(t,e);if(void 0===t)return Math.sqrt(n);for(var r=0;r<n.length;r++)n[r]=Math.sqrt(n[r]);return n}},{key:"center",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");var n=e.center,r=void 0===n?this.mean(t):n;switch(t){case"row":if(!y.isAnyArray(r))throw new TypeError("center must be an array");return function(t,e){for(var n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)-e[n])}(this,r),this;case"column":if(!y.isAnyArray(r))throw new TypeError("center must be an array");return function(t,e){for(var n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)-e[r])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(var n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)-e)}(this,r),this;default:throw new Error("invalid option: ".concat(t))}}},{key:"scale",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");var n=e.scale;switch(t){case"row":if(void 0===n)n=function(t){for(var e=[],n=0;n<t.rows;n++){for(var r=0,i=0;i<t.columns;i++)r+=Math.pow(t.get(n,i),2)/(t.columns-1);e.push(Math.sqrt(r))}return e}(this);else if(!y.isAnyArray(n))throw new TypeError("scale must be an array");return function(t,e){for(var n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)/e[n])}(this,n),this;case"column":if(void 0===n)n=function(t){for(var e=[],n=0;n<t.columns;n++){for(var r=0,i=0;i<t.rows;i++)r+=Math.pow(t.get(i,n),2)/(t.rows-1);e.push(Math.sqrt(r))}return e}(this);else if(!y.isAnyArray(n))throw new TypeError("scale must be an array");return function(t,e){for(var n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)/e[r])}(this,n),this;case void 0:if(void 0===n)n=function(t){for(var e=t.size-1,n=0,r=0;r<t.columns;r++)for(var i=0;i<t.rows;i++)n+=Math.pow(t.get(i,r),2)/e;return Math.sqrt(n)}(this);else if("number"!=typeof n)throw new TypeError("scale must be a number");return function(t,e){for(var n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)/e)}(this,n),this;default:throw new Error("invalid option: ".concat(t))}}},{key:"toString",value:function(t){return w(this,t)}},{key:Symbol.iterator,value:function(){return this.entries()}},{key:"entries",value:v().mark((function t(){var e,n;return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=0;case 1:if(!(e<this.rows)){t.next=12;break}n=0;case 3:if(!(n<this.columns)){t.next=9;break}return t.next=6,[e,n,this.get(e,n)];case 6:n++,t.next=3;break;case 9:e++,t.next=1;break;case 12:case"end":return t.stop()}}),t,this)}))},{key:"values",value:v().mark((function t(){var e,n;return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=0;case 1:if(!(e<this.rows)){t.next=12;break}n=0;case 3:if(!(n<this.columns)){t.next=9;break}return t.next=6,this.get(e,n);case 6:n++,t.next=3;break;case 9:e++,t.next=1;break;case 12:case"end":return t.stop()}}),t,this)}))}],[{key:"from1DArray",value:function(t,e,n){if(t*e!==n.length)throw new RangeError("data length does not match given dimensions");for(var r=new j(t,e),i=0;i<t;i++)for(var a=0;a<e;a++)r.set(i,a,n[i*e+a]);return r}},{key:"rowVector",value:function(t){for(var e=new j(1,t.length),n=0;n<t.length;n++)e.set(0,n,t[n]);return e}},{key:"columnVector",value:function(t){for(var e=new j(t.length,1),n=0;n<t.length;n++)e.set(n,0,t[n]);return e}},{key:"zeros",value:function(t,e){return new j(t,e)}},{key:"ones",value:function(t,e){return new j(t,e).fill(1)}},{key:"rand",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("object"!=typeof n)throw new TypeError("options must be an object");for(var r=n.random,i=void 0===r?Math.random:r,a=new j(t,e),o=0;o<t;o++)for(var s=0;s<e;s++)a.set(o,s,i());return a}},{key:"randInt",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("object"!=typeof n)throw new TypeError("options must be an object");var r=n.min,i=void 0===r?0:r,a=n.max,o=void 0===a?1e3:a,s=n.random,u=void 0===s?Math.random:s;if(!Number.isInteger(i))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(i>=o)throw new RangeError("min must be smaller than max");for(var c=o-i,l=new j(t,e),h=0;h<t;h++)for(var d=0;d<e;d++){var f=i+Math.round(u()*c);l.set(h,d,f)}return l}},{key:"eye",value:function(t,e,n){void 0===e&&(e=t),void 0===n&&(n=1);for(var r=Math.min(t,e),i=this.zeros(t,e),a=0;a<r;a++)i.set(a,a,n);return i}},{key:"diag",value:function(t,e,n){var r=t.length;void 0===e&&(e=r),void 0===n&&(n=e);for(var i=Math.min(r,e,n),a=this.zeros(e,n),o=0;o<i;o++)a.set(o,o,t[o]);return a}},{key:"min",value:function(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new j(n,r),a=0;a<n;a++)for(var o=0;o<r;o++)i.set(a,o,Math.min(t.get(a,o),e.get(a,o)));return i}},{key:"max",value:function(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),a=0;a<n;a++)for(var o=0;o<r;o++)i.set(a,o,Math.max(t.get(a,o),e.get(a,o)));return i}},{key:"checkMatrix",value:function(e){return t.isMatrix(e)?e:new j(e)}},{key:"isMatrix",value:function(t){return null!=t&&"Matrix"===t.klass}},{key:"copy",value:function(t,e){var n,r=f(t.entries());try{for(r.s();!(n=r.n()).done;){var i=d(n.value,3),a=i[0],o=i[1],s=i[2];e.set(a,o,s)}}catch(t){r.e(t)}finally{r.f()}return e}}])}();function _(t,e){return t-e}D.prototype.klass="Matrix","undefined"!=typeof Symbol&&(D.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return w(this)}),D.random=D.rand,D.randomInt=D.randInt,D.diagonal=D.diag,D.prototype.diagonal=D.prototype.diag,D.identity=D.eye,D.prototype.negate=D.prototype.neg,D.prototype.tensorProduct=D.prototype.kroneckerProduct;var I=new WeakSet,j=function(t){function e(t,n){var r;if(p(this,e),r=s(this,e),c(r,I),l(r,"data",void 0),e.isMatrix(t))h(I,r,F).call(r,t.rows,t.columns),e.copy(t,r);else if(Number.isInteger(t)&&t>=0)h(I,r,F).call(r,t,n);else{if(!y.isAnyArray(t))throw new TypeError("First argument must be a positive number or an array");var i=t;if("number"!=typeof(n=(t=i.length)?i[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");r.data=[];for(var a=0;a<t;a++){if(i[a].length!==n)throw new RangeError("Inconsistent array dimensions");if(!i[a].every((function(t){return"number"==typeof t})))throw new TypeError("Input data contains non-numeric values");r.data.push(Float64Array.from(i[a]))}r.rows=t,r.columns=n}return r}return u(e,t),g(e,[{key:"set",value:function(t,e,n){return this.data[t][e]=n,this}},{key:"get",value:function(t,e){return this.data[t][e]}},{key:"removeRow",value:function(t){return M(this,t),this.data.splice(t,1),this.rows-=1,this}},{key:"addRow",value:function(t,e){return void 0===e&&(e=t,t=this.rows),M(this,t,!0),e=Float64Array.from(O(this,e)),this.data.splice(t,0,e),this.rows+=1,this}},{key:"removeColumn",value:function(t){S(this,t);for(var e=0;e<this.rows;e++){for(var n=new Float64Array(this.columns-1),r=0;r<t;r++)n[r]=this.data[e][r];for(var i=t+1;i<this.columns;i++)n[i-1]=this.data[e][i];this.data[e]=n}return this.columns-=1,this}},{key:"addColumn",value:function(t,e){void 0===e&&(e=t,t=this.columns),S(this,t,!0),e=N(this,e);for(var n=0;n<this.rows;n++){for(var r=new Float64Array(this.columns+1),i=0;i<t;i++)r[i]=this.data[n][i];for(r[i++]=e[n];i<this.columns+1;i++)r[i]=this.data[n][i-1];this.data[n]=r}return this.columns+=1,this}}])}(D);function F(t,e){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(var n=0;n<t;n++)this.data.push(new Float64Array(e));this.rows=t,this.columns=e}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)+t.get(n,r));return this},t.add=function(t,n){return new e(t).add(n)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)-t.get(n,r));return this},t.sub=function(t,n){return new e(t).sub(n)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)*t.get(n,r));return this},t.mul=function(t,n){return new e(t).mul(n)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)/t.get(n,r));return this},t.div=function(t,n){return new e(t).div(n)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)%t.get(n,r));return this},t.mod=function(t,n){return new e(t).mod(n)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)&t.get(n,r));return this},t.and=function(t,n){return new e(t).and(n)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)|t.get(n,r));return this},t.or=function(t,n){return new e(t).or(n)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)^t.get(n,r));return this},t.xor=function(t,n){return new e(t).xor(n)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)<<t.get(n,r));return this},t.leftShift=function(t,n){return new e(t).leftShift(n)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)>>t.get(n,r));return this},t.signPropagatingRightShift=function(t,n){return new e(t).signPropagatingRightShift(n)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)>>>t.get(n,r));return this},t.rightShift=function(t,n){return new e(t).rightShift(n)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,n){return new e(t).pow(n)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,Math.pow(this.get(e,n),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,Math.pow(this.get(n,r),t.get(n,r)));return this}}(D,j);var B=new WeakMap,z=function(t){function e(t){var n;if(p(this,e),n=s(this,e),i(n,B,void 0),j.isMatrix(t)){if(!t.isSymmetric())throw new TypeError("not symmetric data");a(B,n,j.copy(t,new j(t.rows,t.rows)))}else if(Number.isInteger(t)&&t>=0)a(B,n,new j(t,t));else if(a(B,n,new j(t)),!n.isSymmetric())throw new TypeError("not symmetric data");return n}return u(e,t),g(e,[{key:"size",get:function(){return o(B,this).size}},{key:"rows",get:function(){return o(B,this).rows}},{key:"columns",get:function(){return o(B,this).columns}},{key:"diagonalSize",get:function(){return this.rows}},{key:"clone",value:function(){var t,n=new e(this.diagonalSize),r=f(this.upperRightEntries());try{for(r.s();!(t=r.n()).done;){var i=d(t.value,3),a=i[0],o=i[1],s=i[2];n.set(a,o,s)}}catch(t){r.e(t)}finally{r.f()}return n}},{key:"toMatrix",value:function(){return new j(this)}},{key:"get",value:function(t,e){return o(B,this).get(t,e)}},{key:"set",value:function(t,e,n){return o(B,this).set(t,e,n),o(B,this).set(e,t,n),this}},{key:"removeCross",value:function(t){return o(B,this).removeRow(t),o(B,this).removeColumn(t),this}},{key:"addCross",value:function(t,e){void 0===e&&(e=t,t=this.diagonalSize);var n=e.slice();return n.splice(t,1),o(B,this).addRow(t,n),o(B,this).addColumn(t,e),this}},{key:"applyMask",value:function(t){if(t.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");var e,n=[],r=f(t.entries());try{for(r.s();!(e=r.n()).done;){var i=d(e.value,2),a=i[0];i[1]||n.push(a)}}catch(t){r.e(t)}finally{r.f()}n.reverse();for(var o=0,s=n;o<s.length;o++){var u=s[o];this.removeCross(u)}return this}},{key:"toCompact",value:function(){for(var t=this.diagonalSize,e=new Array(t*(t+1)/2),n=0,r=0,i=0;i<e.length;i++)e[i]=this.get(r,n),++n>=t&&(n=++r);return e}},{key:"upperRightEntries",value:v().mark((function t(){var e,n,r;return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=0,n=0;case 1:if(!(e<this.diagonalSize)){t.next=9;break}return r=this.get(e,n),t.next=5,[e,n,r];case 5:++n>=this.diagonalSize&&(n=++e);case 6:t.next=1;break;case 9:case"end":return t.stop()}}),t,this)}))},{key:"upperRightValues",value:v().mark((function t(){var e,n,r;return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=0,n=0;case 1:if(!(e<this.diagonalSize)){t.next=9;break}return r=this.get(e,n),t.next=5,r;case 5:++n>=this.diagonalSize&&(n=++e);case 6:t.next=1;break;case 9:case"end":return t.stop()}}),t,this)}))}],[{key:"isSymmetricMatrix",value:function(t){return j.isMatrix(t)&&"SymmetricMatrix"===t.klassType}},{key:"zeros",value:function(t){return new this(t)}},{key:"ones",value:function(t){return new this(t).fill(1)}},{key:"fromCompact",value:function(t){var n=t.length,r=(Math.sqrt(8*n+1)-1)/2;if(!Number.isInteger(r))throw new TypeError("This array is not a compact representation of a Symmetric Matrix, ".concat(JSON.stringify(t)));for(var i=new e(r),a=0,o=0,s=0;s<n;s++)i.set(a,o,t[s]),++a>=r&&(a=++o);return i}}])}(D);z.prototype.klassType="SymmetricMatrix";var G=function(t){function e(t){var n;if(p(this,e),!(n=s(this,e,[t])).isDistance())throw new TypeError("Provided arguments do no produce a distance matrix");return n}return u(e,t),g(e,[{key:"set",value:function(t,n,i){return t===n&&(i=0),r(e,"set",this,3)([t,n,i])}},{key:"addCross",value:function(t,n){return void 0===n&&(n=t,t=this.diagonalSize),(n=n.slice())[t]=0,r(e,"addCross",this,3)([t,n])}},{key:"toSymmetricMatrix",value:function(){return new z(this)}},{key:"clone",value:function(){var t,n=new e(this.diagonalSize),r=f(this.upperRightEntries());try{for(r.s();!(t=r.n()).done;){var i=d(t.value,3),a=i[0],o=i[1],s=i[2];a!==o&&n.set(a,o,s)}}catch(t){r.e(t)}finally{r.f()}return n}},{key:"toCompact",value:function(){for(var t=this.diagonalSize,e=new Array((t-1)*t/2),n=1,r=0,i=0;i<e.length;i++)e[i]=this.get(r,n),++n>=t&&(n=1+ ++r);return e}}],[{key:"isDistanceMatrix",value:function(t){return z.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}},{key:"fromCompact",value:function(t){var e=t.length;if(0===e)return new this(0);var n=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(n))throw new TypeError("This array is not a compact representation of a DistanceMatrix, ".concat(JSON.stringify(t)));for(var r=new this(n),i=1,a=0,o=0;o<e;o++)r.set(i,a,t[o]),++i>=n&&(i=1+ ++a);return r}}])}(z);G.prototype.klassSubType="DistanceMatrix";var V=function(t){function e(t,n,r){var i;return p(this,e),(i=s(this,e)).matrix=t,i.rows=n,i.columns=r,i}return u(e,t),g(e)}(D),W=function(t){function e(t,n){var r;return p(this,e),S(t,n),(r=s(this,e,[t,t.rows,1])).column=n,r}return u(e,t),g(e,[{key:"set",value:function(t,e,n){return this.matrix.set(t,this.column,n),this}},{key:"get",value:function(t){return this.matrix.get(t,this.column)}}])}(V),H=function(t){function e(t,n){var r;return p(this,e),T(t,n),(r=s(this,e,[t,t.rows,n.length])).columnIndices=n,r}return u(e,t),g(e,[{key:"set",value:function(t,e,n){return this.matrix.set(t,this.columnIndices[e],n),this}},{key:"get",value:function(t,e){return this.matrix.get(t,this.columnIndices[e])}}])}(V),Y=function(t){function e(t){return p(this,e),s(this,e,[t,t.rows,t.columns])}return u(e,t),g(e,[{key:"set",value:function(t,e,n){return this.matrix.set(t,this.columns-e-1,n),this}},{key:"get",value:function(t,e){return this.matrix.get(t,this.columns-e-1)}}])}(V),U=function(t){function e(t){return p(this,e),s(this,e,[t,t.rows,t.columns])}return u(e,t),g(e,[{key:"set",value:function(t,e,n){return this.matrix.set(this.rows-t-1,e,n),this}},{key:"get",value:function(t,e){return this.matrix.get(this.rows-t-1,e)}}])}(V),q=function(t){function e(t,n){var r;return p(this,e),M(t,n),(r=s(this,e,[t,1,t.columns])).row=n,r}return u(e,t),g(e,[{key:"set",value:function(t,e,n){return this.matrix.set(this.row,e,n),this}},{key:"get",value:function(t,e){return this.matrix.get(this.row,e)}}])}(V),X=function(t){function e(t,n){var r;return p(this,e),A(t,n),(r=s(this,e,[t,n.length,t.columns])).rowIndices=n,r}return u(e,t),g(e,[{key:"set",value:function(t,e,n){return this.matrix.set(this.rowIndices[t],e,n),this}},{key:"get",value:function(t,e){return this.matrix.get(this.rowIndices[t],e)}}])}(V),K=function(t){function e(t,n,r){var i;return p(this,e),A(t,n),T(t,r),(i=s(this,e,[t,n.length,r.length])).rowIndices=n,i.columnIndices=r,i}return u(e,t),g(e,[{key:"set",value:function(t,e,n){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],n),this}},{key:"get",value:function(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}])}(V),$=function(t){function e(t,n,r,i,a){var o;return p(this,e),P(t,n,r,i,a),(o=s(this,e,[t,r-n+1,a-i+1])).startRow=n,o.startColumn=i,o}return u(e,t),g(e,[{key:"set",value:function(t,e,n){return this.matrix.set(this.startRow+t,this.startColumn+e,n),this}},{key:"get",value:function(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}}])}(V),Z=function(t){function e(t){return p(this,e),s(this,e,[t,t.columns,t.rows])}return u(e,t),g(e,[{key:"set",value:function(t,e,n){return this.matrix.set(e,t,n),this}},{key:"get",value:function(t,e){return this.matrix.get(e,t)}}])}(V),Q=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};p(this,e);var i=r.rows,a=void 0===i?1:i;if(t.length%a!=0)throw new Error("the data length is not divisible by the number of rows");return(n=s(this,e)).rows=a,n.columns=t.length/a,n.data=t,n}return u(e,t),g(e,[{key:"set",value:function(t,e,n){var r=this._calculateIndex(t,e);return this.data[r]=n,this}},{key:"get",value:function(t,e){var n=this._calculateIndex(t,e);return this.data[n]}},{key:"_calculateIndex",value:function(t,e){return t*this.columns+e}}])}(D),J=function(t){function e(t){var n;return p(this,e),(n=s(this,e)).data=t,n.rows=t.length,n.columns=t[0].length,n}return u(e,t),g(e,[{key:"set",value:function(t,e,n){return this.data[t][e]=n,this}},{key:"get",value:function(t,e){return this.data[t][e]}}])}(D),tt=function(){return g((function t(e){p(this,t);var n,r,i,a,o,s,u,c,l,h=(e=J.checkMatrix(e)).clone(),d=h.rows,f=h.columns,v=new Float64Array(d),g=1;for(n=0;n<d;n++)v[n]=n;for(c=new Float64Array(d),r=0;r<f;r++){for(n=0;n<d;n++)c[n]=h.get(n,r);for(n=0;n<d;n++){for(l=Math.min(n,r),o=0,i=0;i<l;i++)o+=h.get(n,i)*c[i];c[n]-=o,h.set(n,r,c[n])}for(a=r,n=r+1;n<d;n++)Math.abs(c[n])>Math.abs(c[a])&&(a=n);if(a!==r){for(i=0;i<f;i++)s=h.get(a,i),h.set(a,i,h.get(r,i)),h.set(r,i,s);u=v[a],v[a]=v[r],v[r]=u,g=-g}if(r<d&&0!==h.get(r,r))for(n=r+1;n<d;n++)h.set(n,r,h.get(n,r)/h.get(r,r))}this.LU=h,this.pivotVector=v,this.pivotSign=g}),[{key:"isSingular",value:function(){for(var t=this.LU,e=t.columns,n=0;n<e;n++)if(0===t.get(n,n))return!0;return!1}},{key:"solve",value:function(t){t=j.checkMatrix(t);var e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,r,i,a=t.columns,o=t.subMatrixRow(this.pivotVector,0,a-1),s=e.columns;for(i=0;i<s;i++)for(n=i+1;n<s;n++)for(r=0;r<a;r++)o.set(n,r,o.get(n,r)-o.get(i,r)*e.get(n,i));for(i=s-1;i>=0;i--){for(r=0;r<a;r++)o.set(i,r,o.get(i,r)/e.get(i,i));for(n=0;n<i;n++)for(r=0;r<a;r++)o.set(n,r,o.get(n,r)-o.get(i,r)*e.get(n,i))}return o}},{key:"determinant",get:function(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var e=this.pivotSign,n=t.columns,r=0;r<n;r++)e*=t.get(r,r);return e}},{key:"lowerTriangularMatrix",get:function(){for(var t=this.LU,e=t.rows,n=t.columns,r=new j(e,n),i=0;i<e;i++)for(var a=0;a<n;a++)i>a?r.set(i,a,t.get(i,a)):i===a?r.set(i,a,1):r.set(i,a,0);return r}},{key:"upperTriangularMatrix",get:function(){for(var t=this.LU,e=t.rows,n=t.columns,r=new j(e,n),i=0;i<e;i++)for(var a=0;a<n;a++)i<=a?r.set(i,a,t.get(i,a)):r.set(i,a,0);return r}},{key:"pivotPermutationVector",get:function(){return Array.from(this.pivotVector)}}])}();function et(t,e){var n=0;return Math.abs(t)>Math.abs(e)?(n=e/t,Math.abs(t)*Math.sqrt(1+n*n)):0!==e?(n=t/e,Math.abs(e)*Math.sqrt(1+n*n)):0}var nt=function(){return g((function t(e){p(this,t);var n,r,i,a,o=(e=J.checkMatrix(e)).clone(),s=e.rows,u=e.columns,c=new Float64Array(u);for(i=0;i<u;i++){var l=0;for(n=i;n<s;n++)l=et(l,o.get(n,i));if(0!==l){for(o.get(i,i)<0&&(l=-l),n=i;n<s;n++)o.set(n,i,o.get(n,i)/l);for(o.set(i,i,o.get(i,i)+1),r=i+1;r<u;r++){for(a=0,n=i;n<s;n++)a+=o.get(n,i)*o.get(n,r);for(a=-a/o.get(i,i),n=i;n<s;n++)o.set(n,r,o.get(n,r)+a*o.get(n,i))}}c[i]=-l}this.QR=o,this.Rdiag=c}),[{key:"solve",value:function(t){t=j.checkMatrix(t);var e=this.QR,n=e.rows;if(t.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var r,i,a,o,s=t.columns,u=t.clone(),c=e.columns;for(a=0;a<c;a++)for(i=0;i<s;i++){for(o=0,r=a;r<n;r++)o+=e.get(r,a)*u.get(r,i);for(o=-o/e.get(a,a),r=a;r<n;r++)u.set(r,i,u.get(r,i)+o*e.get(r,a))}for(a=c-1;a>=0;a--){for(i=0;i<s;i++)u.set(a,i,u.get(a,i)/this.Rdiag[a]);for(r=0;r<a;r++)for(i=0;i<s;i++)u.set(r,i,u.get(r,i)-u.get(a,i)*e.get(r,a))}return u.subMatrix(0,c-1,0,s-1)}},{key:"isFullRank",value:function(){for(var t=this.QR.columns,e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}},{key:"upperTriangularMatrix",get:function(){var t,e,n=this.QR,r=n.columns,i=new j(r,r);for(t=0;t<r;t++)for(e=0;e<r;e++)t<e?i.set(t,e,n.get(t,e)):t===e?i.set(t,e,this.Rdiag[t]):i.set(t,e,0);return i}},{key:"orthogonalMatrix",get:function(){var t,e,n,r,i=this.QR,a=i.rows,o=i.columns,s=new j(a,o);for(n=o-1;n>=0;n--){for(t=0;t<a;t++)s.set(t,n,0);for(s.set(n,n,1),e=n;e<o;e++)if(0!==i.get(n,n)){for(r=0,t=n;t<a;t++)r+=i.get(t,n)*s.get(t,e);for(r=-r/i.get(n,n),t=n;t<a;t++)s.set(t,e,s.get(t,e)+r*i.get(t,n))}}return s}}])}(),rt=function(){return g((function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(p(this,t),(e=J.checkMatrix(e)).isEmpty())throw new Error("Matrix must be non-empty");var r,i=e.rows,a=e.columns,o=n.computeLeftSingularVectors,s=void 0===o||o,u=n.computeRightSingularVectors,c=void 0===u||u,l=n.autoTranspose,h=void 0!==l&&l,d=Boolean(s),f=Boolean(c),v=!1;if(i<a)if(h){i=(r=e.transpose()).rows,a=r.columns,v=!0;var g=d;d=f,f=g}else r=e.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else r=e.clone();for(var y=Math.min(i,a),m=Math.min(i+1,a),b=new Float64Array(m),x=new j(i,y),w=new j(a,a),E=new Float64Array(a),k=new Float64Array(i),M=new Float64Array(m),S=0;S<m;S++)M[S]=S;for(var O=Math.min(i-1,a),N=Math.max(0,Math.min(a-2,i)),A=Math.max(O,N),T=0;T<A;T++){if(T<O){b[T]=0;for(var P=T;P<i;P++)b[T]=et(b[T],r.get(P,T));if(0!==b[T]){r.get(T,T)<0&&(b[T]=-b[T]);for(var C=T;C<i;C++)r.set(C,T,r.get(C,T)/b[T]);r.set(T,T,r.get(T,T)+1)}b[T]=-b[T]}for(var R=T+1;R<a;R++){if(T<O&&0!==b[T]){for(var L=0,D=T;D<i;D++)L+=r.get(D,T)*r.get(D,R);L=-L/r.get(T,T);for(var _=T;_<i;_++)r.set(_,R,r.get(_,R)+L*r.get(_,T))}E[R]=r.get(T,R)}if(d&&T<O)for(var I=T;I<i;I++)x.set(I,T,r.get(I,T));if(T<N){E[T]=0;for(var F=T+1;F<a;F++)E[T]=et(E[T],E[F]);if(0!==E[T]){E[T+1]<0&&(E[T]=0-E[T]);for(var B=T+1;B<a;B++)E[B]/=E[T];E[T+1]+=1}if(E[T]=-E[T],T+1<i&&0!==E[T]){for(var z=T+1;z<i;z++)k[z]=0;for(var G=T+1;G<i;G++)for(var V=T+1;V<a;V++)k[G]+=E[V]*r.get(G,V);for(var W=T+1;W<a;W++)for(var H=-E[W]/E[T+1],Y=T+1;Y<i;Y++)r.set(Y,W,r.get(Y,W)+H*k[Y])}if(f)for(var U=T+1;U<a;U++)w.set(U,T,E[U])}}var q=Math.min(a,i+1);if(O<a&&(b[O]=r.get(O,O)),i<q&&(b[q-1]=0),N+1<q&&(E[N]=r.get(N,q-1)),E[q-1]=0,d){for(var X=O;X<y;X++){for(var K=0;K<i;K++)x.set(K,X,0);x.set(X,X,1)}for(var $=O-1;$>=0;$--)if(0!==b[$]){for(var Z=$+1;Z<y;Z++){for(var Q=0,tt=$;tt<i;tt++)Q+=x.get(tt,$)*x.get(tt,Z);Q=-Q/x.get($,$);for(var nt=$;nt<i;nt++)x.set(nt,Z,x.get(nt,Z)+Q*x.get(nt,$))}for(var rt=$;rt<i;rt++)x.set(rt,$,-x.get(rt,$));x.set($,$,1+x.get($,$));for(var it=0;it<$-1;it++)x.set(it,$,0)}else{for(var at=0;at<i;at++)x.set(at,$,0);x.set($,$,1)}}if(f)for(var ot=a-1;ot>=0;ot--){if(ot<N&&0!==E[ot])for(var st=ot+1;st<a;st++){for(var ut=0,ct=ot+1;ct<a;ct++)ut+=w.get(ct,ot)*w.get(ct,st);ut=-ut/w.get(ot+1,ot);for(var lt=ot+1;lt<a;lt++)w.set(lt,st,w.get(lt,st)+ut*w.get(lt,ot))}for(var ht=0;ht<a;ht++)w.set(ht,ot,0);w.set(ot,ot,1)}for(var dt=q-1,ft=Number.EPSILON;q>0;){var vt=void 0,pt=void 0;for(vt=q-2;vt>=-1&&-1!==vt;vt--){var gt=Number.MIN_VALUE+ft*Math.abs(b[vt]+Math.abs(b[vt+1]));if(Math.abs(E[vt])<=gt||Number.isNaN(E[vt])){E[vt]=0;break}}if(vt===q-2)pt=4;else{var yt=void 0;for(yt=q-1;yt>=vt&&yt!==vt;yt--){var mt=(yt!==q?Math.abs(E[yt]):0)+(yt!==vt+1?Math.abs(E[yt-1]):0);if(Math.abs(b[yt])<=ft*mt){b[yt]=0;break}}yt===vt?pt=3:yt===q-1?pt=1:(pt=2,vt=yt)}switch(vt++,pt){case 1:var bt=E[q-2];E[q-2]=0;for(var xt=q-2;xt>=vt;xt--){var wt=et(b[xt],bt),Et=b[xt]/wt,kt=bt/wt;if(b[xt]=wt,xt!==vt&&(bt=-kt*E[xt-1],E[xt-1]=Et*E[xt-1]),f)for(var Mt=0;Mt<a;Mt++)wt=Et*w.get(Mt,xt)+kt*w.get(Mt,q-1),w.set(Mt,q-1,-kt*w.get(Mt,xt)+Et*w.get(Mt,q-1)),w.set(Mt,xt,wt)}break;case 2:var St=E[vt-1];E[vt-1]=0;for(var Ot=vt;Ot<q;Ot++){var Nt=et(b[Ot],St),At=b[Ot]/Nt,Tt=St/Nt;if(b[Ot]=Nt,St=-Tt*E[Ot],E[Ot]=At*E[Ot],d)for(var Pt=0;Pt<i;Pt++)Nt=At*x.get(Pt,Ot)+Tt*x.get(Pt,vt-1),x.set(Pt,vt-1,-Tt*x.get(Pt,Ot)+At*x.get(Pt,vt-1)),x.set(Pt,Ot,Nt)}break;case 3:var Ct=Math.max(Math.abs(b[q-1]),Math.abs(b[q-2]),Math.abs(E[q-2]),Math.abs(b[vt]),Math.abs(E[vt])),Rt=b[q-1]/Ct,Lt=b[q-2]/Ct,Dt=E[q-2]/Ct,_t=b[vt]/Ct,It=E[vt]/Ct,jt=((Lt+Rt)*(Lt-Rt)+Dt*Dt)/2,Ft=Rt*Dt*(Rt*Dt),Bt=0;0===jt&&0===Ft||(Bt=Ft/(jt+(Bt=jt<0?0-Math.sqrt(jt*jt+Ft):Math.sqrt(jt*jt+Ft))));for(var zt=(_t+Rt)*(_t-Rt)+Bt,Gt=_t*It,Vt=vt;Vt<q-1;Vt++){var Wt=et(zt,Gt);0===Wt&&(Wt=Number.MIN_VALUE);var Ht=zt/Wt,Yt=Gt/Wt;if(Vt!==vt&&(E[Vt-1]=Wt),zt=Ht*b[Vt]+Yt*E[Vt],E[Vt]=Ht*E[Vt]-Yt*b[Vt],Gt=Yt*b[Vt+1],b[Vt+1]=Ht*b[Vt+1],f)for(var Ut=0;Ut<a;Ut++)Wt=Ht*w.get(Ut,Vt)+Yt*w.get(Ut,Vt+1),w.set(Ut,Vt+1,-Yt*w.get(Ut,Vt)+Ht*w.get(Ut,Vt+1)),w.set(Ut,Vt,Wt);if(0===(Wt=et(zt,Gt))&&(Wt=Number.MIN_VALUE),Ht=zt/Wt,Yt=Gt/Wt,b[Vt]=Wt,zt=Ht*E[Vt]+Yt*b[Vt+1],b[Vt+1]=-Yt*E[Vt]+Ht*b[Vt+1],Gt=Yt*E[Vt+1],E[Vt+1]=Ht*E[Vt+1],d&&Vt<i-1)for(var qt=0;qt<i;qt++)Wt=Ht*x.get(qt,Vt)+Yt*x.get(qt,Vt+1),x.set(qt,Vt+1,-Yt*x.get(qt,Vt)+Ht*x.get(qt,Vt+1)),x.set(qt,Vt,Wt)}E[q-2]=zt;break;case 4:if(b[vt]<=0&&(b[vt]=b[vt]<0?-b[vt]:0,f))for(var Xt=0;Xt<=dt;Xt++)w.set(Xt,vt,-w.get(Xt,vt));for(;vt<dt&&!(b[vt]>=b[vt+1]);){var Kt=b[vt];if(b[vt]=b[vt+1],b[vt+1]=Kt,f&&vt<a-1)for(var $t=0;$t<a;$t++)Kt=w.get($t,vt+1),w.set($t,vt+1,w.get($t,vt)),w.set($t,vt,Kt);if(d&&vt<i-1)for(var Zt=0;Zt<i;Zt++)Kt=x.get(Zt,vt+1),x.set(Zt,vt+1,x.get(Zt,vt)),x.set(Zt,vt,Kt);vt++}q--}}if(v){var Qt=w;w=x,x=Qt}this.m=i,this.n=a,this.s=b,this.U=x,this.V=w}),[{key:"solve",value:function(t){for(var e=t,n=this.threshold,r=this.s.length,i=j.zeros(r,r),a=0;a<r;a++)Math.abs(this.s[a])<=n?i.set(a,a,0):i.set(a,a,1/this.s[a]);for(var o=this.U,s=this.rightSingularVectors,u=s.mmul(i),c=s.rows,l=o.rows,h=j.zeros(c,l),d=0;d<c;d++)for(var f=0;f<l;f++){for(var v=0,p=0;p<r;p++)v+=u.get(d,p)*o.get(f,p);h.set(d,f,v)}return h.mmul(e)}},{key:"solveForDiagonal",value:function(t){return this.solve(j.diag(t))}},{key:"inverse",value:function(){for(var t=this.V,e=this.threshold,n=t.rows,r=t.columns,i=new j(n,this.s.length),a=0;a<n;a++)for(var o=0;o<r;o++)Math.abs(this.s[o])>e&&i.set(a,o,t.get(a,o)/this.s[o]);for(var s=this.U,u=s.rows,c=s.columns,l=new j(n,u),h=0;h<n;h++)for(var d=0;d<u;d++){for(var f=0,v=0;v<c;v++)f+=i.get(h,v)*s.get(d,v);l.set(h,d,f)}return l}},{key:"condition",get:function(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}},{key:"norm2",get:function(){return this.s[0]}},{key:"rank",get:function(){for(var t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,n=this.s,r=0,i=n.length;r<i;r++)n[r]>t&&e++;return e}},{key:"diagonal",get:function(){return Array.from(this.s)}},{key:"threshold",get:function(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}},{key:"leftSingularVectors",get:function(){return this.U}},{key:"rightSingularVectors",get:function(){return this.V}},{key:"diagonalMatrix",get:function(){return j.diag(this.s)}}])}();function it(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t=J.checkMatrix(t),e=J.checkMatrix(e),n?new rt(t).solve(e):t.isSquare()?new tt(t).solve(e):new nt(t).solve(e)}function at(t,e){for(var n=[],r=0;r<t;r++)r!==e&&n.push(r);return n}function ot(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-9;if(t>(arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e-9))return new Array(e.rows+1).fill(0);for(var i=e.addRow(n,[0]),a=0;a<i.rows;a++)Math.abs(i.get(a,0))<r&&i.set(a,0,0);return i.to1DArray()}var st=function(){return g((function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};p(this,t);var r=n.assumeSymmetric,i=void 0!==r&&r;if(!(e=J.checkMatrix(e)).isSquare())throw new Error("Matrix is not a square matrix");if(e.isEmpty())throw new Error("Matrix must be non-empty");var a,o,s=e.columns,u=new j(s,s),c=new Float64Array(s),l=new Float64Array(s),h=e;if(i||e.isSymmetric()){for(a=0;a<s;a++)for(o=0;o<s;o++)u.set(a,o,h.get(a,o));!function(t,e,n,r){var i,a,o,s,u,c,l,h;for(u=0;u<t;u++)n[u]=r.get(t-1,u);for(s=t-1;s>0;s--){for(h=0,o=0,c=0;c<s;c++)h+=Math.abs(n[c]);if(0===h)for(e[s]=n[s-1],u=0;u<s;u++)n[u]=r.get(s-1,u),r.set(s,u,0),r.set(u,s,0);else{for(c=0;c<s;c++)n[c]/=h,o+=n[c]*n[c];for(i=n[s-1],a=Math.sqrt(o),i>0&&(a=-a),e[s]=h*a,o-=i*a,n[s-1]=i-a,u=0;u<s;u++)e[u]=0;for(u=0;u<s;u++){for(i=n[u],r.set(u,s,i),a=e[u]+r.get(u,u)*i,c=u+1;c<=s-1;c++)a+=r.get(c,u)*n[c],e[c]+=r.get(c,u)*i;e[u]=a}for(i=0,u=0;u<s;u++)e[u]/=o,i+=e[u]*n[u];for(l=i/(o+o),u=0;u<s;u++)e[u]-=l*n[u];for(u=0;u<s;u++){for(i=n[u],a=e[u],c=u;c<=s-1;c++)r.set(c,u,r.get(c,u)-(i*e[c]+a*n[c]));n[u]=r.get(s-1,u),r.set(s,u,0)}}n[s]=o}for(s=0;s<t-1;s++){if(r.set(t-1,s,r.get(s,s)),r.set(s,s,1),0!==(o=n[s+1])){for(c=0;c<=s;c++)n[c]=r.get(c,s+1)/o;for(u=0;u<=s;u++){for(a=0,c=0;c<=s;c++)a+=r.get(c,s+1)*r.get(c,u);for(c=0;c<=s;c++)r.set(c,u,r.get(c,u)-a*n[c])}}for(c=0;c<=s;c++)r.set(c,s+1,0)}for(u=0;u<t;u++)n[u]=r.get(t-1,u),r.set(t-1,u,0);r.set(t-1,t-1,1),e[0]=0}(s,l,c,u),function(t,e,n,r){var i,a,o,s,u,c,l,h,d,f,v,p,g,y,m,b;for(o=1;o<t;o++)e[o-1]=e[o];e[t-1]=0;var x=0,w=0,E=Number.EPSILON;for(c=0;c<t;c++){for(w=Math.max(w,Math.abs(n[c])+Math.abs(e[c])),l=c;l<t&&!(Math.abs(e[l])<=E*w);)l++;if(l>c)do{for(i=n[c],d=et(h=(n[c+1]-i)/(2*e[c]),1),h<0&&(d=-d),n[c]=e[c]/(h+d),n[c+1]=e[c]*(h+d),f=n[c+1],a=i-n[c],o=c+2;o<t;o++)n[o]-=a;for(x+=a,h=n[l],p=v=1,g=v,y=e[c+1],m=0,b=0,o=l-1;o>=c;o--)for(g=p,p=v,b=m,i=v*e[o],a=v*h,d=et(h,e[o]),e[o+1]=m*d,m=e[o]/d,h=(v=h/d)*n[o]-m*i,n[o+1]=a+m*(v*i+m*n[o]),u=0;u<t;u++)a=r.get(u,o+1),r.set(u,o+1,m*r.get(u,o)+v*a),r.set(u,o,v*r.get(u,o)-m*a);h=-m*b*g*y*e[c]/f,e[c]=m*h,n[c]=v*h}while(Math.abs(e[c])>E*w);n[c]=n[c]+x,e[c]=0}for(o=0;o<t-1;o++){for(u=o,h=n[o],s=o+1;s<t;s++)n[s]<h&&(u=s,h=n[s]);if(u!==o)for(n[u]=n[o],n[o]=h,s=0;s<t;s++)h=r.get(s,o),r.set(s,o,r.get(s,u)),r.set(s,u,h)}}(s,l,c,u)}else{var d=new j(s,s),f=new Float64Array(s);for(o=0;o<s;o++)for(a=0;a<s;a++)d.set(a,o,h.get(a,o));!function(t,e,n,r){var i,a,o,s,u,c,l,h=t-1;for(c=1;c<=h-1;c++){for(l=0,s=c;s<=h;s++)l+=Math.abs(e.get(s,c-1));if(0!==l){for(o=0,s=h;s>=c;s--)n[s]=e.get(s,c-1)/l,o+=n[s]*n[s];for(a=Math.sqrt(o),n[c]>0&&(a=-a),o-=n[c]*a,n[c]=n[c]-a,u=c;u<t;u++){for(i=0,s=h;s>=c;s--)i+=n[s]*e.get(s,u);for(i/=o,s=c;s<=h;s++)e.set(s,u,e.get(s,u)-i*n[s])}for(s=0;s<=h;s++){for(i=0,u=h;u>=c;u--)i+=n[u]*e.get(s,u);for(i/=o,u=c;u<=h;u++)e.set(s,u,e.get(s,u)-i*n[u])}n[c]=l*n[c],e.set(c,c-1,l*a)}}for(s=0;s<t;s++)for(u=0;u<t;u++)r.set(s,u,s===u?1:0);for(c=h-1;c>=1;c--)if(0!==e.get(c,c-1)){for(s=c+1;s<=h;s++)n[s]=e.get(s,c-1);for(u=c;u<=h;u++){for(a=0,s=c;s<=h;s++)a+=n[s]*r.get(s,u);for(a=a/n[c]/e.get(c,c-1),s=c;s<=h;s++)r.set(s,u,r.get(s,u)+a*n[s])}}}(s,d,f,u),function(t,e,n,r,i){var a,o,s,u,c,l,h,d,f,v,p,g,y,m,b,x=t-1,w=t-1,E=Number.EPSILON,k=0,M=0,S=0,O=0,N=0,A=0,T=0,P=0;for(a=0;a<t;a++)for((a<0||a>w)&&(n[a]=i.get(a,a),e[a]=0),o=Math.max(a-1,0);o<t;o++)M+=Math.abs(i.get(a,o));for(;x>=0;){for(u=x;u>0&&(0===(A=Math.abs(i.get(u-1,u-1))+Math.abs(i.get(u,u)))&&(A=M),!(Math.abs(i.get(u,u-1))<E*A));)u--;if(u===x)i.set(x,x,i.get(x,x)+k),n[x]=i.get(x,x),e[x]=0,x--,P=0;else if(u===x-1){if(h=i.get(x,x-1)*i.get(x-1,x),O=(S=(i.get(x-1,x-1)-i.get(x,x))/2)*S+h,T=Math.sqrt(Math.abs(O)),i.set(x,x,i.get(x,x)+k),i.set(x-1,x-1,i.get(x-1,x-1)+k),d=i.get(x,x),O>=0){for(T=S>=0?S+T:S-T,n[x-1]=d+T,n[x]=n[x-1],0!==T&&(n[x]=d-h/T),e[x-1]=0,e[x]=0,S=(d=i.get(x,x-1))/(A=Math.abs(d)+Math.abs(T)),O=T/A,S/=N=Math.sqrt(S*S+O*O),O/=N,o=x-1;o<t;o++)T=i.get(x-1,o),i.set(x-1,o,O*T+S*i.get(x,o)),i.set(x,o,O*i.get(x,o)-S*T);for(a=0;a<=x;a++)T=i.get(a,x-1),i.set(a,x-1,O*T+S*i.get(a,x)),i.set(a,x,O*i.get(a,x)-S*T);for(a=0;a<=w;a++)T=r.get(a,x-1),r.set(a,x-1,O*T+S*r.get(a,x)),r.set(a,x,O*r.get(a,x)-S*T)}else n[x-1]=d+S,n[x]=d+S,e[x-1]=T,e[x]=-T;x-=2,P=0}else{if(d=i.get(x,x),f=0,h=0,u<x&&(f=i.get(x-1,x-1),h=i.get(x,x-1)*i.get(x-1,x)),10===P){for(k+=d,a=0;a<=x;a++)i.set(a,a,i.get(a,a)-d);d=f=.75*(A=Math.abs(i.get(x,x-1))+Math.abs(i.get(x-1,x-2))),h=-.4375*A*A}if(30===P&&(A=(A=(f-d)/2)*A+h)>0){for(A=Math.sqrt(A),f<d&&(A=-A),A=d-h/((f-d)/2+A),a=0;a<=x;a++)i.set(a,a,i.get(a,a)-A);k+=A,d=f=h=.964}for(P+=1,c=x-2;c>=u&&(S=((N=d-(T=i.get(c,c)))*(A=f-T)-h)/i.get(c+1,c)+i.get(c,c+1),O=i.get(c+1,c+1)-T-N-A,N=i.get(c+2,c+1),S/=A=Math.abs(S)+Math.abs(O)+Math.abs(N),O/=A,N/=A,c!==u)&&!(Math.abs(i.get(c,c-1))*(Math.abs(O)+Math.abs(N))<E*(Math.abs(S)*(Math.abs(i.get(c-1,c-1))+Math.abs(T)+Math.abs(i.get(c+1,c+1)))));)c--;for(a=c+2;a<=x;a++)i.set(a,a-2,0),a>c+2&&i.set(a,a-3,0);for(s=c;s<=x-1&&(m=s!==x-1,s!==c&&(S=i.get(s,s-1),O=i.get(s+1,s-1),N=m?i.get(s+2,s-1):0,0!==(d=Math.abs(S)+Math.abs(O)+Math.abs(N))&&(S/=d,O/=d,N/=d)),0!==d);s++)if(A=Math.sqrt(S*S+O*O+N*N),S<0&&(A=-A),0!==A){for(s!==c?i.set(s,s-1,-A*d):u!==c&&i.set(s,s-1,-i.get(s,s-1)),d=(S+=A)/A,f=O/A,T=N/A,O/=S,N/=S,o=s;o<t;o++)S=i.get(s,o)+O*i.get(s+1,o),m&&(S+=N*i.get(s+2,o),i.set(s+2,o,i.get(s+2,o)-S*T)),i.set(s,o,i.get(s,o)-S*d),i.set(s+1,o,i.get(s+1,o)-S*f);for(a=0;a<=Math.min(x,s+3);a++)S=d*i.get(a,s)+f*i.get(a,s+1),m&&(S+=T*i.get(a,s+2),i.set(a,s+2,i.get(a,s+2)-S*N)),i.set(a,s,i.get(a,s)-S),i.set(a,s+1,i.get(a,s+1)-S*O);for(a=0;a<=w;a++)S=d*r.get(a,s)+f*r.get(a,s+1),m&&(S+=T*r.get(a,s+2),r.set(a,s+2,r.get(a,s+2)-S*N)),r.set(a,s,r.get(a,s)-S),r.set(a,s+1,r.get(a,s+1)-S*O)}}}if(0!==M){for(x=t-1;x>=0;x--)if(S=n[x],0===(O=e[x]))for(u=x,i.set(x,x,1),a=x-1;a>=0;a--){for(h=i.get(a,a)-S,N=0,o=u;o<=x;o++)N+=i.get(a,o)*i.get(o,x);if(e[a]<0)T=h,A=N;else if(u=a,0===e[a]?i.set(a,x,0!==h?-N/h:-N/(E*M)):(d=i.get(a,a+1),f=i.get(a+1,a),l=(d*A-T*N)/(O=(n[a]-S)*(n[a]-S)+e[a]*e[a]),i.set(a,x,l),i.set(a+1,x,Math.abs(d)>Math.abs(T)?(-N-h*l)/d:(-A-f*l)/T)),E*(l=Math.abs(i.get(a,x)))*l>1)for(o=a;o<=x;o++)i.set(o,x,i.get(o,x)/l)}else if(O<0)for(u=x-1,Math.abs(i.get(x,x-1))>Math.abs(i.get(x-1,x))?(i.set(x-1,x-1,O/i.get(x,x-1)),i.set(x-1,x,-(i.get(x,x)-S)/i.get(x,x-1))):(b=ut(0,-i.get(x-1,x),i.get(x-1,x-1)-S,O),i.set(x-1,x-1,b[0]),i.set(x-1,x,b[1])),i.set(x,x-1,0),i.set(x,x,1),a=x-2;a>=0;a--){for(v=0,p=0,o=u;o<=x;o++)v+=i.get(a,o)*i.get(o,x-1),p+=i.get(a,o)*i.get(o,x);if(h=i.get(a,a)-S,e[a]<0)T=h,N=v,A=p;else if(u=a,0===e[a]?(b=ut(-v,-p,h,O),i.set(a,x-1,b[0]),i.set(a,x,b[1])):(d=i.get(a,a+1),f=i.get(a+1,a),g=(n[a]-S)*(n[a]-S)+e[a]*e[a]-O*O,y=2*(n[a]-S)*O,0===g&&0===y&&(g=E*M*(Math.abs(h)+Math.abs(O)+Math.abs(d)+Math.abs(f)+Math.abs(T))),b=ut(d*N-T*v+O*p,d*A-T*p-O*v,g,y),i.set(a,x-1,b[0]),i.set(a,x,b[1]),Math.abs(d)>Math.abs(T)+Math.abs(O)?(i.set(a+1,x-1,(-v-h*i.get(a,x-1)+O*i.get(a,x))/d),i.set(a+1,x,(-p-h*i.get(a,x)-O*i.get(a,x-1))/d)):(b=ut(-N-f*i.get(a,x-1),-A-f*i.get(a,x),T,O),i.set(a+1,x-1,b[0]),i.set(a+1,x,b[1]))),E*(l=Math.max(Math.abs(i.get(a,x-1)),Math.abs(i.get(a,x))))*l>1)for(o=a;o<=x;o++)i.set(o,x-1,i.get(o,x-1)/l),i.set(o,x,i.get(o,x)/l)}for(a=0;a<t;a++)if(a<0||a>w)for(o=a;o<t;o++)r.set(a,o,i.get(a,o));for(o=t-1;o>=0;o--)for(a=0;a<=w;a++){for(T=0,s=0;s<=Math.min(o,w);s++)T+=r.get(a,s)*i.get(s,o);r.set(a,o,T)}}}(s,l,c,u,d)}this.n=s,this.e=l,this.d=c,this.V=u}),[{key:"realEigenvalues",get:function(){return Array.from(this.d)}},{key:"imaginaryEigenvalues",get:function(){return Array.from(this.e)}},{key:"eigenvectorMatrix",get:function(){return this.V}},{key:"diagonalMatrix",get:function(){var t,e,n=this.n,r=this.e,i=this.d,a=new j(n,n);for(t=0;t<n;t++){for(e=0;e<n;e++)a.set(t,e,0);a.set(t,t,i[t]),r[t]>0?a.set(t,t+1,r[t]):r[t]<0&&a.set(t,t-1,r[t])}return a}}])}();function ut(t,e,n,r){var i,a;return Math.abs(n)>Math.abs(r)?[(t+(i=r/n)*e)/(a=n+i*r),(e-i*t)/a]:[((i=n/r)*t+e)/(a=r+i*n),(i*e-t)/a]}var ct=function(){return g((function t(e){if(p(this,t),!(e=J.checkMatrix(e)).isSymmetric())throw new Error("Matrix is not symmetric");var n,r,i,a=e,o=a.rows,s=new j(o,o),u=!0;for(r=0;r<o;r++){var c=0;for(i=0;i<r;i++){var l=0;for(n=0;n<i;n++)l+=s.get(i,n)*s.get(r,n);l=(a.get(r,i)-l)/s.get(i,i),s.set(r,i,l),c+=l*l}for(c=a.get(r,r)-c,u&&(u=c>0),s.set(r,r,Math.sqrt(Math.max(c,0))),i=r+1;i<o;i++)s.set(r,i,0)}this.L=s,this.positiveDefinite=u}),[{key:"isPositiveDefinite",value:function(){return this.positiveDefinite}},{key:"solve",value:function(t){t=J.checkMatrix(t);var e=this.L,n=e.rows;if(t.rows!==n)throw new Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw new Error("Matrix is not positive definite");var r,i,a,o=t.columns,s=t.clone();for(a=0;a<n;a++)for(i=0;i<o;i++){for(r=0;r<a;r++)s.set(a,i,s.get(a,i)-s.get(r,i)*e.get(a,r));s.set(a,i,s.get(a,i)/e.get(a,a))}for(a=n-1;a>=0;a--)for(i=0;i<o;i++){for(r=a+1;r<n;r++)s.set(a,i,s.get(a,i)-s.get(r,i)*e.get(r,a));s.set(a,i,s.get(a,i)/e.get(a,a))}return s}},{key:"lowerTriangularMatrix",get:function(){return this.L}}])}(),lt=g((function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};p(this,t),e=J.checkMatrix(e);var r,i=n.Y,a=n.scaleScores,o=void 0!==a&&a,s=n.maxIterations,u=void 0===s?1e3:s,c=n.terminationCriteria,l=void 0===c?1e-10:c;if(i){if((i=y.isAnyArray(i)&&"number"==typeof i[0]?j.columnVector(i):J.checkMatrix(i)).rows!==e.rows)throw new Error("Y should have the same number of rows as X");r=i.getColumnVector(0)}else r=e.getColumnVector(0);for(var h,d,f,v,g=1,m=0;m<u&&g>l;m++)f=(f=e.transpose().mmul(r).div(r.transpose().mmul(r).get(0,0))).div(f.norm()),h=e.mmul(f).div(f.transpose().mmul(f).get(0,0)),m>0&&(g=h.clone().sub(v).pow(2).sum()),v=h.clone(),i?(d=(d=i.transpose().mmul(h).div(h.transpose().mmul(h).get(0,0))).div(d.norm()),r=i.mmul(d).div(d.transpose().mmul(d).get(0,0))):r=h;if(i){var b=e.transpose().mmul(h).div(h.transpose().mmul(h).get(0,0));b=b.div(b.norm());var x=e.clone().sub(h.clone().mmul(b.transpose())),w=r.transpose().mmul(h).div(h.transpose().mmul(h).get(0,0)),E=i.clone().sub(h.clone().mulS(w.get(0,0)).mmul(d.transpose()));this.t=h,this.p=b.transpose(),this.w=f.transpose(),this.q=d,this.u=r,this.s=h.transpose().mmul(h),this.xResidual=x,this.yResidual=E,this.betas=w}else this.w=f.transpose(),this.s=h.transpose().mmul(h).sqrt(),this.t=o?h.clone().div(this.s.get(0,0)):h,this.xResidual=e.sub(h.mmul(f.transpose()))}));e.y3=D,e.jy=ct,e.oN=ct,e.Hc=G,e.cg=st,e.hj=st,e.LU=tt,e.Tb=tt,e.uq=j,e.Zm=H,e.Dq=W,e.__=Y,e.q0=U,e.lh=X,e.pI=q,e.zC=K,e.zg=$,e.g6=Z,e.OL=lt,e.ks=lt,e.QR=nt,e.jp=nt,e.mk=rt,e.W2=rt,e.l=z,e.KY=Q,e.dv=J,e.BR=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=new j(t);var r=!1;if("object"!=typeof e||j.isMatrix(e)||y.isAnyArray(e)?e=new j(e):(n=e,e=t,r=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");var i=n,a=i.center,o=void 0===a||a,s=i.scale,u=void 0===s||s;o&&(t.center("column"),r||e.center("column")),u&&(t.scale("column"),r||e.scale("column"));for(var c=t.standardDeviation("column",{unbiased:!0}),l=r?c:e.standardDeviation("column",{unbiased:!0}),h=t.transpose().mmul(e),d=0;d<h.rows;d++)for(var f=0;f<h.columns;f++)h.set(d,f,h.get(d,f)*(1/(c[d]*l[f]))*(1/(t.rows-1)));return h},e.Wu=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=new j(t);var r=!1;if("object"!=typeof e||j.isMatrix(e)||y.isAnyArray(e)?e=new j(e):(n=e,e=t,r=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");var i=n.center;(void 0===i||i)&&(t=t.center("column"),r||(e=e.center("column")));for(var a=t.transpose().mmul(e),o=0;o<a.rows;o++)for(var s=0;s<a.columns;s++)a.set(o,s,a.get(o,s)*(1/(t.rows-1)));return a},e.a4=function t(e){var n,r,i,a,o,s;if((e=j.checkMatrix(e)).isSquare())return 0===e.columns?1:2===e.columns?(n=e.get(0,0),r=e.get(0,1),i=e.get(1,0),n*e.get(1,1)-r*i):3===e.columns?(a=new K(e,[1,2],[1,2]),o=new K(e,[1,2],[0,2]),s=new K(e,[1,2],[0,1]),n=e.get(0,0),r=e.get(0,1),i=e.get(0,2),n*t(a)-r*t(o)+i*t(s)):new tt(e).determinant;throw Error("determinant can only be calculated for a square matrix")},e.DI=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t=J.checkMatrix(t),e?new rt(t).inverse():it(t,j.eye(t.rows))},e.Jo=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.thresholdValue,r=void 0===n?1e-9:n,i=e.thresholdError,a=void 0===i?1e-9:i,o=(t=j.checkMatrix(t)).rows,s=new j(o,o),u=0;u<o;u++){var c=j.columnVector(t.getRow(u)),l=t.subMatrixRow(at(o,u)).transpose(),h=new rt(l).solve(c),d=j.sub(c,l.mmul(h)).abs().max();s.setRow(u,ot(d,h,u,r,a))}return s},e.Zi=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.EPSILON;if((t=j.checkMatrix(t)).isEmpty())return t.transpose();for(var n=new rt(t,{autoTranspose:!0}),r=n.leftSingularVectors,i=n.rightSingularVectors,a=n.diagonal,o=0;o<a.length;o++)Math.abs(a[o])>e?a[o]=1/a[o]:a[o]=0;return i.mmul(j.diag(a).mmul(r.transpose()))},e.kH=it,e.LV=function(t,e){if(y.isAnyArray(t))return t[0]&&y.isAnyArray(t[0])?new J(t):new Q(t,e);throw new Error("the argument is not an array")}},6278:t=>{t.exports=function(t,e,n,r){var i=n?n.call(r,t,e):void 0;if(void 0!==i)return!!i;if(t===e)return!0;if("object"!=typeof t||!t||"object"!=typeof e||!e)return!1;var a=Object.keys(t),o=Object.keys(e);if(a.length!==o.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(e),u=0;u<a.length;u++){var c=a[u];if(!s(c))return!1;var l=t[c],h=e[c];if(!1===(i=n?n.call(r,l,h,c):void 0)||void 0===i&&l!==h)return!1}return!0}},7450:(t,e,n)=>{"use strict";var r=n(9587),i=Array.prototype.concat,a=Array.prototype.slice,o=t.exports=function(t){for(var e=[],n=0,o=t.length;n<o;n++){var s=t[n];r(s)?e=i.call(e,a.call(s)):e.push(s)}return e};o.wrap=function(t){return function(){return t(o(arguments))}}},5442:t=>{"use strict";t.exports=n},6003:e=>{"use strict";e.exports=t},9276:t=>{"use strict";t.exports=e},7173:t=>{t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r},t.exports.__esModule=!0,t.exports.default=t.exports},5589:t=>{t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports},3030:t=>{t.exports=function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")},t.exports.__esModule=!0,t.exports.default=t.exports},1709:t=>{t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.__esModule=!0,t.exports.default=t.exports},1046:(t,e,n)=>{var r=n(2814),i=n(7996),a=n(9314);t.exports=function(t,e,n){return e=r(e),a(t,i()?Reflect.construct(e,n||[],r(t).constructor):e.apply(t,n))},t.exports.__esModule=!0,t.exports.default=t.exports},111:t=>{t.exports=function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")},t.exports.__esModule=!0,t.exports.default=t.exports},1201:t=>{t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},6374:(t,e,n)=>{var r=n(3030);t.exports=function(t,e){return t.get(r(t,e))},t.exports.__esModule=!0,t.exports.default=t.exports},585:(t,e,n)=>{var r=n(111);t.exports=function(t,e,n){r(t,e),e.set(t,n)},t.exports.__esModule=!0,t.exports.default=t.exports},4258:(t,e,n)=>{var r=n(3030);t.exports=function(t,e,n){return t.set(r(t,e),n),n},t.exports.__esModule=!0,t.exports.default=t.exports},1386:(t,e,n)=>{var r=n(111);t.exports=function(t,e){r(t,e),e.add(t)},t.exports.__esModule=!0,t.exports.default=t.exports},6585:(t,e,n)=>{var r=n(6726);function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,r(i.key),i)}}t.exports=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports},385:(t,e,n)=>{var r=n(1164);t.exports=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=r(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){u=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}},t.exports.__esModule=!0,t.exports.default=t.exports},9599:(t,e,n)=>{var r=n(6726);t.exports=function(t,e,n){return(e=r(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},t.exports.__esModule=!0,t.exports.default=t.exports},4345:(t,e,n)=>{var r=n(6762);function i(){return t.exports=i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=r(t,e);if(i){var a=Object.getOwnPropertyDescriptor(i,e);return a.get?a.get.call(arguments.length<3?t:n):a.value}},t.exports.__esModule=!0,t.exports.default=t.exports,i.apply(null,arguments)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},2814:t=>{function e(n){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},1105:(t,e,n)=>{var r=n(9682);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&r(t,e)},t.exports.__esModule=!0,t.exports.default=t.exports},7996:t=>{function e(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(n){}return(t.exports=e=function(){return!!n},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},4574:t=>{t.exports=function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,c=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==e);u=!0);}catch(t){c=!0,i=t}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw i}}return s}},t.exports.__esModule=!0,t.exports.default=t.exports},8590:t=>{t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},9314:(t,e,n)=>{var r=n(3752).default,i=n(1709);t.exports=function(t,e){if(e&&("object"==r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return i(t)},t.exports.__esModule=!0,t.exports.default=t.exports},29:t=>{t.exports=function(t){throw new TypeError('"'+t+'" is read-only')},t.exports.__esModule=!0,t.exports.default=t.exports},5551:(t,e,n)=>{var r=n(3752).default;function i(){"use strict";t.exports=i=function(){return n},t.exports.__esModule=!0,t.exports.default=t.exports;var e,n={},a=Object.prototype,o=a.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},u="function"==typeof Symbol?Symbol:{},c=u.iterator||"@@iterator",l=u.asyncIterator||"@@asyncIterator",h=u.toStringTag||"@@toStringTag";function d(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{d({},"")}catch(e){d=function(t,e,n){return t[e]=n}}function f(t,e,n,r){var i=e&&e.prototype instanceof x?e:x,a=Object.create(i.prototype),o=new L(r||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function v(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}n.wrap=f;var p="suspendedStart",g="suspendedYield",y="executing",m="completed",b={};function x(){}function w(){}function E(){}var k={};d(k,c,(function(){return this}));var M=Object.getPrototypeOf,S=M&&M(M(D([])));S&&S!==a&&o.call(S,c)&&(k=S);var O=E.prototype=x.prototype=Object.create(k);function N(t){["next","throw","return"].forEach((function(e){d(t,e,(function(t){return this._invoke(e,t)}))}))}function A(t,e){function n(i,a,s,u){var c=v(t[i],t,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==r(h)&&o.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,u)}),(function(t){n("throw",t,s,u)})):e.resolve(h).then((function(t){l.value=t,s(l)}),(function(t){return n("throw",t,s,u)}))}u(c.arg)}var i;s(this,"_invoke",{value:function(t,r){function a(){return new e((function(e,i){n(t,r,e,i)}))}return i=i?i.then(a,a):a()}})}function T(t,n,r){var i=p;return function(a,o){if(i===y)throw Error("Generator is already running");if(i===m){if("throw"===a)throw o;return{value:e,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var u=P(s,r);if(u){if(u===b)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===p)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=y;var c=v(t,n,r);if("normal"===c.type){if(i=r.done?m:g,c.arg===b)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=m,r.method="throw",r.arg=c.arg)}}}function P(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,P(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),b;var a=v(i,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,b;var o=a.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,b):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,b)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function D(t){if(t||""===t){var n=t[c];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(o.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(r(t)+" is not iterable")}return w.prototype=E,s(O,"constructor",{value:E,configurable:!0}),s(E,"constructor",{value:w,configurable:!0}),w.displayName=d(E,h,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,E):(t.__proto__=E,d(t,h,"GeneratorFunction")),t.prototype=Object.create(O),t},n.awrap=function(t){return{__await:t}},N(A.prototype),d(A.prototype,l,(function(){return this})),n.AsyncIterator=A,n.async=function(t,e,r,i,a){void 0===a&&(a=Promise);var o=new A(f(t,e,r,i),a);return n.isGeneratorFunction(e)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},N(O),d(O,h,"Generator"),d(O,c,(function(){return this})),d(O,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},n.values=D,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var u=o.call(a,"catchLoc"),c=o.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),R(n),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;R(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:D(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),b}},n}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},9682:t=>{function e(n,r){return t.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n,r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},7161:(t,e,n)=>{var r=n(5589),i=n(4574),a=n(1164),o=n(8590);t.exports=function(t,e){return r(t)||i(t,e)||a(t,e)||o()},t.exports.__esModule=!0,t.exports.default=t.exports},6762:(t,e,n)=>{var r=n(2814);t.exports=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=r(t)););return t},t.exports.__esModule=!0,t.exports.default=t.exports},1975:(t,e,n)=>{var r=n(4345),i=n(2814);t.exports=function(t,e,n,a){var o=r(i(1&a?t.prototype:t),e,n);return 2&a&&"function"==typeof o?function(t){return o.apply(n,t)}:o},t.exports.__esModule=!0,t.exports.default=t.exports},3467:(t,e,n)=>{var r=n(3752).default;t.exports=function(t,e){if("object"!=r(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)},t.exports.__esModule=!0,t.exports.default=t.exports},6726:(t,e,n)=>{var r=n(3752).default,i=n(3467);t.exports=function(t){var e=i(t,"string");return"symbol"==r(e)?e:e+""},t.exports.__esModule=!0,t.exports.default=t.exports},3752:t=>{function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},1164:(t,e,n)=>{var r=n(7173);t.exports=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports}},i={};function a(t){var e=i[t];if(void 0!==e)return e.exports;var n=i[t]={id:t,loaded:!1,exports:{}};return r[t](n,n.exports,a),n.loaded=!0,n.exports}a.m=r,a.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return a.d(e,{a:e}),e},a.d=(t,e)=>{for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},a.u=t=>t+".min.js",a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),a.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t;a.g.importScripts&&(t=a.g.location+"");var e=a.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!t||!/^http(s?):/.test(t));)t=n[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=t})(),a.b=document.baseURI||self.location.href,a.nc=void 0;var o={};return(()=>{"use strict";a.r(o),a.d(o,{CollapseExpandIcon:()=>r,Dendrogram:()=>iL,Fishbone:()=>hL,FlowDirectionGraph:()=>gL,FlowGraph:()=>wL,G6:()=>n,IndentedTree:()=>LL,MindMap:()=>BL,NetworkGraph:()=>VL,OrganizationChart:()=>qL,RCNode:()=>i,getNodeSide:()=>kL,measureTextSize:()=>oL,mergeOptions:()=>tL});var t={};a.r(t),a.d(t,{add:()=>zt,adjoint:()=>at,clone:()=>Q,copy:()=>J,create:()=>Z,determinant:()=>ot,equals:()=>Yt,exactEquals:()=>Ht,frob:()=>Bt,fromQuat:()=>Nt,fromQuat2:()=>wt,fromRotation:()=>gt,fromRotationTranslation:()=>xt,fromRotationTranslationScale:()=>St,fromRotationTranslationScaleOrigin:()=>Ot,fromScaling:()=>pt,fromTranslation:()=>vt,fromValues:()=>tt,fromXRotation:()=>yt,fromYRotation:()=>mt,fromZRotation:()=>bt,frustum:()=>At,getRotation:()=>Mt,getScaling:()=>kt,getTranslation:()=>Et,identity:()=>nt,invert:()=>it,lookAt:()=>It,mul:()=>Ut,multiply:()=>st,multiplyScalar:()=>Vt,multiplyScalarAndAdd:()=>Wt,ortho:()=>Dt,orthoNO:()=>Lt,orthoZO:()=>_t,perspective:()=>Pt,perspectiveFromFieldOfView:()=>Rt,perspectiveNO:()=>Tt,perspectiveZO:()=>Ct,rotate:()=>lt,rotateX:()=>ht,rotateY:()=>dt,rotateZ:()=>ft,scale:()=>ct,set:()=>et,str:()=>Ft,sub:()=>qt,subtract:()=>Gt,targetTo:()=>jt,translate:()=>ut,transpose:()=>rt});var e={};a.r(e),a.d(e,{circle:()=>Lp,diamond:()=>_p,rect:()=>jp,simple:()=>Bp,triangle:()=>Dp,triangleRect:()=>Fp,vee:()=>Ip});var n={};a.r(n),a.d(n,{AntVDagreLayout:()=>Bm,AutoAdaptLabel:()=>Lh,Background:()=>bw,Badge:()=>Qd,BaseBehavior:()=>Rh,BaseCombo:()=>cp,BaseEdge:()=>Gp,BaseLayout:()=>Ig,BaseNode:()=>df,BasePlugin:()=>gw,BaseShape:()=>Xd,BaseTransform:()=>fN,BrushSelect:()=>bd,BubbleSets:()=>eE,CameraSetting:()=>iE,Canvas:()=>PN,CanvasEvent:()=>Yc,Circle:()=>ff,CircleCombo:()=>lp,CircularLayout:()=>Wm,ClickSelect:()=>Ad,CollapseExpand:()=>xg,ComboCombinedLayout:()=>Bb,ComboEvent:()=>Uc,CommonEvent:()=>qc,CompactBoxLayout:()=>Qg.compactBox,ConcentricLayout:()=>Km,ContainerEvent:()=>Xc,Contextmenu:()=>sE,CreateEdge:()=>Mg,Cubic:()=>Vp,CubicHorizontal:()=>Wp,CubicRadial:()=>Hp,CubicVertical:()=>Yp,D3ForceLayout:()=>Nx,DagreLayout:()=>Cx,DendrogramLayout:()=>Qg.dendrogram,Diamond:()=>pf,Donut:()=>gf,DragCanvas:()=>Ng,DragElement:()=>Tg,DragElementForce:()=>Gg,EdgeBundling:()=>uE,EdgeEvent:()=>Kc,EdgeFilterLens:()=>yE,Ellipse:()=>bf,ExtensionCategory:()=>el,FishboneLayout:()=>cw,Fisheye:()=>bE,FixElementSize:()=>Wg,FocusElement:()=>Hg,ForceAtlas2Layout:()=>Ix,ForceLayout:()=>yb,FruchtermanLayout:()=>Fx,Fullscreen:()=>xE,Graph:()=>IA,GraphEvent:()=>$c,GridLayout:()=>zx,GridLine:()=>wE,HTML:()=>np,Hexagon:()=>xf,History:()=>OE,HistoryEvent:()=>Zc,HoverActivate:()=>Yg,Hull:()=>PE,Icon:()=>cf,Image:()=>ip,IndentedLayout:()=>Qg.indented,Label:()=>Zd,LassoSelect:()=>Ug,Legend:()=>Vk,Line:()=>Up,MDSLayout:()=>Lb,MapNodeSize:()=>GA,MindmapLayout:()=>Qg.mindmap,Minimap:()=>Wk,NodeEvent:()=>Qc,OptimizeViewportTransform:()=>qg,PlaceRadialLabels:()=>VA,Polyline:()=>ng,ProcessParallelEdges:()=>HA,Quadratic:()=>rg,RadialLayout:()=>Jx,RandomLayout:()=>ow,Rect:()=>ap,RectCombo:()=>hp,ScrollCanvas:()=>Kg,Shortcut:()=>md,SnakeLayout:()=>fw,Snapline:()=>Xk,Star:()=>op,Timebar:()=>BO,Toolbar:()=>YO,Tooltip:()=>JO,Triangle:()=>sp,Watermark:()=>oN,ZoomCanvas:()=>Zg,effect:()=>wN,getExtension:()=>al,getExtensions:()=>ol,iconfont:()=>ZA,idOf:()=>yh,invokeLayoutMethod:()=>Bg,isCollapsed:()=>Td,omitStyleProps:()=>Id,parseSize:()=>jd,positionOf:()=>ed,register:()=>kN,setVisibility:()=>Th,subStyleProps:()=>Dd,treeToGraphData:()=>FA,version:()=>sl});var r={};a.r(r),a.d(r,{ArrowCountIcon:()=>aR,PlusMinusIcon:()=>sR});var i={};function s(t){if(Array.isArray(t))return t}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function c(t,e){if(t){if("string"==typeof t)return u(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(t,e){return s(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,c=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==e);u=!0);}catch(t){c=!0,i=t}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw i}}return s}}(t,e)||c(t,e)||l()}function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function f(t){var e=function(t){if("object"!=d(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==d(e)?e:e+""}function v(t,e,n){return(e=f(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){v(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,f(r.key),r)}}function b(t,e,n){return e&&m(t.prototype,e),n&&m(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function x(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function w(t){return function(t){if(Array.isArray(t))return u(t)}(t)||x(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(t){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},E(t)}function k(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(k=function(){return!!t})()}function M(t,e){if(e&&("object"==d(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function S(t,e,n){return e=E(e),M(t,k()?Reflect.construct(e,n||[],E(t).constructor):e.apply(t,n))}function O(t,e){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},O(t,e)}function N(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&O(t,e)}a.r(i),a.d(i,{OrganizationChartNode:()=>cR,TextNode:()=>PR});const A=a(1668);var T=1e-6,P="undefined"!=typeof Float32Array?Float32Array:Array;function C(){var t=new P(3);return P!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function R(t){var e=new P(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function L(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function D(t,e,n){var r=new P(3);return r[0]=t,r[1]=e,r[2]=n,r}function _(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function I(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function j(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function F(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function B(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function z(t,e){var n=e[0],r=e[1],i=e[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function G(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function V(t,e,n,r){var i=e[0],a=e[1],o=e[2];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t[2]=o+r*(n[2]-o),t}function W(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[3]*r+n[7]*i+n[11]*a+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/o,t}function H(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],o=e[1],s=e[2];return Math.abs(n-a)<=T*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-o)<=T*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-s)<=T*Math.max(1,Math.abs(i),Math.abs(s))}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Y=F,U=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)},q=L;function X(){var t=new P(4);return P!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function K(t,e,n,r){var i=new P(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function $(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*o,t}function Z(){var t=new P(16);return P!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Q(t){var e=new P(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function J(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function tt(t,e,n,r,i,a,o,s,u,c,l,h,d,f,v,p){var g=new P(16);return g[0]=t,g[1]=e,g[2]=n,g[3]=r,g[4]=i,g[5]=a,g[6]=o,g[7]=s,g[8]=u,g[9]=c,g[10]=l,g[11]=h,g[12]=d,g[13]=f,g[14]=v,g[15]=p,g}function et(t,e,n,r,i,a,o,s,u,c,l,h,d,f,v,p,g){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=u,t[8]=c,t[9]=l,t[10]=h,t[11]=d,t[12]=f,t[13]=v,t[14]=p,t[15]=g,t}function nt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function rt(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function it(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=e[9],d=e[10],f=e[11],v=e[12],p=e[13],g=e[14],y=e[15],m=n*s-r*o,b=n*u-i*o,x=n*c-a*o,w=r*u-i*s,E=r*c-a*s,k=i*c-a*u,M=l*p-h*v,S=l*g-d*v,O=l*y-f*v,N=h*g-d*p,A=h*y-f*p,T=d*y-f*g,P=m*T-b*A+x*N+w*O-E*S+k*M;return P?(P=1/P,t[0]=(s*T-u*A+c*N)*P,t[1]=(i*A-r*T-a*N)*P,t[2]=(p*k-g*E+y*w)*P,t[3]=(d*E-h*k-f*w)*P,t[4]=(u*O-o*T-c*S)*P,t[5]=(n*T-i*O+a*S)*P,t[6]=(g*x-v*k-y*b)*P,t[7]=(l*k-d*x+f*b)*P,t[8]=(o*A-s*O+c*M)*P,t[9]=(r*O-n*A-a*M)*P,t[10]=(v*E-p*x+y*m)*P,t[11]=(h*x-l*E-f*m)*P,t[12]=(s*S-o*N-u*M)*P,t[13]=(n*N-r*S+i*M)*P,t[14]=(p*b-v*w-g*m)*P,t[15]=(l*w-h*b+d*m)*P,t):null}function at(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=e[9],d=e[10],f=e[11],v=e[12],p=e[13],g=e[14],y=e[15];return t[0]=s*(d*y-f*g)-h*(u*y-c*g)+p*(u*f-c*d),t[1]=-(r*(d*y-f*g)-h*(i*y-a*g)+p*(i*f-a*d)),t[2]=r*(u*y-c*g)-s*(i*y-a*g)+p*(i*c-a*u),t[3]=-(r*(u*f-c*d)-s*(i*f-a*d)+h*(i*c-a*u)),t[4]=-(o*(d*y-f*g)-l*(u*y-c*g)+v*(u*f-c*d)),t[5]=n*(d*y-f*g)-l*(i*y-a*g)+v*(i*f-a*d),t[6]=-(n*(u*y-c*g)-o*(i*y-a*g)+v*(i*c-a*u)),t[7]=n*(u*f-c*d)-o*(i*f-a*d)+l*(i*c-a*u),t[8]=o*(h*y-f*p)-l*(s*y-c*p)+v*(s*f-c*h),t[9]=-(n*(h*y-f*p)-l*(r*y-a*p)+v*(r*f-a*h)),t[10]=n*(s*y-c*p)-o*(r*y-a*p)+v*(r*c-a*s),t[11]=-(n*(s*f-c*h)-o*(r*f-a*h)+l*(r*c-a*s)),t[12]=-(o*(h*g-d*p)-l*(s*g-u*p)+v*(s*d-u*h)),t[13]=n*(h*g-d*p)-l*(r*g-i*p)+v*(r*d-i*h),t[14]=-(n*(s*g-u*p)-o*(r*g-i*p)+v*(r*u-i*s)),t[15]=n*(s*d-u*h)-o*(r*d-i*h)+l*(r*u-i*s),t}function ot(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],u=t[7],c=t[8],l=t[9],h=t[10],d=t[11],f=t[12],v=t[13],p=t[14],g=t[15];return(e*o-n*a)*(h*g-d*p)-(e*s-r*a)*(l*g-d*v)+(e*u-i*a)*(l*p-h*v)+(n*s-r*o)*(c*g-d*f)-(n*u-i*o)*(c*p-h*f)+(r*u-i*s)*(c*v-l*f)}function st(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],d=e[9],f=e[10],v=e[11],p=e[12],g=e[13],y=e[14],m=e[15],b=n[0],x=n[1],w=n[2],E=n[3];return t[0]=b*r+x*s+w*h+E*p,t[1]=b*i+x*u+w*d+E*g,t[2]=b*a+x*c+w*f+E*y,t[3]=b*o+x*l+w*v+E*m,b=n[4],x=n[5],w=n[6],E=n[7],t[4]=b*r+x*s+w*h+E*p,t[5]=b*i+x*u+w*d+E*g,t[6]=b*a+x*c+w*f+E*y,t[7]=b*o+x*l+w*v+E*m,b=n[8],x=n[9],w=n[10],E=n[11],t[8]=b*r+x*s+w*h+E*p,t[9]=b*i+x*u+w*d+E*g,t[10]=b*a+x*c+w*f+E*y,t[11]=b*o+x*l+w*v+E*m,b=n[12],x=n[13],w=n[14],E=n[15],t[12]=b*r+x*s+w*h+E*p,t[13]=b*i+x*u+w*d+E*g,t[14]=b*a+x*c+w*f+E*y,t[15]=b*o+x*l+w*v+E*m,t}function ut(t,e,n){var r,i,a,o,s,u,c,l,h,d,f,v,p=n[0],g=n[1],y=n[2];return e===t?(t[12]=e[0]*p+e[4]*g+e[8]*y+e[12],t[13]=e[1]*p+e[5]*g+e[9]*y+e[13],t[14]=e[2]*p+e[6]*g+e[10]*y+e[14],t[15]=e[3]*p+e[7]*g+e[11]*y+e[15]):(r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],d=e[9],f=e[10],v=e[11],t[0]=r,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=h,t[9]=d,t[10]=f,t[11]=v,t[12]=r*p+s*g+h*y+e[12],t[13]=i*p+u*g+d*y+e[13],t[14]=a*p+c*g+f*y+e[14],t[15]=o*p+l*g+v*y+e[15]),t}function ct(t,e,n){var r=n[0],i=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function lt(t,e,n,r){var i,a,o,s,u,c,l,h,d,f,v,p,g,y,m,b,x,w,E,k,M,S,O,N,A=r[0],P=r[1],C=r[2],R=Math.hypot(A,P,C);return R<T?null:(A*=R=1/R,P*=R,C*=R,i=Math.sin(n),o=1-(a=Math.cos(n)),s=e[0],u=e[1],c=e[2],l=e[3],h=e[4],d=e[5],f=e[6],v=e[7],p=e[8],g=e[9],y=e[10],m=e[11],b=A*A*o+a,x=P*A*o+C*i,w=C*A*o-P*i,E=A*P*o-C*i,k=P*P*o+a,M=C*P*o+A*i,S=A*C*o+P*i,O=P*C*o-A*i,N=C*C*o+a,t[0]=s*b+h*x+p*w,t[1]=u*b+d*x+g*w,t[2]=c*b+f*x+y*w,t[3]=l*b+v*x+m*w,t[4]=s*E+h*k+p*M,t[5]=u*E+d*k+g*M,t[6]=c*E+f*k+y*M,t[7]=l*E+v*k+m*M,t[8]=s*S+h*O+p*N,t[9]=u*S+d*O+g*N,t[10]=c*S+f*O+y*N,t[11]=l*S+v*O+m*N,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function ht(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[4],o=e[5],s=e[6],u=e[7],c=e[8],l=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+c*r,t[5]=o*i+l*r,t[6]=s*i+h*r,t[7]=u*i+d*r,t[8]=c*i-a*r,t[9]=l*i-o*r,t[10]=h*i-s*r,t[11]=d*i-u*r,t}function dt(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],o=e[1],s=e[2],u=e[3],c=e[8],l=e[9],h=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-c*r,t[1]=o*i-l*r,t[2]=s*i-h*r,t[3]=u*i-d*r,t[8]=a*r+c*i,t[9]=o*r+l*i,t[10]=s*r+h*i,t[11]=u*r+d*i,t}function ft(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],o=e[1],s=e[2],u=e[3],c=e[4],l=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+c*r,t[1]=o*i+l*r,t[2]=s*i+h*r,t[3]=u*i+d*r,t[4]=c*i-a*r,t[5]=l*i-o*r,t[6]=h*i-s*r,t[7]=d*i-u*r,t}function vt(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function pt(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function gt(t,e,n){var r,i,a,o=n[0],s=n[1],u=n[2],c=Math.hypot(o,s,u);return c<T?null:(o*=c=1/c,s*=c,u*=c,r=Math.sin(e),a=1-(i=Math.cos(e)),t[0]=o*o*a+i,t[1]=s*o*a+u*r,t[2]=u*o*a-s*r,t[3]=0,t[4]=o*s*a-u*r,t[5]=s*s*a+i,t[6]=u*s*a+o*r,t[7]=0,t[8]=o*u*a+s*r,t[9]=s*u*a-o*r,t[10]=u*u*a+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function yt(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function mt(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function bt(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function xt(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=r+r,u=i+i,c=a+a,l=r*s,h=r*u,d=r*c,f=i*u,v=i*c,p=a*c,g=o*s,y=o*u,m=o*c;return t[0]=1-(f+p),t[1]=h+m,t[2]=d-y,t[3]=0,t[4]=h-m,t[5]=1-(l+p),t[6]=v+g,t[7]=0,t[8]=d+y,t[9]=v-g,t[10]=1-(l+f),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function wt(t,e){var n=new P(3),r=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=r*r+i*i+a*a+o*o;return h>0?(n[0]=2*(s*o+l*r+u*a-c*i)/h,n[1]=2*(u*o+l*i+c*r-s*a)/h,n[2]=2*(c*o+l*a+s*i-u*r)/h):(n[0]=2*(s*o+l*r+u*a-c*i),n[1]=2*(u*o+l*i+c*r-s*a),n[2]=2*(c*o+l*a+s*i-u*r)),xt(t,e,n),t}function Et(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function kt(t,e){var n=e[0],r=e[1],i=e[2],a=e[4],o=e[5],s=e[6],u=e[8],c=e[9],l=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(a,o,s),t[2]=Math.hypot(u,c,l),t}function Mt(t,e){var n=new P(3);kt(n,e);var r=1/n[0],i=1/n[1],a=1/n[2],o=e[0]*r,s=e[1]*i,u=e[2]*a,c=e[4]*r,l=e[5]*i,h=e[6]*a,d=e[8]*r,f=e[9]*i,v=e[10]*a,p=o+l+v,g=0;return p>0?(g=2*Math.sqrt(p+1),t[3]=.25*g,t[0]=(h-f)/g,t[1]=(d-u)/g,t[2]=(s-c)/g):o>l&&o>v?(g=2*Math.sqrt(1+o-l-v),t[3]=(h-f)/g,t[0]=.25*g,t[1]=(s+c)/g,t[2]=(d+u)/g):l>v?(g=2*Math.sqrt(1+l-o-v),t[3]=(d-u)/g,t[0]=(s+c)/g,t[1]=.25*g,t[2]=(h+f)/g):(g=2*Math.sqrt(1+v-o-l),t[3]=(s-c)/g,t[0]=(d+u)/g,t[1]=(h+f)/g,t[2]=.25*g),t}function St(t,e,n,r){var i=e[0],a=e[1],o=e[2],s=e[3],u=i+i,c=a+a,l=o+o,h=i*u,d=i*c,f=i*l,v=a*c,p=a*l,g=o*l,y=s*u,m=s*c,b=s*l,x=r[0],w=r[1],E=r[2];return t[0]=(1-(v+g))*x,t[1]=(d+b)*x,t[2]=(f-m)*x,t[3]=0,t[4]=(d-b)*w,t[5]=(1-(h+g))*w,t[6]=(p+y)*w,t[7]=0,t[8]=(f+m)*E,t[9]=(p-y)*E,t[10]=(1-(h+v))*E,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Ot(t,e,n,r,i){var a=e[0],o=e[1],s=e[2],u=e[3],c=a+a,l=o+o,h=s+s,d=a*c,f=a*l,v=a*h,p=o*l,g=o*h,y=s*h,m=u*c,b=u*l,x=u*h,w=r[0],E=r[1],k=r[2],M=i[0],S=i[1],O=i[2],N=(1-(p+y))*w,A=(f+x)*w,T=(v-b)*w,P=(f-x)*E,C=(1-(d+y))*E,R=(g+m)*E,L=(v+b)*k,D=(g-m)*k,_=(1-(d+p))*k;return t[0]=N,t[1]=A,t[2]=T,t[3]=0,t[4]=P,t[5]=C,t[6]=R,t[7]=0,t[8]=L,t[9]=D,t[10]=_,t[11]=0,t[12]=n[0]+M-(N*M+P*S+L*O),t[13]=n[1]+S-(A*M+C*S+D*O),t[14]=n[2]+O-(T*M+R*S+_*O),t[15]=1,t}function Nt(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n+n,s=r+r,u=i+i,c=n*o,l=r*o,h=r*s,d=i*o,f=i*s,v=i*u,p=a*o,g=a*s,y=a*u;return t[0]=1-h-v,t[1]=l+y,t[2]=d-g,t[3]=0,t[4]=l-y,t[5]=1-c-v,t[6]=f+p,t[7]=0,t[8]=d+g,t[9]=f-p,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function At(t,e,n,r,i,a,o){var s=1/(n-e),u=1/(i-r),c=1/(a-o);return t[0]=2*a*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(o+a)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*c,t[15]=0,t}function Tt(t,e,n,r,i){var a,o=1/Math.tan(e/2);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(a=1/(r-i),t[10]=(i+r)*a,t[14]=2*i*r*a):(t[10]=-1,t[14]=-2*r),t}C(),X();var Pt=Tt;function Ct(t,e,n,r,i){var a,o=1/Math.tan(e/2);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(a=1/(r-i),t[10]=i*a,t[14]=i*r*a):(t[10]=-1,t[14]=-r),t}function Rt(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(o+s),c=2/(i+a);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-s)*u*.5,t[9]=(i-a)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function Lt(t,e,n,r,i,a,o){var s=1/(e-n),u=1/(r-i),c=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(o+a)*c,t[15]=1,t}var Dt=Lt;function _t(t,e,n,r,i,a,o){var s=1/(e-n),u=1/(r-i),c=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=a*c,t[15]=1,t}function It(t,e,n,r){var i,a,o,s,u,c,l,h,d,f,v=e[0],p=e[1],g=e[2],y=r[0],m=r[1],b=r[2],x=n[0],w=n[1],E=n[2];return Math.abs(v-x)<T&&Math.abs(p-w)<T&&Math.abs(g-E)<T?nt(t):(l=v-x,h=p-w,d=g-E,i=m*(d*=f=1/Math.hypot(l,h,d))-b*(h*=f),a=b*(l*=f)-y*d,o=y*h-m*l,(f=Math.hypot(i,a,o))?(i*=f=1/f,a*=f,o*=f):(i=0,a=0,o=0),s=h*o-d*a,u=d*i-l*o,c=l*a-h*i,(f=Math.hypot(s,u,c))?(s*=f=1/f,u*=f,c*=f):(s=0,u=0,c=0),t[0]=i,t[1]=s,t[2]=l,t[3]=0,t[4]=a,t[5]=u,t[6]=h,t[7]=0,t[8]=o,t[9]=c,t[10]=d,t[11]=0,t[12]=-(i*v+a*p+o*g),t[13]=-(s*v+u*p+c*g),t[14]=-(l*v+h*p+d*g),t[15]=1,t)}function jt(t,e,n,r){var i=e[0],a=e[1],o=e[2],s=r[0],u=r[1],c=r[2],l=i-n[0],h=a-n[1],d=o-n[2],f=l*l+h*h+d*d;f>0&&(l*=f=1/Math.sqrt(f),h*=f,d*=f);var v=u*d-c*h,p=c*l-s*d,g=s*h-u*l;return(f=v*v+p*p+g*g)>0&&(v*=f=1/Math.sqrt(f),p*=f,g*=f),t[0]=v,t[1]=p,t[2]=g,t[3]=0,t[4]=h*g-d*p,t[5]=d*v-l*g,t[6]=l*p-h*v,t[7]=0,t[8]=l,t[9]=h,t[10]=d,t[11]=0,t[12]=i,t[13]=a,t[14]=o,t[15]=1,t}function Ft(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Bt(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function zt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function Gt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function Vt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function Wt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function Ht(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Yt(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7],l=t[8],h=t[9],d=t[10],f=t[11],v=t[12],p=t[13],g=t[14],y=t[15],m=e[0],b=e[1],x=e[2],w=e[3],E=e[4],k=e[5],M=e[6],S=e[7],O=e[8],N=e[9],A=e[10],P=e[11],C=e[12],R=e[13],L=e[14],D=e[15];return Math.abs(n-m)<=T*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(r-b)<=T*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(i-x)<=T*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(a-w)<=T*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(o-E)<=T*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(s-k)<=T*Math.max(1,Math.abs(s),Math.abs(k))&&Math.abs(u-M)<=T*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(c-S)<=T*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(l-O)<=T*Math.max(1,Math.abs(l),Math.abs(O))&&Math.abs(h-N)<=T*Math.max(1,Math.abs(h),Math.abs(N))&&Math.abs(d-A)<=T*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(f-P)<=T*Math.max(1,Math.abs(f),Math.abs(P))&&Math.abs(v-C)<=T*Math.max(1,Math.abs(v),Math.abs(C))&&Math.abs(p-R)<=T*Math.max(1,Math.abs(p),Math.abs(R))&&Math.abs(g-L)<=T*Math.max(1,Math.abs(g),Math.abs(L))&&Math.abs(y-D)<=T*Math.max(1,Math.abs(y),Math.abs(D))}var Ut=st,qt=Gt;function Xt(){var t=new P(9);return P!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Kt(){var t=new P(4);return P!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function $t(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function Zt(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=n[0],u=n[1],c=n[2],l=n[3];return t[0]=r*l+o*s+i*c-a*u,t[1]=i*l+o*u+a*s-r*c,t[2]=a*l+o*c+r*u-i*s,t[3]=o*l-r*s-i*u-a*c,t}function Qt(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n*n+r*r+i*i+a*a,s=o?1/o:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=a*s,t}function Jt(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var a=Math.sin(e),o=Math.cos(e),s=Math.sin(n),u=Math.cos(n),c=Math.sin(r),l=Math.cos(r);return t[0]=a*u*l-o*s*c,t[1]=o*s*l+a*u*c,t[2]=o*u*c-a*s*l,t[3]=o*u*l+a*s*c,t}var te=K,ee=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},ne=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},re=Zt,ie=function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n*n+r*r+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=a*o,t};function ae(){var t=new P(2);return P!=Float32Array&&(t[0]=0,t[1]=0),t}function oe(t){return"number"==typeof t}function se(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}function ue(t){return null==t}function ce(t){return"string"==typeof t}C(),D(1,0,0),D(0,1,0),Kt(),Kt(),Xt(),ae();const le=function(t,e,n){return t<e?e:t>n?n:t};var he=function(t,e){return he=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},he(t,e)};function de(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}he(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var fe=function(){return fe=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},fe.apply(this,arguments)};function ve(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function pe(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function ge(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ye(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,a=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}function me(t,e,n){if(n||2===arguments.length)for(var r,i=0,a=e.length;i<a;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}function be(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var xe={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function we(t){return Array.isArray(t)&&t.every((function(t){var e=t[0].toLowerCase();return xe[e]===t.length-1&&"achlmqstvz".includes(e)}))}function Ee(t){return we(t)&&t.every((function(t){var e=t[0];return e===e.toUpperCase()}))}function ke(t){return Ee(t)&&t.every((function(t){var e=t[0];return"ACLMQZ".includes(e)}))}var Me={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function Se(t){for(var e=t.pathValue[t.segmentStart],n=e.toLowerCase(),r=t.data;r.length>=xe[n]&&("m"===n&&r.length>2?(t.segments.push([e].concat(r.splice(0,2))),n="l",e="m"===e?"l":"L"):t.segments.push([e].concat(r.splice(0,xe[n]))),xe[n]););}function Oe(t){var e=t.index,n=t.pathValue,r=n.charCodeAt(e);return 48===r?(t.param=0,void(t.index+=1)):49===r?(t.param=1,void(t.index+=1)):void(t.err='[path-util]: invalid Arc flag "'.concat(n[e],'", expecting 0 or 1 at index ').concat(e))}function Ne(t){return t>=48&&t<=57}function Ae(t){var e,n=t.max,r=t.pathValue,i=t.index,a=i,o=!1,s=!1,u=!1,c=!1;if(a>=n)t.err="[path-util]: Invalid path value at index ".concat(a,', "pathValue" is missing param');else if(43!==(e=r.charCodeAt(a))&&45!==e||(a+=1,e=r.charCodeAt(a)),Ne(e)||46===e){if(46!==e){if(o=48===e,a+=1,e=r.charCodeAt(a),o&&a<n&&e&&Ne(e))return void(t.err="[path-util]: Invalid path value at index ".concat(i,', "').concat(r[i],'" illegal number'));for(;a<n&&Ne(r.charCodeAt(a));)a+=1,s=!0;e=r.charCodeAt(a)}if(46===e){for(c=!0,a+=1;Ne(r.charCodeAt(a));)a+=1,u=!0;e=r.charCodeAt(a)}if(101===e||69===e){if(c&&!s&&!u)return void(t.err="[path-util]: Invalid path value at index ".concat(a,', "').concat(r[a],'" invalid float exponent'));if(a+=1,43!==(e=r.charCodeAt(a))&&45!==e||(a+=1),!(a<n&&Ne(r.charCodeAt(a))))return void(t.err="[path-util]: Invalid path value at index ".concat(a,', "').concat(r[a],'" invalid integer exponent'));for(;a<n&&Ne(r.charCodeAt(a));)a+=1}t.index=a,t.param=+t.pathValue.slice(i,a)}else t.err="[path-util]: Invalid path value at index ".concat(a,', "').concat(r[a],'" is not a number')}function Te(t){for(var e,n=t.pathValue,r=t.max;t.index<r&&(10===(e=n.charCodeAt(t.index))||13===e||8232===e||8233===e||32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e));)t.index+=1}function Pe(t){var e,n=t.max,r=t.pathValue,i=t.index,a=r.charCodeAt(i),o=xe[r[i].toLowerCase()];if(t.segmentStart=i,function(t){switch(32|t){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}(a))if(t.index+=1,Te(t),t.data=[],o){for(;;){for(var s=o;s>0;s-=1){if(97!=(32|a)||3!==s&&4!==s?Ae(t):Oe(t),t.err.length)return;t.data.push(t.param),Te(t),t.index<n&&44===r.charCodeAt(t.index)&&(t.index+=1,Te(t))}if(t.index>=t.max)break;if(!((e=r.charCodeAt(t.index))>=48&&e<=57||43===e||45===e||46===e))break}Se(t)}else Se(t);else t.err='[path-util]: Invalid path value "'.concat(r[i],'" is not a path command')}var Ce=function(t){this.pathValue=t,this.segments=[],this.max=t.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""};function Re(t,e){var n=t[0],r=e.x1,i=e.y1,a=e.x2,o=e.y2,s=t.slice(1).map(Number),u=t;if("TQ".includes(n)||(e.qx=null,e.qy=null),"H"===n)u=["L",t[1],i];else if("V"===n)u=["L",r,t[1]];else if("S"===n){var c=2*r-a,l=2*i-o;e.x1=c,e.y1=l,u=["C",c,l].concat(s)}else if("T"===n){var h=2*r-e.qx,d=2*i-e.qy;e.qx=h,e.qy=d,u=["Q",h,d].concat(s)}else if("Q"===n){var f=s[0],v=s[1];e.qx=f,e.qy=v}return u}function Le(t){if(ke(t))return[].concat(t);for(var e=function(t){if(Ee(t))return[].concat(t);var e=function(t){if(we(t))return[].concat(t);var e=new Ce(t);for(Te(e);e.index<e.max&&!e.err.length;)Pe(e);return e.err?e.err:e.segments}(t),n=0,r=0,i=0,a=0;return e.map((function(t){var e,o=t.slice(1).map(Number),s=t[0],u=s.toUpperCase();if("M"===s)return n=o[0],r=o[1],i=n,a=r,["M",n,r];if(s!==u)switch(u){case"A":e=[u,o[0],o[1],o[2],o[3],o[4],o[5]+n,o[6]+r];break;case"V":e=[u,o[0]+r];break;case"H":e=[u,o[0]+n];break;default:var c=o.map((function(t,e){return t+(e%2?r:n)}));e=[u].concat(c)}else e=[u].concat(o);var l=e.length;switch(u){case"Z":n=i,r=a;break;case"H":n=e[1];break;case"V":r=e[1];break;default:n=e[l-2],r=e[l-1],"M"===u&&(i=n,a=r)}return e}))}(t),n=fe({},Me),r=0;r<e.length;r+=1){e[r]=Re(e[r],n);var i=e[r],a=i.length;n.x1=+i[a-2],n.y1=+i[a-1],n.x2=+i[a-4]||n.x1,n.y2=+i[a-3]||n.y1}return e}function De(t,e,n){var r=t[0],i=t[1];return[r+(e[0]-r)*n,i+(e[1]-i)*n]}function _e(t,e,n,r,i){var a=se([t,e],[n,r]),o={x:0,y:0};if("number"==typeof i)if(i<=0)o={x:t,y:e};else if(i>=a)o={x:n,y:r};else{var s=De([t,e],[n,r],i/a);o={x:s[0],y:s[1]}}return{length:a,point:o,min:{x:Math.min(t,n),y:Math.min(e,r)},max:{x:Math.max(t,n),y:Math.max(e,r)}}}function Ie(t,e){var n=t.x,r=t.y,i=e.x,a=e.y,o=n*i+r*a,s=Math.sqrt((Math.pow(n,2)+Math.pow(r,2))*(Math.pow(i,2)+Math.pow(a,2)));return(n*a-r*i<0?-1:1)*Math.acos(o/s)}function je(t,e,n,r,i,a,o,s,u,c){var l=Math.abs,h=Math.sin,d=Math.cos,f=Math.sqrt,v=Math.PI,p=l(n),g=l(r),y=(i%360+360)%360*(v/180);if(t===s&&e===u)return{x:t,y:e};if(0===p||0===g)return _e(t,e,s,u,c).point;var m=(t-s)/2,b=(e-u)/2,x={x:d(y)*m+h(y)*b,y:-h(y)*m+d(y)*b},w=Math.pow(x.x,2)/Math.pow(p,2)+Math.pow(x.y,2)/Math.pow(g,2);w>1&&(p*=f(w),g*=f(w));var E=(Math.pow(p,2)*Math.pow(g,2)-Math.pow(p,2)*Math.pow(x.y,2)-Math.pow(g,2)*Math.pow(x.x,2))/(Math.pow(p,2)*Math.pow(x.y,2)+Math.pow(g,2)*Math.pow(x.x,2)),k=(a!==o?1:-1)*f(E=E<0?0:E),M=k*(p*x.y/g),S=k*(-g*x.x/p),O=d(y)*M-h(y)*S+(t+s)/2,N=h(y)*M+d(y)*S+(e+u)/2,A={x:(x.x-M)/p,y:(x.y-S)/g},T=Ie({x:1,y:0},A),P=Ie(A,{x:(-x.x-M)/p,y:(-x.y-S)/g});!o&&P>0?P-=2*v:o&&P<0&&(P+=2*v);var C=T+(P%=2*v)*c,R=p*d(C),L=g*h(C);return{x:d(y)*R-h(y)*L+O,y:h(y)*R+d(y)*L+N}}function Fe(t,e,n,r,i,a,o,s,u,c,l){var h,d=l.bbox,f=void 0===d||d,v=l.length,p=void 0===v||v,g=l.sampleSize,y=void 0===g?30:g,m="number"==typeof c,b=t,x=e,w=0,E=[b,x,w],k=[b,x],M={x:0,y:0},S=[{x:b,y:x}];m&&c<=0&&(M={x:b,y:x});for(var O=0;O<=y;O+=1){if(b=(h=je(t,e,n,r,i,a,o,s,u,O/y)).x,x=h.y,f&&S.push({x:b,y:x}),p&&(w+=se(k,[b,x])),k=[b,x],m&&w>=c&&c>E[2]){var N=(w-c)/(w-E[2]);M={x:k[0]*(1-N)+E[0]*N,y:k[1]*(1-N)+E[1]*N}}E=[b,x,w]}return m&&c>=w&&(M={x:s,y:u}),{length:w,point:M,min:{x:Math.min.apply(null,S.map((function(t){return t.x}))),y:Math.min.apply(null,S.map((function(t){return t.y})))},max:{x:Math.max.apply(null,S.map((function(t){return t.x}))),y:Math.max.apply(null,S.map((function(t){return t.y})))}}}function Be(t,e,n,r,i,a,o,s,u){var c=1-u;return{x:Math.pow(c,3)*t+3*Math.pow(c,2)*u*n+3*c*Math.pow(u,2)*i+Math.pow(u,3)*o,y:Math.pow(c,3)*e+3*Math.pow(c,2)*u*r+3*c*Math.pow(u,2)*a+Math.pow(u,3)*s}}function ze(t,e,n,r,i,a,o,s,u,c){var l,h=c.bbox,d=void 0===h||h,f=c.length,v=void 0===f||f,p=c.sampleSize,g=void 0===p?10:p,y="number"==typeof u,m=t,b=e,x=0,w=[m,b,x],E=[m,b],k={x:0,y:0},M=[{x:m,y:b}];y&&u<=0&&(k={x:m,y:b});for(var S=0;S<=g;S+=1){if(m=(l=Be(t,e,n,r,i,a,o,s,S/g)).x,b=l.y,d&&M.push({x:m,y:b}),v&&(x+=se(E,[m,b])),E=[m,b],y&&x>=u&&u>w[2]){var O=(x-u)/(x-w[2]);k={x:E[0]*(1-O)+w[0]*O,y:E[1]*(1-O)+w[1]*O}}w=[m,b,x]}return y&&u>=x&&(k={x:o,y:s}),{length:x,point:k,min:{x:Math.min.apply(null,M.map((function(t){return t.x}))),y:Math.min.apply(null,M.map((function(t){return t.y})))},max:{x:Math.max.apply(null,M.map((function(t){return t.x}))),y:Math.max.apply(null,M.map((function(t){return t.y})))}}}function Ge(t,e,n,r,i,a,o){var s=1-o;return{x:Math.pow(s,2)*t+2*s*o*n+Math.pow(o,2)*i,y:Math.pow(s,2)*e+2*s*o*r+Math.pow(o,2)*a}}function Ve(t,e,n,r,i,a,o,s){var u,c=s.bbox,l=void 0===c||c,h=s.length,d=void 0===h||h,f=s.sampleSize,v=void 0===f?10:f,p="number"==typeof o,g=t,y=e,m=0,b=[g,y,m],x=[g,y],w={x:0,y:0},E=[{x:g,y}];p&&o<=0&&(w={x:g,y});for(var k=0;k<=v;k+=1){if(g=(u=Ge(t,e,n,r,i,a,k/v)).x,y=u.y,l&&E.push({x:g,y}),d&&(m+=se(x,[g,y])),x=[g,y],p&&m>=o&&o>b[2]){var M=(m-o)/(m-b[2]);w={x:x[0]*(1-M)+b[0]*M,y:x[1]*(1-M)+b[1]*M}}b=[g,y,m]}return p&&o>=m&&(w={x:i,y:a}),{length:m,point:w,min:{x:Math.min.apply(null,E.map((function(t){return t.x}))),y:Math.min.apply(null,E.map((function(t){return t.y})))},max:{x:Math.max.apply(null,E.map((function(t){return t.x}))),y:Math.max.apply(null,E.map((function(t){return t.y})))}}}function We(t,e,n){for(var r,i,a,o,s,u,c,l,h,d=Le(t),f="number"==typeof e,v=[],p=0,g=0,y=0,m=0,b=[],x=[],w=0,E={x:0,y:0},k=E,M=E,S=E,O=0,N=0,A=d.length;N<A;N+=1)v=(c="M"===(l=(h=d[N])[0]))?v:[p,g].concat(h.slice(1)),c?(k=E={x:y=h[1],y:m=h[2]},w=0,f&&e<.001&&(S=E)):"L"===l?(w=(r=_e(v[0],v[1],v[2],v[3],(e||0)-O)).length,E=r.min,k=r.max,M=r.point):"A"===l?(w=(i=Fe(v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7],v[8],(e||0)-O,n||{})).length,E=i.min,k=i.max,M=i.point):"C"===l?(w=(a=ze(v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7],(e||0)-O,n||{})).length,E=a.min,k=a.max,M=a.point):"Q"===l?(w=(o=Ve(v[0],v[1],v[2],v[3],v[4],v[5],(e||0)-O,n||{})).length,E=o.min,k=o.max,M=o.point):"Z"===l&&(w=(s=_e((v=[p,g,y,m])[0],v[1],v[2],v[3],(e||0)-O)).length,E=s.min,k=s.max,M=s.point),f&&O<e&&O+w>=e&&(S=M),x.push(k),b.push(E),O+=w,p=(u="Z"!==l?h.slice(-2):[y,m])[0],g=u[1];return f&&e>=O&&(S={x:p,y:g}),{length:O,point:S,min:{x:Math.min.apply(null,b.map((function(t){return t.x}))),y:Math.min.apply(null,b.map((function(t){return t.y})))},max:{x:Math.max.apply(null,x.map((function(t){return t.x}))),y:Math.max.apply(null,x.map((function(t){return t.y})))}}}function He(t){return Array.isArray(t)}const Ye=function(t){if(He(t))return t.reduce((function(t,e){return Math.min(t,e)}),t[0])};function Ue(t){if(!Array.isArray(t))return-1/0;var e=t.length;if(!e)return-1/0;for(var n=t[0],r=1;r<e;r++)n=Math.max(n,t[r]);return n}function qe(t,e,n){return void 0===n&&(n=1e-5),t===e||Math.abs(t-e)<n}const Xe=function(t,e){return(t%e+e)%e};function Ke(t,e,n){if(t[n].length>7){t[n].shift();for(var r=t[n],i=n;r.length;)e[n]="A",t.splice(i+=1,0,["C"].concat(r.splice(0,6)));t.splice(n,1)}}function $e(t,e,n){return{x:t*Math.cos(n)-e*Math.sin(n),y:t*Math.sin(n)+e*Math.cos(n)}}function Ze(t,e,n,r,i,a,o,s,u,c){var l,h,d,f,v,p=t,g=e,y=n,m=r,b=s,x=u,w=120*Math.PI/180,E=Math.PI/180*(+i||0),k=[];if(c)h=c[0],d=c[1],f=c[2],v=c[3];else{p=(l=$e(p,g,-E)).x,g=l.y;var M=(p-(b=(l=$e(b,x,-E)).x))/2,S=(g-(x=l.y))/2,O=M*M/(y*y)+S*S/(m*m);O>1&&(y*=O=Math.sqrt(O),m*=O);var N=y*y,A=m*m,T=(a===o?-1:1)*Math.sqrt(Math.abs((N*A-N*S*S-A*M*M)/(N*S*S+A*M*M)));f=T*y*S/m+(p+b)/2,v=T*-m*M/y+(g+x)/2,h=Math.asin(((g-v)/m*Math.pow(10,9)|0)/Math.pow(10,9)),d=Math.asin(((x-v)/m*Math.pow(10,9)|0)/Math.pow(10,9)),h=p<f?Math.PI-h:h,d=b<f?Math.PI-d:d,h<0&&(h=2*Math.PI+h),d<0&&(d=2*Math.PI+d),o&&h>d&&(h-=2*Math.PI),!o&&d>h&&(d-=2*Math.PI)}var P=d-h;if(Math.abs(P)>w){var C=d,R=b,L=x;d=h+w*(o&&d>h?1:-1),k=Ze(b=f+y*Math.cos(d),x=v+m*Math.sin(d),y,m,i,0,o,R,L,[d,C,f,v])}P=d-h;var D=Math.cos(h),_=Math.sin(h),I=Math.cos(d),j=Math.sin(d),F=Math.tan(P/4),B=4/3*y*F,z=4/3*m*F,G=[p,g],V=[p+B*_,g-z*D],W=[b+B*j,x-z*I],H=[b,x];if(V[0]=2*G[0]-V[0],V[1]=2*G[1]-V[1],c)return V.concat(W,H,k);for(var Y=[],U=0,q=(k=V.concat(W,H,k)).length;U<q;U+=1)Y[U]=U%2?$e(k[U-1],k[U],E).y:$e(k[U],k[U+1],E).x;return Y}var Qe=function(t,e,n,r){return me(me([],De([t,e],[n,r],.5),!0),[n,r,n,r],!1)};function Je(t,e){var n,r,i,a,o,s,u,c,l,h=t[0],d=t.slice(1).map(Number),f=d[0],v=d[1],p=e.x1,g=e.y1,y=e.x,m=e.y;switch("TQ".includes(h)||(e.qx=null,e.qy=null),h){case"M":return e.x=f,e.y=v,t;case"A":return n=[p,g].concat(d),["C"].concat(Ze(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9]));case"Q":return e.qx=f,e.qy=v,n=[p,g].concat(d),["C"].concat((r=n[0],i=n[1],[(c=1/3)*r+(l=2/3)*(a=n[2]),c*i+l*(o=n[3]),c*(s=n[4])+l*a,c*(u=n[5])+l*o,s,u]));case"L":return["C"].concat(Qe(p,g,f,v));case"Z":return p===y&&g===m?["C",p,g,y,m,y,m]:["C"].concat(Qe(p,g,y,m))}return t}function tn(t,e){if(void 0===e&&(e=!1),function(t){return ke(t)&&t.every((function(t){var e=t[0];return"MC".includes(e)}))}(t)){var n=[].concat(t);return e?[n,[]]:n}for(var r,i,a=Le(t),o=fe({},Me),s=[],u="",c=a.length,l=[],h=0;h<c;h+=1){a[h]&&(u=a[h][0]),s[h]=u;var d=Je(a[h],o);a[h]=d,Ke(a,s,h),c=a.length,"Z"===u&&l.push(h),i=(r=a[h]).length,o.x1=+r[i-2],o.y1=+r[i-1],o.x2=+r[i-4]||o.x1,o.y2=+r[i-3]||o.y1}return e?[a,l]:a}function en(t){return t.map((function(t,e,n){var r=e&&n[e-1].slice(-2).concat(t.slice(1)),i=e?ze(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],{bbox:!1}).length:0;return{s:t,ss:e?i?function(t,e){void 0===e&&(e=.5);var n=t.slice(0,2),r=t.slice(2,4),i=t.slice(4,6),a=t.slice(6,8),o=De(n,r,e),s=De(r,i,e),u=De(i,a,e),c=De(o,s,e),l=De(s,u,e),h=De(c,l,e);return[["C"].concat(o,c,h),["C"].concat(l,u,a)]}(r):[t,t]:[t],l:i}}))}function nn(t,e,n){var r=en(t),i=en(e),a=r.length,o=i.length,s=r.filter((function(t){return t.l})).length,u=i.filter((function(t){return t.l})).length,c=r.filter((function(t){return t.l})).reduce((function(t,e){return t+e.l}),0)/s||0,l=i.filter((function(t){return t.l})).reduce((function(t,e){return t+e.l}),0)/u||0,h=n||Math.max(a,o),d=[c,l],f=[h-a,h-o],v=0,p=[r,i].map((function(t,e){return t.l===h?t.map((function(t){return t.s})):t.map((function(t,n){return v=n&&f[e]&&t.l>=d[e],f[e]-=v?1:0,v?t.ss:[t.s]})).flat()}));return p[0].length===p[1].length?p:nn(p[0],p[1],h)}function rn(t){return function(t){var e=0,n=0,r=0;return tn(t).map((function(t){var i;if("M"===t[0])return e=t[1],n=t[2],0;var a=t.slice(1),o=a[0],s=a[1],u=a[2],c=a[3],l=a[4],h=a[5];return r=function(t,e,n,r,i,a,o,s){return 3*((s-e)*(n+i)-(o-t)*(r+a)+r*(t-i)-n*(e-a)+s*(i+t/3)-o*(a+e/3))/20}(e,n,o,s,u,c,l,h),i=t.slice(-2),e=i[0],n=i[1],r})).reduce((function(t,e){return t+e}),0)}(t)>=0}const an=function(t){return void 0===t};var on={}.toString;const sn=function(t,e){return on.call(t)==="[object "+e+"]"},un=function(t){return sn(t,"Boolean")};function cn(t){return"function"==typeof t}const ln=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function hn(){return hn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=E(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},hn.apply(null,arguments)}function dn(t,e,n,r){var i=hn(E(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof i?function(t){return i.apply(n,t)}:i}function fn(t,e,n,r){var i=t-n,a=e-r;return Math.sqrt(i*i+a*a)}function vn(t,e){var n=Math.min.apply(Math,me([],ye(t),!1)),r=Math.min.apply(Math,me([],ye(e),!1));return{x:n,y:r,width:Math.max.apply(Math,me([],ye(t),!1))-n,height:Math.max.apply(Math,me([],ye(e),!1))-r}}function pn(t,e,n,r,i,a){return n*Math.cos(i)*Math.cos(a)-r*Math.sin(i)*Math.sin(a)+t}function gn(t,e,n,r,i,a){return n*Math.sin(i)*Math.cos(a)+r*Math.cos(i)*Math.sin(a)+e}function yn(t,e,n,r,i,a,o){for(var s=function(t,e,n){return Math.atan(-e/t*Math.tan(n))}(n,r,i),u=1/0,c=-1/0,l=[a,o],h=2*-Math.PI;h<=2*Math.PI;h+=Math.PI){var d=s+h;a<o?a<d&&d<o&&l.push(d):o<d&&d<a&&l.push(d)}for(h=0;h<l.length;h++){var f=pn(t,0,n,r,i,l[h]);f<u&&(u=f),f>c&&(c=f)}var v=function(t,e,n){return Math.atan(e/(t*Math.tan(n)))}(n,r,i),p=1/0,g=-1/0,y=[a,o];for(h=2*-Math.PI;h<=2*Math.PI;h+=Math.PI){var m=v+h;a<o?a<m&&m<o&&y.push(m):o<m&&m<a&&y.push(m)}for(h=0;h<y.length;h++){var b=gn(0,e,n,r,i,y[h]);b<p&&(p=b),b>g&&(g=b)}return{x:u,y:p,width:c-u,height:g-p}}function mn(t,e,n,r,i,a){var o=-1,s=1/0,u=[n,r],c=20;a&&a>200&&(c=a/10);for(var l=1/c,h=l/10,d=0;d<=c;d++){var f=d*l,v=[i.apply(void 0,me([],ye(t.concat([f])),!1)),i.apply(void 0,me([],ye(e.concat([f])),!1))];(m=fn(u[0],u[1],v[0],v[1]))<s&&(o=f,s=m)}if(0===o)return{x:t[0],y:e[0]};if(1===o){var p=t.length;return{x:t[p-1],y:e[p-1]}}for(s=1/0,d=0;d<32&&!(h<1e-4);d++){var g=o-h,y=o+h,m=(v=[i.apply(void 0,me([],ye(t.concat([g])),!1)),i.apply(void 0,me([],ye(e.concat([g])),!1))],fn(u[0],u[1],v[0],v[1]));if(g>=0&&m<s)o=g,s=m;else{var b=[i.apply(void 0,me([],ye(t.concat([y])),!1)),i.apply(void 0,me([],ye(e.concat([y])),!1))],x=fn(u[0],u[1],b[0],b[1]);y<=1&&x<s?(o=y,s=x):h*=.5}}return{x:i.apply(void 0,me([],ye(t.concat([o])),!1)),y:i.apply(void 0,me([],ye(e.concat([o])),!1))}}function bn(t,e,n,r){return fn(t,e,n,r)}function xn(t,e,n,r,i){return{x:(1-i)*t+i*n,y:(1-i)*e+i*r}}function wn(t,e,n,r,i){var a=1-i;return a*a*a*t+3*e*i*a*a+3*n*i*i*a+r*i*i*i}function En(t,e,n,r){var i,a,o,s=-3*t+9*e-9*n+3*r,u=6*t-12*e+6*n,c=3*e-3*t,l=[];if(qe(s,0))qe(u,0)||(i=-c/u)>=0&&i<=1&&l.push(i);else{var h=u*u-4*s*c;qe(h,0)?l.push(-u/(2*s)):h>0&&(a=(-u-(o=Math.sqrt(h)))/(2*s),(i=(-u+o)/(2*s))>=0&&i<=1&&l.push(i),a>=0&&a<=1&&l.push(a))}return l}function kn(t,e,n,r,i,a,o,s){for(var u=[t,o],c=[e,s],l=En(t,n,i,o),h=En(e,r,a,s),d=0;d<l.length;d++)u.push(wn(t,n,i,o,l[d]));for(d=0;d<h.length;d++)c.push(wn(e,r,a,s,h[d]));return vn(u,c)}function Mn(t,e,n,r,i,a,o,s,u,c,l){var h=function(t,e,n,r,i,a,o,s,u,c,l){return mn([t,n,i,o],[e,r,a,s],u,c,wn,l)}(t,e,n,r,i,a,o,s,u,c,l);return fn(h.x,h.y,u,c)}function Sn(t,e,n,r){var i=1-r;return i*i*t+2*r*i*e+r*r*n}function On(t,e,n){var r=t+n-2*e;if(qe(r,0))return[.5];var i=(t-e)/r;return i<=1&&i>=0?[i]:[]}function Nn(t,e,n,r,i,a){var o=On(t,n,i)[0],s=On(e,r,a)[0],u=[t,i],c=[e,a];return void 0!==o&&u.push(Sn(t,n,i,o)),void 0!==s&&c.push(Sn(e,r,a,s)),vn(u,c)}function An(t,e,n,r,i,a,o,s){var u=function(t,e,n,r,i,a,o,s){return mn([t,n,i],[e,r,a],o,s,Sn)}(t,e,n,r,i,a,o,s);return fn(u.x,u.y,o,s)}function Tn(){Tn=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var a=e&&e.prototype instanceof m?e:m,o=Object.create(a.prototype),s=new C(r||[]);return i(o,"_invoke",{value:N(t,n,s)}),o}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",v="suspendedYield",p="executing",g="completed",y={};function m(){}function b(){}function x(){}var w={};c(w,o,(function(){return this}));var E=Object.getPrototypeOf,k=E&&E(E(R([])));k&&k!==n&&r.call(k,o)&&(w=k);var M=x.prototype=m.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function n(i,a,o,s){var u=h(t[i],t,a);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==d(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,o,s)}),(function(t){n("throw",t,o,s)})):e.resolve(l).then((function(t){c.value=t,o(c)}),(function(t){return n("throw",t,o,s)}))}s(u.arg)}var a;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return a=a?a.then(i,i):i()}})}function N(e,n,r){var i=f;return function(a,o){if(i===p)throw Error("Generator is already running");if(i===g){if("throw"===a)throw o;return{value:t,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var u=A(s,r);if(u){if(u===y)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(e,n,r);if("normal"===c.type){if(i=r.done?g:v,c.arg===y)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=g,r.method="throw",r.arg=c.arg)}}}function A(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,A(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var a=h(i,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var o=a.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function R(e){if(e||""===e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(d(e)+" is not iterable")}return b.prototype=x,i(M,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:b,configurable:!0}),b.displayName=c(x,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,c(t,u,"GeneratorFunction")),t.prototype=Object.create(M),t},e.awrap=function(t){return{__await:t}},S(O.prototype),c(O.prototype,s,(function(){return this})),e.AsyncIterator=O,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new O(l(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},S(M),c(M,u,"Generator"),c(M,o,(function(){return this})),c(M,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;P(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:R(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function Pn(t,e,n,r,i,a,o){try{var s=t[a](o),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function Cn(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){Pn(a,r,i,o,s,"next",t)}function s(t){Pn(a,r,i,o,s,"throw",t)}o(void 0)}))}}function Rn(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=c(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Ln(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(-1!==e.indexOf(r))continue;n[r]=t[r]}return n}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)n=a[r],-1===e.indexOf(n)&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==a.g?a.g:"undefined"!=typeof self&&self;var Dn={exports:{}};!function(t){t.exports=function(){function t(t,n,i,a,o){e(t,n,i||0,a||t.length-1,o||r)}function e(t,r,i,a,o){for(;a>i;){if(a-i>600){var s=a-i+1,u=r-i+1,c=Math.log(s),l=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*l*(s-l)/s)*(u-s/2<0?-1:1);e(t,r,Math.max(i,Math.floor(r-u*l/s+h)),Math.min(a,Math.floor(r+(s-u)*l/s+h)),o)}var d=t[r],f=i,v=a;for(n(t,i,r),o(t[a],d)>0&&n(t,i,a);f<v;){for(n(t,f,v),f++,v--;o(t[f],d)<0;)f++;for(;o(t[v],d)>0;)v--}0===o(t[i],d)?n(t,i,v):n(t,++v,a),v<=r&&(i=v+1),r<=v&&(a=v-1)}}function n(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function r(t,e){return t<e?-1:t>e?1:0}var i=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function a(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,r,i){i||(i=p(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var a=e;a<n;a++){var o=t.children[a];u(i,t.leaf?r(o):o)}return i}function u(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function c(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function d(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function v(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,n,r,i,a){for(var o=[n,r];o.length;)if(!((r=o.pop())-(n=o.pop())<=i)){var s=n+Math.ceil((r-n)/i/2)*i;t(e,s,n,r,a),o.push(n,s,s,r)}}return i.prototype.all=function(){return this._all(this.data,[])},i.prototype.search=function(t){var e=this.data,n=[];if(!v(t,e))return n;for(var r=this.toBBox,i=[];e;){for(var a=0;a<e.children.length;a++){var o=e.children[a],s=e.leaf?r(o):o;v(t,s)&&(e.leaf?n.push(o):f(t,s)?this._all(o,n):i.push(o))}e=i.pop()}return n},i.prototype.collides=function(t){var e=this.data;if(!v(t,e))return!1;for(var n=[];e;){for(var r=0;r<e.children.length;r++){var i=e.children[r],a=e.leaf?this.toBBox(i):i;if(v(t,a)){if(e.leaf||f(t,a))return!0;n.push(i)}}e=n.pop()}return!1},i.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},i.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},i.prototype.clear=function(){return this.data=p([]),this},i.prototype.remove=function(t,e){if(!t)return this;for(var n,r,i,o=this.data,s=this.toBBox(t),u=[],c=[];o||u.length;){if(o||(o=u.pop(),r=u[u.length-1],n=c.pop(),i=!0),o.leaf){var l=a(t,o.children,e);if(-1!==l)return o.children.splice(l,1),u.push(o),this._condense(u),this}i||o.leaf||!f(o,s)?r?(n++,o=r.children[n],i=!1):o=null:(u.push(o),c.push(n),n=0,r=o,o=o.children[0])}return this},i.prototype.toBBox=function(t){return t},i.prototype.compareMinX=function(t,e){return t.minX-e.minX},i.prototype.compareMinY=function(t,e){return t.minY-e.minY},i.prototype.toJSON=function(){return this.data},i.prototype.fromJSON=function(t){return this.data=t,this},i.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},i.prototype._build=function(t,e,n,r){var i,a=n-e+1,s=this._maxEntries;if(a<=s)return o(i=p(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,r-1))),(i=p([])).leaf=!1,i.height=r;var u=Math.ceil(a/s),c=u*Math.ceil(Math.sqrt(s));g(t,e,n,c,this.compareMinX);for(var l=e;l<=n;l+=c){var h=Math.min(l+c-1,n);g(t,l,h,u,this.compareMinY);for(var d=l;d<=h;d+=u){var f=Math.min(d+u-1,h);i.children.push(this._build(t,d,f,r-1))}}return o(i,this.toBBox),i},i.prototype._chooseSubtree=function(t,e,n,r){for(;r.push(e),!e.leaf&&r.length-1!==n;){for(var i=1/0,a=1/0,o=void 0,s=0;s<e.children.length;s++){var u=e.children[s],c=h(u),l=(d=t,f=u,(Math.max(f.maxX,d.maxX)-Math.min(f.minX,d.minX))*(Math.max(f.maxY,d.maxY)-Math.min(f.minY,d.minY))-c);l<a?(a=l,i=c<i?c:i,o=u):l===a&&c<i&&(i=c,o=u)}e=o||e.children[0]}var d,f;return e},i.prototype._insert=function(t,e,n){var r=n?t:this.toBBox(t),i=[],a=this._chooseSubtree(r,this.data,e,i);for(a.children.push(t),u(a,r);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(r,i,e)},i.prototype._split=function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var a=this._chooseSplitIndex(n,i,r),s=p(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,o(n,this.toBBox),o(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},i.prototype._splitRoot=function(t,e){this.data=p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},i.prototype._chooseSplitIndex=function(t,e,n){for(var r,i=1/0,a=1/0,o=e;o<=n-e;o++){var u=s(t,0,o,this.toBBox),c=s(t,o,n,this.toBBox),l=(f=u,v=c,p=void 0,g=void 0,y=void 0,m=void 0,p=Math.max(f.minX,v.minX),g=Math.max(f.minY,v.minY),y=Math.min(f.maxX,v.maxX),m=Math.min(f.maxY,v.maxY),Math.max(0,y-p)*Math.max(0,m-g)),d=h(u)+h(c);l<i?(i=l,r=o,a=d<a?d:a):l===i&&d<a&&(a=d,r=o)}var f,v,p,g,y,m;return r||n-e},i.prototype._chooseSplitAxis=function(t,e,n){var r=t.leaf?this.compareMinX:c,i=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},i.prototype._allDistMargin=function(t,e,n,r){t.children.sort(r);for(var i=this.toBBox,a=s(t,0,e,i),o=s(t,n-e,n,i),c=d(a)+d(o),l=e;l<n-e;l++){var h=t.children[l];u(a,t.leaf?i(h):h),c+=d(a)}for(var f=n-e-1;f>=e;f--){var v=t.children[f];u(o,t.leaf?i(v):v),c+=d(o)}return c},i.prototype._adjustParentBBoxes=function(t,e,n){for(var r=n;r>=0;r--)u(e[r],t)},i.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},i}()}(Dn);var _n=Dn.exports,In=function(t){return t.GROUP="g",t.FRAGMENT="fragment",t.CIRCLE="circle",t.ELLIPSE="ellipse",t.IMAGE="image",t.RECT="rect",t.LINE="line",t.POLYLINE="polyline",t.POLYGON="polygon",t.TEXT="text",t.PATH="path",t.HTML="html",t.MESH="mesh",t}({}),jn=function(t){return t[t.ZERO=0]="ZERO",t[t.NEGATIVE_ONE=1]="NEGATIVE_ONE",t}({}),Fn=function(){return b((function t(){y(this,t),this.plugins=[]}),[{key:"addRenderingPlugin",value:function(t){this.plugins.push(t),this.context.renderingPlugins.push(t)}},{key:"removeAllRenderingPlugins",value:function(){var t=this;this.plugins.forEach((function(e){var n=t.context.renderingPlugins.indexOf(e);n>=0&&t.context.renderingPlugins.splice(n,1)}))}}])}(),Bn=function(){return b((function t(e){y(this,t),this.clipSpaceNearZ=jn.NEGATIVE_ONE,this.plugins=[],this.config=g({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0,enableRenderingOptimization:!1},e)}),[{key:"registerPlugin",value:function(t){-1===this.plugins.findIndex((function(e){return e===t}))&&this.plugins.push(t)}},{key:"unregisterPlugin",value:function(t){var e=this.plugins.findIndex((function(e){return e===t}));e>-1&&this.plugins.splice(e,1)}},{key:"getPlugins",value:function(){return this.plugins}},{key:"getPlugin",value:function(t){return this.plugins.find((function(e){return e.name===t}))}},{key:"getConfig",value:function(){return this.config}},{key:"setConfig",value:function(t){Object.assign(this.config,t)}}])}(),zn=j,Gn=_,Vn=B,Wn=Y,Hn=function(){function t(){y(this,t),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return b(t,[{key:"update",value:function(t,e){Gn(this.center,t),Gn(this.halfExtents,e),Wn(this.min,this.center,this.halfExtents),zn(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(t,e){zn(this.center,e,t),Vn(this.center,this.center,.5),Wn(this.halfExtents,e,t),Vn(this.halfExtents,this.halfExtents,.5),Gn(this.min,t),Gn(this.max,e)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(e){if(!t.isEmpty(e))if(t.isEmpty(this))this.setMinMax(e.getMin(),e.getMax());else{var n=this.center,r=n[0],i=n[1],a=n[2],o=this.halfExtents,s=o[0],u=o[1],c=o[2],l=r-s,h=r+s,d=i-u,f=i+u,v=a-c,p=a+c,g=e.center,y=g[0],m=g[1],b=g[2],x=e.halfExtents,w=x[0],E=x[1],k=x[2],M=y-w,S=y+w,O=m-E,N=m+E,A=b-k,T=b+k;M<l&&(l=M),S>h&&(h=S),O<d&&(d=O),N>f&&(f=N),A<v&&(v=A),T>p&&(p=T),n[0]=.5*(l+h),n[1]=.5*(d+f),n[2]=.5*(v+p),o[0]=.5*(h-l),o[1]=.5*(f-d),o[2]=.5*(p-v),this.min[0]=l,this.min[1]=d,this.min[2]=v,this.max[0]=h,this.max[1]=f,this.max[2]=p}}},{key:"setFromTransformedAABB",value:function(t,e){var n=this.center,r=this.halfExtents,i=t.center,a=t.halfExtents,o=e[0],s=e[4],u=e[8],c=e[1],l=e[5],h=e[9],d=e[2],f=e[6],v=e[10],p=Math.abs(o),g=Math.abs(s),y=Math.abs(u),m=Math.abs(c),b=Math.abs(l),x=Math.abs(h),w=Math.abs(d),E=Math.abs(f),k=Math.abs(v);n[0]=e[12]+o*i[0]+s*i[1]+u*i[2],n[1]=e[13]+c*i[0]+l*i[1]+h*i[2],n[2]=e[14]+d*i[0]+f*i[1]+v*i[2],r[0]=p*a[0]+g*a[1]+y*a[2],r[1]=m*a[0]+b*a[1]+x*a[2],r[2]=w*a[0]+E*a[1]+k*a[2],Wn(this.min,n,r),zn(this.max,n,r)}},{key:"intersects",value:function(t){var e=this.getMax(),n=this.getMin(),r=t.getMax(),i=t.getMin();return n[0]<=r[0]&&e[0]>=i[0]&&n[1]<=r[1]&&e[1]>=i[1]&&n[2]<=r[2]&&e[2]>=i[2]}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var n,r,i,a=new t,o=(n=[0,0,0],r=this.getMin(),i=e.getMin(),n[0]=Math.max(r[0],i[0]),n[1]=Math.max(r[1],i[1]),n[2]=Math.max(r[2],i[2]),n),s=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}([0,0,0],this.getMax(),e.getMax());return a.setMinMax(o,s),a}},{key:"getNegativeFarPoint",value:function(t){return 273===t.pnVertexFlag?Gn([0,0,0],this.min):272===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:257===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:256===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:17===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:16===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:1===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]}},{key:"getPositiveFarPoint",value:function(t){return 273===t.pnVertexFlag?Gn([0,0,0],this.max):272===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:257===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:256===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:17===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:16===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:1===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]}}],[{key:"isEmpty",value:function(t){return!t||0===t.halfExtents[0]&&0===t.halfExtents[1]&&0===t.halfExtents[2]}}])}(),Yn=function(){return b((function t(e,n){y(this,t),this.distance=e||0,this.normal=n||D(0,1,0),this.updatePNVertexFlag()}),[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(t){return G(t,this.normal)-this.distance}},{key:"normalize",value:function(){var t=1/q(this.normal);B(this.normal,this.normal,t),this.distance*=t}},{key:"intersectsLine",value:function(t,e,n){var r=this.distanceToPoint(t),i=r/(r-this.distanceToPoint(e)),a=i>=0&&i<=1;return a&&n&&V(n,t,e,i),a}}])}(),Un=function(t){return t[t.OUTSIDE=4294967295]="OUTSIDE",t[t.INSIDE=0]="INSIDE",t[t.INDETERMINATE=2147483647]="INDETERMINATE",t}({}),qn=function(){return b((function t(e){if(y(this,t),this.planes=[],e)this.planes=e;else for(var n=0;n<6;n++)this.planes.push(new Yn)}),[{key:"extractFromVPMatrix",value:function(t){var e=h(t,16),n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],d=e[9],f=e[10],v=e[11],p=e[12],g=e[13],y=e[14],m=e[15];I(this.planes[0].normal,a-n,c-o,v-l),this.planes[0].distance=m-p,I(this.planes[1].normal,a+n,c+o,v+l),this.planes[1].distance=m+p,I(this.planes[2].normal,a+r,c+s,v+d),this.planes[2].distance=m+g,I(this.planes[3].normal,a-r,c-s,v-d),this.planes[3].distance=m-g,I(this.planes[4].normal,a-i,c-u,v-f),this.planes[4].distance=m-y,I(this.planes[5].normal,a+i,c+u,v+f),this.planes[5].distance=m+y,this.planes.forEach((function(t){t.normalize(),t.updatePNVertexFlag()}))}}])}(),Xn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;y(this,t),this.x=0,this.y=0,this.x=e,this.y=n}return b(t,[{key:"clone",value:function(){return new t(this.x,this.y)}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y}}])}(),Kn=function(){function t(e,n,r,i){y(this,t),this.x=e,this.y=n,this.width=r,this.height=i,this.left=e,this.right=e+r,this.top=n,this.bottom=n+i}return b(t,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new t(e.x,e.y,e.width,e.height)}},{key:"applyTransform",value:function(e,n){var r=K(e.x,e.y,0,1),i=K(e.x+e.width,e.y,0,1),a=K(e.x,e.y+e.height,0,1),o=K(e.x+e.width,e.y+e.height,0,1),s=X(),u=X(),c=X(),l=X();$(s,r,n),$(u,i,n),$(c,a,n),$(l,o,n);var h=Math.min(s[0],u[0],c[0],l[0]),d=Math.min(s[1],u[1],c[1],l[1]),f=Math.max(s[0],u[0],c[0],l[0]),v=Math.max(s[1],u[1],c[1],l[1]);return t.fromRect({x:h,y:d,width:f-h,height:v-d})}}])}(),$n="Method not implemented.",Zn="Use document.documentElement instead.";function Qn(t){return void 0===t?0:t>360||t<-360?t%360:t}var Jn=C();function tr(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return Array.isArray(t)&&3===t.length?r?R(t):_(Jn,t):oe(t)?r?D(t,e,n):I(Jn,t,e,n):r?D(t[0],t[1]||e,t[2]||n):I(Jn,t[0],t[1]||e,t[2]||n)}var er=Math.PI/180;function nr(t){return t*er}var rr=180/Math.PI;function ir(t){return t*rr}var ar=Math.PI/2;function or(t,e){return 16===e.length?function(t,e){var n,r,i=h(kt(C(),e),3),a=i[0],o=i[1],s=i[2],u=Math.asin(-e[2]/a);return u<ar?u>-ar?(n=Math.atan2(e[6]/o,e[10]/s),r=Math.atan2(e[1]/a,e[0]/a)):(r=0,n=-Math.atan2(e[4]/o,e[5]/o)):(r=0,n=Math.atan2(e[4]/o,e[5]/o)),t[0]=n,t[1]=u,t[2]=r,t}(t,e):function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=r*r,s=i*i,u=a*a,c=n*n+o+s+u,l=n*a-r*i;return l>.499995*c?(t[0]=ar,t[1]=2*Math.atan2(r,n),t[2]=0):l<-.499995*c?(t[0]=-ar,t[1]=2*Math.atan2(r,n),t[2]=0):(t[0]=Math.asin(2*(n*i-a*r)),t[1]=Math.atan2(2*(n*a+r*i),1-2*(s+u)),t[2]=Math.atan2(2*(n*r+i*a),1-2*(o+s))),t}(t,e)}function sr(t){var e=t[0],n=t[1],r=t[3],i=t[4],a=Math.sqrt(e*e+n*n),o=Math.sqrt(r*r+i*i);if(e*i-n*r<0&&(e<i?a=-a:o=-o),a){var s=1/a;e*=s,n*=s}if(o){var u=1/o;r*=u,i*=u}var c=ir(Math.atan2(n,e));return[t[6],t[7],a,o,c]}var ur=Z(),cr=Z(),lr=X(),hr=[C(),C(),C()],dr=C();function fr(t,e,n,r,i){t[0]=e[0]*r+n[0]*i,t[1]=e[1]*r+n[1]*i,t[2]=e[2]*r+n[2]*i}var vr=function(t){return t[t.ORBITING=0]="ORBITING",t[t.EXPLORING=1]="EXPLORING",t[t.TRACKING=2]="TRACKING",t}({}),pr=function(t){return t[t.DEFAULT=0]="DEFAULT",t[t.ROTATIONAL=1]="ROTATIONAL",t[t.TRANSLATIONAL=2]="TRANSLATIONAL",t[t.CINEMATIC=3]="CINEMATIC",t}({}),gr=function(t){return t[t.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",t[t.PERSPECTIVE=1]="PERSPECTIVE",t}({}),yr="updated",mr=2e-4,br=function(){return b((function t(){y(this,t),this.clipSpaceNearZ=jn.NEGATIVE_ONE,this.eventEmitter=new A,this.matrix=Z(),this.right=D(1,0,0),this.up=D(0,1,0),this.forward=D(0,0,1),this.position=D(0,0,1),this.focalPoint=D(0,0,0),this.distanceVector=D(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=Z(),this.projectionMatrixInverse=Z(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=vr.EXPLORING,this.trackingMode=pr.DEFAULT,this.projectionMode=gr.PERSPECTIVE,this.frustum=new qn,this.orthoMatrix=Z()}),[{key:"isOrtho",value:function(){return this.projectionMode===gr.ORTHOGRAPHIC}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getDollyingStep",value:function(){return this.dollyingStep}},{key:"getNear",value:function(){return this.near}},{key:"getFar",value:function(){return this.far}},{key:"getZoom",value:function(){return this.zoom}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix}},{key:"getView",value:function(){return this.view}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t}},{key:"setType",value:function(t,e){return this.type=t,this.type===vr.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===vr.TRACKING&&void 0!==e&&this.setTrackingMode(e),this}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this}},{key:"setTrackingMode",value:function(t){if(this.type!==vr.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this}},{key:"getViewTransform",value:function(){return it(Z(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"jitterProjectionMatrix",value:function(t,e){var n=vt(Z(),[t,e,0]);this.jitteredProjectionMatrix=st(Z(),n,this.projectionMatrix)}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this}},{key:"setProjectionMatrix",value:function(t){this.projectionMatrix=t}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this}},{key:"setNear",value:function(t){return this.projectionMode===gr.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this}},{key:"setFar",value:function(t){return this.projectionMode===gr.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this}},{key:"setViewOffset",value:function(t,e,n,r,i,a){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.projectionMode===gr.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===gr.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===gr.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===gr.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this}},{key:"setZoomByViewportPoint",value:function(t,e){var n=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),r=n.x,i=n.y,a=this.roll;this.rotate(0,0,-a),this.setPosition(r,i),this.setFocalPoint(r,i),this.setZoom(t),this.rotate(0,0,a);var o=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),s=D(o.x-r,o.y-i,0),u=G(s,this.right)/L(this.right),c=G(s,this.up)/L(this.up),l=h(this.getPosition(),2),d=l[0],f=l[1],v=h(this.getFocalPoint(),2),p=v[0],g=v[1];return this.setPosition(d-u,f-c),this.setFocalPoint(p-u,g-c),this}},{key:"setPerspective",value:function(t,e,n,r){var i;this.projectionMode=gr.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=r;var a=this.near*Math.tan(nr(.5*this.fov))/this.zoom,o=2*a,s=this.aspect*o,u=-.5*s;if(null!==(i=this.view)&&void 0!==i&&i.enabled){var c=this.view.fullWidth,l=this.view.fullHeight;u+=this.view.offsetX*s/c,a-=this.view.offsetY*o/l,s*=this.view.width/c,o*=this.view.height/l}return function(t,e,n,r,i,a,o){var s,u,c=2*a,l=n-e,h=r-i,d=c/l,f=c/h,v=(n+e)/l,p=(r+i)/h,g=o-a,y=o*a;arguments.length>7&&void 0!==arguments[7]&&arguments[7]?(s=-o/g,u=-y/g):(s=-(o+a)/g,u=-2*y/g),t[0]=d,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=f,t[6]=0,t[7]=0,t[8]=v,t[9]=p,t[10]=s,t[11]=-1,t[12]=0,t[13]=0,t[14]=u,t[15]=0}(this.projectionMatrix,u,u+s,a-o,a,t,this.far,this.clipSpaceNearZ===jn.ZERO),it(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this}},{key:"setOrthographic",value:function(t,e,n,r,i,a){var o;this.projectionMode=gr.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=r,this.near=i,this.far=a;var s=(this.rright-this.left)/(2*this.zoom),u=(this.top-this.bottom)/(2*this.zoom),c=(this.rright+this.left)/2,l=(this.top+this.bottom)/2,h=c-s,d=c+s,f=l+u,v=l-u;if(null!==(o=this.view)&&void 0!==o&&o.enabled){var p=(this.rright-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;d=(h+=p*this.view.offsetX)+p*this.view.width,v=(f-=g*this.view.offsetY)-g*this.view.height}return this.clipSpaceNearZ===jn.NEGATIVE_ONE?Dt(this.projectionMatrix,h,d,f,v,i,a):_t(this.projectionMatrix,h,d,f,v,i,a),it(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this}},{key:"setPosition",value:function(t){var e=tr(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position[2]);return this._setPosition(e),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this}},{key:"setFocalPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focalPoint[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.focalPoint[2],r=D(0,1,0);if(this.focalPoint=tr(t,e,n),this.trackingMode===pr.CINEMATIC){var i=F(C(),this.focalPoint,this.position);t=i[0],e=i[1],n=i[2];var a=L(i),o=ir(Math.asin(e/a)),s=90+ir(Math.atan2(n,t)),u=Z();dt(u,u,nr(s)),ht(u,u,nr(o)),r=W(C(),[0,1,0],u)}return it(this.matrix,It(Z(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this}},{key:"getDistance",value:function(){return this.distance}},{key:"getDistanceVector",value:function(){return this.distanceVector}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<mr&&(this.distance=mr),this.dollyingStep=this.distance/100;var e=C();t=this.distance;var n=this.forward,r=this.focalPoint;return e[0]=t*n[0]+r[0],e[1]=t*n[1]+r[1],e[2]=t*n[2]+r[2],this._setPosition(e),this.triggerUpdate(),this}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this}},{key:"setAzimuth",value:function(t){return this.azimuth=Qn(t),this.computeMatrix(),this._getAxes(),this.type===vr.ORBITING||this.type===vr.EXPLORING?this._getPosition():this.type===vr.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(t){return this.elevation=Qn(t),this.computeMatrix(),this._getAxes(),this.type===vr.ORBITING||this.type===vr.EXPLORING?this._getPosition():this.type===vr.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getElevation",value:function(){return this.elevation}},{key:"setRoll",value:function(t){return this.roll=Qn(t),this.computeMatrix(),this._getAxes(),this.type===vr.ORBITING||this.type===vr.EXPLORING?this._getPosition():this.type===vr.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getRoll",value:function(){return this.roll}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()}},{key:"computeMatrix",value:function(){var t=$t(Kt(),[0,0,1],nr(this.roll));nt(this.matrix);var e=$t(Kt(),[1,0,0],nr((this.rotateWorld&&this.type!==vr.TRACKING||this.type===vr.TRACKING?1:-1)*this.elevation)),n=$t(Kt(),[0,1,0],nr((this.rotateWorld&&this.type!==vr.TRACKING||this.type===vr.TRACKING?1:-1)*this.azimuth)),r=Zt(Kt(),n,e);r=Zt(Kt(),r,t);var i=Nt(Z(),r);this.type===vr.ORBITING||this.type===vr.EXPLORING?(ut(this.matrix,this.matrix,this.focalPoint),st(this.matrix,this.matrix,i),ut(this.matrix,this.matrix,[0,0,this.distance])):this.type===vr.TRACKING&&(ut(this.matrix,this.matrix,this.position),st(this.matrix,this.matrix,i))}},{key:"_setPosition",value:function(t,e,n){this.position=tr(t,e,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1,this._getOrthoMatrix()}},{key:"_getAxes",value:function(){_(this.right,tr($(X(),[1,0,0,0],this.matrix))),_(this.up,tr($(X(),[0,1,0,0],this.matrix))),_(this.forward,tr($(X(),[0,0,1,0],this.matrix))),z(this.right,this.right),z(this.up,this.up),z(this.forward,this.forward)}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],r=L(this.distanceVector);if(0===r)return this.elevation=0,void(this.azimuth=0);this.type===vr.TRACKING||this.rotateWorld?(this.elevation=ir(Math.asin(e/r)),this.azimuth=ir(Math.atan2(-t,-n))):(this.elevation=-ir(Math.asin(e/r)),this.azimuth=-ir(Math.atan2(-t,-n)))}},{key:"_getPosition",value:function(){_(this.position,tr($(X(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){var t,e;!function(t,e,n){var r=e[0],i=e[1],a=e[2];t[0]=r*n[0]+i*n[3]+a*n[6],t[1]=r*n[1]+i*n[4]+a*n[7],t[2]=r*n[2]+i*n[5]+a*n[8]}(this.distanceVector,[0,0,-this.distance],(t=Xt(),e=this.matrix,t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t)),j(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=F(C(),this.focalPoint,this.position),this.distance=L(this.distanceVector),this.dollyingStep=this.distance/100}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===gr.ORTHOGRAPHIC){var t=this.position,e=$t(Kt(),[0,0,1],-this.roll*Math.PI/180);Ot(this.orthoMatrix,e,D((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),D(this.zoom,this.zoom,1),t)}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var t=this.getViewTransform(),e=st(Z(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit(yr)}}},{key:"rotate",value:function(t,e,n){throw new Error($n)}},{key:"pan",value:function(t,e){throw new Error($n)}},{key:"dolly",value:function(t){throw new Error($n)}},{key:"createLandmark",value:function(t,e){throw new Error($n)}},{key:"gotoLandmark",value:function(t,e){throw new Error($n)}},{key:"cancelLandmarkAnimation",value:function(){throw new Error($n)}}])}(),xr=function(t){return t[t.Standard=0]="Standard",t}({}),wr=function(t){return t[t.ADDED=0]="ADDED",t[t.REMOVED=1]="REMOVED",t[t.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",t}({}),Er={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Kn(0,0,0,0)},kr=function(t){return t.COORDINATE="<coordinate>",t.COLOR="<color>",t.PAINT="<paint>",t.NUMBER="<number>",t.ANGLE="<angle>",t.OPACITY_VALUE="<opacity-value>",t.SHADOW_BLUR="<shadow-blur>",t.LENGTH="<length>",t.PERCENTAGE="<percentage>",t.LENGTH_PERCENTAGE="<length> | <percentage>",t.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",t.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",t.LIST_OF_POINTS="<list-of-points>",t.PATH="<path>",t.FILTER="<filter>",t.Z_INDEX="<z-index>",t.OFFSET_DISTANCE="<offset-distance>",t.DEFINED_PATH="<defined-path>",t.MARKER="<marker>",t.TRANSFORM="<transform>",t.TRANSFORM_ORIGIN="<transform-origin>",t.TEXT="<text>",t.TEXT_TRANSFORM="<text-transform>",t}({});function Mr(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Sr(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Or(){}var Nr=.7,Ar=1/Nr,Tr="\\s*([+-]?\\d+)\\s*",Pr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Cr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Rr=/^#([0-9a-f]{3,8})$/,Lr=new RegExp("^rgb\\(".concat(Tr,",").concat(Tr,",").concat(Tr,"\\)$")),Dr=new RegExp("^rgb\\(".concat(Cr,",").concat(Cr,",").concat(Cr,"\\)$")),_r=new RegExp("^rgba\\(".concat(Tr,",").concat(Tr,",").concat(Tr,",").concat(Pr,"\\)$")),Ir=new RegExp("^rgba\\(".concat(Cr,",").concat(Cr,",").concat(Cr,",").concat(Pr,"\\)$")),jr=new RegExp("^hsl\\(".concat(Pr,",").concat(Cr,",").concat(Cr,"\\)$")),Fr=new RegExp("^hsla\\(".concat(Pr,",").concat(Cr,",").concat(Cr,",").concat(Pr,"\\)$")),Br={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function zr(){return this.rgb().formatHex()}function Gr(){return this.rgb().formatRgb()}function Vr(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Rr.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Wr(e):3===n?new Yr(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Hr(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Hr(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Lr.exec(t))?new Yr(e[1],e[2],e[3],1):(e=Dr.exec(t))?new Yr(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=_r.exec(t))?Hr(e[1],e[2],e[3],e[4]):(e=Ir.exec(t))?Hr(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=jr.exec(t))?Zr(e[1],e[2]/100,e[3]/100,1):(e=Fr.exec(t))?Zr(e[1],e[2]/100,e[3]/100,e[4]):Br.hasOwnProperty(t)?Wr(Br[t]):"transparent"===t?new Yr(NaN,NaN,NaN,0):null}function Wr(t){return new Yr(t>>16&255,t>>8&255,255&t,1)}function Hr(t,e,n,r){return r<=0&&(t=e=n=NaN),new Yr(t,e,n,r)}function Yr(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Ur(){return"#".concat($r(this.r)).concat($r(this.g)).concat($r(this.b))}function qr(){var t=Xr(this.opacity);return"".concat(1===t?"rgb(":"rgba(").concat(Kr(this.r),", ").concat(Kr(this.g),", ").concat(Kr(this.b)).concat(1===t?")":", ".concat(t,")"))}function Xr(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Kr(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function $r(t){return((t=Kr(t))<16?"0":"")+t.toString(16)}function Zr(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Jr(t,e,n,r)}function Qr(t){if(t instanceof Jr)return new Jr(t.h,t.s,t.l,t.opacity);if(t instanceof Or||(t=Vr(t)),!t)return new Jr;if(t instanceof Jr)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,u=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new Jr(o,s,u,t.opacity)}function Jr(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function ti(t){return(t=(t||0)%360)<0?t+360:t}function ei(t){return Math.max(0,Math.min(1,t||0))}function ni(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function ri(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];var o=e?e.apply(this,i):i[0],s=n.cache;if(s.has(o))return s.get(o);var u=t.apply(this,i);return n.cache=s.set(o,u)||s,u};return n.cache=new(ri.Cache||Map),ri.cacheList.push(n.cache),n}Mr(Or,Vr,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:zr,formatHex:zr,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Qr(this).formatHsl()},formatRgb:Gr,toString:Gr}),Mr(Yr,(function(t,e,n,r){return 1===arguments.length?((i=t)instanceof Or||(i=Vr(i)),i?new Yr((i=i.rgb()).r,i.g,i.b,i.opacity):new Yr):new Yr(t,e,n,null==r?1:r);var i}),Sr(Or,{brighter:function(t){return t=null==t?Ar:Math.pow(Ar,t),new Yr(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Nr:Math.pow(Nr,t),new Yr(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},clamp:function(){return new Yr(Kr(this.r),Kr(this.g),Kr(this.b),Xr(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ur,formatHex:Ur,formatHex8:function(){return"#".concat($r(this.r)).concat($r(this.g)).concat($r(this.b)).concat($r(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:qr,toString:qr})),Mr(Jr,(function(t,e,n,r){return 1===arguments.length?Qr(t):new Jr(t,e,n,null==r?1:r)}),Sr(Or,{brighter:function(t){return t=null==t?Ar:Math.pow(Ar,t),new Jr(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Nr:Math.pow(Nr,t),new Jr(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Yr(ni(t>=240?t-240:t+120,i,r),ni(t,i,r),ni(t<120?t+240:t-120,i,r),this.opacity)},clamp:function(){return new Jr(ti(this.h),ei(this.s),ei(this.l),Xr(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=Xr(this.opacity);return"".concat(1===t?"hsl(":"hsla(").concat(ti(this.h),", ").concat(100*ei(this.s),"%, ").concat(100*ei(this.l),"%").concat(1===t?")":", ".concat(t,")"))}})),ri.Cache=Map,ri.cacheList=[],ri.clearCache=function(){ri.cacheList.forEach((function(t){return t.clear()}))};var ii=function(t){return t[t.kUnknown=0]="kUnknown",t[t.kNumber=1]="kNumber",t[t.kPercentage=2]="kPercentage",t[t.kEms=3]="kEms",t[t.kPixels=4]="kPixels",t[t.kRems=5]="kRems",t[t.kDegrees=6]="kDegrees",t[t.kRadians=7]="kRadians",t[t.kGradians=8]="kGradians",t[t.kTurns=9]="kTurns",t[t.kMilliseconds=10]="kMilliseconds",t[t.kSeconds=11]="kSeconds",t[t.kInteger=12]="kInteger",t}({}),ai=function(t){return t[t.kUNumber=0]="kUNumber",t[t.kUPercent=1]="kUPercent",t[t.kULength=2]="kULength",t[t.kUAngle=3]="kUAngle",t[t.kUTime=4]="kUTime",t[t.kUOther=5]="kUOther",t}({}),oi=function(t){return t[t.kYes=0]="kYes",t[t.kNo=1]="kNo",t}({}),si=function(t){return t[t.kYes=0]="kYes",t[t.kNo=1]="kNo",t}({}),ui=[{name:"em",unit_type:ii.kEms},{name:"px",unit_type:ii.kPixels},{name:"deg",unit_type:ii.kDegrees},{name:"rad",unit_type:ii.kRadians},{name:"grad",unit_type:ii.kGradians},{name:"ms",unit_type:ii.kMilliseconds},{name:"s",unit_type:ii.kSeconds},{name:"rem",unit_type:ii.kRems},{name:"turn",unit_type:ii.kTurns}],ci=function(t){return t[t.kUnknownType=0]="kUnknownType",t[t.kUnparsedType=1]="kUnparsedType",t[t.kKeywordType=2]="kKeywordType",t[t.kUnitType=3]="kUnitType",t[t.kSumType=4]="kSumType",t[t.kProductType=5]="kProductType",t[t.kNegateType=6]="kNegateType",t[t.kInvertType=7]="kInvertType",t[t.kMinType=8]="kMinType",t[t.kMaxType=9]="kMaxType",t[t.kClampType=10]="kClampType",t[t.kTransformType=11]="kTransformType",t[t.kPositionType=12]="kPositionType",t[t.kURLImageType=13]="kURLImageType",t[t.kColorType=14]="kColorType",t[t.kUnsupportedColorType=15]="kUnsupportedColorType",t}({}),li=function(t){var e=1;switch(t){case ii.kPixels:case ii.kDegrees:case ii.kSeconds:break;case ii.kMilliseconds:e=.001;break;case ii.kRadians:e=180/Math.PI;break;case ii.kGradians:e=.9;break;case ii.kTurns:e=360}return e},hi=function(t){switch(t){case ii.kNumber:case ii.kInteger:return"";case ii.kPercentage:return"%";case ii.kEms:return"em";case ii.kRems:return"rem";case ii.kPixels:return"px";case ii.kDegrees:return"deg";case ii.kRadians:return"rad";case ii.kGradians:return"grad";case ii.kMilliseconds:return"ms";case ii.kSeconds:return"s";case ii.kTurns:return"turn"}return""},di=function(){return b((function t(){y(this,t)}),[{key:"toString",value:function(){return this.buildCSSText(oi.kNo,si.kNo,"")}},{key:"isNumericValue",value:function(){return this.getType()>=ci.kUnitType&&this.getType()<=ci.kClampType}}],[{key:"isAngle",value:function(t){return t===ii.kDegrees||t===ii.kRadians||t===ii.kGradians||t===ii.kTurns}},{key:"isLength",value:function(t){return t>=ii.kEms&&t<ii.kDegrees}},{key:"isRelativeUnit",value:function(t){return t===ii.kPercentage||t===ii.kEms||t===ii.kRems}},{key:"isTime",value:function(t){return t===ii.kSeconds||t===ii.kMilliseconds}}])}(),fi=function(t){function e(t){var n;return y(this,e),(n=S(this,e)).colorSpace=t,n}return N(e,t),b(e,[{key:"getType",value:function(){return ci.kColorType}},{key:"to",value:function(t){return this}}])}(di),vi=function(t){return t[t.Constant=0]="Constant",t[t.LinearGradient=1]="LinearGradient",t[t.RadialGradient=2]="RadialGradient",t}({}),pi=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e)).type=t,r.value=n,r}return N(e,t),b(e,[{key:"clone",value:function(){return new e(this.type,this.value)}},{key:"buildCSSText",value:function(t,e,n){return n}},{key:"getType",value:function(){return ci.kColorType}}])}(di),gi=function(t){function e(t){var n;return y(this,e),(n=S(this,e)).value=t,n}return N(e,t),b(e,[{key:"clone",value:function(){return new e(this.value)}},{key:"getType",value:function(){return ci.kKeywordType}},{key:"buildCSSText",value:function(t,e,n){return n+this.value}}])}(di),yi=function(t){return function(t){switch(t){case ai.kUNumber:return ii.kNumber;case ai.kULength:return ii.kPixels;case ai.kUPercent:return ii.kPercentage;case ai.kUTime:return ii.kSeconds;case ai.kUAngle:return ii.kDegrees;default:return ii.kUnknown}}(function(t){switch(t){case ii.kNumber:case ii.kInteger:return ai.kUNumber;case ii.kPercentage:return ai.kUPercent;case ii.kPixels:return ai.kULength;case ii.kMilliseconds:case ii.kSeconds:return ai.kUTime;case ii.kDegrees:case ii.kRadians:case ii.kGradians:case ii.kTurns:return ai.kUAngle;default:return ai.kUOther}}(t))},mi=function(t){function e(t){var n,r,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ii.kNumber;return y(this,e),n=S(this,e),r="string"==typeof a?(i=a)?"number"===i?ii.kNumber:"percent"===i||"%"===i?ii.kPercentage:function(t){return ui.find((function(e){return e.name===t})).unit_type}(i):ii.kUnknown:a,n.unit=r,n.value=t,n}return N(e,t),b(e,[{key:"clone",value:function(){return new e(this.value,this.unit)}},{key:"equals",value:function(t){var e=t;return this.value===e.value&&this.unit===e.unit}},{key:"getType",value:function(){return ci.kUnitType}},{key:"convertTo",value:function(t){if(this.unit===t)return new e(this.value,this.unit);var n=yi(this.unit);if(n!==yi(t)||n===ii.kUnknown)return null;var r=li(this.unit)/li(t);return new e(this.value*r,t)}},{key:"buildCSSText",value:function(t,e,n){var r;switch(this.unit){case ii.kUnknown:break;case ii.kInteger:r=Number(this.value).toFixed(0);break;case ii.kNumber:case ii.kPercentage:case ii.kEms:case ii.kRems:case ii.kPixels:case ii.kDegrees:case ii.kRadians:case ii.kGradians:case ii.kMilliseconds:case ii.kSeconds:case ii.kTurns:var i=this.value,a=hi(this.unit);if(i<-999999||i>999999){var o=hi(this.unit);r=!Number.isFinite(i)||Number.isNaN(i)?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(t)?"NaN":t>0?"infinity":"-infinity")+e}(i,o):i+(o||"")}else r="".concat(i).concat(a)}return n+r}}])}(di),bi=new mi(0,"px");new mi(1,"px");var xi=new mi(0,"deg"),wi=function(t){function e(t,n,r){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return y(this,e),(i=S(this,e,["rgb"])).r=t,i.g=n,i.b=r,i.alpha=a,i.isNone=o,i}return N(e,t),b(e,[{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.alpha)}},{key:"buildCSSText",value:function(t,e,n){return"".concat(n,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")}}])}(fi),Ei=new gi("unset"),ki={"":Ei,unset:Ei,initial:new gi("initial"),inherit:new gi("inherit")},Mi=new wi(0,0,0,0,!0),Si=new wi(0,0,0,0),Oi=ri((function(t,e,n,r){return new wi(t,e,n,r)}),(function(t,e,n,r){return"rgba(".concat(t,",").concat(e,",").concat(n,",").concat(r,")")})),Ni=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ii.kNumber;return new mi(t,e)};function Ai(t){var e=t.type,n=t.value;return"hex"===e?"#".concat(n):"literal"===e?n:"rgb"===e?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")")}new mi(50,"%");var Ti=function(){var t=/^(linear\-gradient)/i,e=/^(repeating\-linear\-gradient)/i,n=/^(radial\-gradient)/i,r=/^(repeating\-radial\-gradient)/i,i=/^(conic\-gradient)/i,a=/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,o=/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,s=/^(left|center|right|top|bottom)/i,u=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,c=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,l=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,h=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,d=/^\(/,f=/^\)/,v=/^,/,p=/^\#([0-9a-fA-F]+)/,g=/^([a-zA-Z]+)/,y=/^rgb/i,m=/^rgba/i,b=/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/,x="";function w(t){throw new Error("".concat(x,": ").concat(t))}function E(){return k("linear-gradient",t,S)||k("repeating-linear-gradient",e,S)||k("radial-gradient",n,O)||k("repeating-radial-gradient",r,O)||k("conic-gradient",i,O)}function k(t,e,n){return M(e,(function(e){var r=n();return r&&(j(v)||w("Missing comma before color stops")),{type:t,orientation:r,colorStops:C(R)}}))}function M(t,e){var n=j(t);if(n){j(d)||w("Missing (");var r=e(n);return j(f)||w("Missing )"),r}}function S(){return I("directional",a,1)||I("angular",h,1)}function O(){var t,e,n=N();return n&&((t=[]).push(n),e=x,j(v)&&((n=N())?t.push(n):x=e)),t}function N(){var t,e=function(){var t=I("shape",/^(circle)/i,0);return t&&(t.style=_()||A()),t}()||((t=I("shape",/^(ellipse)/i,0))&&(t.style=D()||A()),t);if(e)e.at=T();else{var n=A();if(n){e=n;var r=T();r&&(e.at=r)}else{var i=P();i&&(e={type:"default-radial",at:i})}}return e}function A(){return I("extent-keyword",o,1)}function T(){if(I("position",/^at/,0)){var t=P();return t||w("Missing positioning value"),t}}function P(){var t={x:D(),y:D()};if(t.x||t.y)return{type:"position",value:t}}function C(t){var e=t(),n=[];if(e)for(n.push(e);j(v);)(e=t())?n.push(e):w("One extra comma");return n}function R(){var t=I("hex",p,1)||M(m,(function(){return{type:"rgba",value:C(L)}}))||M(y,(function(){return{type:"rgb",value:C(L)}}))||I("literal",g,0);return t||w("Expected color definition"),t.length=D(),t}function L(){return j(b)[1]}function D(){return I("%",c,1)||I("position-keyword",s,1)||_()}function _(){return I("px",u,1)||I("em",l,1)}function I(t,e,n){var r=j(e);if(r)return{type:t,value:r[n]}}function j(t){var e=/^[\n\r\t\s]+/.exec(x);e&&F(e[0].length);var n=t.exec(x);return n&&F(n[0].length),n}function F(t){x=x.substring(t)}return function(t){return x=t,e=C(E),x.length>0&&w("Invalid input not EOF"),e;var e}}(),Pi=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,Ci=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,Ri=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,Li=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,Di={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},_i=ri((function(t){var e;return e="angular"===t.type?Number(t.value):Di[t.value]||0,Ni(e,"deg")})),Ii=ri((function(t){var e=50,n=50,r="%",i="%";if("position"===(null==t?void 0:t.type)){var a=t.value,o=a.x,s=a.y;"position-keyword"===(null==o?void 0:o.type)&&("left"===o.value?e=0:"center"===o.value?e=50:"right"===o.value?e=100:"top"===o.value?n=0:"bottom"===o.value&&(n=100)),"position-keyword"===(null==s?void 0:s.type)&&("left"===s.value?e=0:"center"===s.value?n=50:"right"===s.value?e=100:"top"===s.value?n=0:"bottom"===s.value&&(n=100)),"px"!==(null==o?void 0:o.type)&&"%"!==(null==o?void 0:o.type)&&"em"!==(null==o?void 0:o.type)||(r=null==o?void 0:o.type,e=Number(o.value)),"px"!==(null==s?void 0:s.type)&&"%"!==(null==s?void 0:s.type)&&"em"!==(null==s?void 0:s.type)||(i=null==s?void 0:s.type,n=Number(s.value))}return{cx:Ni(e,r),cy:Ni(n,i)}})),ji=ri((function(t){if(t.indexOf("linear")>-1||t.indexOf("radial")>-1)return Ti(t).map((function(t){var e=t.type,n=t.orientation,r=t.colorStops;!function(t){var e,n,r=t.length;t[r-1].length=null!==(e=t[r-1].length)&&void 0!==e?e:{type:"%",value:"100"},r>1&&(t[0].length=null!==(n=t[0].length)&&void 0!==n?n:{type:"%",value:"0"});for(var i=0,a=Number(t[0].length.value),o=1;o<r;o++){var s,u=null===(s=t[o].length)||void 0===s?void 0:s.value;if(!ue(u)&&!ue(a)){for(var c=1;c<o-i;c++)t[i+c].length={type:"%",value:"".concat(a+(Number(u)-a)*c/(o-i))};i=o,a=Number(u)}}}(r);var i,a=r.map((function(t){return{offset:Ni(Number(t.length.value),"%"),color:Ai(t)}}));if("linear-gradient"===e)return new pi(vi.LinearGradient,{angle:n?_i(n):xi,steps:a});if("radial-gradient"===e&&(n||(n=[{type:"shape",value:"circle"}]),"shape"===n[0].type&&"circle"===n[0].value)){var o,s=Ii(n[0].at),u=s.cx,c=s.cy;if(n[0].style){var l=n[0].style,h=l.type,d=l.value;"extent-keyword"===h?(ki[i=d]||(ki[i]=new gi(i)),o=ki[i]):o=Ni(d,h)}return new pi(vi.RadialGradient,{cx:u,cy:c,size:o,steps:a})}}));var e=t[0];if("("===t[1]||"("===t[2])if("l"===e){var n=Pi.exec(t);if(n){var r,i=(null===(r=n[2].match(Li))||void 0===r?void 0:r.map((function(t){return t.split(":")})))||[];return[new pi(vi.LinearGradient,{angle:Ni(parseFloat(n[1]),"deg"),steps:i.map((function(t){var e=h(t,2),n=e[0],r=e[1];return{offset:Ni(100*Number(n),"%"),color:r}}))})]}}else if("r"===e){var a=function(t){var e=Ci.exec(t);if(e){var n,r=(null===(n=e[4].match(Li))||void 0===n?void 0:n.map((function(t){return t.split(":")})))||[];return{cx:Ni(50,"%"),cy:Ni(50,"%"),steps:r.map((function(t){var e=h(t,2),n=e[0],r=e[1];return{offset:Ni(100*Number(n),"%"),color:r}}))}}return null}(t);if(a){if(!ce(a))return[new pi(vi.RadialGradient,a)];t=a}}else if("p"===e)return function(t){var e=Ri.exec(t);if(e){var n=e[1],r=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat"}return{image:r,repetition:n}}return null}(t)}));function Fi(t){return t&&!!t.image}function Bi(t){return t&&!ue(t.r)&&!ue(t.g)&&!ue(t.b)}var zi=ri((function(t){if(Fi(t))return g({repetition:"repeat"},t);if(ue(t)&&(t=""),"transparent"===t)return Si;if("currentColor"===t)t="black";else if("none"===t)return Mi;var e=ji(t);if(e)return e;var n=Vr(t),r=[0,0,0,0];return null!==n&&(r[0]=n.r||0,r[1]=n.g||0,r[2]=n.b||0,r[3]=n.opacity),Oi.apply(void 0,r)}));function Gi(t,e){if(Bi(t)&&Bi(e))return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var e=t.slice();if(e[3])for(var n=0;n<3;n++)e[n]=Math.round(le(e[n],0,255));return e[3]=le(e[3],0,1),"rgba(".concat(e.join(","),")")}]}function Vi(t,e){if(ue(e))return Ni(0,"px");if(e="".concat(e).trim().toLowerCase(),isFinite(Number(e))){if("px".search(t)>=0)return Ni(Number(e),"px");if("deg".search(t)>=0)return Ni(Number(e),"deg")}var n=[];e=e.replace(t,(function(t){return n.push(t),"U".concat(t)}));var r="U(".concat(t.source,")");return n.map((function(t){return Ni(Number(e.replace(new RegExp("U".concat(t),"g"),"").replace(new RegExp(r,"g"),"*0")),t)}))[0]}var Wi=function(t){return Vi(new RegExp("px","g"),t)},Hi=ri(Wi);ri((function(t){return Vi(new RegExp("%","g"),t)}));var Yi=function(t){return oe(t)||isFinite(Number(t))?Ni(Number(t)||0,"px"):Vi(new RegExp("px|%|em|rem","g"),t)},Ui=ri(Yi),qi=function(t){return Vi(new RegExp("deg|rad|grad|turn","g"),t)},Xi=ri(qi);function Ki(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a="",o=t.value||0,s=e.value||0,u=yi(t.unit),c=t.convertTo(u),l=e.convertTo(u);return c&&l?(o=c.value,s=l.value,a=hi(t.unit)):(mi.isLength(t.unit)||mi.isLength(e.unit))&&(o=Qi(t,i,n),s=Qi(e,i,n),a="px"),[o,s,function(t){return r&&(t=Math.max(t,0)),t+a}]}function $i(t){var e=0;return t.unit===ii.kDegrees?e=t.value:t.unit===ii.kRadians?e=ir(Number(t.value)):t.unit===ii.kTurns?e=360*Number(t.value):t.value&&(e=t.value),e}function Zi(t,e){var n;return Array.isArray(t)?n=t.map((function(t){return Number(t)})):ce(t)?n=t.split(" ").map((function(t){return Number(t)})):oe(t)&&(n=[t]),2===e?1===n.length?[n[0],n[0]]:[n[0],n[1]]:4===e?1===n.length?[n[0],n[0],n[0],n[0]]:2===n.length?[n[0],n[1],n[0],n[1]]:3===n.length?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]:"even"===e&&n.length%2==1?[].concat(w(n),w(n)):n}function Qi(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.unit===ii.kPixels)return Number(t.value);if(t.unit===ii.kPercentage&&n){var i=n.nodeName===In.GROUP?n.getLocalBounds():n.getGeometryBounds();return(r?i.min[e]:0)+t.value/100*i.halfExtents[e]*2}return 0}var Ji=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function ta(t){return t.toString()}var ea=function(t){return"number"==typeof t?Ni(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?Ni(Number(t)):Ni(0)},na=ri(ea);function ra(t,e){return[t,e,ta]}function ia(t,e){return function(n,r){return[n,r,function(n){return ta(le(n,t,e))}]}}function aa(t,e){if(t.length===e.length)return[t,e,function(t){return t}]}function oa(t){return 0===t.parsedStyle.d.totalLength&&(t.parsedStyle.d.totalLength=We(t.parsedStyle.d.absolutePath,void 0,fe(fe({},undefined),{bbox:!1,length:!0})).length),t.parsedStyle.d.totalLength}function sa(t){return 0===t.parsedStyle.points.totalLength&&(t.parsedStyle.points.totalLength=function(t){if(t.length<2)return 0;for(var e=0,n=0;n<t.length-1;n++){var r=t[n],i=t[n+1];e+=fn(r[0],r[1],i[0],i[1])}return e}(t.parsedStyle.points.points)),t.parsedStyle.points.totalLength}function ua(t,e){return t[0]===e[0]&&t[1]===e[1]}function ca(t,e){var n=t.prePoint,r=t.currentPoint,i=t.nextPoint,a=Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2),o=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2),u=Math.acos((a+o-s)/(2*Math.sqrt(a)*Math.sqrt(o)));if(!u||0===Math.sin(u)||qe(u,0))return{xExtra:0,yExtra:0};var c=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),l=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));return c=c>Math.PI/2?Math.PI-c:c,l=l>Math.PI/2?Math.PI-l:l,{xExtra:Math.cos(u/2-c)*(e/2*(1/Math.sin(u/2)))-e/2||0,yExtra:Math.cos(l-u/2)*(e/2*(1/Math.sin(u/2)))-e/2||0}}function la(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])]}ri((function(t){return ce(t)?t.split(" ").map(na):t.map(na)}));var ha=function(t,e){var n=t.x*e.x+t.y*e.y,r=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(n/r)},da=function(t,e,n,r,i,a,o,s){e=Math.abs(e),n=Math.abs(n);var u=nr(r=Xe(r,360));if(t.x===o.x&&t.y===o.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(0===e||0===n)return{x:0,y:0,ellipticalArcAngle:0};var c=(t.x-o.x)/2,l=(t.y-o.y)/2,h={x:Math.cos(u)*c+Math.sin(u)*l,y:-Math.sin(u)*c+Math.cos(u)*l},d=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(n,2);d>1&&(e*=Math.sqrt(d),n*=Math.sqrt(d));var f=(Math.pow(e,2)*Math.pow(n,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(n,2)*Math.pow(h.x,2))/(Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(n,2)*Math.pow(h.x,2));f=f<0?0:f;var v=(i!==a?1:-1)*Math.sqrt(f),p=v*(e*h.y/n),g=v*(-n*h.x/e),y={x:Math.cos(u)*p-Math.sin(u)*g+(t.x+o.x)/2,y:Math.sin(u)*p+Math.cos(u)*g+(t.y+o.y)/2},m={x:(h.x-p)/e,y:(h.y-g)/n},b=ha({x:1,y:0},m),x=ha(m,{x:(-h.x-p)/e,y:(-h.y-g)/n});!a&&x>0?x-=2*Math.PI:a&&x<0&&(x+=2*Math.PI);var w=b+(x%=2*Math.PI)*s,E=e*Math.cos(w),k=n*Math.sin(w);return{x:Math.cos(u)*E-Math.sin(u)*k+y.x,y:Math.sin(u)*E+Math.cos(u)*k+y.y,ellipticalArcStartAngle:b,ellipticalArcEndAngle:b+x,ellipticalArcAngle:w,ellipticalArcCenter:y,resultantRx:e,resultantRy:n}};function fa(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.arcParams,i=r.rx,a=void 0===i?0:i,o=r.ry,s=void 0===o?0:o,u=r.xRotation,c=r.arcFlag,l=r.sweepFlag,h=da({x:t.prePoint[0],y:t.prePoint[1]},a,s,u,!!c,!!l,{x:t.currentPoint[0],y:t.currentPoint[1]},e),d=da({x:t.prePoint[0],y:t.prePoint[1]},a,s,u,!!c,!!l,{x:t.currentPoint[0],y:t.currentPoint[1]},n?e+.005:e-.005),f=d.x-h.x,v=d.y-h.y,p=Math.sqrt(f*f+v*v);return{x:-f/p,y:-v/p}}function va(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function pa(t,e){return va(t)*va(e)?(t[0]*e[0]+t[1]*e[1])/(va(t)*va(e)):1}function ga(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(pa(t,e))}function ya(t,e){var n=e[1],r=e[2],i=Xe(nr(e[3]),2*Math.PI),a=e[4],o=e[5],s=t[0],u=t[1],c=e[6],l=e[7],h=Math.cos(i)*(s-c)/2+Math.sin(i)*(u-l)/2,d=-1*Math.sin(i)*(s-c)/2+Math.cos(i)*(u-l)/2,f=h*h/(n*n)+d*d/(r*r);f>1&&(n*=Math.sqrt(f),r*=Math.sqrt(f));var v=n*n*(d*d)+r*r*(h*h),p=v?Math.sqrt((n*n*(r*r)-v)/v):1;a===o&&(p*=-1),isNaN(p)&&(p=0);var g=r?p*n*d/r:0,y=n?p*-r*h/n:0,m=(s+c)/2+Math.cos(i)*g-Math.sin(i)*y,b=(u+l)/2+Math.sin(i)*g+Math.cos(i)*y,x=[(h-g)/n,(d-y)/r],w=[(-1*h-g)/n,(-1*d-y)/r],E=ga([1,0],x),k=ga(x,w);return pa(x,w)<=-1&&(k=Math.PI),pa(x,w)>=1&&(k=0),0===o&&k>0&&(k-=2*Math.PI),1===o&&k<0&&(k+=2*Math.PI),{cx:m,cy:b,rx:ua(t,[c,l])?0:n,ry:ua(t,[c,l])?0:r,startAngle:E,endAngle:E+k,xRotation:i,arcFlag:a,sweepFlag:o}}var ma=function(t){if(""===t||Array.isArray(t)&&0===t.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var e;try{e=Le(t)}catch(n){e=Le(""),console.error("[g]: Invalid SVG Path definition: ".concat(t))}!function(t){for(var e=0;e<t.length;e++){var n=t[e-1],r=t[e];if("M"===r[0]&&n){var i=n[0],a=[r[1],r[2]],o=void 0;"L"===i||"M"===i?o=[n[1],n[2]]:"C"!==i&&"A"!==i&&"Q"!==i||(o=[n[n.length-2],n[n.length-1]]),o&&ua(a,o)&&(t.splice(e,1),e--)}}}(e);var n=function(t){for(var e=!1,n=t.length,r=0;r<n;r++){var i=t[r][0];if("C"===i||"A"===i||"Q"===i){e=!0;break}}return e}(e),r=function(t){for(var e=[],n=[],r=[],i=0;i<t.length;i++){var a=t[i],o=a[0];"M"===o?(r.length&&(n.push(r),r=[]),r.push([a[1],a[2]])):"Z"===o?r.length&&(e.push(r),r=[]):r.push([a[1],a[2]])}return r.length>0&&n.push(r),{polygons:e,polylines:n}}(e),i=r.polygons,a=r.polylines,o=function(t){for(var e=[],n=null,r=null,i=null,a=0,o=t.length,s=0;s<o;s++){var u=t[s];r=t[s+1];var c=u[0],l={command:c,prePoint:n,params:u,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(c){case"M":i=[u[1],u[2]],a=s;break;case"A":var h=ya(n,u);l.arcParams=h}if("Z"===c)n=i,r=t[a+1];else{var d=u.length;n=[u[d-2],u[d-1]]}r&&"Z"===r[0]&&(r=t[a],e[a]&&(e[a].prePoint=n)),l.currentPoint=n,e[a]&&ua(n,e[a].currentPoint)&&(e[a].prePoint=l.prePoint);var f=r?[r[r.length-2],r[r.length-1]]:null;l.nextPoint=f;var v=l.prePoint;if(["L","H","V"].includes(c))l.startTangent=[v[0]-n[0],v[1]-n[1]],l.endTangent=[n[0]-v[0],n[1]-v[1]];else if("Q"===c){var p=[u[1],u[2]];l.startTangent=[v[0]-p[0],v[1]-p[1]],l.endTangent=[n[0]-p[0],n[1]-p[1]]}else if("T"===c){var g=e[s-1],y=la(g.currentPoint,v);"Q"===g.command?(l.command="Q",l.startTangent=[v[0]-y[0],v[1]-y[1]],l.endTangent=[n[0]-y[0],n[1]-y[1]]):(l.command="TL",l.startTangent=[v[0]-n[0],v[1]-n[1]],l.endTangent=[n[0]-v[0],n[1]-v[1]])}else if("C"===c){var m=[u[1],u[2]],b=[u[3],u[4]];l.startTangent=[v[0]-m[0],v[1]-m[1]],l.endTangent=[n[0]-b[0],n[1]-b[1]],0===l.startTangent[0]&&0===l.startTangent[1]&&(l.startTangent=[m[0]-b[0],m[1]-b[1]]),0===l.endTangent[0]&&0===l.endTangent[1]&&(l.endTangent=[b[0]-m[0],b[1]-m[1]])}else if("S"===c){var x=e[s-1],w=la(x.currentPoint,v),E=[u[1],u[2]];"C"===x.command?(l.command="C",l.startTangent=[v[0]-w[0],v[1]-w[1]],l.endTangent=[n[0]-E[0],n[1]-E[1]]):(l.command="SQ",l.startTangent=[v[0]-E[0],v[1]-E[1]],l.endTangent=[n[0]-E[0],n[1]-E[1]])}else if("A"===c){var k=fa(l,0),M=k.x,S=k.y,O=fa(l,1,!1),N=O.x,A=O.y;l.startTangent=[M,S],l.endTangent=[N,A]}e.push(l)}return e}(e),s=function(t){for(var e=[],n=[],r=[],i=0;i<t.length;i++){var a=t[i],o=a.currentPoint,s=a.params,u=a.prePoint,c=void 0;switch(a.command){case"Q":c=Nn(u[0],u[1],s[1],s[2],s[3],s[4]);break;case"C":c=kn(u[0],u[1],s[1],s[2],s[3],s[4],s[5],s[6]);break;case"A":var l=a.arcParams;c=yn(l.cx,l.cy,l.rx,l.ry,l.xRotation,l.startAngle,l.endAngle);break;default:e.push(o[0]),n.push(o[1])}c&&(a.box=c,e.push(c.x,c.x+c.width),n.push(c.y,c.y+c.height))}e=e.filter((function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0})),n=n.filter((function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0}));var h=Ye(e),d=Ye(n),f=Ue(e),v=Ue(n);if(0===r.length)return{x:h,y:d,width:f-h,height:v-d};for(var p=0;p<r.length;p++){var g=r[p],y=g.currentPoint;y[0]===h?h-=ca(g,0).xExtra:y[0]===f&&(f+=ca(g,0).xExtra),y[1]===d?d-=ca(g,0).yExtra:y[1]===v&&(v+=ca(g,0).yExtra)}return{x:h,y:d,width:f-h,height:v-d}}(o),u=s.x,c=s.y,l=s.width,h=s.height;return{absolutePath:e,hasArc:n,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(u)?u:0,y:Number.isFinite(c)?c:0,width:Number.isFinite(l)?l:0,height:Number.isFinite(h)?h:0}}},ba=ri(ma);function xa(t){return ce(t)?ba(t):ma(t)}function wa(t,e,n){var r=t.curve,i=e.curve;r&&0!==r.length||(r=tn(t.absolutePath,!1),t.curve=r),i&&0!==i.length||(i=tn(e.absolutePath,!1),e.curve=i);var a=[r,i];r.length!==i.length&&(a=nn(r,i));var o,s,u,c,l,h,d,f,v=rn(a[0])!==rn(a[1])?(s=(o=a[0]).slice(1).map((function(t,e,n){return e?n[e-1].slice(-2).concat(t.slice(1)):o[0].slice(1).concat(t.slice(1))})).map((function(t){return t.map((function(e,n){return t[t.length-n-2*(1-n%2)]}))})).reverse(),[["M"].concat(s[0].slice(0,2))].concat(s.map((function(t){return["C"].concat(t.slice(2))})))):a[0].map((function(t){return Array.isArray(t)?[].concat(t):t}));return[v,(u=a[1],c=v,l=u.length-1,h=[],d=0,f=function(t){var e=t.length,n=e-1;return t.map((function(r,i){return t.map((function(r,a){var o,s=i+a;return 0===a||t[s]&&"M"===t[s][0]?(o=t[s],["M"].concat(o.slice(-2))):(s>=e&&(s-=n),t[s])}))}))}(u),f.forEach((function(t,e){u.slice(1).forEach((function(t,n){d+=se(u[(e+n)%l].slice(-2),c[n%l].slice(-2))})),h[e]=d,d=0})),f[h.indexOf(Math.min.apply(null,h))]),function(t){return t}]}function Ea(t,e){return[t.points,e.points,function(t){return t}]}var ka=null,Ma=/\s*(\w+)\(([^)]*)\)/g;function Sa(t){return function(e){var n=0;return t.map((function(t){return t===ka?e[n++]:t}))}}function Oa(t){return t}var Na={matrix:["NNNNNN",[ka,ka,0,0,ka,ka,0,0,0,0,1,0,ka,ka,0,1],Oa],matrix3d:["NNNNNNNNNNNNNNNN",Oa],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",Sa([ka,ka,new mi(1)]),Oa],scaleX:["N",Sa([ka,new mi(1),new mi(1)]),Sa([ka,new mi(1)])],scaleY:["N",Sa([new mi(1),ka,new mi(1)]),Sa([new mi(1),ka])],scaleZ:["N",Sa([new mi(1),new mi(1),ka])],scale3d:["NNN",Oa],skew:["Aa",null,Oa],skewX:["A",null,Sa([ka,xi])],skewY:["A",null,Sa([xi,ka])],translate:["Tt",Sa([ka,ka,bi]),Oa],translateX:["T",Sa([ka,bi,bi]),Sa([ka,bi])],translateY:["T",Sa([bi,ka,bi]),Sa([bi,ka])],translateZ:["L",Sa([bi,bi,ka])],translate3d:["TTL",Oa]};function Aa(t){for(var e=[],n=t.length,r=0;r<n;r++){var i=t[r],a=i[0],o=i.slice(1);if("translate"===a||"skew"===a?1===o.length&&o.push(0):"scale"===a&&1===o.length&&o.push(o[0]),!Na[a])return[];var s=o.map((function(t){return Ni(t)}));e.push({t:a,d:s})}return e}function Ta(t){if(Array.isArray(t))return Aa(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(Ma.lastIndex=0;e=Ma.exec(t);){if(e.index!==r)return[];r=e.index+e[0].length;var i=e[1],a=Na[i];if(!a)return[];var o=e[2].split(","),s=a[0];if(s.length<o.length)return[];for(var u=[],c=0;c<s.length;c++){var l,h=o[c],d=s[c];if(void 0===(l=h?{A:function(t){return"0"===t.trim()?xi:Xi(t)},N:na,T:Ui,L:Hi}[d.toUpperCase()](h):{a:xi,n:u[0],t:bi}[d]))return[];u.push(l)}if(n.push({t:i,d:u}),Ma.lastIndex===t.length)return n}return[]}function Pa(t){if(Array.isArray(t))return Aa(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(Ma.lastIndex=0;e=Ma.exec(t);){if(e.index!==r)return[];r=e.index+e[0].length;var i=e[1],a=Na[i];if(!a)return[];var o=e[2].split(","),s=a[0];if(s.length<o.length)return[];for(var u=[],c=0;c<s.length;c++){var l,h=o[c],d=s[c];if(void 0===(l=h?{A:function(t){return"0"===t.trim()?xi:qi(t)},N:ea,T:Yi,L:Wi}[d.toUpperCase()](h):{a:xi,n:u[0],t:bi}[d]))return[];u.push(l)}if(n.push({t:i,d:u}),Ma.lastIndex===t.length)return n}return[]}function Ca(t){var e,n,r,i;switch(t.t){case"rotateX":return i=nr($i(t.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return i=nr($i(t.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return i=nr($i(t.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=t.d[0].value,n=t.d[1].value,r=t.d[2].value,i=nr($i(t.d[3]));var a=e*e+n*n+r*r;if(0===a)e=1,n=0,r=0;else if(1!==a){var o=Math.sqrt(a);e/=o,n/=o,r/=o}var s=Math.sin(i/2),u=s*Math.cos(i/2),c=s*s;return[1-2*(n*n+r*r)*c,2*(e*n*c+r*u),2*(e*r*c-n*u),0,2*(e*n*c-r*u),1-2*(e*e+r*r)*c,2*(n*r*c+e*u),0,2*(e*r*c+n*u),2*(n*r*c-e*u),1-2*(e*e+n*n)*c,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var l=nr($i(t.d[0])),h=nr($i(t.d[1]));return[1,Math.tan(h),0,0,Math.tan(l),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return i=nr($i(t.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return i=nr($i(t.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,e=Qi(t.d[0],0,null)||0,n=Qi(t.d[1],0,null)||0,0,1];case"translateX":return[1,0,0,0,0,1,0,0,0,0,1,0,e=Qi(t.d[0],0,null)||0,0,0,1];case"translateY":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=Qi(t.d[0],0,null)||0,0,1];case"translateZ":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r=Qi(t.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,e=Qi(t.d[0],0,null)||0,n=Qi(t.d[1],0,null)||0,r=Qi(t.d[2],0,null)||0,1];case"perspective":var d=Qi(t.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,d?-1/d:0,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map((function(t){return t.value}))}}function Ra(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]]}function La(t){var e=[0,0,0],n=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return function(t,e,n,r,i,a){if(!function(t,e){var n=e[15];if(0===n)return!1;for(var r=1/n,i=0;i<16;i++)t[i]=e[i]*r;return!0}(ur,t))return!1;if(J(cr,ur),cr[3]=0,cr[7]=0,cr[11]=0,cr[15]=1,Math.abs(ot(cr))<1e-8)return!1;var o,s,u=ur[3],c=ur[7],l=ur[11],h=ur[12],d=ur[13],f=ur[14],v=ur[15];if(0!==u||0!==c||0!==l){if(lr[0]=u,lr[1]=c,lr[2]=l,lr[3]=v,!it(cr,cr))return!1;rt(cr,cr),$(i,lr,cr)}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=h,e[1]=d,e[2]=f,s=ur,(o=hr)[0][0]=s[0],o[0][1]=s[1],o[0][2]=s[2],o[1][0]=s[4],o[1][1]=s[5],o[1][2]=s[6],o[2][0]=s[8],o[2][1]=s[9],o[2][2]=s[10],n[0]=L(hr[0]),z(hr[0],hr[0]),r[0]=G(hr[0],hr[1]),fr(hr[1],hr[1],hr[0],1,-r[0]),n[1]=L(hr[1]),z(hr[1],hr[1]),r[0]/=n[1],r[1]=G(hr[0],hr[2]),fr(hr[2],hr[2],hr[0],1,-r[1]),r[2]=G(hr[1],hr[2]),fr(hr[2],hr[2],hr[1],1,-r[2]),n[2]=L(hr[2]),z(hr[2],hr[2]),r[1]/=n[2],r[2]/=n[2],function(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[0],s=n[1],u=n[2];t[0]=i*u-a*s,t[1]=a*o-r*u,t[2]=r*s-i*o}(dr,hr[1],hr[2]),G(hr[0],dr)<0)for(var p=0;p<3;p++)n[p]*=-1,hr[p][0]*=-1,hr[p][1]*=-1,hr[p][2]*=-1;a[0]=.5*Math.sqrt(Math.max(1+hr[0][0]-hr[1][1]-hr[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-hr[0][0]+hr[1][1]-hr[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-hr[0][0]-hr[1][1]+hr[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+hr[0][0]+hr[1][1]+hr[2][2],0)),hr[2][1]>hr[1][2]&&(a[0]=-a[0]),hr[0][2]>hr[2][0]&&(a[1]=-a[1]),hr[1][0]>hr[0][1]&&(a[2]=-a[2])}(function(t){return 0===t.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(Ca).reduce(Ra)}(t),e,n,r,i,a),[[e,n,r,a,i]]}var Da=function(){function t(t,e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var i=0;i<4;i++)for(var a=0;a<4;a++)n[r][i]+=e[r][a]*t[a][i];return n}return function(e,n,r,i,a){for(var o=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],s=0;s<4;s++)o[s][3]=a[s];for(var u=0;u<3;u++)for(var c=0;c<3;c++)o[3][u]+=e[c]*o[c][u];var l=i[0],h=i[1],d=i[2],f=i[3],v=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];v[0][0]=1-2*(h*h+d*d),v[0][1]=2*(l*h-d*f),v[0][2]=2*(l*d+h*f),v[1][0]=2*(l*h+d*f),v[1][1]=1-2*(l*l+d*d),v[1][2]=2*(h*d-l*f),v[2][0]=2*(l*d-h*f),v[2][1]=2*(h*d+l*f),v[2][2]=1-2*(l*l+h*h),o=t(o,v);var p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];r[2]&&(p[2][1]=r[2],o=t(o,p)),r[1]&&(p[2][1]=0,p[2][0]=r[0],o=t(o,p)),r[0]&&(p[2][0]=0,p[1][0]=r[0],o=t(o,p));for(var g=0;g<3;g++)for(var y=0;y<3;y++)o[g][y]*=n[g];return function(t){return 0===t[0][2]&&0===t[0][3]&&0===t[1][2]&&0===t[1][3]&&0===t[2][0]&&0===t[2][1]&&1===t[2][2]&&0===t[2][3]&&0===t[3][2]&&1===t[3][3]}(o)?[o[0][0],o[0][1],o[1][0],o[1][1],o[3][0],o[3][1]]:o[0].concat(o[1],o[2],o[3])}}();function _a(t){return t.toFixed(6).replace(".000000","")}function Ia(t,e){var n,r;return t.decompositionPair!==e&&(t.decompositionPair=e,n=La(t)),e.decompositionPair!==t&&(e.decompositionPair=t,r=La(e)),null===n[0]||null===r[0]?[[!1],[!0],function(n){return n?e[0].d:t[0].d}]:(n[0].push(0),r[0].push(1),[n,r,function(t){var e=function(t,e,n){var r=function(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[r];return n}(t,e),i=[];if(1===(r=le(r,-1,1)))i=t;else for(var a=Math.acos(r),o=1*Math.sin(n*a)/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(t[s]*(Math.cos(n*a)-r*o)+e[s]*o);return i}(n[0][3],r[0][3],t[5]);return Da(t[0],t[1],t[2],e,t[4]).map(_a).join(",")}])}function ja(t){return t.replace(/[XY]/,"")}function Fa(t){return t.replace(/(X|Y|Z|3d)?$/,"3d")}var Ba=function(t,e){return"perspective"===t&&"perspective"===e||("matrix"===t||"matrix3d"===t)&&("matrix"===e||"matrix3d"===e)};function za(t,e,n){var r=!1;if(!t.length||!e.length){t.length||(r=!0,t=e,e=[]);for(var i=function(){var n=t[a],r=n.t,i=n.d,o="scale"===r.substring(0,5)?1:0;e.push({t:r,d:i.map((function(t){return"number"==typeof t?Ni(o):Ni(o,t.unit)}))})},a=0;a<t.length;a++)i()}var o=[],s=[],u=[];if(t.length!==e.length){var c=Ia(t,e);o=[c[0]],s=[c[1]],u=[["matrix",[c[2]]]]}else for(var l=0;l<t.length;l++){var h=t[l].t,d=e[l].t,f=t[l].d,v=e[l].d,p=Na[h],g=Na[d],y=void 0;if(Ba(h,d)){var m=Ia([t[l]],[e[l]]);o.push(m[0]),s.push(m[1]),u.push(["matrix",[m[2]]])}else{if(h===d)y=h;else if(p[2]&&g[2]&&ja(h)===ja(d))y=ja(h),f=p[2](f),v=g[2](v);else{if(!p[1]||!g[1]||Fa(h)!==Fa(d)){var b=Ia(t,e);o=[b[0]],s=[b[1]],u=[["matrix",[b[2]]]];break}y=Fa(h),f=p[1](f),v=g[1](v)}for(var x=[],w=[],E=[],k=0;k<f.length;k++){var M=Ki(f[k],v[k],n,!1,k);x[k]=M[0],w[k]=M[1],E.push(M[2])}o.push(x),s.push(w),u.push([y,E])}}if(r){var S=o;o=s,s=S}return[o,s,function(t){return t.map((function(t,e){var n=t.map((function(t,n){return u[e][1][n](t)})).join(",");return"matrix"===u[e][0]&&16===n.split(",").length&&(u[e][0]="matrix3d"),"matrix3d"===u[e][0]&&6===n.split(",").length&&(u[e][0]="matrix"),"".concat(u[e][0],"(").concat(n,")")})).join(" ")}]}var Ga=ri((function(t){if(ce(t)){if("text-anchor"===t)return[Ni(0,"px"),Ni(0,"px")];var e=t.split(" ");return 1===e.length&&("top"===e[0]||"bottom"===e[0]?(e[1]=e[0],e[0]="center"):e[1]="center"),2!==e.length?null:[Ui(Va(e[0])),Ui(Va(e[1]))]}return[Ni(t[0]||0,"px"),Ni(t[1]||0,"px")]}));function Va(t){return"center"===t?"50%":"left"===t||"top"===t?"0%":"right"===t||"bottom"===t?"100%":t}var Wa=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:kr.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:kr.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:kr.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:kr.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:kr.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:kr.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:kr.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:kr.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:kr.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:kr.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:kr.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:kr.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:kr.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:kr.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:kr.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:kr.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:kr.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:kr.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:kr.FILTER},{n:"clipPath",syntax:kr.DEFINED_PATH},{n:"textPath",syntax:kr.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:kr.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:kr.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:kr.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:kr.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:kr.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:kr.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:kr.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:kr.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:kr.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:kr.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:kr.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:kr.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:kr.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:kr.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:kr.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:kr.COORDINATE},{n:"y1",int:!0,l:!0,syntax:kr.COORDINATE},{n:"z1",int:!0,l:!0,syntax:kr.COORDINATE},{n:"x2",int:!0,l:!0,syntax:kr.COORDINATE},{n:"y2",int:!0,l:!0,syntax:kr.COORDINATE},{n:"z2",int:!0,l:!0,syntax:kr.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:kr.PATH,p:50},{n:"points",int:!0,l:!0,syntax:kr.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:kr.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:kr.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:kr.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:kr.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:kr.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:kr.NUMBER,d:function(t){return t===In.PATH||t===In.POLYGON||t===In.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:kr.MARKER},{n:"markerEnd",syntax:kr.MARKER},{n:"markerMid",syntax:kr.MARKER},{n:"markerStartOffset",syntax:kr.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:kr.LENGTH,l:!0,int:!0,d:"0"}],Ha=new Set(Wa.filter((function(t){return!!t.l})).map((function(t){return t.n}))),Ya={},Ua=function(){return b((function t(e){var n=this;y(this,t),this.runtime=e,Wa.forEach((function(t){n.registerMetadata(t)}))}),[{key:"registerMetadata",value:function(t){[t.n].concat(w(t.a||[])).forEach((function(e){Ya[e]=t}))}},{key:"getPropertySyntax",value:function(t){return this.runtime.CSSPropertySyntaxFactory[t]}},{key:"processProperties",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(t.attributes,e);var r=t.parsedStyle.clipPath,i=t.parsedStyle.offsetPath;!function(t,e){var n=qa(t);for(var r in e)n.has(r)&&(t.parsedStyle[r]=e[r])}(t,e);var a=!!n.forceUpdateGeometry;if(!a)for(var o in e)if(Ha.has(o)){a=!0;break}var s,u=qa(t);u.has("fill")&&e.fill&&(t.parsedStyle.fill=zi(e.fill)),u.has("stroke")&&e.stroke&&(t.parsedStyle.stroke=zi(e.stroke)),u.has("shadowColor")&&e.shadowColor&&(t.parsedStyle.shadowColor=zi(e.shadowColor)),u.has("filter")&&e.filter&&(t.parsedStyle.filter=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("none"===(t=t.toLowerCase().trim()))return[];for(var e,n=/\s*([\w-]+)\(([^)]*)\)/g,r=[],i=0;e=n.exec(t);){if(e.index!==i)return[];if(i=e.index+e[0].length,Ji.indexOf(e[1])>-1&&r.push({name:e[1],params:e[2].split(" ").map((function(t){return Vi(/deg|rad|grad|turn|px|%/g,t)||zi(t)}))}),n.lastIndex===t.length)return r}return[]}(e.filter)),u.has("radius")&&!ue(e.radius)&&(t.parsedStyle.radius=Zi(e.radius,4)),u.has("lineDash")&&!ue(e.lineDash)&&(t.parsedStyle.lineDash=Zi(e.lineDash,"even")),u.has("points")&&e.points&&(t.parsedStyle.points={points:ce(s=e.points)?s.split(" ").map((function(t){var e=h(t.split(","),2),n=e[0],r=e[1];return[Number(n),Number(r)]})):s,totalLength:0,segments:[]}),u.has("d")&&""===e.d&&(t.parsedStyle.d=g({},Er)),u.has("d")&&e.d&&(t.parsedStyle.d=xa(e.d)),u.has("textTransform")&&e.textTransform&&this.runtime.CSSPropertySyntaxFactory[kr.TEXT_TRANSFORM].calculator(null,null,{value:e.textTransform},t,null),u.has("clipPath")&&!an(e.clipPath)&&this.runtime.CSSPropertySyntaxFactory[kr.DEFINED_PATH].calculator("clipPath",r,e.clipPath,t,this.runtime),u.has("offsetPath")&&e.offsetPath&&this.runtime.CSSPropertySyntaxFactory[kr.DEFINED_PATH].calculator("offsetPath",i,e.offsetPath,t,this.runtime),u.has("transform")&&e.transform&&(t.parsedStyle.transform=Ta(e.transform)),u.has("transformOrigin")&&e.transformOrigin&&(t.parsedStyle.transformOrigin=Ga(e.transformOrigin)),u.has("markerStart")&&e.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[kr.MARKER].calculator(null,e.markerStart,e.markerStart,null,null)),u.has("markerEnd")&&e.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[kr.MARKER].calculator(null,e.markerEnd,e.markerEnd,null,null)),u.has("markerMid")&&e.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[kr.MARKER].calculator("",e.markerMid,e.markerMid,null,null)),u.has("zIndex")&&!ue(e.zIndex)&&this.runtime.CSSPropertySyntaxFactory[kr.Z_INDEX].postProcessor(t),u.has("offsetDistance")&&!ue(e.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[kr.OFFSET_DISTANCE].postProcessor(t),u.has("transform")&&e.transform&&this.runtime.CSSPropertySyntaxFactory[kr.TRANSFORM].postProcessor(t),u.has("transformOrigin")&&e.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[kr.TRANSFORM_ORIGIN].postProcessor(t),a&&(t.geometry.dirty=!0,t.renderable.boundsDirty=!0,t.renderable.renderBoundsDirty=!0,n.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(t))}},{key:"updateGeometry",value:function(t){var e=t.nodeName,n=this.runtime.geometryUpdaterFactory[e];if(n){var r=t.geometry;r.contentBounds||(r.contentBounds=new Hn),r.renderBounds||(r.renderBounds=new Hn);var i=t.parsedStyle,a=n.update(i,t),o=a.cx,s=void 0===o?0:o,u=a.cy,c=void 0===u?0:u,l=a.cz,h=void 0===l?0:l,d=a.hwidth,f=void 0===d?0:d,v=a.hheight,p=void 0===v?0:v,g=a.hdepth,y=void 0===g?0:g,m=[Math.abs(f),Math.abs(p),y],b=i.stroke,x=i.lineWidth,w=void 0===x?1:x,E=i.increasedLineWidthForHitTesting,k=void 0===E?0:E,M=i.shadowType,S=void 0===M?"outer":M,O=i.shadowColor,N=i.filter,A=void 0===N?[]:N,T=i.transformOrigin,P=[s,c,h];r.contentBounds.update(P,m);var C=e===In.POLYLINE||e===In.POLYGON||e===In.PATH?Math.SQRT2:.5;if(b&&!b.isNone){var R=((w||0)+(k||0))*C;m[0]+=R,m[1]+=R}if(r.renderBounds.update(P,m),O&&S&&"inner"!==S){var L=r.renderBounds,D=L.min,_=L.max,I=i.shadowBlur||0,F=i.shadowOffsetX||0,B=i.shadowOffsetY||0,z=D[0]-I+F,G=_[0]+I+F,V=D[1]-I+B,W=_[1]+I+B;D[0]=Math.min(D[0],z),_[0]=Math.max(_[0],G),D[1]=Math.min(D[1],V),_[1]=Math.max(_[1],W),r.renderBounds.setMinMax(D,_)}A.forEach((function(t){var e=t.name,n=t.params;if("blur"===e){var i=n[0].value;r.renderBounds.update(r.renderBounds.center,j(r.renderBounds.halfExtents,r.renderBounds.halfExtents,[i,i,0]))}else if("drop-shadow"===e){var a=n[0].value,o=n[1].value,s=n[2].value,u=r.renderBounds,c=u.min,l=u.max,h=c[0]-s+a,d=l[0]+s+a,f=c[1]-s+o,v=l[1]+s+o;c[0]=Math.min(c[0],h),l[0]=Math.max(l[0],d),c[1]=Math.min(c[1],f),l[1]=Math.max(l[1],v),r.renderBounds.setMinMax(c,l)}})),t.geometry.dirty=!1;var H=p<0,Y=(f<0?-1:1)*(T?Qi(T[0],0,t,!0):0),U=(H?-1:1)*(T?Qi(T[1],1,t,!0):0);(Y||U)&&t.setOrigin(Y,U)}}},{key:"updateSizeAttenuation",value:function(t,e){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/e,t.nodeName===In.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/e)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===In.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR))}}])}();function qa(t){return t.constructor.PARSED_STYLE_LIST}var Xa=function(){return b((function t(){y(this,t),this.mixer=ra}),[{key:"calculator",value:function(t,e,n,r){return $i(n)}}])}(),Ka=function(){return b((function t(){y(this,t)}),[{key:"calculator",value:function(t,e,n,r,i){return n instanceof gi&&(n=null),i.sceneGraphService.updateDisplayObjectDependency(t,e,n,r),"clipPath"===t&&r.forEach((function(t){0===t.childNodes.length&&i.sceneGraphService.dirtifyToRoot(t)})),n}}])}(),$a=function(){return b((function t(){y(this,t),this.parser=zi,this.mixer=Gi}),[{key:"calculator",value:function(t,e,n,r){return n instanceof gi?"none"===n.value?Mi:Si:n}}])}(),Za=function(){return b((function t(){y(this,t)}),[{key:"calculator",value:function(t,e,n){return n instanceof gi?[]:n}}])}();function Qa(t){var e=t.parsedStyle.fontSize;return ue(e)?null:e}var Ja=function(){return b((function t(){y(this,t),this.mixer=ra}),[{key:"calculator",value:function(t,e,n,r,i){if(oe(n))return n;if(!mi.isRelativeUnit(n.unit))return n.value;if(n.unit===ii.kPercentage)return 0;if(n.unit===ii.kEms){if(r.parentNode){var a=Qa(r.parentNode);if(a)return a*n.value}return 0}if(n.unit===ii.kRems){var o;if(null!=r&&null!==(o=r.ownerDocument)&&void 0!==o&&o.documentElement){var s=Qa(r.ownerDocument.documentElement);if(s)return s*n.value}return 0}}}])}(),to=function(){return b((function t(){y(this,t),this.mixer=aa}),[{key:"calculator",value:function(t,e,n){return n.map((function(t){return t.value}))}}])}(),eo=function(){return b((function t(){y(this,t),this.mixer=aa}),[{key:"calculator",value:function(t,e,n){return n.map((function(t){return t.value}))}}])}(),no=function(){return b((function t(){y(this,t)}),[{key:"calculator",value:function(t,e,n,r){var i;n instanceof gi&&(n=null);var a=null===(i=n)||void 0===i?void 0:i.cloneNode(!0);return a&&(a.style.isMarker=!0),a}}])}(),ro=function(){return b((function t(){y(this,t),this.mixer=ra}),[{key:"calculator",value:function(t,e,n){return n.value}}])}(),io=function(){return b((function t(){y(this,t),this.mixer=ia(0,1)}),[{key:"calculator",value:function(t,e,n){return n.value}},{key:"postProcessor",value:function(t){var e=t.parsedStyle,n=e.offsetPath,r=e.offsetDistance;if(n){var i=n.nodeName;if(i===In.LINE||i===In.PATH||i===In.POLYLINE){var a=n.getPoint(r);a&&t.setLocalPosition(a.x,a.y)}}}}])}(),ao=function(){return b((function t(){y(this,t),this.mixer=ia(0,1)}),[{key:"calculator",value:function(t,e,n){return n.value}}])}(),oo=function(){return b((function t(){y(this,t),this.parser=xa,this.mixer=wa}),[{key:"calculator",value:function(t,e,n){return n instanceof gi&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Kn(0,0,0,0)}:n}}])}(),so=b((function t(){y(this,t),this.mixer=Ea})),uo=function(t){function e(){var t;y(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=S(this,e,[].concat(r))).mixer=ia(0,1/0),t}return N(e,t),b(e)}(Ja),co=function(){return b((function t(){y(this,t)}),[{key:"calculator",value:function(t,e,n,r){return n instanceof gi?"unset"===n.value?"":n.value:"".concat(n)}},{key:"postProcessor",value:function(t){t.nodeValue="".concat(t.parsedStyle.text)||""}}])}(),lo=function(){return b((function t(){y(this,t)}),[{key:"calculator",value:function(t,e,n,r){var i=r.getAttribute("text");if(i){var a=i;"capitalize"===n.value?a=i.charAt(0).toUpperCase()+i.slice(1):"lowercase"===n.value?a=i.toLowerCase():"uppercase"===n.value&&(a=i.toUpperCase()),r.parsedStyle.text=a}return n.value}}])}(),ho=new WeakMap,fo="undefined"!=typeof window&&void 0!==window.document;function vo(t){return!!t.getAttribute}function po(t,e){var n=Number(t.parsedStyle.zIndex||0),r=Number(e.parsedStyle.zIndex||0);if(n===r){var i=t.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(t)-a.indexOf(e)}}return n-r}function go(t){var e=t;do{var n;if(null===(n=e.parsedStyle)||void 0===n?void 0:n.clipPath)return e;e=e.parentElement}while(null!==e);return null}function yo(t,e){if(fo)return document.defaultView.getComputedStyle(t,null).getPropertyValue(e)}var mo={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},bo="object"==typeof performance&&performance.now?performance:Date;function xo(t){return t.nodeName===In.FRAGMENT||t.getRootNode().nodeName===In.FRAGMENT}function wo(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=!1,i=!1,a=!!e&&!e.isNone,o=!!n&&!n.isNone;return"visiblepainted"===t||"painted"===t||"auto"===t?(r=a,i=o):"visiblefill"===t||"fill"===t?r=!0:"visiblestroke"===t||"stroke"===t?i=!0:"visible"!==t&&"all"!==t||(r=!0,i=!0),[r,i]}var Eo=1,ko="object"==typeof self&&self.self===self?self:"object"==typeof a.g&&a.g.global===a.g?a.g:{},Mo=Date.now(),So={},Oo=Date.now(),No=function(t){if("function"!=typeof t)throw new TypeError("".concat(t," is not a function"));var e=Date.now(),n=e-Oo,r=n>16?0:16-n,i=Eo++;return So[i]=t,Object.keys(So).length>1||setTimeout((function(){Oo=e;var t=So;So={},Object.keys(t).forEach((function(e){return t[e](ko.performance&&"function"==typeof ko.performance.now?ko.performance.now():Date.now()-Mo)}))}),r),i},Ao=function(t){delete So[t]},To=function(t){return"string"!=typeof t?No:""===t?ko.requestAnimationFrame:ko["".concat(t,"RequestAnimationFrame")]},Po=function(t,e){for(var n=0;void 0!==t[n];){if(e(t[n]))return t[n];n+=1}}(["","webkit","moz","ms","o"],(function(t){return!!To(t)})),Co=To(Po),Ro=function(t){return"string"!=typeof t?Ao:""===t?ko.cancelAnimationFrame:ko["".concat(t,"CancelAnimationFrame")]||ko["".concat(t,"CancelRequestAnimationFrame")]}(Po);ko.requestAnimationFrame=Co,ko.cancelAnimationFrame=Ro;var Lo=function(){return b((function t(){y(this,t),this.callbacks=[]}),[{key:"getCallbacksNum",value:function(){return this.callbacks.length}},{key:"tapPromise",value:function(t,e){this.callbacks.push(e)}},{key:"promise",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Promise.all(this.callbacks.map((function(t){return t.apply(void 0,e)})))}}])}(),Do=function(){return b((function t(){y(this,t),this.callbacks=[]}),[{key:"tapPromise",value:function(t,e){this.callbacks.push(e)}},{key:"promise",value:(t=Cn(Tn().mark((function t(){var e,n,r,i,a=arguments;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.callbacks.length){t.next=14;break}return t.next=3,(e=this.callbacks)[0].apply(e,a);case 3:n=t.sent,r=0;case 5:if(!(r<this.callbacks.length-1)){t.next=13;break}return i=this.callbacks[r],t.next=9,i(n);case 9:n=t.sent;case 10:r++,t.next=5;break;case 13:return t.abrupt("return",n);case 14:return t.abrupt("return",null);case 15:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})}]);var t}(),_o=function(){return b((function t(){y(this,t),this.callbacks=[]}),[{key:"tap",value:function(t,e){this.callbacks.push(e)}},{key:"call",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=arguments;this.callbacks.forEach((function(t){t.apply(void 0,r)}))}}])}(),Io=function(){return b((function t(){y(this,t),this.callbacks=[]}),[{key:"tap",value:function(t,e){this.callbacks.push(e)}},{key:"call",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(this.callbacks.length){for(var r=arguments,i=this.callbacks[0].apply(void 0,r),a=0;a<this.callbacks.length-1;a++)i=(0,this.callbacks[a])(i);return i}return null}}])}(),jo=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Fo=/([\"\'])[^\'\"]+\1/;function Bo(t,e,n){return nt(t),t[4]=Math.tan(e),t[1]=Math.tan(n),t}var zo=Z(),Go=Z(),Vo={scale:function(t){pt(zo,[t[0].value,t[1].value,1])},scaleX:function(t){pt(zo,[t[0].value,1,1])},scaleY:function(t){pt(zo,[1,t[0].value,1])},scaleZ:function(t){pt(zo,[1,1,t[0].value])},scale3d:function(t){pt(zo,[t[0].value,t[1].value,t[2].value])},translate:function(t){vt(zo,[t[0].value,t[1].value,0])},translateX:function(t){vt(zo,[t[0].value,0,0])},translateY:function(t){vt(zo,[0,t[0].value,0])},translateZ:function(t){vt(zo,[0,0,t[0].value])},translate3d:function(t){vt(zo,[t[0].value,t[1].value,t[2].value])},rotate:function(t){bt(zo,nr($i(t[0])))},rotateX:function(t){yt(zo,nr($i(t[0])))},rotateY:function(t){mt(zo,nr($i(t[0])))},rotateZ:function(t){bt(zo,nr($i(t[0])))},rotate3d:function(t){gt(zo,nr($i(t[3])),[t[0].value,t[1].value,t[2].value])},skew:function(t){Bo(zo,nr(t[0].value),nr(t[1].value))},skewX:function(t){Bo(zo,nr(t[0].value),0)},skewY:function(t){Bo(zo,0,nr(t[0].value))},matrix:function(t){et(zo,t[0].value,t[1].value,0,0,t[2].value,t[3].value,0,0,0,0,1,0,t[4].value,t[5].value,0,1)},matrix3d:function(e){et.apply(t,[zo].concat(w(e.map((function(t){return t.value})))))}},Wo=D(1,1,1),Ho=C(),Yo={translate:function(t,e){$s.sceneGraphService.setLocalScale(t,Wo,!1),$s.sceneGraphService.setLocalEulerAngles(t,Ho,void 0,void 0,!1),$s.sceneGraphService.setLocalPosition(t,[e[0].value,e[1].value,0],!1),$s.sceneGraphService.dirtifyLocal(t,t.transformable)}};function Uo(t,e){if(t.length){if(1===t.length&&Yo[t[0].t])return void Yo[t[0].t](e,t[0].d);for(var n=nt(Go),r=0;r<t.length;r++){var i=t[r],a=i.t,o=i.d,s=Vo[a];s&&(s(o),Ut(n,n,zo))}e.setLocalTransform(n)}else e.resetLocalTransform();return e.getLocalTransform()}var qo=function(){return b((function t(){y(this,t),this.parser=Pa,this.mixer=za}),[{key:"calculator",value:function(t,e,n,r){return n instanceof gi?[]:n}},{key:"postProcessor",value:function(t){Uo(t.parsedStyle.transform,t)}}])}(),Xo=function(){return b((function t(){y(this,t)}),[{key:"postProcessor",value:function(t){var e=t.parsedStyle.transformOrigin;e[0].unit===ii.kPixels&&e[1].unit===ii.kPixels?t.setOrigin(e[0].value,e[1].value):t.getGeometryBounds()}}])}(),Ko=function(){return b((function t(){y(this,t)}),[{key:"calculator",value:function(t,e,n,r){return n.value}},{key:"postProcessor",value:function(t){if(t.parentNode){var e=t.parentNode,n=e.renderable,r=e.sortable;n&&(n.dirty=!0),r&&(r.dirty=!0,r.dirtyReason=wr.Z_INDEX_CHANGED)}}}])}(),$o=function(){return b((function t(){y(this,t)}),[{key:"update",value:function(t,e){var n=t.cx,r=void 0===n?0:n,i=t.cy,a=void 0===i?0:i,o=t.r,s=void 0===o?0:o;return{cx:r,cy:a,hwidth:s,hheight:s}}}])}(),Zo=function(){return b((function t(){y(this,t)}),[{key:"update",value:function(t,e){var n=t.cx,r=void 0===n?0:n,i=t.cy,a=void 0===i?0:i,o=t.rx,s=void 0===o?0:o,u=t.ry;return{cx:r,cy:a,hwidth:s,hheight:void 0===u?0:u}}}])}(),Qo=function(){return b((function t(){y(this,t)}),[{key:"update",value:function(t){var e=t.x1,n=t.y1,r=t.x2,i=t.y2,a=Math.min(e,r),o=Math.max(e,r),s=Math.min(n,i),u=(o-a)/2,c=(Math.max(n,i)-s)/2;return{cx:a+u,cy:s+c,hwidth:u,hheight:c}}}])}(),Jo=function(){return b((function t(){y(this,t)}),[{key:"update",value:function(t){var e=t.d.rect,n=e.x,r=e.y,i=e.width/2,a=e.height/2;return{cx:n+i,cy:r+a,hwidth:i,hheight:a}}}])}(),ts=function(){return b((function t(){y(this,t)}),[{key:"update",value:function(t){if(t.points&&He(t.points.points)){var e=t.points.points,n=Math.min.apply(Math,w(e.map((function(t){return t[0]})))),r=Math.max.apply(Math,w(e.map((function(t){return t[0]})))),i=Math.min.apply(Math,w(e.map((function(t){return t[1]})))),a=Math.max.apply(Math,w(e.map((function(t){return t[1]})))),o=(r-n)/2,s=(a-i)/2;return{cx:n+o,cy:i+s,hwidth:o,hheight:s}}return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),es=function(){return b((function t(){y(this,t)}),[{key:"update",value:function(t,e){var n=t.x,r=void 0===n?0:n,i=t.y,a=void 0===i?0:i,o=t.src,s=t.width,u=void 0===s?0:s,c=t.height,l=u,h=void 0===c?0:c;return o&&!ce(o)&&(l||(l=o.width,t.width=l),h||(h=o.height,t.height=h)),{cx:r+l/2,cy:a+h/2,hwidth:l/2,hheight:h/2}}}])}(),ns=function(){return b((function t(e){y(this,t),this.globalRuntime=e}),[{key:"isReadyToMeasure",value:function(t,e){return t.text}},{key:"update",value:function(t,e){var n,r=t.text,i=t.textAlign,a=void 0===i?"start":i,o=t.lineWidth,s=void 0===o?1:o,u=t.textBaseline,c=void 0===u?"alphabetic":u,l=t.dx,h=void 0===l?0:l,d=t.dy,f=void 0===d?0:d,v=t.x,p=void 0===v?0:v,g=t.y,y=void 0===g?0:g;if(!this.isReadyToMeasure(t,e))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var m=((null==e||null===(n=e.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n?void 0:n.getConfig())||{}).offscreenCanvas,b=this.globalRuntime.textService.measureText(r,t,m);t.metrics=b;var x=b.width/2,w=b.height/2,E=p+x;"center"===a||"middle"===a?E+=s/2-x:"right"!==a&&"end"!==a||(E+=s-2*x);var k=y-w;return"middle"===c?k+=w:"top"===c||"hanging"===c?k+=2*w:"alphabetic"===c||"bottom"!==c&&"ideographic"!==c||(k+=0),h&&(E+=h),f&&(k+=f),{cx:E,cy:k,hwidth:x,hheight:w}}}])}(),rs=function(){return b((function t(){y(this,t)}),[{key:"update",value:function(t,e){return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),is=function(){return b((function t(){y(this,t)}),[{key:"update",value:function(t,e){var n=t.x,r=void 0===n?0:n,i=t.y,a=void 0===i?0:i,o=t.width,s=void 0===o?0:o,u=t.height,c=void 0===u?0:u;return{cx:r+s/2,cy:a+c/2,hwidth:s/2,hheight:c/2}}}])}(),as=function(){return b((function t(e){y(this,t),this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Xn,this.page=new Xn,this.canvas=new Xn,this.viewport=new Xn,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}),[{key:"name",get:function(){return this.type}},{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewportX",get:function(){return this.viewport.x}},{key:"viewportY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return!this.manager||this.path&&this.path[0]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"propagationPath",get:function(){return this.composedPath()}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw new Error($n)}}])}(),os=function(t){function e(){var t;y(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=S(this,e,[].concat(r))).client=new Xn,t.movement=new Xn,t.offset=new Xn,t.global=new Xn,t.screen=new Xn,t}return N(e,t),b(e,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}},{key:"initMouseEvent",value:function(){throw new Error($n)}}])}(as),ss=function(t){function e(){var t;y(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=S(this,e,[].concat(r))).width=0,t.height=0,t.isPrimary=!1,t}return N(e,t),b(e,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this)}}])}(os),us=function(t){function e(){return y(this,e),S(this,e,arguments)}return N(e,t),b(e,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this)}}])}(os),cs=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[null])).type=t,r.detail=n,Object.assign(r,n),r}return N(e,t),b(e)}(as),ls=new WeakMap,hs=function(){return b((function t(){y(this,t),this.emitter=new A}),[{key:"on",value:function(t,e,n){return this.addEventListener(t,e,n),this}},{key:"addEventListener",value:function(t,e,n){var r=!1,i=!1;if(un(n))r=n;else if(n){var a=n.capture;r=void 0!==a&&a;var o=n.once;i=void 0!==o&&o}r&&(t+="capture"),e=cn(e)?e:e.handleEvent;var s=cn(e)?void 0:e;return i?this.emitter.once(t,e,s):this.emitter.on(t,e,s),this}},{key:"off",value:function(t,e,n){return t?this.removeEventListener(t,e,n):this.removeAllEventListeners(),this}},{key:"removeAllEventListeners",value:function(){var t;null===(t=this.emitter)||void 0===t||t.removeAllListeners()}},{key:"removeEventListener",value:function(t,e,n){var r;if(!this.emitter)return this;(un(n)?n:null==n?void 0:n.capture)&&(t+="capture"),e=cn(e)?e:null===(r=e)||void 0===r?void 0:r.handleEvent;var i=cn(e)?void 0:e;return this.emitter.off(t,e,i),this}},{key:"emit",value:function(t,e){this.dispatchEvent(new cs(t,e))}},{key:"dispatchEvent",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=ls.get(this);if(r||(r=this.document?this:this.defaultView?this.defaultView:null===(e=this.ownerDocument)||void 0===e?void 0:e.defaultView)&&ls.set(this,r),r){if(t.manager=r.getEventService(),!t.manager)return!1;t.defaultPrevented=!1,t.path?t.path.length=0:t.page=[],n||(t.target=this),t.manager.dispatchEvent(t,t.type,n)}else this.emitter.emit(t.type,t);return!t.defaultPrevented}}])}(),ds=function(t){function e(){var t;y(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=S(this,e,[].concat(r))).shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.parentNode=null,t}return N(e,t),b(e,[{key:"textContent",get:function(){var t="";this.nodeName===In.TEXT&&(t+=this.style.text);var e,n=Rn(this.childNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.nodeName===In.TEXT?t+=r.nodeValue:t+=r.textContent}}catch(t){n.e(t)}finally{n.f()}return t},set:function(t){var e=this;this.childNodes.slice().forEach((function(t){e.removeChild(t)})),this.nodeName===In.TEXT&&(this.style.text="".concat(t))}},{key:"getRootNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0}},{key:"isDefaultNamespace",value:function(t){throw new Error($n)}},{key:"lookupNamespaceURI",value:function(t){throw new Error($n)}},{key:"lookupPrefix",value:function(t){throw new Error($n)}},{key:"normalize",value:function(){throw new Error($n)}},{key:"isEqualNode",value:function(t){return this===t}},{key:"isSameNode",value:function(t){return this.isEqualNode(t)}},{key:"parent",get:function(){return this.parentNode}},{key:"parentElement",get:function(){return null}},{key:"nextSibling",get:function(){return null}},{key:"previousSibling",get:function(){return null}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null}},{key:"compareDocumentPosition",value:function(t){if(t===this)return 0;for(var n=t,r=this,i=[n],a=[r];null!==(o=n.parentNode)&&void 0!==o?o:r.parentNode;){var o;n=n.parentNode?(i.push(n.parentNode),n.parentNode):n,r=r.parentNode?(a.push(r.parentNode),r.parentNode):r}if(n!==r)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var s=i.length>a.length?i:a,u=s===i?a:i;if(s[s.length-u.length]===u[0])return s===i?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var c=s.length-u.length,l=u.length-1;l>=0;l--){var h=u[l],d=s[c+l];if(d!==h){var f=h.parentNode.childNodes;return f.indexOf(h)<f.indexOf(d)?u===i?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING:s===i?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING}}return e.DOCUMENT_POSITION_FOLLOWING}},{key:"contain",value:function(t){return this.contains(t)}},{key:"contains",value:function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e}},{key:"getAncestor",value:function(t){for(var e=this;t>0&&e;)e=e.parentNode,t--;return e}},{key:"forEach",value:function(t){for(var e=[this];e.length>0;){var n=e.pop();if(!1===t(n))break;for(var r=n.childNodes.length-1;r>=0;r--)e.push(n.childNodes[r])}}}],[{key:"isNode",value:function(t){return!!t.childNodes}}])}(hs);ds.DOCUMENT_POSITION_DISCONNECTED=1,ds.DOCUMENT_POSITION_PRECEDING=2,ds.DOCUMENT_POSITION_FOLLOWING=4,ds.DOCUMENT_POSITION_CONTAINS=8,ds.DOCUMENT_POSITION_CONTAINED_BY=16,ds.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var fs=function(){return b((function t(e,n){var r=this;y(this,t),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=Z(),this.tmpVec3=C(),this.onPointerDown=function(t){var e=r.createPointerEvent(t);if(r.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)r.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){var n=2===e.button;r.dispatchEvent(e,n?"rightdown":"mousedown")}r.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),r.freeEvent(e)},this.onPointerUp=function(t){var e=bo.now(),n=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)r.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){var i=2===n.button;r.dispatchEvent(n,i?"rightup":"mouseup")}var a=r.trackingData(t.pointerId),o=r.findMountedTarget(a.pressTargetsByButton[t.button]),s=o;if(o&&!n.composedPath().includes(o)){for(var u=o;u&&!n.composedPath().includes(u);){if(n.currentTarget=u,r.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)r.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){var c=2===n.button;r.notifyTarget(n,c?"rightupoutside":"mouseupoutside")}ds.isNode(u)&&(u=u.parentNode)}delete a.pressTargetsByButton[t.button],s=u}if(s){var l,h=r.clonePointerEvent(n,"click");h.target=s,h.path=[],a.clicksByButton[t.button]||(a.clicksByButton[t.button]={clickCount:0,target:h.target,timeStamp:e});var d=r.context.renderingContext.root.ownerDocument.defaultView,f=a.clicksByButton[t.button];f.target===h.target&&e-f.timeStamp<d.getConfig().dblClickSpeed?++f.clickCount:f.clickCount=1,f.target=h.target,f.timeStamp=e,h.detail=f.clickCount,null!==(l=n.detail)&&void 0!==l&&l.preventClick||(r.context.config.useNativeClickEvent||"mouse"!==h.pointerType&&"touch"!==h.pointerType||r.dispatchEvent(h,"click"),r.dispatchEvent(h,"pointertap")),r.freeEvent(h)}r.freeEvent(n)},this.onPointerMove=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),n="mouse"===e.pointerType||"pen"===e.pointerType,i=r.trackingData(t.pointerId),a=r.findMountedTarget(i.overTargets);if(i.overTargets&&a!==e.target){var o="mousemove"===t.type?"mouseout":"pointerout",s=r.createPointerEvent(t,o,a||void 0);if(r.dispatchEvent(s,"pointerout"),n&&r.dispatchEvent(s,"mouseout"),!e.composedPath().includes(a)){var u=r.createPointerEvent(t,"pointerleave",a||void 0);for(u.eventPhase=u.AT_TARGET;u.target&&!e.composedPath().includes(u.target);)u.currentTarget=u.target,r.notifyTarget(u),n&&r.notifyTarget(u,"mouseleave"),ds.isNode(u.target)&&(u.target=u.target.parentNode);r.freeEvent(u)}r.freeEvent(s)}if(a!==e.target){var c="mousemove"===t.type?"mouseover":"pointerover",l=r.clonePointerEvent(e,c);r.dispatchEvent(l,"pointerover"),n&&r.dispatchEvent(l,"mouseover");for(var h=a&&ds.isNode(a)&&a.parentNode;h&&h!==(ds.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&h!==e.target;)h=h.parentNode;if(!h||h===(ds.isNode(r.rootTarget)&&r.rootTarget.parentNode)){var d=r.clonePointerEvent(e,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==a&&d.target!==(ds.isNode(r.rootTarget)&&r.rootTarget.parentNode);)d.currentTarget=d.target,r.notifyTarget(d),n&&r.notifyTarget(d,"mouseenter"),ds.isNode(d.target)&&(d.target=d.target.parentNode);r.freeEvent(d)}r.freeEvent(l)}r.dispatchEvent(e,"pointermove"),"touch"===e.pointerType&&r.dispatchEvent(e,"touchmove"),n&&(r.dispatchEvent(e,"mousemove"),r.cursor=r.getCursor(e.target)),i.overTargets=e.composedPath(),r.freeEvent(e)},this.onPointerOut=function(t){var e=r.trackingData(t.pointerId);if(e.overTargets){var n="mouse"===t.pointerType||"pen"===t.pointerType,i=r.findMountedTarget(e.overTargets),a=r.createPointerEvent(t,"pointerout",i||void 0);r.dispatchEvent(a),n&&r.dispatchEvent(a,"mouseout");var o=r.createPointerEvent(t,"pointerleave",i||void 0);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==(ds.isNode(r.rootTarget)&&r.rootTarget.parentNode);)o.currentTarget=o.target,r.notifyTarget(o),n&&r.notifyTarget(o,"mouseleave"),ds.isNode(o.target)&&(o.target=o.target.parentNode);e.overTargets=null,r.freeEvent(a),r.freeEvent(o)}r.cursor=null},this.onPointerOver=function(t){var e=r.trackingData(t.pointerId),n=r.createPointerEvent(t),i="mouse"===n.pointerType||"pen"===n.pointerType;r.dispatchEvent(n,"pointerover"),i&&r.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(r.cursor=r.getCursor(n.target));var a=r.clonePointerEvent(n,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==(ds.isNode(r.rootTarget)&&r.rootTarget.parentNode);)a.currentTarget=a.target,r.notifyTarget(a),i&&r.notifyTarget(a,"mouseenter"),ds.isNode(a.target)&&(a.target=a.target.parentNode);e.overTargets=n.composedPath(),r.freeEvent(n),r.freeEvent(a)},this.onPointerUpOutside=function(t){var e=r.trackingData(t.pointerId),n=r.findMountedTarget(e.pressTargetsByButton[t.button]),i=r.createPointerEvent(t);if(n){for(var a=n;a;)i.currentTarget=a,r.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType||"mouse"!==i.pointerType&&"pen"!==i.pointerType||r.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),ds.isNode(a)&&(a=a.parentNode);delete e.pressTargetsByButton[t.button]}r.freeEvent(i)},this.onWheel=function(t){var e=r.createWheelEvent(t);r.dispatchEvent(e),r.freeEvent(e)},this.onClick=function(t){if(r.context.config.useNativeClickEvent){var e=r.createPointerEvent(t);r.dispatchEvent(e),r.freeEvent(e)}},this.onPointerCancel=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(e),r.freeEvent(e)},this.globalRuntime=e,this.context=n}),[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear()}},{key:"getScale",value:function(){var t=this.context.contextService.getBoundingClientRect(),e=1,n=1,r=this.context.contextService.getDomElement();if(r&&t){var i=r.offsetWidth,a=r.offsetHeight;i&&a&&(e=t.width/i,n=t.height/a)}return{scaleX:e,scaleY:n,bbox:t}}},{key:"client2Viewport",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new Xn((t.x-((null==i?void 0:i.left)||0))/n,(t.y-((null==i?void 0:i.top)||0))/r)}},{key:"viewport2Client",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new Xn((t.x+((null==i?void 0:i.left)||0))*n,(t.y+((null==i?void 0:i.top)||0))*r)}},{key:"viewport2Canvas",value:function(t){var e=t.x,n=t.y,r=this.rootTarget.defaultView.getCamera(),i=this.context.config,a=i.width,o=i.height,s=r.getPerspectiveInverse(),u=r.getWorldTransform(),c=st(this.tmpMatrix,u,s),l=I(this.tmpVec3,e/a*2-1,2*(1-n/o)-1,0);return W(l,l,c),new Xn(l[0],l[1])}},{key:"canvas2Viewport",value:function(t){var e=this.rootTarget.defaultView.getCamera(),n=e.getPerspective(),r=e.getViewTransform(),i=st(this.tmpMatrix,n,r),a=I(this.tmpVec3,t.x,t.y,0);W(this.tmpVec3,this.tmpVec3,i);var o=this.context.config,s=o.width,u=o.height;return new Xn((a[0]+1)/2*s,(1-(a[1]+1)/2)*u)}},{key:"setPickHandler",value:function(t){this.pickHandler=t}},{key:"addEventMapping",value:function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((function(t,e){return t.priority-e.priority}))}},{key:"mapEvent",value:function(t){if(this.rootTarget){var e=this.mappingTable[t.type];if(e)for(var n=0,r=e.length;n<r;n++)e[n].fn(t);else console.warn("[EventService]: Event mapping not defined for ".concat(t.type))}}},{key:"dispatchEvent",value:function(t,e,n){if(n){t.eventPhase=t.AT_TARGET;var r=this.rootTarget.defaultView||null;t.currentTarget=r,this.notifyListeners(t,e)}else t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e)}},{key:"propagate",value:function(t,e){if(t.target){var n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var r=n.length-1;r>=1;r--)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){var i=n.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var a=i+1;a<n.length;a++)if(t.currentTarget=n[a],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}}},{key:"propagationPath",value:function(t){var e=[t],n=this.rootTarget.defaultView||null;if(n&&n===t)return e.unshift(n.document),e;for(var r=0;r<2048&&t!==this.rootTarget;r++)ds.isNode(t)&&t.parentNode&&(e.push(t.parentNode),t=t.parentNode);return n&&e.push(n),e}},{key:"hitTest",value:function(t){var e=t.viewportX,n=t.viewportY,r=this.context.config,i=r.width,a=r.height,o=r.disableHitTesting;return e<0||n<0||e>i||n>a?null:!o&&this.pickHandler(t)||this.rootTarget||null}},{key:"isNativeEventFromCanvas",value:function(t,e){var n,r=null==e?void 0:e.target;if(null!==(n=r)&&void 0!==n&&n.shadowRoot&&(r=e.composedPath()[0]),r){if(r===t)return!0;if(t&&t.contains)return t.contains(r)}return!(null==e||!e.composedPath)&&e.composedPath().indexOf(t)>-1}},{key:"getExistedHTML",value:function(t){if(t.nativeEvent.composedPath)for(var e=0,n=t.nativeEvent.composedPath();e<n.length;e++){var r=n[e],i=this.nativeHTMLMap.get(r);if(i)return i}return null}},{key:"pickTarget",value:function(t){return this.hitTest({clientX:t.clientX,clientY:t.clientY,viewportX:t.viewportX,viewportY:t.viewportY,x:t.canvasX,y:t.canvasY})}},{key:"createPointerEvent",value:function(t,e,n,r){var i=this.allocateEvent(ss);this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t;var a=this.getExistedHTML(i),o=this.context.contextService.getDomElement();return i.target=null!=n?n:a||this.isNativeEventFromCanvas(o,i.nativeEvent)&&this.pickTarget(i)||r,"string"==typeof e&&(i.type=e),i}},{key:"createWheelEvent",value:function(t){var e=this.allocateEvent(us);this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t;var n=this.getExistedHTML(e),r=this.context.contextService.getDomElement();return e.target=n||this.isNativeEventFromCanvas(r,e.nativeEvent)&&this.pickTarget(e),e}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}},{key:"cloneWheelEvent",value:function(t){var e=this.allocateEvent(us);return e.nativeEvent=t.nativeEvent,e.originalEvent=t.originalEvent,this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.target=t.target,e.path=t.composedPath().slice(),e.type=t.type,e}},{key:"clonePointerEvent",value:function(t,e){var n=this.allocateEvent(ss);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=null!=e?e:n.type,n}},{key:"copyPointerData",value:function(t,e){e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist}},{key:"copyMouseData",value:function(t,e){e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.client.copyFrom(t.client),e.movement.copyFrom(t.movement),e.canvas.copyFrom(t.canvas),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global),e.offset.copyFrom(t.offset)}},{key:"copyWheelData",value:function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}},{key:"copyData",value:function(t,e){e.isTrusted=t.isTrusted,e.timeStamp=bo.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.page.copyFrom(t.page),e.viewport.copyFrom(t.viewport)}},{key:"allocateEvent",value:function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.target=null,e}},{key:"freeEvent",value:function(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}},{key:"notifyTarget",value:function(t,e){e=null!=e?e:t.type;var n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}},{key:"notifyListeners",value:function(t,e){var n=t.currentTarget.emitter,r=n._events[e];if(r)if("fn"in r)r.once&&n.removeListener(e,r.fn,void 0,!0),r.fn.call(t.currentTarget||r.context,t);else for(var i=0;i<r.length&&!t.propagationImmediatelyStopped;i++)r[i].once&&n.removeListener(e,r[i].fn,void 0,!0),r[i].fn.call(t.currentTarget||r[i].context,t)}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var e=t[t.length-1],n=t.length-2;n>=0;n--){var r=t[n];if(!(r===this.rootTarget||ds.isNode(r)&&r.parentNode===e))break;e=t[n]}return e}},{key:"getCursor",value:function(t){for(var e=t;e;){var n=vo(e)&&e.getAttribute("cursor");if(n)return n;e=ds.isNode(e)&&e.parentNode}}}])}(),vs=function(){return b((function t(){y(this,t)}),[{key:"getOrCreateCanvas",value:function(t,e){if(this.canvas)return this.canvas;if(t||$s.offscreenCanvas)this.canvas=t||$s.offscreenCanvas,this.context=this.canvas.getContext("2d",g({willReadFrequently:!0},e));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",g({willReadFrequently:!0},e)),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",g({willReadFrequently:!0},e))}return this.canvas.width=10,this.canvas.height=10,this.canvas}},{key:"getOrCreateContext",value:function(t,e){return this.context||this.getOrCreateCanvas(t,e),this.context}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0)}catch(t){}try{return document.createElement("canvas")}catch(t){}return null}}])}(),ps=function(t){return t[t.CAMERA_CHANGED=0]="CAMERA_CHANGED",t[t.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",t[t.NONE=2]="NONE",t}({}),gs=function(){return b((function t(e,n){y(this,t),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new _o,initAsync:new Lo,dirtycheck:new Io,cull:new Io,beginFrame:new _o,beforeRender:new _o,render:new _o,afterRender:new _o,endFrame:new _o,destroy:new _o,pick:new Do,pickSync:new Io,pointerDown:new _o,pointerUp:new _o,pointerMove:new _o,pointerOut:new _o,pointerOver:new _o,pointerWheel:new _o,pointerCancel:new _o,click:new _o},this.globalRuntime=e,this.context=n}),[{key:"init",value:function(t){var e=this,n=g(g({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach((function(t){t.apply(n,e.globalRuntime)})),this.hooks.init.call(),0===this.hooks.initAsync.getCallbacksNum()?(this.inited=!0,t()):this.hooks.initAsync.promise().then((function(){e.inited=!0,t()})).catch((function(t){}))}},{key:"getStats",value:function(){return this.stats}},{key:"disableDirtyRectangleRendering",value:function(){return!this.context.config.renderer.getConfig().enableDirtyRectangleRendering||this.context.renderingContext.renderReasons.has(ps.CAMERA_CHANGED)}},{key:"render",value:function(t,e,n){var r=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var i=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(i.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),i.renderReasons.size&&this.inited){i.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var a=1===i.renderReasons.size&&i.renderReasons.has(ps.CAMERA_CHANGED),o=!t.disableRenderHooks||!(t.disableRenderHooks&&a);o&&this.renderDisplayObject(i.root,t,i),this.hooks.beginFrame.call(e),o&&i.renderListCurrentFrame.forEach((function(t){r.hooks.beforeRender.call(t),r.hooks.render.call(t),r.hooks.afterRender.call(t)})),this.hooks.endFrame.call(e),i.renderListCurrentFrame=[],i.renderReasons.clear(),n()}}},{key:"renderDisplayObject",value:function(t,e,n){var r=this,i=e.renderer.getConfig(),a=i.enableDirtyCheck,o=i.enableCulling;function s(t){var e=t.renderable,i=t.sortable,s=a?e.dirty||n.dirtyRectangleRenderingDisabled?t:null:t;if(s){var u=o?r.hooks.cull.call(s,r.context.camera):s;u&&(r.stats.rendered+=1,n.renderListCurrentFrame.push(u))}e.dirty=!1,i.renderOrder=r.zIndexCounter,r.zIndexCounter+=1,r.stats.total+=1,i.dirty&&(r.sort(t,i),i.dirty=!1,i.dirtyChildren=[],i.dirtyReason=void 0)}for(var u=[t];u.length>0;){var c=u.pop();s(c);for(var l=c.sortable.sorted||c.childNodes,h=l.length-1;h>=0;h--)u.push(l[h])}}},{key:"sort",value:function(t,e){e.sorted&&e.dirtyReason!==wr.Z_INDEX_CHANGED?e.dirtyChildren.forEach((function(n){if(-1===t.childNodes.indexOf(n)){var r=e.sorted.indexOf(n);r>=0&&e.sorted.splice(r,1)}else if(0===e.sorted.length)e.sorted.push(n);else{var i=function(t,e){for(var n=0,r=t.length;n<r;){var i=n+r>>>1;po(t[i],e)<0?n=i+1:r=i}return n}(e.sorted,n);e.sorted.splice(i,0,n)}})):e.sorted=t.childNodes.slice().sort(po)}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()}},{key:"dirtify",value:function(){this.context.renderingContext.renderReasons.add(ps.DISPLAY_OBJECT_CHANGED)}}])}(),ys=/\[\s*(.*)=(.*)\s*\]/,ms=function(){return b((function t(){y(this,t)}),[{key:"selectOne",value:function(t,e){var n=this;if(t.startsWith("."))return e.find((function(e){return((null==e?void 0:e.classList)||[]).indexOf(n.getIdOrClassname(t))>-1}));if(t.startsWith("#"))return e.find((function(e){return e.id===n.getIdOrClassname(t)}));if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.find((function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a)})):null}return e.find((function(n){return e!==n&&n.nodeName===t}))}},{key:"selectAll",value:function(t,e){var n=this;if(t.startsWith("."))return e.findAll((function(r){return e!==r&&((null==r?void 0:r.classList)||[]).indexOf(n.getIdOrClassname(t))>-1}));if(t.startsWith("#"))return e.findAll((function(r){return e!==r&&r.id===n.getIdOrClassname(t)}));if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.findAll((function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a)})):[]}return e.findAll((function(n){return e!==n&&n.nodeName===t}))}},{key:"is",value:function(t,e){if(t.startsWith("."))return e.className===this.getIdOrClassname(t);if(t.startsWith("#"))return e.id===this.getIdOrClassname(t);if(t.startsWith("[")){var n=this.getAttribute(t),r=n.name,i=n.value;return"name"===r?e.name===i:this.attributeToString(e,r)===i}return e.nodeName===t}},{key:"getIdOrClassname",value:function(t){return t.substring(1)}},{key:"getAttribute",value:function(t){var e=t.match(ys),n="",r="";return e&&e.length>2&&(n=e[1].replace(/"/g,""),r=e[2].replace(/"/g,"")),{name:n,value:r}}},{key:"attributeToString",value:function(t,e){if(!t.getAttribute)return"";var n=t.getAttribute(e);return ue(n)?"":n.toString?n.toString():""}}])}(),bs=function(t){return t.ATTR_MODIFIED="DOMAttrModified",t.INSERTED="DOMNodeInserted",t.MOUNTED="DOMNodeInsertedIntoDocument",t.REMOVED="removed",t.UNMOUNTED="DOMNodeRemovedFromDocument",t.REPARENT="reparent",t.DESTROY="destroy",t.BOUNDS_CHANGED="bounds-changed",t.CULLED="culled",t}({}),xs=function(t){function e(t,n,r,i,a,o,s,u){var c;return y(this,e),(c=S(this,e,[null])).relatedNode=n,c.prevValue=r,c.newValue=i,c.attrName=a,c.attrChange=o,c.prevParsedValue=s,c.newParsedValue=u,c.type=t,c}return N(e,t),b(e)}(as);function ws(t){var e=t.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0)}xs.ADDITION=2,xs.MODIFICATION=1,xs.REMOVAL=3;var Es,ks,Ms,Ss=new xs(bs.REPARENT,null,"","","",0,"",""),Os=ae(),Ns=C(),As=D(1,1,1),Ts=Z(),Ps=ae(),Cs=C(),Rs=Z(),Ls=Kt(),Ds=C(),_s=Kt(),Is=C(),js=C(),Fs=C(),Bs=Z(),zs=Kt(),Gs=Kt(),Vs=Kt(),Ws={affectChildren:!0},Hs=function(){return b((function t(e){y(this,t),this.pendingEvents=new Map,this.boundsChangedEvent=new cs(bs.BOUNDS_CHANGED),this.displayObjectDependencyMap=new WeakMap,this.runtime=e}),[{key:"matches",value:function(t,e){return this.runtime.sceneGraphSelector.is(t,e)}},{key:"querySelector",value:function(t,e){return this.runtime.sceneGraphSelector.selectOne(t,e)}},{key:"querySelectorAll",value:function(t,e){return this.runtime.sceneGraphSelector.selectAll(t,e)}},{key:"attach",value:function(t,e,n){var r,i=!1;t.parentNode&&(i=t.parentNode!==e,this.detach(t));var a=t.nodeName===In.FRAGMENT,o=xo(e);t.parentNode=e;var s=a?t.childNodes:[t];oe(n)?s.forEach((function(t){e.childNodes.splice(n,0,t),t.parentNode=e})):s.forEach((function(t){e.childNodes.push(t),t.parentNode=e}));var u=e.sortable;if((null!=u&&null!==(r=u.sorted)&&void 0!==r&&r.length||t.parsedStyle.zIndex)&&(-1===u.dirtyChildren.indexOf(t)&&u.dirtyChildren.push(t),u.dirty=!0,u.dirtyReason=wr.ADDED),!o){if(a)this.dirtifyFragment(t);else{var c=t.transformable;c&&this.dirtifyWorld(t,c)}i&&t.dispatchEvent(Ss)}}},{key:"detach",value:function(t){if(t.parentNode){var e,n,r=t.transformable,i=t.parentNode.sortable;(null!=i&&null!==(e=i.sorted)&&void 0!==e&&e.length||null!==(n=t.style)&&void 0!==n&&n.zIndex)&&(-1===i.dirtyChildren.indexOf(t)&&i.dirtyChildren.push(t),i.dirty=!0,i.dirtyReason=wr.REMOVED);var a=t.parentNode.childNodes.indexOf(t);a>-1&&t.parentNode.childNodes.splice(a,1),r&&this.dirtifyWorld(t,r),t.parentNode=null}}},{key:"getOrigin",value:function(t){return t.getGeometryBounds(),t.transformable.origin}},{key:"setOrigin",value:function(t,e){"number"==typeof e&&(e=[e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0]);var n=t.transformable;if(e[0]!==n.origin[0]||e[1]!==n.origin[1]||e[2]!==n.origin[2]){var r=n.origin;r[0]=e[0],r[1]=e[1],r[2]=e[2]||0,this.dirtifyLocal(t,n)}}},{key:"rotate",value:function(t,e){"number"==typeof e&&(e=D(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){var r=Ls;Jt(r,e[0],e[1],e[2]);var i=this.getRotation(t),a=this.getRotation(t.parentNode);ee(Vs,a),Qt(Vs,Vs),Zt(r,Vs,r),Zt(n.localRotation,r,i),ie(n.localRotation,n.localRotation),this.dirtifyLocal(t,n)}else this.rotateLocal(t,e)}},{key:"rotateLocal",value:function(t,e){"number"==typeof e&&(e=D(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;Jt(Gs,e[0],e[1],e[2]),re(n.localRotation,n.localRotation,Gs),this.dirtifyLocal(t,n)}},{key:"setEulerAngles",value:function(t,e){"number"==typeof e&&(e=D(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){Jt(n.localRotation,e[0],e[1],e[2]);var r=this.getRotation(t.parentNode);ee(zs,Qt(Ls,r)),re(n.localRotation,n.localRotation,zs),this.dirtifyLocal(t,n)}else this.setLocalEulerAngles(t,e)}},{key:"setLocalEulerAngles",value:function(t,e){var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];"number"==typeof e&&(e=D(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var r=t.transformable;Jt(r.localRotation,e[0],e[1],e[2]),n&&this.dirtifyLocal(t,r)}},{key:"translateLocal",value:function(t,e){"number"==typeof e&&(e=D(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;H(e,Ns)||(function(t,e,n){var r=n[0],i=n[1],a=n[2],o=n[3],s=e[0],u=e[1],c=e[2],l=i*c-a*u,h=a*s-r*c,d=r*u-i*s,f=i*d-a*h,v=a*l-r*d,p=r*h-i*l,g=2*o;l*=g,h*=g,d*=g,f*=2,v*=2,p*=2,t[0]=s+l+f,t[1]=u+h+v,t[2]=c+d+p}(e,e,n.localRotation),j(n.localPosition,n.localPosition,e),this.dirtifyLocal(t,n))}},{key:"setPosition",value:function(t,e){var n,r=t.transformable;if(Fs[0]=e[0],Fs[1]=e[1],Fs[2]=null!==(n=e[2])&&void 0!==n?n:0,!H(this.getPosition(t),Fs)){if(_(r.position,Fs),null!==t.parentNode&&t.parentNode.transformable){var i=t.parentNode.transformable;J(Bs,i.worldTransform),it(Bs,Bs),W(r.localPosition,Fs,Bs)}else _(r.localPosition,Fs);this.dirtifyLocal(t,r)}}},{key:"setLocalPosition",value:function(t,e){var n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t.transformable;js[0]=e[0],js[1]=e[1],js[2]=null!==(n=e[2])&&void 0!==n?n:0,H(i.localPosition,js)||(_(i.localPosition,js),r&&this.dirtifyLocal(t,i))}},{key:"scaleLocal",value:function(t,e){var n,r,i,a,o=t.transformable;r=o.localScale,i=o.localScale,a=I(Cs,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:1),r[0]=i[0]*a[0],r[1]=i[1]*a[1],r[2]=i[2]*a[2],this.dirtifyLocal(t,o)}},{key:"setLocalScale",value:function(t,e){var n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t.transformable;I(Cs,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:i.localScale[2]),H(Cs,i.localScale)||(_(i.localScale,Cs),r&&this.dirtifyLocal(t,i))}},{key:"translate",value:function(t,e){"number"==typeof e&&(e=I(Cs,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)),H(e,Ns)||(j(Cs,this.getPosition(t),e),this.setPosition(t,Cs))}},{key:"setRotation",value:function(t,e,n,r,i){var a=t.transformable;if("number"==typeof e&&(e=te(e,n,r,i)),null!==t.parentNode&&t.parentNode.transformable){var o=this.getRotation(t.parentNode);ee(Ls,o),Qt(Ls,Ls),Zt(a.localRotation,Ls,e),ie(a.localRotation,a.localRotation),this.dirtifyLocal(t,a)}else this.setLocalRotation(t,e)}},{key:"setLocalRotation",value:function(t,e,n,r,i){var a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];"number"==typeof e&&(e=ne(Ls,e,n,r,i));var o=t.transformable;ee(o.localRotation,e),a&&this.dirtifyLocal(t,o)}},{key:"setLocalSkew",value:function(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];"number"==typeof e&&(e=function(t,e,n){return t[0]=e,t[1]=n,t}(Ps,e,n));var i,a,o=t.transformable;i=o.localSkew,a=e,i[0]=a[0],i[1]=a[1],r&&this.dirtifyLocal(t,o)}},{key:"dirtifyLocal",value:function(t,e){xo(t)||e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtifyWorld(t,e))}},{key:"dirtifyWorld",value:function(t,e){e.dirtyFlag||this.unfreezeParentToRoot(t),this.dirtifyWorldInternal(t,e),this.dirtifyToRoot(t,!0)}},{key:"dirtifyFragment",value:function(t){var e=t.transformable;e&&(e.frozen=!1,e.dirtyFlag=!0,e.localDirtyFlag=!0);var n=t.renderable;n&&(n.renderBoundsDirty=!0,n.boundsDirty=!0,n.dirty=!0);for(var r=t.childNodes.length,i=0;i<r;i++)this.dirtifyFragment(t.childNodes[i]);t.nodeName===In.FRAGMENT&&this.pendingEvents.set(t,!1)}},{key:"triggerPendingEvents",value:function(){var t=this,e=new Set,n=function(n,r){n.isConnected&&!e.has(n)&&n.nodeName!==In.FRAGMENT&&(t.boundsChangedEvent.detail=r,t.boundsChangedEvent.target=n,n.isMutationObserved?n.dispatchEvent(t.boundsChangedEvent):n.ownerDocument.defaultView.dispatchEvent(t.boundsChangedEvent,!0),e.add(n))};this.pendingEvents.forEach((function(t,e){e.nodeName!==In.FRAGMENT&&(Ws.affectChildren=t,t?e.forEach((function(t){n(t,Ws)})):n(e,Ws))})),e.clear(),this.clearPendingEvents()}},{key:"clearPendingEvents",value:function(){this.pendingEvents.clear()}},{key:"dirtifyToRoot",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t;for(n.renderable&&(n.renderable.dirty=!0);n;)ws(n),n=n.parentNode;e&&t.forEach((function(t){ws(t)})),this.informDependentDisplayObjects(t),this.pendingEvents.set(t,e)}},{key:"updateDisplayObjectDependency",value:function(t,e,n,r){if(e&&e!==n){var i=this.displayObjectDependencyMap.get(e);if(i&&i[t]){var a=i[t].indexOf(r);i[t].splice(a,1)}}if(n){var o=this.displayObjectDependencyMap.get(n);o||(this.displayObjectDependencyMap.set(n,{}),o=this.displayObjectDependencyMap.get(n)),o[t]||(o[t]=[]),o[t].push(r)}}},{key:"informDependentDisplayObjects",value:function(t){var e=this,n=this.displayObjectDependencyMap.get(t);n&&Object.keys(n).forEach((function(t){n[t].forEach((function(n){e.dirtifyToRoot(n,!0),n.dispatchEvent(new xs(bs.ATTR_MODIFIED,n,e,e,t,xs.MODIFICATION,e,e)),n.isCustomElement&&n.isConnected&&n.attributeChangedCallback&&n.attributeChangedCallback(t,e,e)}))}))}},{key:"getPosition",value:function(t){var e=t.transformable;return Et(e.position,this.getWorldTransform(t,e))}},{key:"getRotation",value:function(t){var e=t.transformable;return Mt(e.rotation,this.getWorldTransform(t,e))}},{key:"getScale",value:function(t){var e=t.transformable;return kt(e.scaling,this.getWorldTransform(t,e))}},{key:"getWorldTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.transformable;return e.localDirtyFlag||e.dirtyFlag?(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.sync(t,e),e.worldTransform):e.worldTransform}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation}},{key:"getLocalScale",value:function(t){return t.transformable.localScale}},{key:"getLocalSkew",value:function(t){return t.transformable.localSkew}},{key:"calcLocalTransform",value:function(t){if(0!==t.localSkew[0]||0!==t.localSkew[1]){Ot(t.localTransform,t.localRotation,t.localPosition,D(1,1,1),t.origin),0===t.localSkew[0]&&0===t.localSkew[1]||(nt(Rs),Rs[4]=Math.tan(t.localSkew[0]),Rs[1]=Math.tan(t.localSkew[1]),st(t.localTransform,t.localTransform,Rs));var e=Ot(Rs,ne(Ls,0,0,0,1),I(Cs,1,1,1),t.localScale,t.origin);st(t.localTransform,t.localTransform,e)}else{var n=t.localTransform,r=t.localPosition,i=t.localRotation,a=t.localScale,o=t.origin,s=0!==r[0]||0!==r[1]||0!==r[2],u=1!==i[3]||0!==i[0]||0!==i[1]||0!==i[2],c=1!==a[0]||1!==a[1]||1!==a[2],l=0!==o[0]||0!==o[1]||0!==o[2];u||c||l?Ot(n,i,r,a,o):s?vt(n,r):nt(n)}}},{key:"getLocalTransform",value:function(t){var e=t.transformable;return e.localDirtyFlag&&(this.calcLocalTransform(e),e.localDirtyFlag=!1),e.localTransform}},{key:"setLocalTransform",value:function(t,e){var n=Et(Ds,e),r=Mt(_s,e),i=kt(Is,e);this.setLocalScale(t,i,!1),this.setLocalPosition(t,n,!1),this.setLocalRotation(t,r,void 0,void 0,void 0,!1),this.dirtifyLocal(t,t.transformable)}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,As,!1),this.setLocalPosition(t,Ns,!1),this.setLocalEulerAngles(t,Ns,void 0,void 0,!1),this.setLocalSkew(t,Os,void 0,!1),this.dirtifyLocal(t,t.transformable)}},{key:"getTransformedGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.getGeometryBounds(t,e);if(!Hn.isEmpty(r)){var i=n||new Hn;return i.setFromTransformedAABB(r,this.getWorldTransform(t)),i}return null}},{key:"getGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.geometry;return n.dirty&&$s.styleValueRegistry.updateGeometry(t),(e?n.renderBounds:n.contentBounds||null)||new Hn}},{key:"getBounds",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.renderable;if(!r.boundsDirty&&!n&&r.bounds)return r.bounds;if(!r.renderBoundsDirty&&n&&r.renderBounds)return r.renderBounds;var i=n?r.renderBounds:r.bounds,a=this.getTransformedGeometryBounds(t,n,i);if(t.childNodes.forEach((function(t){var r=e.getBounds(t,n);r&&(a?a.add(r):(a=i||new Hn).update(r.center,r.halfExtents))})),a||(a=new Hn),n){var o=go(t);if(o){var s=o.parsedStyle.clipPath.getBounds(n);a?s&&(a=s.intersection(a)):a.update(s.center,s.halfExtents)}}return n?(r.renderBounds=a,r.renderBoundsDirty=!1):(r.bounds=a,r.boundsDirty=!1),a}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var e=Ts;t.parentNode.transformable&&(e=it(Rs,this.getWorldTransform(t.parentNode)));var n=this.getBounds(t);if(!Hn.isEmpty(n)){var r=new Hn;return r.setFromTransformedAABB(n,e),r}}return this.getBounds(t)}},{key:"getBoundingClientRect",value:function(t){var e,n,r=this.getGeometryBounds(t);Hn.isEmpty(r)||(n=new Hn).setFromTransformedAABB(r,this.getWorldTransform(t));var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e?void 0:e.getContextService().getBoundingClientRect();if(n){var a=h(n.getMin(),2),o=a[0],s=a[1],u=h(n.getMax(),2),c=u[0],l=u[1];return new Kn(o+((null==i?void 0:i.left)||0),s+((null==i?void 0:i.top)||0),c-o,l-s)}return new Kn((null==i?void 0:i.left)||0,(null==i?void 0:i.top)||0,0,0)}},{key:"dirtifyWorldInternal",value:function(t,e){var n=this;if(!e.dirtyFlag){e.dirtyFlag=!0,e.frozen=!1,t.childNodes.forEach((function(t){var e=t.transformable;e.dirtyFlag||n.dirtifyWorldInternal(t,e)}));var r=t.renderable;r&&(r.renderBoundsDirty=!0,r.boundsDirty=!0,r.dirty=!0)}}},{key:"syncHierarchy",value:function(t){var e=t.transformable;if(!e.frozen){e.frozen=!0,(e.localDirtyFlag||e.dirtyFlag)&&this.sync(t,e);for(var n=t.childNodes,r=0;r<n.length;r++)this.syncHierarchy(n[r])}}},{key:"sync",value:function(t,e){if(e.localDirtyFlag&&(this.calcLocalTransform(e),e.localDirtyFlag=!1),e.dirtyFlag){var n=t.parentNode,r=n&&n.transformable;null!==n&&r?st(e.worldTransform,r.worldTransform,e.localTransform):J(e.worldTransform,e.localTransform),e.dirtyFlag=!1}}},{key:"unfreezeParentToRoot",value:function(t){for(var e=t.parentNode;e;){var n=e.transformable;n&&(n.frozen=!1),e=e.parentNode}}}])}(),Ys={MetricsString:"|ÉqÅ",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},Us=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,qs=new RegExp("".concat(/[!%),.:;?\]}¢°·'""†‡›℃∶、。〃〆〕〗〞﹚﹜！＂％＇），．：；？！］｝～]/.source,"|").concat(/[!),.:;?\]}¢·–—'"•"、。〆〞〕〉》」︰︱︲︳﹐﹑﹒﹓﹔﹕﹖﹘﹚﹜！），．：；？︶︸︺︼︾﹀﹂﹗］｜｝､]/.source,"|").concat(/[)\]｝〕〉》」』】〙〗〟'"｠»ヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻‐゠–〜?!‼⁇⁈⁉・、:;,。.]/.source,"|").concat(/[!%),.:;?\]}¢°'"†‡℃〆〈《「『〕！％），．：；？］｝]/.source)),Xs=new RegExp("".concat(/[$(£¥·'"〈《「『【〔〖〝﹙﹛＄（．［｛￡￥]/.source,"|").concat(/[([{£¥'"‵〈《「『〔〝︴﹙﹛（｛︵︷︹︻︽︿﹁﹃﹏]/.source,"|").concat(/[([｛〔〈《「『【〘〖〝'"｟«—...‥〳〴〵]/.source,"|").concat(/[$([{£¥'"々〇〉》」〔＄（［｛｠￥￦#]/.source)),Ks=function(){return b((function t(e){var n=this;y(this,t),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(t,e){return!n.isBreakingSpace(e)&&!(!t||!Xs.exec(e)&&!qs.exec(t))},this.trimByKinsokuShorui=function(t){var e=w(t),n=e[e.length-2];if(!n)return t;var r=n[n.length-1];return e[e.length-2]=n.slice(0,-1),e[e.length-1]=r+e[e.length-1],e},this.runtime=e}),[{key:"measureFont",value:function(t,e){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var n={ascent:0,descent:0,fontSize:0},r=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(e),i=this.runtime.offscreenCanvasCreator.getOrCreateContext(e,{willReadFrequently:!0});i.font=t;var a=Ys.MetricsString+Ys.BaselineSymbol,o=Math.ceil(i.measureText(a).width),s=Math.ceil(i.measureText(Ys.BaselineSymbol).width),u=Ys.HeightMultiplier*s;s=s*Ys.BaselineMultiplier|0,r.width=o,r.height=u,i.fillStyle="#f00",i.fillRect(0,0,o,u),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(a,0,s);var c=i.getImageData(0,0,o||1,u||1).data,l=c.length,h=4*o,d=0,f=0,v=!1;for(d=0;d<s;++d){for(var p=0;p<h;p+=4)if(255!==c[f+p]){v=!0;break}if(v)break;f+=h}for(n.ascent=s-d,f=l-h,v=!1,d=u;d>s;--d){for(var g=0;g<h;g+=4)if(255!==c[f+g]){v=!0;break}if(v)break;f-=h}return n.descent=d-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[t]=n,n}},{key:"measureText",value:function(t,e,n){var r=e.fontSize,i=void 0===r?16:r,a=e.wordWrap,o=void 0!==a&&a,s=e.lineHeight,u=e.lineWidth,c=void 0===u?1:u,l=e.textBaseline,h=void 0===l?"alphabetic":l,d=e.textAlign,f=void 0===d?"start":d,v=e.letterSpacing,p=void 0===v?0:v,g=e.textPath;e.textPathSide,e.textPathStartOffset;var y=e.leading,m=void 0===y?0:y,b=function(t){for(var e=t.fontSize,n=void 0===e?16:e,r=t.fontFamily,i=void 0===r?"sans-serif":r,a=t.fontStyle,o=void 0===a?"normal":a,s=t.fontVariant,u=void 0===s?"normal":s,c=t.fontWeight,l=void 0===c?"normal":c,h=oe(n)&&"".concat(n,"px")||"16px",d=i.split(","),f=d.length-1;f>=0;f--){var v=d[f].trim();!Fo.test(v)&&jo.indexOf(v)<0&&(v='"'.concat(v,'"')),d[f]=v}return"".concat(o," ").concat(u," ").concat(l," ").concat(h," ").concat(d.join(","))}(e),x=this.measureFont(b,n);0===x.fontSize&&(x.fontSize=i,x.ascent=i);var w=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);w.font=b,e.isOverflowing=!1;var E=(o?this.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),k=new Array(E.length),M=0;if(!g){for(var S=0;S<E.length;S++){var O=w.measureText(E[S]).width+(E[S].length-1)*p;k[S]=O,M=Math.max(M,O)}var N=M+c,A=s||x.fontSize+c,T=Math.max(A,x.fontSize+c)+(E.length-1)*(A+m),P=0;return"middle"===h?P=-T/2:"bottom"===h||"alphabetic"===h||"ideographic"===h?P=-T:"top"!==h&&"hanging"!==h||(P=0),{font:b,width:N,height:T,lines:E,lineWidths:k,lineHeight:A+=m,maxLineWidth:M,fontProperties:x,lineMetrics:k.map((function(t,e){var n=0;return"center"===f||"middle"===f?n-=t/2:"right"!==f&&"end"!==f||(n-=t),new Kn(n-c/2,P+e*A,t+c,A)}))}}g.getTotalLength();for(var C=0;C<E.length;C++)w.measureText(E[C]).width,E[C].length}},{key:"wordWrap",value:function(t,e,n){var r=this,i=this,a=e.wordWrapWidth,o=void 0===a?0:a,s=e.letterSpacing,u=void 0===s?0:s,c=e.maxLines,l=void 0===c?1/0:c,h=e.textOverflow,d=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),f=o+u,v="";"ellipsis"===h?v="...":h&&"clip"!==h&&(v=h);var p=Array.from(t),g=[],y=0,m=0,b=0,x={},w=function(t){return r.getFromCache(t,u,x,d)},E=w(v);function k(t,e,n,r){for(;w(t)<r&&e<p.length-1&&!i.isNewline(p[e+1]);)t+=p[e+=1];for(;w(t)>r&&e>n;)e-=1,t=t.slice(0,-1);return{lineTxt:t,txtLastCharIndex:e}}function M(t,e){if(!(E<=0||E>f))if(g[t]){var n=k(g[t],e,b+1,f-E);g[t]=n.lineTxt+v}else g[t]=v}for(var S=0;S<p.length;S++){var O=p[S],N=p[S-1],A=p[S+1],T=w(O);if(this.isNewline(O)){if(y+1>=l){e.isOverflowing=!0,S<p.length-1&&M(y,S-1);break}b=S-1,m=0,g[y+=1]=""}else{if(m>0&&m+T>f){var P=k(g[y],S-1,b+1,f);if(P.txtLastCharIndex!==S-1){if(g[y]=P.lineTxt,P.txtLastCharIndex===p.length-1)break;S=P.txtLastCharIndex+1,O=p[S],N=p[S-1],A=p[S+1],T=w(O)}if(y+1>=l){e.isOverflowing=!0,M(y,S-1);break}if(b=S-1,m=0,g[y+=1]="",this.isBreakingSpace(O))continue;this.canBreakInLastChar(O)||(g=this.trimToBreakable(g),m=this.sumTextWidthByCache(g[y]||"",w)),this.shouldBreakByKinsokuShorui(O,A)&&(g=this.trimByKinsokuShorui(g),m+=w(N||""))}m+=T,g[y]=(g[y]||"")+O}}return g.join("\n")}},{key:"isBreakingSpace",value:function(t){return"string"==typeof t&&Ys.BreakingSpaces.indexOf(t.charCodeAt(0))>=0}},{key:"isNewline",value:function(t){return"string"==typeof t&&Ys.Newlines.indexOf(t.charCodeAt(0))>=0}},{key:"trimToBreakable",value:function(t){var e=w(t),n=e[e.length-2],r=this.findBreakableIndex(n);if(-1===r||!n)return e;var i=n.slice(r,r+1),a=r+1,o=r+(this.isBreakingSpace(i)?0:1);return e[e.length-1]+=n.slice(a,n.length),e[e.length-2]=n.slice(0,o),e}},{key:"canBreakInLastChar",value:function(t){return!t||!Us.test(t)}},{key:"sumTextWidthByCache",value:function(t,e){return t.split("").reduce((function(t,n){return t+e(n)}),0)}},{key:"findBreakableIndex",value:function(t){for(var e=t.length-1;e>=0;e--)if(!Us.test(t[e]))return e;return-1}},{key:"getFromCache",value:function(t,e,n,r){var i=n[t];if("number"!=typeof i){var a=t.length*e;i=r.measureText(t).width+a,n[t]=i}return i}}])}(),$s={},Zs=(ks=new es,Ms=new ts,v(v(v(v(v(v(v(v(v(v(Es={},In.FRAGMENT,null),In.CIRCLE,new $o),In.ELLIPSE,new Zo),In.RECT,ks),In.IMAGE,ks),In.GROUP,new rs),In.LINE,new Qo),In.TEXT,new ns($s)),In.POLYLINE,Ms),In.POLYGON,Ms),v(v(v(Es,In.PATH,new Jo),In.HTML,new is),In.MESH,null)),Qs=function(t){var e=new $a,n=new Ja;return v(v(v(v(v(v(v(v(v(v(t={},kr.PERCENTAGE,null),kr.NUMBER,new ro),kr.ANGLE,new Xa),kr.DEFINED_PATH,new Ka),kr.PAINT,e),kr.COLOR,e),kr.FILTER,new Za),kr.LENGTH,n),kr.LENGTH_PERCENTAGE,n),kr.LENGTH_PERCENTAGE_12,new to),v(v(v(v(v(v(v(v(v(v(t,kr.LENGTH_PERCENTAGE_14,new eo),kr.COORDINATE,new Ja),kr.OFFSET_DISTANCE,new io),kr.OPACITY_VALUE,new ao),kr.PATH,new oo),kr.LIST_OF_POINTS,new so),kr.SHADOW_BLUR,new uo),kr.TEXT,new co),kr.TEXT_TRANSFORM,new lo),kr.TRANSFORM,new qo),v(v(v(t,kr.TRANSFORM_ORIGIN,new Xo),kr.Z_INDEX,new Ko),kr.MARKER,new no)}();$s.CameraContribution=br,$s.AnimationTimeline=null,$s.EasingFunction=null,$s.offscreenCanvasCreator=new vs,$s.sceneGraphSelector=new ms,$s.sceneGraphService=new Hs($s),$s.textService=new Ks($s),$s.geometryUpdaterFactory=Zs,$s.CSSPropertySyntaxFactory=Qs,$s.styleValueRegistry=new Ua($s),$s.layoutRegistry=null,$s.globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==a.g?a.g:{},$s.enableStyleSyntax=!0,$s.enableSizeAttenuation=!1;var Js=0,tu=new xs(bs.INSERTED,null,"","","",0,"",""),eu=new xs(bs.REMOVED,null,"","","",0,"",""),nu=new cs(bs.DESTROY),ru=function(t){function e(){var t;y(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=S(this,e,[].concat(r))).entity=Js++,t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.cullable={strategy:xr.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.destroyed=!1,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t}return N(e,t),b(e,[{key:"className",get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)}},{key:"classList",get:function(){return this.className.split(" ").filter((function(t){return""!==t}))}},{key:"tagName",get:function(){return this.nodeName}},{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"parentElement",get:function(){return this.parentNode}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null}return null}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null}return null}},{key:"cloneNode",value:function(t){throw new Error($n)}},{key:"appendChild",value:function(t,e){var n;if(t.destroyed)throw new Error("Cannot append a destroyed element.");return $s.sceneGraphService.attach(t,this,e),null!==(n=this.ownerDocument)&&void 0!==n&&n.defaultView&&(xo(this)||t.nodeName!==In.FRAGMENT?this.ownerDocument.defaultView.mountChildren(t):this.ownerDocument.defaultView.mountFragment(t)),this.isMutationObserved&&(tu.relatedNode=this,t.dispatchEvent(tu)),t}},{key:"insertBefore",value:function(t,e){if(e){t.parentElement&&t.parentElement.removeChild(t);var n=this.childNodes.indexOf(e);-1===n?this.appendChild(t):this.appendChild(t,n)}else this.appendChild(t);return t}},{key:"replaceChild",value:function(t,e){var n=this.childNodes.indexOf(e);return this.removeChild(e),this.appendChild(t,n),e}},{key:"removeChild",value:function(t){var e;return eu.relatedNode=this,t.dispatchEvent(eu),null!==(e=t.ownerDocument)&&void 0!==e&&e.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),$s.sceneGraphService.detach(t),t}},{key:"removeChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];this.removeChild(e)}}},{key:"destroyChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];e.childNodes.length>0&&e.destroyChildren(),e.destroy()}}},{key:"matches",value:function(t){return $s.sceneGraphService.matches(t,this)}},{key:"getElementById",value:function(t){return $s.sceneGraphService.querySelector("#".concat(t),this)}},{key:"getElementsByName",value:function(t){return $s.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this)}},{key:"getElementsByClassName",value:function(t){return $s.sceneGraphService.querySelectorAll(".".concat(t),this)}},{key:"getElementsByTagName",value:function(t){return $s.sceneGraphService.querySelectorAll(t,this)}},{key:"querySelector",value:function(t){return $s.sceneGraphService.querySelector(t,this)}},{key:"querySelectorAll",value:function(t){return $s.sceneGraphService.querySelectorAll(t,this)}},{key:"closest",value:function(t){var e=this;do{if($s.sceneGraphService.matches(t,e))return e;e=e.parentElement}while(null!==e);return null}},{key:"find",value:function(t){var e=this,n=null;return this.forEach((function(r){return r===e||!t(r)||(n=r,!1)})),n}},{key:"findAll",value:function(t){var e=this,n=[];return this.forEach((function(r){r!==e&&t(r)&&n.push(r)})),n}},{key:"after",value:function(){var t=this;if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach((function(n,r){var i;return null===(i=t.parentNode)||void 0===i?void 0:i.appendChild(n,e+r+1)}))}}},{key:"before",value:function(){if(this.parentNode){for(var t,e=this.parentNode.childNodes.indexOf(this),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=r[0],o=r.slice(1);this.parentNode.appendChild(a,e),(t=a).after.apply(t,w(o))}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove()}},{key:"append",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach((function(e){return t.appendChild(e)}))}},{key:"prepend",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach((function(e,n){return t.appendChild(e,n)}))}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments)}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this}},{key:"destroy",value:function(){this.destroyChildren(),this.dispatchEvent(nu),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0}},{key:"getGeometryBounds",value:function(){return $s.sceneGraphService.getGeometryBounds(this)}},{key:"getRenderBounds",value:function(){return $s.sceneGraphService.getBounds(this,!0)}},{key:"getBounds",value:function(){return $s.sceneGraphService.getBounds(this)}},{key:"getLocalBounds",value:function(){return $s.sceneGraphService.getLocalBounds(this)}},{key:"getBoundingClientRect",value:function(){return $s.sceneGraphService.getBoundingClientRect(this)}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle))}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes)}},{key:"getAttribute",value:function(t){if("symbol"!=typeof t)return this.attributes[t]}},{key:"hasAttribute",value:function(t){return this.getAttributeNames().includes(t)}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null),delete this.attributes[t]}},{key:"setAttribute",value:function(t,e,n,r){this.attributes[t]=e}},{key:"getAttributeNS",value:function(t,e){throw new Error($n)}},{key:"getAttributeNode",value:function(t){throw new Error($n)}},{key:"getAttributeNodeNS",value:function(t,e){throw new Error($n)}},{key:"hasAttributeNS",value:function(t,e){throw new Error($n)}},{key:"removeAttributeNS",value:function(t,e){throw new Error($n)}},{key:"removeAttributeNode",value:function(t){throw new Error($n)}},{key:"setAttributeNS",value:function(t,e,n){throw new Error($n)}},{key:"setAttributeNode",value:function(t){throw new Error($n)}},{key:"setAttributeNodeNS",value:function(t){throw new Error($n)}},{key:"toggleAttribute",value:function(t,e){throw new Error($n)}}])}(ds);function iu(t){return!(null==t||!t.nodeName)}var au=$s.globalThis.Proxy?$s.globalThis.Proxy:function(){},ou=new xs(bs.ATTR_MODIFIED,null,null,null,null,xs.MODIFICATION,null,null),su=C(),uu=Kt(),cu=function(t){function e(t){var n;return y(this,e),(n=S(this,e)).isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=t,n.id=t.id||"",n.name=t.name||"",(t.className||t.class)&&(n.className=t.className||t.class),n.nodeName=t.type||In.GROUP,t.initialParsedStyle&&Object.assign(n.parsedStyle,t.initialParsedStyle),n.initAttributes(t.style),$s.enableStyleSyntax&&(n.style=new au({setProperty:function(t,e){n.setAttribute(t,e)},getPropertyValue:function(t){return n.getAttribute(t)},removeProperty:function(t){n.removeAttribute(t)},item:function(){return""}},{get:function(t,e){return void 0!==t[e]?t[e]:n.getAttribute(e)},set:function(t,e,r){return n.setAttribute(e,r),!0}})),n}return N(e,t),b(e,[{key:"destroy",value:function(){dn(e,"destroy",this,3)([]),this.getAnimations().forEach((function(t){t.cancel()}))}},{key:"cloneNode",value:function(t,e){var n=g({},this.attributes);for(var r in n){var i=n[r];iu(i)&&"clipPath"!==r&&"offsetPath"!==r&&"textPath"!==r&&(n[r]=i.cloneNode(t)),e&&(n[r]=e(r,i))}var a=new this.constructor(g(g({},this.config),{},{style:n}));return a.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach((function(e){if(!e.style.isMarker){var n=e.cloneNode(t);a.appendChild(n)}})),a}},{key:"initAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};$s.styleValueRegistry.processProperties(this,t,{forceUpdateGeometry:!0}),this.renderable.dirty=!0}},{key:"setAttribute",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];an(n)||(r||n!==this.attributes[t])&&(this.internalSetAttribute(t,n,{memoize:i}),dn(e,"setAttribute",this,3)([t,n]))}},{key:"internalSetAttribute",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.renderable,i=this.attributes[t],a=this.parsedStyle[t];$s.styleValueRegistry.processProperties(this,v({},t,e),n),r.dirty=!0;var o,s=this.parsedStyle[t];this.isConnected&&(ou.relatedNode=this,ou.prevValue=i,ou.newValue=e,ou.attrName=t,ou.prevParsedValue=a,ou.newParsedValue=s,this.isMutationObserved?this.dispatchEvent(ou):(ou.target=this,this.ownerDocument.defaultView.dispatchEvent(ou,!0))),(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&(null===(o=this.attributeChangedCallback)||void 0===o||o.call(this,t,i,e,a,s))}},{key:"getBBox",value:function(){var t=this.getBounds(),e=h(t.getMin(),2),n=e[0],r=e[1],i=h(t.getMax(),2),a=i[0],o=i[1];return new Kn(n,r,a-n,o-r)}},{key:"setOrigin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return $s.sceneGraphService.setOrigin(this,tr(t,e,n,!1)),this}},{key:"getOrigin",value:function(){return $s.sceneGraphService.getOrigin(this)}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return $s.sceneGraphService.setPosition(this,tr(t,e,n,!1)),this}},{key:"setLocalPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return $s.sceneGraphService.setLocalPosition(this,tr(t,e,n,!1)),this}},{key:"translate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return $s.sceneGraphService.translate(this,tr(t,e,n,!1)),this}},{key:"translateLocal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return $s.sceneGraphService.translateLocal(this,tr(t,e,n,!1)),this}},{key:"getPosition",value:function(){return $s.sceneGraphService.getPosition(this)}},{key:"getLocalPosition",value:function(){return $s.sceneGraphService.getLocalPosition(this)}},{key:"scale",value:function(t,e,n){return this.scaleLocal(t,e,n)}},{key:"scaleLocal",value:function(t,e,n){return"number"==typeof t&&(t=tr(t,e=e||t,n=n||t,!1)),$s.sceneGraphService.scaleLocal(this,t),this}},{key:"setLocalScale",value:function(t,e,n){return"number"==typeof t&&(t=tr(t,e=e||t,n=n||t,!1)),$s.sceneGraphService.setLocalScale(this,t),this}},{key:"getLocalScale",value:function(){return $s.sceneGraphService.getLocalScale(this)}},{key:"getScale",value:function(){return $s.sceneGraphService.getScale(this)}},{key:"getEulerAngles",value:function(){return ir(h(or(su,$s.sceneGraphService.getWorldTransform(this)),3)[2])}},{key:"getLocalEulerAngles",value:function(){return ir(h(or(su,$s.sceneGraphService.getLocalRotation(this)),3)[2])}},{key:"setEulerAngles",value:function(t){return $s.sceneGraphService.setEulerAngles(this,0,0,t),this}},{key:"setLocalEulerAngles",value:function(t){return $s.sceneGraphService.setLocalEulerAngles(this,0,0,t),this}},{key:"rotateLocal",value:function(t,e,n){return ue(e)&&ue(n)?$s.sceneGraphService.rotateLocal(this,0,0,t):$s.sceneGraphService.rotateLocal(this,t,e,n),this}},{key:"rotate",value:function(t,e,n){return ue(e)&&ue(n)?$s.sceneGraphService.rotate(this,0,0,t):$s.sceneGraphService.rotate(this,t,e,n),this}},{key:"setRotation",value:function(t,e,n,r){return $s.sceneGraphService.setRotation(this,t,e,n,r),this}},{key:"setLocalRotation",value:function(t,e,n,r){return $s.sceneGraphService.setLocalRotation(this,t,e,n,r),this}},{key:"setLocalSkew",value:function(t,e){return $s.sceneGraphService.setLocalSkew(this,t,e),this}},{key:"getRotation",value:function(){return $s.sceneGraphService.getRotation(this)}},{key:"getLocalRotation",value:function(){return $s.sceneGraphService.getLocalRotation(this)}},{key:"getLocalSkew",value:function(){return $s.sceneGraphService.getLocalSkew(this)}},{key:"getLocalTransform",value:function(){return $s.sceneGraphService.getLocalTransform(this)}},{key:"getWorldTransform",value:function(){return $s.sceneGraphService.getWorldTransform(this)}},{key:"setLocalTransform",value:function(t){return $s.sceneGraphService.setLocalTransform(this,t),this}},{key:"resetLocalTransform",value:function(){$s.sceneGraphService.resetLocalTransform(this)}},{key:"getAnimations",value:function(){return this.activeAnimations}},{key:"animate",value:function(t,e){var n,r=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return r?r.play(this,t,e):null}},{key:"isVisible",value:function(){var t;return"hidden"!==(null===(t=this.parsedStyle)||void 0===t?void 0:t.visibility)}},{key:"interactive",get:function(){return this.isInteractive()},set:function(t){this.style.pointerEvents=t?"auto":"none"}},{key:"isInteractive",value:function(){var t;return"none"!==(null===(t=this.parsedStyle)||void 0===t?void 0:t.pointerEvents)}},{key:"isCulled",value:function(){return!(!this.cullable||!this.cullable.enable||this.cullable.visible)}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,w(this.parentNode.children.map((function(t){return Number(t.style.zIndex)}))))+1),this}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,w(this.parentNode.children.map((function(t){return Number(t.style.zIndex)}))))-1),this}},{key:"getConfig",value:function(){return this.config}},{key:"attr",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],a=n[1];return i?ln(i)?(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),this):2===n.length?(this.setAttribute(i,a),this):this.attributes[i]:this.attributes}},{key:"getMatrix",value:function(t){var e=t||this.getWorldTransform(),n=h(Et(su,e),2),r=n[0],i=n[1],a=h(kt(su,e),2),o=a[0],s=a[1],u=Mt(uu,e),c=h(or(su,u),3),l=c[0],d=c[2];return function(t,e,n,r,i){var a,o,s,u,c,l,h,d=Math.cos(t),f=Math.sin(t);return a=r*d,o=i*f,s=-r*f,u=i*d,c=e,l=n,(h=new P(9))[0]=a,h[1]=o,h[2]=0,h[3]=s,h[4]=u,h[5]=0,h[6]=c,h[7]=l,h[8]=1,h}(l||d,r,i,o,s)}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform())}},{key:"setMatrix",value:function(t){var e=h(sr(t),5),n=e[0],r=e[1],i=e[2],a=e[3],o=e[4];this.setEulerAngles(o).setPosition(n,r).setLocalScale(i,a)}},{key:"setLocalMatrix",value:function(t){var e=h(sr(t),5),n=e[0],r=e[1],i=e[2],a=e[3],o=e[4];this.setLocalEulerAngles(o).setLocalPosition(n,r).setLocalScale(i,a)}},{key:"show",value:function(){this.forEach((function(t){t.style.visibility="visible"}))}},{key:"hide",value:function(){this.forEach((function(t){t.style.visibility="hidden"}))}},{key:"getCount",value:function(){return this.childElementCount}},{key:"getParent",value:function(){return this.parentElement}},{key:"getChildren",value:function(){return this.children}},{key:"getFirst",value:function(){return this.firstElementChild}},{key:"getLast",value:function(){return this.lastElementChild}},{key:"getChildByIndex",value:function(t){return this.children[t]||null}},{key:"add",value:function(t,e){return this.appendChild(t,e)}},{key:"set",value:function(t,e){this.config[t]=e}},{key:"get",value:function(t){return this.config[t]}},{key:"moveTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this}},{key:"setZIndex",value:function(t){return this.style.zIndex=t,this}}])}(ru);cu.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var lu=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return y(this,e),S(this,e,[g({type:In.CIRCLE},t)])}return N(e,t),b(e)}(cu);lu.PARSED_STYLE_LIST=new Set([].concat(w(cu.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var hu=["style"],du=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=Ln(n,hu);return y(this,e),(t=S(this,e,[g({style:r},i)])).isCustomElement=!0,t}return N(e,t),b(e)}(cu);du.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var fu=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return y(this,e),S(this,e,[g({type:In.ELLIPSE},t)])}return N(e,t),b(e)}(cu);fu.PARSED_STYLE_LIST=new Set([].concat(w(cu.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"])),(function(t){function e(){return y(this,e),S(this,e,[{type:In.FRAGMENT}])}return N(e,t),b(e)}(cu)).PARSED_STYLE_LIST=new Set(["class","className"]);var vu=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return y(this,e),S(this,e,[g({type:In.GROUP},t)])}return N(e,t),b(e)}(cu);vu.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var pu=["style"],gu=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=Ln(n,pu);return y(this,e),(t=S(this,e,[g({type:In.HTML,style:r},i)])).cullable.enable=!1,t}return N(e,t),b(e,[{key:"getDomElement",value:function(){return this.parsedStyle.$el}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"getLocalBounds",value:function(){if(this.parentNode){var t=it(Z(),this.parentNode.getWorldTransform()),e=this.getBounds();if(!Hn.isEmpty(e)){var n=new Hn;return n.setFromTransformedAABB(e,t),n}}return this.getBounds()}}])}(cu);gu.PARSED_STYLE_LIST=new Set([].concat(w(cu.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var yu=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return y(this,e),S(this,e,[g({type:In.IMAGE},t)])}return N(e,t),b(e)}(cu);yu.PARSED_STYLE_LIST=new Set([].concat(w(cu.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var mu=["style"],bu=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=Ln(n,mu);y(this,e),(t=S(this,e,[g({type:In.LINE,style:g({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},r)},i)])).markerStartAngle=0,t.markerEndAngle=0;var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd;return o&&iu(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),s&&iu(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t}return N(e,t),b(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"x1"===t||"y1"===t||"x2"===t||"y2"===t||"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&iu(r)&&(this.markerStartAngle=0,r.remove()),i&&iu(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t&&(r&&iu(r)&&(this.markerEndAngle=0,r.remove()),i&&iu(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1)))}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s,u=this.parsedStyle,c=u.markerStart,l=u.markerEnd,h=u.markerStartOffset,d=u.markerEndOffset,f=u.x1,v=u.x2,p=u.y1,g=u.y2,y=t?c:l;y&&iu(y)&&(t?(i=f,a=p,n=v-f,r=g-p,o=h||0,s=this.markerStartAngle):(i=v,a=g,n=f-v,r=p-g,o=d||0,s=this.markerEndAngle),e=Math.atan2(r,n),y.setLocalEulerAngles(180*e/Math.PI+s),y.setLocalPosition(i+Math.cos(e)*o,a+Math.sin(e)*o))}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle,r=xn(n.x1,n.y1,n.x2,n.y2,t),i=r.x,a=r.y,o=W(C(),D(i,a,0),e?this.getWorldTransform():this.getLocalTransform());return new Xn(o[0],o[1])}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e)}},{key:"getTotalLength",value:function(){var t=this.parsedStyle;return bn(t.x1,t.y1,t.x2,t.y2)}}])}(cu);bu.PARSED_STYLE_LIST=new Set([].concat(w(cu.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var xu=["style"],wu=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=Ln(n,xu);y(this,e),(t=S(this,e,[g({type:In.PATH,style:r,initialParsedStyle:{miterLimit:4,d:g({},Er)}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,u=a.markerMid;return o&&iu(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),u&&iu(u)&&t.placeMarkerMid(u),s&&iu(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t}return N(e,t),b(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"d"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&iu(r)&&(this.markerStartAngle=0,r.remove()),i&&iu(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&iu(r)&&(this.markerEndAngle=0,r.remove()),i&&iu(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i)}},{key:"transformMarker",value:function(t){var e=this.parsedStyle,n=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,a=e.markerEndOffset,o=t?n:r;if(o&&iu(o)){var s,u,c,l,d,f,v;if(t){var p=h(this.getStartTangent(),2),g=p[0],y=p[1];l=y[0],d=y[1],u=g[0]-y[0],c=g[1]-y[1],f=i||0,v=this.markerStartAngle}else{var m=h(this.getEndTangent(),2),b=m[0],x=m[1];l=x[0],d=x[1],u=b[0]-x[0],c=b[1]-x[1],f=a||0,v=this.markerEndAngle}s=Math.atan2(c,u),o.setLocalEulerAngles(180*s/Math.PI+v),o.setLocalPosition(l+Math.cos(s)*f,d+Math.sin(s)*f)}}},{key:"placeMarkerMid",value:function(t){var e=this.parsedStyle.d.segments;if(this.markerMidList.forEach((function(t){t.remove()})),t&&iu(t))for(var n=1;n<e.length-1;n++){var r=h(e[n].currentPoint,2),i=r[0],a=r[1],o=1===n?t:t.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(i,a)}}},{key:"getTotalLength",value:function(){return oa(this)}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=function(t,e){return We(t,e,fe(fe({},void 0),{bbox:!1,length:!0})).point}(this.parsedStyle.d.absolutePath,t),r=n.x,i=n.y,a=W(C(),D(r,i,0),e?this.getWorldTransform():this.getLocalTransform());return new Xn(a[0],a[1])}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPointAtLength(t*oa(this),e)}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.d.segments,e=[];if(t.length>1){var n=t[0].currentPoint,r=t[1].currentPoint,i=t[1].startTangent;e=[],i?(e.push([n[0]-i[0],n[1]-i[1]]),e.push([n[0],n[1]])):(e.push([r[0],r[1]]),e.push([n[0],n[1]]))}return e}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.d.segments,e=t.length,n=[];if(e>1){var r=t[e-2].currentPoint,i=t[e-1].currentPoint,a=t[e-1].endTangent;n=[],a?(n.push([i[0]-a[0],i[1]-a[1]]),n.push([i[0],i[1]])):(n.push([r[0],r[1]]),n.push([i[0],i[1]]))}return n}}])}(cu);wu.PARSED_STYLE_LIST=new Set([].concat(w(cu.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var Eu=["style"],ku=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=Ln(n,Eu);y(this,e),(t=S(this,e,[g({type:In.POLYGON,style:r,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,u=a.markerMid;return o&&iu(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),u&&iu(u)&&t.placeMarkerMid(u),s&&iu(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t}return N(e,t),b(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"points"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&iu(r)&&(this.markerStartAngle=0,r.remove()),i&&iu(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&iu(r)&&(this.markerEndAngle=0,r.remove()),i&&iu(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i)}},{key:"transformMarker",value:function(t){var e=this.parsedStyle,n=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,a=e.markerEndOffset,o=(e.points||{}).points,s=t?n:r;if(s&&iu(s)&&o){var u,c,l,h,d,f,v;if(h=o[0][0],d=o[0][1],t)c=o[1][0]-o[0][0],l=o[1][1]-o[0][1],f=i||0,v=this.markerStartAngle;else{var p=o.length;this.parsedStyle.isClosed?(c=o[p-1][0]-o[0][0],l=o[p-1][1]-o[0][1]):(h=o[p-1][0],d=o[p-1][1],c=o[p-2][0]-o[p-1][0],l=o[p-2][1]-o[p-1][1]),f=a||0,v=this.markerEndAngle}u=Math.atan2(l,c),s.setLocalEulerAngles(180*u/Math.PI+v),s.setLocalPosition(h+Math.cos(u)*f,d+Math.sin(u)*f)}}},{key:"placeMarkerMid",value:function(t){var e=(this.parsedStyle.points||{}).points;if(this.markerMidList.forEach((function(t){t.remove()})),this.markerMidList=[],t&&iu(t)&&e)for(var n=1;n<(this.parsedStyle.isClosed?e.length:e.length-1);n++){var r=e[n][0],i=e[n][1],a=1===n?t:t.cloneNode(!0);this.markerMidList.push(a),this.appendChild(a),a.setLocalPosition(r,i)}}}])}(cu);ku.PARSED_STYLE_LIST=new Set([].concat(w(cu.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var Mu=["style"],Su=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=Ln(t,Mu);return y(this,e),S(this,e,[g({type:In.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},r)])}return N(e,t),b(e,[{key:"getTotalLength",value:function(){return sa(this)}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e)}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.points.points;if(0===this.parsedStyle.points.segments.length){var r,i,a=[],o=0,s=this.getTotalLength();n.forEach((function(t,e){n[e+1]&&((r=[0,0])[0]=o/s,i=bn(t[0],t[1],n[e+1][0],n[e+1][1]),o+=i,r[1]=o/s,a.push(r))})),this.parsedStyle.points.segments=a}var u=0,c=0;this.parsedStyle.points.segments.forEach((function(e,n){t>=e[0]&&t<=e[1]&&(u=(t-e[0])/(e[1]-e[0]),c=n)}));var l=xn(n[c][0],n[c][1],n[c+1][0],n[c+1][1],u),h=l.x,d=l.y,f=W(C(),D(h,d,0),e?this.getWorldTransform():this.getLocalTransform());return new Xn(f[0],f[1])}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.points.points,e=t.length-1,n=[];return n.push([t[e-1][0],t[e-1][1]]),n.push([t[e][0],t[e][1]]),n}}])}(ku);Su.PARSED_STYLE_LIST=new Set([].concat(w(ku.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var Ou=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return y(this,e),S(this,e,[g({type:In.RECT},t)])}return N(e,t),b(e)}(cu);Ou.PARSED_STYLE_LIST=new Set([].concat(w(cu.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var Nu=["style"],Au=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=Ln(t,Nu);return y(this,e),S(this,e,[g({type:In.TEXT,style:g({fill:"black"},n)},r)])}return N(e,t),b(e,[{key:"getComputedTextLength",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.maxLineWidth)||0}},{key:"getLineBoundingRects",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.lineMetrics)||[]}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing}}])}(cu);Au.PARSED_STYLE_LIST=new Set([].concat(w(cu.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textPathSide","textPathStartOffset","metrics","dx","dy"]));var Tu=function(){return b((function t(){y(this,t),this.registry={},this.define(In.CIRCLE,lu),this.define(In.ELLIPSE,fu),this.define(In.RECT,Ou),this.define(In.IMAGE,yu),this.define(In.LINE,bu),this.define(In.GROUP,vu),this.define(In.PATH,wu),this.define(In.POLYGON,ku),this.define(In.POLYLINE,Su),this.define(In.TEXT,Au),this.define(In.HTML,gu)}),[{key:"define",value:function(t,e){this.registry[t]=e}},{key:"get",value:function(t){return this.registry[t]}}])}(),Pu=function(t){function e(){var t;y(this,e),(t=S(this,e)).defaultView=null,t.ownerDocument=null,t.nodeName="document";try{t.timeline=new $s.AnimationTimeline(t)}catch(t){}var n={};return Wa.forEach((function(t){var e=t.n,r=t.inh,i=t.d;r&&i&&(n[e]=cn(i)?i(In.GROUP):i)})),t.documentElement=new vu({id:"g-root",style:n}),t.documentElement.ownerDocument=t,t.documentElement.parentNode=t,t.childNodes=[t.documentElement],t}return N(e,t),b(e,[{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"createElement",value:function(t,e){if("svg"===t)return this.documentElement;var n=this.defaultView.customElements.get(t);n||(console.warn("Unsupported tagName: ",t),n="tspan"===t?Au:vu);var r=new n(e);return r.ownerDocument=this,r}},{key:"createElementNS",value:function(t,e,n){return this.createElement(e,n)}},{key:"cloneNode",value:function(t){throw new Error($n)}},{key:"destroy",value:function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch(t){}}},{key:"elementsFromBBox",value:function(t,e,n,r){var i=this.defaultView.context.rBushRoot.search({minX:t,minY:e,maxX:n,maxY:r}),a=[];return i.forEach((function(t){var e=t.displayObject,n=e.parsedStyle.pointerEvents,r=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(void 0===n?"auto":n);(!r||r&&e.isVisible())&&!e.isCulled()&&e.isInteractive()&&a.push(e)})),a.sort((function(t,e){return e.sortable.renderOrder-t.sortable.renderOrder})),a}},{key:"elementFromPointSync",value:function(t,e){var n=this.defaultView.canvas2Viewport({x:t,y:e}),r=n.x,i=n.y,a=this.defaultView.getConfig(),o=a.width,s=a.height;if(r<0||i<0||r>o||i>s)return null;var u=this.defaultView.viewport2Client({x:r,y:i}),c=u.x,l=u.y,h=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:t,y:e,viewportX:r,viewportY:i,clientX:c,clientY:l},picked:[]}).picked;return h&&h[0]||this.documentElement}},{key:"elementFromPoint",value:(r=Cn(Tn().mark((function t(e,n){var r,i,a,o,s,u,c,l,h,d,f;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.defaultView.canvas2Viewport({x:e,y:n}),i=r.x,a=r.y,o=this.defaultView.getConfig(),s=o.width,u=o.height,!(i<0||a<0||i>s||a>u)){t.next=4;break}return t.abrupt("return",null);case 4:return c=this.defaultView.viewport2Client({x:i,y:a}),l=c.x,h=c.y,t.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:e,y:n,viewportX:i,viewportY:a,clientX:l,clientY:h},picked:[]});case 7:return d=t.sent,f=d.picked,t.abrupt("return",f&&f[0]||this.documentElement);case 10:case"end":return t.stop()}}),t,this)}))),function(t,e){return r.apply(this,arguments)})},{key:"elementsFromPointSync",value:function(t,e){var n=this.defaultView.canvas2Viewport({x:t,y:e}),r=n.x,i=n.y,a=this.defaultView.getConfig(),o=a.width,s=a.height;if(r<0||i<0||r>o||i>s)return[];var u=this.defaultView.viewport2Client({x:r,y:i}),c=u.x,l=u.y,h=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:t,y:e,viewportX:r,viewportY:i,clientX:c,clientY:l},picked:[]}).picked;return h[h.length-1]!==this.documentElement&&h.push(this.documentElement),h}},{key:"elementsFromPoint",value:(n=Cn(Tn().mark((function t(e,n){var r,i,a,o,s,u,c,l,h,d,f;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.defaultView.canvas2Viewport({x:e,y:n}),i=r.x,a=r.y,o=this.defaultView.getConfig(),s=o.width,u=o.height,!(i<0||a<0||i>s||a>u)){t.next=4;break}return t.abrupt("return",[]);case 4:return c=this.defaultView.viewport2Client({x:i,y:a}),l=c.x,h=c.y,t.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:e,y:n,viewportX:i,viewportY:a,clientX:l,clientY:h},picked:[]});case 7:return d=t.sent,(f=d.picked)[f.length-1]!==this.documentElement&&f.push(this.documentElement),t.abrupt("return",f);case 11:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"appendChild",value:function(t,e){throw new Error(Zn)}},{key:"insertBefore",value:function(t,e){throw new Error(Zn)}},{key:"removeChild",value:function(t,e){throw new Error(Zn)}},{key:"replaceChild",value:function(t,e,n){throw new Error(Zn)}},{key:"append",value:function(){throw new Error(Zn)}},{key:"prepend",value:function(){throw new Error(Zn)}},{key:"getElementById",value:function(t){return this.documentElement.getElementById(t)}},{key:"getElementsByName",value:function(t){return this.documentElement.getElementsByName(t)}},{key:"getElementsByTagName",value:function(t){return this.documentElement.getElementsByTagName(t)}},{key:"getElementsByClassName",value:function(t){return this.documentElement.getElementsByClassName(t)}},{key:"querySelector",value:function(t){return this.documentElement.querySelector(t)}},{key:"querySelectorAll",value:function(t){return this.documentElement.querySelectorAll(t)}},{key:"find",value:function(t){return this.documentElement.find(t)}},{key:"findAll",value:function(t){return this.documentElement.findAll(t)}}]);var n,r}(ds),Cu=function(){function t(e){y(this,t),this.strategies=e}return b(t,[{key:"apply",value:function(e){var n=e.camera,r=e.renderingService,i=e.renderingContext,a=this.strategies;r.hooks.cull.tap(t.tag,(function(t){if(t){var e=t.cullable;return 0===a.length?e.visible=i.unculledEntities.indexOf(t.entity)>-1:e.visible=a.every((function(e){return e.isVisible(n,t)})),!t.isCulled()&&t.isVisible()?t:(t.dispatchEvent(new cs(bs.CULLED)),null)}return t})),r.hooks.afterRender.tap(t.tag,(function(t){t.cullable.visibilityPlaneMask=-1}))}}])}();Cu.tag="Culling";var Ru=function(){function t(){var e=this;y(this,t),this.autoPreventDefault=!1,this.rootPointerEvent=new ss(null),this.rootWheelEvent=new us(null),this.onPointerMove=function(t){var n,r=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView;if(!r.supportsTouchEvents||"touch"!==t.pointerType){var i,a=Rn(e.normalizeToPointerEvent(t,r));try{for(a.s();!(i=a.n()).done;){var o=i.value,s=e.bootstrapEvent(e.rootPointerEvent,o,r,t);e.context.eventService.mapEvent(s)}}catch(t){a.e(t)}finally{a.f()}e.setCursor(e.context.eventService.cursor)}},this.onClick=function(t){var n,r,i=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView,a=Rn(e.normalizeToPointerEvent(t,i));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=e.bootstrapEvent(e.rootPointerEvent,o,i,t);e.context.eventService.mapEvent(s)}}catch(t){a.e(t)}finally{a.f()}e.setCursor(e.context.eventService.cursor)}}return b(t,[{key:"apply",value:function(e){var n=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler((function(t){return n.context.renderingService.hooks.pickSync.call({position:t,picked:[],topmost:!0}).picked[0]||null})),r.hooks.pointerWheel.tap(t.tag,(function(t){var e=n.normalizeWheelEvent(t);n.context.eventService.mapEvent(e)})),r.hooks.pointerDown.tap(t.tag,(function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e=n.normalizeToPointerEvent(t,i);n.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();var r,a=Rn(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s)}}catch(t){a.e(t)}finally{a.f()}n.setCursor(n.context.eventService.cursor)}})),r.hooks.pointerUp.tap(t.tag,(function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e,r=n.context.contextService.getDomElement(),a=n.context.eventService.isNativeEventFromCanvas(r,t)?"":"outside",o=Rn(n.normalizeToPointerEvent(t,i));try{for(o.s();!(e=o.n()).done;){var s=e.value,u=n.bootstrapEvent(n.rootPointerEvent,s,i,t);u.type+=a,n.context.eventService.mapEvent(u)}}catch(t){o.e(t)}finally{o.f()}n.setCursor(n.context.eventService.cursor)}})),r.hooks.pointerMove.tap(t.tag,this.onPointerMove),r.hooks.pointerOver.tap(t.tag,this.onPointerMove),r.hooks.pointerOut.tap(t.tag,this.onPointerMove),r.hooks.click.tap(t.tag,this.onClick),r.hooks.pointerCancel.tap(t.tag,(function(t){var e,r=Rn(n.normalizeToPointerEvent(t,i));try{for(r.s();!(e=r.n()).done;){var a=e.value,o=n.bootstrapEvent(n.rootPointerEvent,a,i,t);n.context.eventService.mapEvent(o)}}catch(t){r.e(t)}finally{r.f()}n.setCursor(n.context.eventService.cursor)}))}},{key:"bootstrapEvent",value:function(t,e,n,r){t.view=n,t.originalEvent=null,t.nativeEvent=r,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var i=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),a=i.x,o=i.y;t.viewport.x=a,t.viewport.y=o;var s=this.context.eventService.viewport2Canvas(t.viewport),u=s.x,c=s.y;return t.canvas.x=u,t.canvas.y=c,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=r.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=mo[t.type]||t.type),t}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var n=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),r=n.x,i=n.y;e.viewport.x=r,e.viewport.y=i;var a=this.context.eventService.viewport2Canvas(e.viewport),o=a.x,s=a.y;return e.canvas.x=o,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=bo.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null}},{key:"setCursor",value:function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default")}},{key:"normalizeToPointerEvent",value:function(t,e){var n=[];if(e.isTouchEvent(t))for(var r=0;r<t.changedTouches.length;r++){var i=t.changedTouches[r];an(i.button)&&(i.button=0),an(i.buttons)&&(i.buttons=1),an(i.isPrimary)&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),an(i.width)&&(i.width=i.radiusX||1),an(i.height)&&(i.height=i.radiusY||1),an(i.tiltX)&&(i.tiltX=0),an(i.tiltY)&&(i.tiltY=0),an(i.pointerType)&&(i.pointerType="touch"),an(i.pointerId)&&(i.pointerId=i.identifier||0),an(i.pressure)&&(i.pressure=i.force||.5),an(i.twist)&&(i.twist=0),an(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=t.type,n.push(i)}else if(e.isMouseEvent(t)){var a=t;an(a.isPrimary)&&(a.isPrimary=!0),an(a.width)&&(a.width=1),an(a.height)&&(a.height=1),an(a.tiltX)&&(a.tiltX=0),an(a.tiltY)&&(a.tiltY=0),an(a.pointerType)&&(a.pointerType="mouse"),an(a.pointerId)&&(a.pointerId=1),an(a.pressure)&&(a.pressure=.5),an(a.twist)&&(a.twist=0),an(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,n.push(a)}else n.push(t);return n}}])}();Ru.tag="Event";var Lu=[In.CIRCLE,In.ELLIPSE,In.IMAGE,In.RECT,In.LINE,In.POLYLINE,In.POLYGON,In.TEXT,In.PATH,In.HTML],Du=function(){return b((function t(){y(this,t)}),[{key:"isVisible",value:function(t,e){var n,r=e.cullable;if(!r.enable)return!0;var i=e.getRenderBounds();if(Hn.isEmpty(i))return!1;var a=t.getFrustum(),o=null===(n=e.parentNode)||void 0===n||null===(n=n.cullable)||void 0===n?void 0:n.visibilityPlaneMask;return r.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(e,i,o||Un.INDETERMINATE,a.planes),r.visible=r.visibilityPlaneMask!==Un.OUTSIDE,r.visible}},{key:"computeVisibilityWithPlaneMask",value:function(t,e,n,r){if(n===Un.OUTSIDE||n===Un.INSIDE)return n;for(var i=Un.INSIDE,a=Lu.indexOf(t.nodeName)>-1,o=0,s=r.length;o<s;++o){var u=1<<o;if(n&u&&(!a||4!==o&&5!==o)){var c=r[o],l=c.normal,h=c.distance;if(G(l,e.getPositiveFarPoint(r[o]))+h<0)return Un.OUTSIDE;G(l,e.getNegativeFarPoint(r[o]))+h<0&&(i|=u)}}return i}}])}(),_u=function(){function t(){y(this,t),this.syncTasks=new Map,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return b(t,[{key:"apply",value:function(e){var n,r=this,i=e.renderingService,a=e.renderingContext,o=e.rBushRoot,s=a.root.ownerDocument.defaultView;this.rBush=o;var u=function(t){t.target.renderable.dirty=!0,i.dirtify()},c=function(t){r.syncTasks.set(t.target,t.detail.affectChildren),i.dirtify()},l=function(t){var e=t.target;$s.enableSizeAttenuation&&$s.styleValueRegistry.updateSizeAttenuation(e,s.getCamera().getZoom())},h=function(t){var e=t.target,n=e.rBushNode;n.aabb&&r.rBush.remove(n.aabb),r.syncTasks.delete(e),$s.sceneGraphService.dirtifyToRoot(e),i.dirtify()};i.hooks.init.tap(t.tag,(function(){s.addEventListener(bs.MOUNTED,l),s.addEventListener(bs.UNMOUNTED,h),s.addEventListener(bs.ATTR_MODIFIED,u),s.addEventListener(bs.BOUNDS_CHANGED,c)})),i.hooks.destroy.tap(t.tag,(function(){s.removeEventListener(bs.MOUNTED,l),s.removeEventListener(bs.UNMOUNTED,h),s.removeEventListener(bs.ATTR_MODIFIED,u),s.removeEventListener(bs.BOUNDS_CHANGED,c),r.syncTasks.clear()}));var d=null!==(n=$s.globalThis.requestIdleCallback)&&void 0!==n?n:Co.bind($s.globalThis);i.hooks.endFrame.tap(t.tag,(function(){r.isFirstTimeRendering?(r.isFirstTimeRendering=!1,r.syncing=!0,d((function(){r.syncRTree(!0),r.isFirstTimeRenderingFinished=!0}))):r.syncRTree()}))}},{key:"syncNode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.isConnected){var n=t.rBushNode;n.aabb&&this.rBush.remove(n.aabb);var r=t.getRenderBounds();if(r){var i=t.renderable;e&&(i.dirtyRenderBounds||(i.dirtyRenderBounds=new Hn),i.dirtyRenderBounds.update(r.center,r.halfExtents));var a=h(r.getMin(),2),o=a[0],s=a[1],u=h(r.getMax(),2),c=u[0],l=u[1];n.aabb||(n.aabb={}),n.aabb.displayObject=t,n.aabb.minX=o,n.aabb.minY=s,n.aabb.maxX=c,n.aabb.maxY=l}return n.aabb&&!(isNaN(n.aabb.maxX)||isNaN(n.aabb.maxX)||isNaN(n.aabb.minX)||isNaN(n.aabb.minY))?n.aabb:void 0}}},{key:"syncRTree",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e||!this.syncing&&0!==this.syncTasks.size){this.syncing=!0;var n=[],r=new Set,i=function(i){if(!r.has(i)&&i.renderable){var a=t.syncNode(i,e);a&&(n.push(a),r.add(i))}};this.syncTasks.forEach((function(t,e){t&&e.forEach(i);for(var n=e;n;)i(n),n=n.parentElement})),this.rBush.load(n),n.length=0,this.syncing=!1}}}])}();_u.tag="Prepare";var Iu=function(t){return t.READY="ready",t.BEFORE_RENDER="beforerender",t.RERENDER="rerender",t.AFTER_RENDER="afterrender",t.BEFORE_DESTROY="beforedestroy",t.AFTER_DESTROY="afterdestroy",t.RESIZE="resize",t.DIRTY_RECTANGLE="dirtyrectangle",t.RENDERER_CHANGED="rendererchanged",t}({}),ju=new cs(bs.MOUNTED),Fu=new cs(bs.UNMOUNTED),Bu=new cs(Iu.BEFORE_RENDER),zu=new cs(Iu.RERENDER),Gu=new cs(Iu.AFTER_RENDER),Vu=function(t){function e(t){var n;y(this,e),(n=S(this,e)).Element=cu,n.inited=!1,n.context={};var r=t.container,i=t.canvas,a=t.renderer,o=t.width,s=t.height,u=t.background,c=t.cursor,l=t.supportsMutipleCanvasesInOneContainer,h=t.cleanUpOnDestroy,d=void 0===h||h,f=t.offscreenCanvas,v=t.devicePixelRatio,p=t.requestAnimationFrame,m=t.cancelAnimationFrame,b=t.createImage,x=t.supportsTouchEvents,w=t.supportsPointerEvents,E=t.isTouchEvent,k=t.isMouseEvent,M=t.dblClickSpeed,O=o,N=s,A=v||fo&&window.devicePixelRatio||1;return A=A>=1?Math.ceil(A):1,i&&(O=o||function(t){var e=yo(t,"width");return"auto"===e?t.offsetWidth:parseFloat(e)}(i)||i.width/A,N=s||function(t){var e=yo(t,"height");return"auto"===e?t.offsetHeight:parseFloat(e)}(i)||i.height/A),n.customElements=new Tu,n.devicePixelRatio=A,n.requestAnimationFrame=null!=p?p:Co.bind($s.globalThis),n.cancelAnimationFrame=null!=m?m:Ro.bind($s.globalThis),n.supportsTouchEvents=null!=x?x:"ontouchstart"in $s.globalThis,n.supportsPointerEvents=null!=w?w:!!$s.globalThis.PointerEvent,n.isTouchEvent=null!=E?E:function(t){return n.supportsTouchEvents&&t instanceof $s.globalThis.TouchEvent},n.isMouseEvent=null!=k?k:function(t){return!$s.globalThis.MouseEvent||t instanceof $s.globalThis.MouseEvent&&(!n.supportsPointerEvents||!(t instanceof $s.globalThis.PointerEvent))},f&&($s.offscreenCanvas=f),n.document=new Pu,n.document.defaultView=n,l||function(t,e,n){if(t){var r="string"==typeof t?document.getElementById(t):t;ho.has(r)&&ho.get(r).destroy(n),ho.set(r,e)}}(r,n,d),n.initRenderingContext(g(g({},t),{},{width:O,height:N,background:null!=u?u:"transparent",cursor:null!=c?c:"default",cleanUpOnDestroy:d,devicePixelRatio:A,requestAnimationFrame:n.requestAnimationFrame,cancelAnimationFrame:n.cancelAnimationFrame,supportsTouchEvents:n.supportsTouchEvents,supportsPointerEvents:n.supportsPointerEvents,isTouchEvent:n.isTouchEvent,isMouseEvent:n.isMouseEvent,dblClickSpeed:null!=M?M:200,createImage:null!=b?b:function(){return new window.Image}})),n.initDefaultCamera(O,N,a.clipSpaceNearZ),n.initRenderer(a,!0),n}return N(e,t),b(e,[{key:"initRenderingContext",value:function(t){this.context.config=t,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}}},{key:"initDefaultCamera",value:function(t,e,n){var r=this,i=new $s.CameraContribution;i.clipSpaceNearZ=n,i.setType(vr.EXPLORING,pr.DEFAULT).setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0).setOrthographic(t/-2,t/2,e/2,e/-2,.1,1e3),i.canvas=this,i.eventEmitter.on(yr,(function(){r.context.renderingContext.renderReasons.add(ps.CAMERA_CHANGED),$s.enableSizeAttenuation&&r.getConfig().renderer.getConfig().enableSizeAttenuation&&r.updateSizeAttenuation()})),this.context.camera=i}},{key:"updateSizeAttenuation",value:function(){var t=this.getCamera().getZoom();this.document.documentElement.forEach((function(e){$s.styleValueRegistry.updateSizeAttenuation(e,t)}))}},{key:"getConfig",value:function(){return this.context.config}},{key:"getRoot",value:function(){return this.document.documentElement}},{key:"getCamera",value:function(){return this.context.camera}},{key:"getContextService",value:function(){return this.context.contextService}},{key:"getEventService",value:function(){return this.context.eventService}},{key:"getRenderingService",value:function(){return this.context.renderingService}},{key:"getRenderingContext",value:function(){return this.context.renderingContext}},{key:"getStats",value:function(){return this.getRenderingService().getStats()}},{key:"ready",get:function(){var t=this;return this.readyPromise||(this.readyPromise=new Promise((function(e){t.resolveReadyPromise=function(){e(t)}})),this.inited&&this.resolveReadyPromise()),this.readyPromise}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0;ri.clearCache(),e||this.dispatchEvent(new cs(Iu.BEFORE_DESTROY)),this.frameId&&this.cancelAnimationFrame(this.frameId);var n=this.getRoot();t&&(this.unmountChildren(n),this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),this.context.rBushRoot&&this.context.rBushRoot.clear(),e||this.dispatchEvent(new cs(Iu.AFTER_DESTROY));var r=function(t){t.currentTarget=null,t.manager=null,t.target=null,t.relatedNode=null};r(ju),r(Fu),r(Bu),r(zu),r(Gu),r(ou),r(tu),r(eu),r(nu)}},{key:"changeSize",value:function(t,e){this.resize(t,e)}},{key:"resize",value:function(t,e){var n=this.context.config;n.width=t,n.height=e,this.getContextService().resize(t,e);var r=this.context.camera,i=r.getProjectionMode();r.setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0),i===gr.ORTHOGRAPHIC?r.setOrthographic(t/-2,t/2,e/2,e/-2,r.getNear(),r.getFar()):r.setAspect(t/e),this.dispatchEvent(new cs(Iu.RESIZE,{width:t,height:e}))}},{key:"appendChild",value:function(t,e){return this.document.documentElement.appendChild(t,e)}},{key:"insertBefore",value:function(t,e){return this.document.documentElement.insertBefore(t,e)}},{key:"removeChild",value:function(t){return this.document.documentElement.removeChild(t)}},{key:"removeChildren",value:function(){this.document.documentElement.removeChildren()}},{key:"destroyChildren",value:function(){this.document.documentElement.destroyChildren()}},{key:"render",value:function(t){var e=this;t&&(Bu.detail=t,Gu.detail=t),this.dispatchEvent(Bu),this.getRenderingService().render(this.getConfig(),t,(function(){e.dispatchEvent(zu)})),this.dispatchEvent(Gu)}},{key:"run",value:function(){var t=this,e=function(n,r){t.render(r),t.frameId=t.requestAnimationFrame(e)};e()}},{key:"initRenderer",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new _n,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new Ru,new _u,new Cu([new Du])),this.loadRendererContainerModule(t),this.context.contextService=new this.context.ContextService(g(g({},$s),this.context)),this.context.renderingService=new gs($s,this.context),this.context.eventService=new fs($s,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(t,n,!0)):this.context.contextService.initAsync().then((function(){e.initRenderingService(t,n)})).catch((function(t){console.error(t)}))}},{key:"initRenderingService",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.context.renderingService.init((function(){e.inited=!0,n?r?e.requestAnimationFrame((function(){e.dispatchEvent(new cs(Iu.READY))})):e.dispatchEvent(new cs(Iu.READY)):e.dispatchEvent(new cs(Iu.RENDERER_CHANGED)),e.readyPromise&&e.resolveReadyPromise(),n||e.getRoot().forEach((function(t){var e=t.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0,e.dirty=!0)})),e.mountChildren(e.getRoot()),t.getConfig().enableAutoRendering&&e.run()}))}},{key:"loadRendererContainerModule",value:function(t){var e=this;t.getPlugins().forEach((function(t){t.context=e.context,t.init($s)}))}},{key:"setRenderer",value:function(t){var e=this.getConfig();if(e.renderer!==t){var n=e.renderer;e.renderer=t,this.destroy(!1,!0),w((null==n?void 0:n.getPlugins())||[]).reverse().forEach((function(t){t.destroy($s)})),this.initRenderer(t)}}},{key:"setCursor",value:function(t){this.getConfig().cursor=t,this.getContextService().applyCursorStyle(t)}},{key:"unmountChildren",value:function(t){var e=this;t.childNodes.forEach((function(t){e.unmountChildren(t)})),this.inited&&(t.isMutationObserved?t.dispatchEvent(Fu):(Fu.target=t,this.dispatchEvent(Fu,!0)),t!==this.document.documentElement&&(t.ownerDocument=null),t.isConnected=!1),t.isCustomElement&&t.disconnectedCallback&&t.disconnectedCallback()}},{key:"mountChildren",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xo(t);this.inited?t.isConnected||(t.ownerDocument=this.document,t.isConnected=!0,n||(t.isMutationObserved?t.dispatchEvent(ju):(ju.target=t,this.dispatchEvent(ju,!0)))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",t.nodeName),t.childNodes.forEach((function(t){e.mountChildren(t,n)})),t.isCustomElement&&t.connectedCallback&&t.connectedCallback()}},{key:"mountFragment",value:function(t){this.mountChildren(t,!1)}},{key:"client2Viewport",value:function(t){return this.getEventService().client2Viewport(t)}},{key:"viewport2Client",value:function(t){return this.getEventService().viewport2Client(t)}},{key:"viewport2Canvas",value:function(t){return this.getEventService().viewport2Canvas(t)}},{key:"canvas2Viewport",value:function(t){return this.getEventService().canvas2Viewport(t)}},{key:"getPointByClient",value:function(t,e){return this.client2Viewport({x:t,y:e})}},{key:"getClientByPoint",value:function(t,e){return this.viewport2Client({x:t,y:e})}}])}(hs),Wu=function(t){function e(){var t;y(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=S(this,e,[].concat(r))).landmarks=[],t}return N(e,t),b(e,[{key:"rotate",value:function(t,e,n){if(this.relElevation=Qn(e),this.relAzimuth=Qn(t),this.relRoll=Qn(n),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===vr.EXPLORING){var r=$t(Kt(),[1,0,0],nr((this.rotateWorld?1:-1)*this.relElevation)),i=$t(Kt(),[0,1,0],nr((this.rotateWorld?1:-1)*this.relAzimuth)),a=$t(Kt(),[0,0,1],nr(this.relRoll)),o=Zt(Kt(),i,r);o=Zt(Kt(),o,a);var s=Nt(Z(),o);ut(this.matrix,this.matrix,[0,0,-this.distance]),st(this.matrix,this.matrix,s),ut(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===vr.ORBITING||this.type===vr.EXPLORING?this._getPosition():this.type===vr.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(t,e){var n=tr(t,e,0),r=R(this.position);return j(r,r,B(C(),this.right,n[0])),j(r,r,B(C(),this.up,n[1])),this._setPosition(r),this.triggerUpdate(),this}},{key:"dolly",value:function(t){var e=this.forward,n=R(this.position),r=this.dollyingStep,i=this.distance+t*this.dollyingStep;return r=Math.max(Math.min(i,this.maxDistance),this.minDistance)-this.distance,n[0]+=r*e[0],n[1]+=r*e[1],n[2]+=r*e[2],this._setPosition(n),this.type===vr.ORBITING||this.type===vr.EXPLORING?this._getDistance():this.type===vr.TRACKING&&j(this.focalPoint,n,this.distanceVector),this.triggerUpdate(),this}},{key:"cancelLandmarkAnimation",value:function(){void 0!==this.landmarkAnimationID&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)}},{key:"createLandmark",value:function(t){var e,n,r,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=a.position,s=void 0===o?this.position:o,u=a.focalPoint,c=void 0===u?this.focalPoint:u,l=a.roll,h=a.zoom,d=new $s.CameraContribution;d.setType(this.type,void 0),d.setPosition(s[0],null!==(e=s[1])&&void 0!==e?e:this.position[1],null!==(n=s[2])&&void 0!==n?n:this.position[2]),d.setFocalPoint(c[0],null!==(r=c[1])&&void 0!==r?r:this.focalPoint[1],null!==(i=c[2])&&void 0!==i?i:this.focalPoint[2]),d.setRoll(null!=l?l:this.roll),d.setZoom(null!=h?h:this.zoom);var f={name:t,matrix:Q(d.getWorldTransform()),right:R(d.right),up:R(d.up),forward:R(d.forward),position:R(d.getPosition()),focalPoint:R(d.getFocalPoint()),distanceVector:R(d.getDistanceVector()),distance:d.getDistance(),dollyingStep:d.getDollyingStep(),azimuth:d.getAzimuth(),elevation:d.getElevation(),roll:d.getRoll(),relAzimuth:d.relAzimuth,relElevation:d.relElevation,relRoll:d.relRoll,zoom:d.getZoom()};return this.landmarks.push(f),f}},{key:"gotoLandmark",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=ce(t)?this.landmarks.find((function(e){return e.name===t})):t;if(r){var i=oe(n)?{duration:n}:n,a=i.easing,o=void 0===a?"linear":a,s=i.duration,u=void 0===s?100:s,c=i.easingFunction,l=void 0===c?void 0:c,h=i.onfinish,d=void 0===h?void 0:h,f=i.onframe,v=void 0===f?void 0:f;this.cancelLandmarkAnimation();var p,g=r.position,y=r.focalPoint,m=r.zoom,b=r.roll,x=l||$s.EasingFunction(o),w=function(){e.setFocalPoint(y),e.setPosition(g),e.setRoll(b),e.setZoom(m),e.computeMatrix(),e.triggerUpdate(),null==d||d()};if(0===u)return w();var E=function(t){void 0===p&&(p=t);var n=t-p;if(n>=u)w();else{var r,i,a=x(n/u),o=C(),s=C();if(V(o,e.focalPoint,y,a),V(s,e.position,g,a),i=e.roll*(1-a)+b*a,r=e.zoom*(1-a)+m*a,e.setFocalPoint(o),e.setPosition(s),e.setRoll(i),e.setZoom(r),U(o,y)+U(s,g)<=.01&&void 0===m&&void 0===b)return w();e.computeMatrix(),e.triggerUpdate(),n<u&&(null==v||v(a),e.landmarkAnimationID=e.canvas.requestAnimationFrame(E))}};this.canvas.requestAnimationFrame(E)}}}])}(br);$s.CameraContribution=Wu,new WeakMap;var Hu=function(t){function e(t,n,r,i){var a;return y(this,e),(a=S(this,e,[t])).currentTime=r,a.timelineTime=i,a.target=n,a.type="finish",a.bubbles=!1,a.currentTarget=n,a.defaultPrevented=!1,a.eventPhase=a.AT_TARGET,a.timeStamp=Date.now(),a.currentTime=r,a.timelineTime=i,a}return N(e,t),b(e)}(as),Yu=0,Uu=function(){return b((function t(e,n){var r;y(this,t),this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=e,e.animation=this,this.timeline=n,this.id="".concat(Yu++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number(null===(r=this.effect)||void 0===r?void 0:r.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}),[{key:"pending",get:function(){return null===this._startTime&&!this._paused&&0!==this.playbackRate||this.currentTimePending}},{key:"playState",get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"}},{key:"ready",get:function(){var t=this;return this.readyPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise((function(e,n){t.resolveReadyPromise=function(){e(t)},t.rejectReadyPromise=function(){n(new Error)}})),this.pending||this.resolveReadyPromise()),this.readyPromise}},{key:"finished",get:function(){var t=this;return this.finishedPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise((function(e,n){t.resolveFinishedPromise=function(){e(t)},t.rejectFinishedPromise=function(){n(new Error)}})),"finished"===this.playState&&this.resolveFinishedPromise()),this.finishedPromise}},{key:"currentTime",get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(t){var e;(t=Number(t),isNaN(t))||(this.timeline.restart(),this._paused||null===this._startTime||(this._startTime=Number(null===(e=this.timeline)||void 0===e?void 0:e.currentTime)-t/this.playbackRate),this.currentTimePending=!1,this._currentTime!==t&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(t,!0),this.timeline.applyDirtiedAnimation(this)))}},{key:"startTime",get:function(){return this._startTime},set:function(t){if(null!==t){if(this.updatePromises(),t=Number(t),isNaN(t))return;if(this._paused||this._idle)return;this._startTime=t,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(t){if(t!==this._playbackRate){this.updatePromises();var e=this.currentTime;this._playbackRate=t,this.startTime=null,"paused"!==this.playState&&"idle"!==this.playState&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),null!==e&&(this.currentTime=e),this.updatePromises()}}},{key:"_isFinished",get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)}},{key:"totalDuration",get:function(){return this._totalDuration}},{key:"_needsTick",get:function(){return this.pending||"running"===this.playState||!this._finishedFlag}},{key:"updatePromises",value:function(){var t=this.oldPlayState,e=this.pending?"pending":this.playState;return this.readyPromise&&e!==t&&("idle"===e?(this.rejectReadyPromise(),this.readyPromise=void 0):"pending"===t?this.resolveReadyPromise():"pending"===e&&(this.readyPromise=void 0)),this.finishedPromise&&e!==t&&("idle"===e?(this.rejectFinishedPromise(),this.finishedPromise=void 0):"finished"===e?this.resolveFinishedPromise():"finished"===t&&(this.finishedPromise=void 0)),this.oldPlayState=e,this.readyPromise||this.finishedPromise}},{key:"play",value:function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),-1===this.timeline.animations.indexOf(this)&&this.timeline.animations.push(this),this.updatePromises()}},{key:"pause",value:function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),this._isFinished||this._paused||this._idle?this._idle&&(this.rewind(),this._idle=!1):this.currentTimePending=!0,this._startTime=null,this._paused=!0,this.updatePromises()}},{key:"finish",value:function(){this.updatePromises(),this._idle||(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())}},{key:"cancel",value:function(){var t=this;if(this.updatePromises(),this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var e=new Hu(null,this,this.currentTime,null);setTimeout((function(){t.oncancel(e)}))}}},{key:"reverse",value:function(){this.updatePromises();var t=this.currentTime;this.playbackRate*=-1,this.play(),null!==t&&(this.currentTime=t),this.updatePromises()}},{key:"updatePlaybackRate",value:function(t){this.playbackRate=t}},{key:"targetAnimations",value:function(){var t;return(null===(t=this.effect)||void 0===t?void 0:t.target).getAnimations()}},{key:"markTarget",value:function(){var t=this.targetAnimations();-1===t.indexOf(this)&&t.push(this)}},{key:"unmarkTarget",value:function(){var t=this.targetAnimations(),e=t.indexOf(this);-1!==e&&t.splice(e,1)}},{key:"tick",value:function(t,e){this._idle||this._paused||(null===this._startTime?e&&(this.startTime=t-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((t-this._startTime)*this.playbackRate)),e&&(this.currentTimePending=!1,this.fireEvents(t))}},{key:"rewind",value:function(){if(this.playbackRate>=0)this.currentTime=0;else{if(!(this._totalDuration<1/0))throw new Error("Unable to rewind negative playback rate animation with infinite duration");this.currentTime=this._totalDuration}}},{key:"persist",value:function(){throw new Error($n)}},{key:"addEventListener",value:function(t,e,n){throw new Error($n)}},{key:"removeEventListener",value:function(t,e,n){throw new Error($n)}},{key:"dispatchEvent",value:function(t){throw new Error($n)}},{key:"commitStyles",value:function(){throw new Error($n)}},{key:"ensureAlive",value:function(){var t,e;this.playbackRate<0&&0===this.currentTime?this._inEffect=!(null===(t=this.effect)||void 0===t||!t.update(-1)):this._inEffect=!(null===(e=this.effect)||void 0===e||!e.update(this.currentTime)),this._inTimeline||!this._inEffect&&this._finishedFlag||(this._inTimeline=!0,this.timeline.animations.push(this))}},{key:"tickCurrentTime",value:function(t,e){t!==this._currentTime&&(this._currentTime=t,this._isFinished&&!e&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())}},{key:"fireEvents",value:function(t){var e=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var n=new Hu(null,this,this.currentTime,t);setTimeout((function(){e.onfinish&&e.onfinish(n)}))}this._finishedFlag=!0}}else{if(this.onframe&&"running"===this.playState){var r=new Hu(null,this,this.currentTime,t);this.onframe(r)}this._finishedFlag=!1}}}])}(),qu=.1,Xu="function"==typeof Float32Array,Ku=function(t,e){return 1-3*e+3*t},$u=function(t,e){return 3*e-6*t},Zu=function(t){return 3*t},Qu=function(t,e,n){return((Ku(e,n)*t+$u(e,n))*t+Zu(e))*t},Ju=function(t,e,n){return 3*Ku(e,n)*t*t+2*$u(e,n)*t+Zu(e)},tc=function(t,e,n,r){if(!(t>=0&&t<=1&&n>=0&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===e&&n===r)return function(t){return t};for(var i=Xu?new Float32Array(11):new Array(11),a=0;a<11;++a)i[a]=Qu(a*qu,t,n);return function(a){return 0===a||1===a?a:Qu(function(e){for(var r=0,a=1;10!==a&&i[a]<=e;++a)r+=qu;--a;var o=r+(e-i[a])/(i[a+1]-i[a])*qu,s=Ju(o,t,n);return s>=.001?function(t,e,n,r){for(var i=0;i<4;++i){var a=Ju(e,n,r);if(0===a)return e;e-=(Qu(e,n,r)-t)/a}return e}(e,o,t,n):0===s?o:function(t,e,n,r,i){var a,o,s=0;do{(a=Qu(o=e+(n-e)/2,r,i)-t)>0?n=o:e=o}while(Math.abs(a)>1e-7&&++s<10);return o}(e,r,r+qu,t,n)}(a),e,r)}},ec=function(t){return Math.pow(t,2)},nc=function(t){return Math.pow(t,3)},rc=function(t){return Math.pow(t,4)},ic=function(t){return Math.pow(t,5)},ac=function(t){return Math.pow(t,6)},oc=function(t){return 1-Math.cos(t*Math.PI/2)},sc=function(t){return 1-Math.sqrt(1-t*t)},uc=function(t){return t*t*(3*t-2)},cc=function(t){for(var e,n=4;t<((e=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*e-2)/22-t,2)},lc=function(t){var e=h(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],2),n=e[0],r=void 0===n?1:n,i=e[1],a=void 0===i?.5:i,o=le(Number(r),1,10),s=le(Number(a),.1,2);return 0===t||1===t?t:-o*Math.pow(2,10*(t-1))*Math.sin((t-1-s/(2*Math.PI)*Math.asin(1/o))*(2*Math.PI)/s)},hc=function(t){var e=arguments.length>2?arguments[2]:void 0,n=h(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],4),r=n[0],i=void 0===r?1:r,a=n[1],o=void 0===a?100:a,s=n[2],u=void 0===s?10:s,c=n[3],l=void 0===c?0:c;i=le(i,.1,1e3),o=le(o,.1,1e3),u=le(u,.1,1e3),l=le(l,.1,1e3);var d=Math.sqrt(o/i),f=u/(2*Math.sqrt(o*i)),v=f<1?d*Math.sqrt(1-f*f):0,p=f<1?(f*d-l)/v:-l+d,g=e?e*t/1e3:t;return g=f<1?Math.exp(-g*f*d)*(1*Math.cos(v*g)+p*Math.sin(v*g)):(1+p*g)*Math.exp(-g*d),0===t||1===t?t:1-g},dc=function(t){var e=h(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],2),n=e[0],r=void 0===n?10:n;return("start"===e[1]?Math.ceil:Math.floor)(le(t,0,1)*r)/r},fc=function(t){var e=h(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],4),n=e[0],r=e[1],i=e[2],a=e[3];return tc(n,r,i,a)(t)},vc=tc(.42,0,1,1),pc=function(t){return function(e){return 1-t(1-e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],arguments.length>2?arguments[2]:void 0)}},gc=function(t){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;return e<.5?t(2*e,n,r)/2:1-t(-2*e+2,n,r)/2}},yc=function(t){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;return e<.5?(1-t(1-2*e,n,r))/2:(t(2*e-1,n,r)+1)/2}},mc={steps:dc,"step-start":function(t){return dc(t,[1,"start"])},"step-end":function(t){return dc(t,[1,"end"])},linear:function(t){return t},"cubic-bezier":fc,ease:function(t){return fc(t,[.25,.1,.25,1])},in:vc,out:pc(vc),"in-out":gc(vc),"out-in":yc(vc),"in-quad":ec,"out-quad":pc(ec),"in-out-quad":gc(ec),"out-in-quad":yc(ec),"in-cubic":nc,"out-cubic":pc(nc),"in-out-cubic":gc(nc),"out-in-cubic":yc(nc),"in-quart":rc,"out-quart":pc(rc),"in-out-quart":gc(rc),"out-in-quart":yc(rc),"in-quint":ic,"out-quint":pc(ic),"in-out-quint":gc(ic),"out-in-quint":yc(ic),"in-expo":ac,"out-expo":pc(ac),"in-out-expo":gc(ac),"out-in-expo":yc(ac),"in-sine":oc,"out-sine":pc(oc),"in-out-sine":gc(oc),"out-in-sine":yc(oc),"in-circ":sc,"out-circ":pc(sc),"in-out-circ":gc(sc),"out-in-circ":yc(sc),"in-back":uc,"out-back":pc(uc),"in-out-back":gc(uc),"out-in-back":yc(uc),"in-bounce":cc,"out-bounce":pc(cc),"in-out-bounce":gc(cc),"out-in-bounce":yc(cc),"in-elastic":lc,"out-elastic":pc(lc),"in-out-elastic":gc(lc),"out-in-elastic":yc(lc),spring:hc,"spring-in":hc,"spring-out":pc(hc),"spring-in-out":gc(hc),"spring-out-in":yc(hc)},bc=function(t){return t};function xc(t,e){return function(n){if(n>=1)return 1;var r=1/t;return(n+=e*r)-n%r}}var wc="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",Ec=new RegExp("cubic-bezier\\(".concat(wc,",").concat(wc,",").concat(wc,",").concat(wc,"\\)")),kc=/steps\(\s*(\d+)\s*\)/,Mc=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function Sc(t){var e=Ec.exec(t);if(e)return tc.apply(void 0,w(e.slice(1).map(Number)));var n=kc.exec(t);if(n)return xc(Number(n[1]),0);var r,i,a=Mc.exec(t);return a?xc(Number(a[1]),{start:1,middle:.5,end:0}[a[2]]):mc[(r=t,(i=r,"-"===(i=i.replace(/([A-Z])/g,(function(t){return"-".concat(t.toLowerCase())}))).charAt(0)?i.substring(1):i).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim())]||mc.linear}function Oc(t){return"offset"!==t&&"easing"!==t&&"composite"!==t&&"computedOffset"!==t}var Nc=function(t,e,n){return function(r){var i=Tc(t,e,r);return oe(i)?i:n(i)}};function Ac(t,e,n,r){var i=Ya[t];if(i&&i.syntax&&i.int){var a=$s.styleValueRegistry.getPropertySyntax(i.syntax);if(a){var o=a.parser,s=o?o(e,r):e,u=o?o(n,r):n,c=a.mixer(s,u,r);if(c){var l=Nc.apply(void 0,w(c));return function(t){return 0===t?e:1===t?n:l(t)}}}}return Nc(!1,!0,(function(t){return t?n:e}))}function Tc(t,e,n){if("number"==typeof t&&"number"==typeof e)return t*(1-n)+e*n;if("boolean"==typeof t&&"boolean"==typeof e||"string"==typeof t&&"string"==typeof e)return n<.5?t:e;if(Array.isArray(t)&&Array.isArray(e)){for(var r=t.length,i=e.length,a=Math.max(r,i),o=[],s=0;s<a;s++)o.push(Tc(t[s<r?s:r-1],e[s<i?s:i-1],n));return o}throw new Error("Mismatched interpolation arguments ".concat(t,":").concat(e))}var Pc=function(){return b((function t(){y(this,t),this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=bc,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}),[{key:"easing",get:function(){return this._easing},set:function(t){this.easingFunction=Sc(t),this._easing=t}}])}();function Cc(t,e){if(null===t)return[];Array.isArray(t)||(t=function(t){var e=[];for(var n in t)if(!(n in["easing","offset","composite"])){var r=t[n];Array.isArray(r)||(r=[r]);for(var i=r.length,a=0;a<i;a++){if(!e[a]){var o={};"offset"in t&&(o.offset=Number(t.offset)),"easing"in t&&(o.easing=t.easing),"composite"in t&&(o.composite=t.composite),e[a]=o}void 0!==r[a]&&null!==r[a]&&(e[a][n]=r[a])}}return e.sort((function(t,e){return(t.computedOffset||0)-(e.computedOffset||0)})),e}(t));for(var n=t.map((function(t){var n={};for(var r in null!=e&&e.composite&&(n.composite="auto"),t){var i=t[r];if("offset"===r){if(null!==i){if(i=Number(i),!isFinite(i))throw new Error("Keyframe offsets must be numbers.");if(i<0||i>1)throw new Error("Keyframe offsets must be between 0 and 1.");n.computedOffset=i}}else if("composite"===r&&-1===["replace","add","accumulate","auto"].indexOf(i))throw new Error("".concat(i," compositing is not supported"));n[r]=i}return void 0===n.offset&&(n.offset=null),void 0===n.easing&&(n.easing=(null==e?void 0:e.easing)||"linear"),void 0===n.composite&&(n.composite="auto"),n})),r=!0,i=-1/0,a=0;a<n.length;a++){var o=n[a].offset;if(ue(o))r=!1;else{if(o<i)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=o}}return n=n.filter((function(t){return Number(t.offset)>=0&&Number(t.offset)<=1})),r||function(){var t,e,r=n.length;n[r-1].computedOffset=Number(null!==(t=n[r-1].offset)&&void 0!==t?t:1),r>1&&(n[0].computedOffset=Number(null!==(e=n[0].offset)&&void 0!==e?e:0));for(var i=0,a=Number(n[0].computedOffset),o=1;o<r;o++){var s=n[o].computedOffset;if(!ue(s)&&!ue(a)){for(var u=1;u<o-i;u++)n[i+u].computedOffset=a+(Number(s)-a)*u/(o-i);i=o,a=Number(s)}}}(),n}var Rc="backwards|forwards|both|none".split("|"),Lc="reverse|alternate|alternate-reverse".split("|");var Dc=function(){return b((function t(e,n,r){var i,a=this;y(this,t),this.composite="replace",this.iterationComposite="replace",this.target=e,this.timing=function(t,e){return function(t,e){var n=new Pc;return e&&(n.fill="both",n.duration="auto"),"number"!=typeof t||isNaN(t)?void 0!==t&&Object.keys(t).forEach((function(e){if(void 0!==t[e]&&null!==t[e]&&"auto"!==t[e]){if(("number"==typeof n[e]||"duration"===e)&&("number"!=typeof t[e]||isNaN(t[e])))return;if("fill"===e&&-1===Rc.indexOf(t[e]))return;if("direction"===e&&-1===Lc.indexOf(t[e]))return;n[e]=t[e]}})):n.duration=t,n}(t=function(t){return"number"==typeof t&&(t=isNaN(t)?{duration:"auto"}:{duration:t}),t}(null!=t?t:{duration:"auto"}),e)}(r,!1),this.timing.effect=this,this.timing.activeDuration=(i=this.timing,Math.abs(function(t){var e;return 0===t.duration||0===t.iterations?0:("auto"===t.duration?0:Number(t.duration))*(null!==(e=t.iterations)&&void 0!==e?e:1)}(i)/(i.playbackRate||1))),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=Cc(n,this.timing),this.interpolations=function(t,e,n){var r=function(t,e){for(var n={},r=0;r<t.length;r++)for(var i in t[r])if(Oc(i)){var a={offset:t[r].offset,computedOffset:t[r].computedOffset,easing:t[r].easing,easingFunction:Sc(t[r].easing)||e.easingFunction,value:t[r][i]};n[i]=n[i]||[],n[i].push(a)}return n}(t,e),i=function(t,e){var n=[];for(var r in t)for(var i=t[r],a=0;a<i.length-1;a++){var o=a,s=a+1,u=i[o].computedOffset,c=i[s].computedOffset,l=u,h=c;0===a&&(l=-1/0,0===c&&(s=o)),a===i.length-2&&(h=1/0,1===u&&(o=s)),n.push({applyFrom:l,applyTo:h,startOffset:i[o].computedOffset,endOffset:i[s].computedOffset,easingFunction:i[o].easingFunction,property:r,interpolation:Ac(r,i[o].value,i[s].value,e)})}return n.sort((function(t,e){return t.startOffset-e.startOffset})),n}(r,n);return function(t,e){if(null!==e)i.filter((function(t){return e>=t.applyFrom&&e<t.applyTo})).forEach((function(n){var r=e-n.startOffset,i=n.endOffset-n.startOffset,a=0===i?0:r/i;t.setAttribute(n.property,n.interpolation(a),!1,!1)}));else for(var n in r)Oc(n)&&t.setAttribute(n,null)}}(this.normalizedKeyframes,this.timing,this.target);var o=$s.globalThis.Proxy;this.computedTiming=o?new o(this.timing,{get:function(t,e){return"duration"===e?"auto"===t.duration?0:t.duration:"fill"===e?"auto"===t.fill?"none":t.fill:"localTime"===e?a.animation&&a.animation.currentTime||null:"currentIteration"===e?a.animation&&"running"===a.animation.playState?t.currentIteration||0:null:"progress"===e?a.animation&&"running"===a.animation.playState?t.progress||0:null:t[e]},set:function(){return!0}}):this.timing}),[{key:"applyInterpolations",value:function(){this.interpolations(this.target,Number(this.timeFraction))}},{key:"update",value:function(t){return null!==t&&(this.timeFraction=function(t,e,n){var r=function(t,e,n){if(null===e)return 0;var r=n.endTime;return e<Math.min(n.delay,r)?1:e>=Math.min(n.delay+t+n.endDelay,r)?2:3}(t,e,n),i=function(t,e,n,r,i){switch(r){case 1:return"backwards"===e||"both"===e?0:null;case 3:return n-i;case 2:return"forwards"===e||"both"===e?t:null;case 0:return null}}(t,n.fill,e,r,n.delay);if(null===i)return null;var a="auto"===n.duration?0:n.duration,o=function(t,e,n,r,i){var a=i;return 0===t?1!==e&&(a+=n):a+=r/t,a}(a,r,n.iterations,i,n.iterationStart),s=function(t,e,n,r,i,a){var o=t===1/0?e%1:t%1;return 0!==o||2!==n||0===r||0===i&&0!==a||(o=1),o}(o,n.iterationStart,r,n.iterations,i,a),u=function(t,e,n,r){return 2===t&&e===1/0?1/0:1===n?Math.floor(r)-1:Math.floor(r)}(r,n.iterations,s,o),c=function(t,e,n){var r=t;if("normal"!==t&&"reverse"!==t){var i=e;"alternate-reverse"===t&&(i+=1),r="normal",i!==1/0&&i%2!=0&&(r="reverse")}return"normal"===r?n:1-n}(n.direction,u,s);return n.currentIteration=u,n.progress=c,n.easingFunction(c)}(this.timing.activeDuration,t,this.timing),null!==this.timeFraction)}},{key:"getKeyframes",value:function(){return this.normalizedKeyframes}},{key:"setKeyframes",value:function(t){this.normalizedKeyframes=Cc(t)}},{key:"getComputedTiming",value:function(){return this.computedTiming}},{key:"getTiming",value:function(){return this.timing}},{key:"updateTiming",value:function(t){var e=this;Object.keys(t||{}).forEach((function(n){e.timing[n]=t[n]}))}}])}();function _c(t,e){return Number(t.id)-Number(e.id)}var Ic=function(){return b((function t(e){var n=this;y(this,t),this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(t){n.currentTime=t,n.discardAnimations(),0===n.animations.length?n.timelineTicking=!1:n.requestAnimationFrame(n.webAnimationsNextTick)},this.processRafCallbacks=function(t){var e=n.rafCallbacks;n.rafCallbacks=[],t<Number(n.currentTime)&&(t=Number(n.currentTime)),n.animations.sort(_c),n.animations=n.tick(t,!0,n.animations)[0],e.forEach((function(e){e[1](t)})),n.applyPendingEffects()},this.document=e}),[{key:"getAnimations",value:function(){return this.discardAnimations(),this.animations.slice()}},{key:"isTicking",value:function(){return this.inTick}},{key:"play",value:function(t,e,n){var r=new Dc(t,e,n),i=new Uu(r,this);return this.animations.push(i),this.restartWebAnimationsNextTick(),i.updatePromises(),i.play(),i.updatePromises(),i}},{key:"applyDirtiedAnimation",value:function(t){var e=this;if(!this.inTick){t.markTarget();var n=t.targetAnimations();n.sort(_c),this.tick(Number(this.currentTime),!1,n.slice())[1].forEach((function(t){var n=e.animations.indexOf(t);-1!==n&&e.animations.splice(n,1)})),this.applyPendingEffects()}}},{key:"restart",value:function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame((function(){})),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame}},{key:"destroy",value:function(){this.document.defaultView.cancelAnimationFrame(this.frameId)}},{key:"applyPendingEffects",value:function(){this.pendingEffects.forEach((function(t){null==t||t.applyInterpolations()})),this.pendingEffects=[]}},{key:"updateAnimationsPromises",value:function(){this.animationsWithPromises=this.animationsWithPromises.filter((function(t){return t.updatePromises()}))}},{key:"discardAnimations",value:function(){this.updateAnimationsPromises(),this.animations=this.animations.filter((function(t){return"finished"!==t.playState&&"idle"!==t.playState}))}},{key:"restartWebAnimationsNextTick",value:function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))}},{key:"rAF",value:function(t){var e=this.rafId++;return 0===this.rafCallbacks.length&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([e,t]),e}},{key:"requestAnimationFrame",value:function(t){var e=this;return this.rAF((function(n){e.updateAnimationsPromises(),t(n),e.updateAnimationsPromises()}))}},{key:"tick",value:function(t,e,n){var r,i,a=this;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=t,this.ticking=!1;var o=[],s=[],u=[],c=[];return n.forEach((function(n){n.tick(t,e),n._inEffect?(s.push(n.effect),n.markTarget()):(o.push(n.effect),n.unmarkTarget()),n._needsTick&&(a.ticking=!0);var r=n._inEffect||n._needsTick;n._inTimeline=r,r?u.push(n):c.push(n)})),(r=this.pendingEffects).push.apply(r,o),(i=this.pendingEffects).push.apply(i,s),this.ticking&&this.requestAnimationFrame((function(){})),this.inTick=!1,[u,c]}}])}();$s.EasingFunction=Sc,$s.AnimationTimeline=Ic;const jc=function(t){return ue(t)?"":t.toString()},Fc=function(t){var e=jc(t);return e.charAt(0).toUpperCase()+e.substring(1)},Bc=function(t){return"object"==typeof t&&null!==t},zc=function(t){return null!==t&&"function"!=typeof t&&isFinite(t.length)};var Gc=function(t,e){if(t===e)return!0;if(!t||!e)return!1;if(ce(t)||ce(e))return!1;if(zc(t)||zc(e)){if(t.length!==e.length)return!1;for(var n=!0,r=0;r<t.length&&(n=Gc(t[r],e[r]));r++);return n}if(Bc(t)||Bc(e)){var i=Object.keys(t),a=Object.keys(e);if(i.length!==a.length)return!1;for(n=!0,r=0;r<i.length&&(n=Gc(t[i[r]],e[i[r]]));r++);return n}return!1};const Vc=Gc;var Wc,Hc,Yc,Uc,qc,Xc,Kc,$c,Zc,Qc,Jc={duration:500},tl={duration:1e3,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",iterations:1,fill:"both"};!function(t){t.NodeAdded="NodeAdded",t.NodeUpdated="NodeUpdated",t.NodeRemoved="NodeRemoved",t.EdgeAdded="EdgeAdded",t.EdgeUpdated="EdgeUpdated",t.EdgeRemoved="EdgeRemoved",t.ComboAdded="ComboAdded",t.ComboUpdated="ComboUpdated",t.ComboRemoved="ComboRemoved"}(Wc||(Wc={})),function(t){t.DRAW="draw",t.COLLAPSE="collapse",t.EXPAND="expand",t.TRANSFORM="transform"}(Hc||(Hc={})),function(t){t.CLICK="canvas:click",t.DBLCLICK="canvas:dblclick",t.POINTER_OVER="canvas:pointerover",t.POINTER_LEAVE="canvas:pointerleave",t.POINTER_ENTER="canvas:pointerenter",t.POINTER_MOVE="canvas:pointermove",t.POINTER_OUT="canvas:pointerout",t.POINTER_DOWN="canvas:pointerdown",t.POINTER_UP="canvas:pointerup",t.CONTEXT_MENU="canvas:contextmenu",t.DRAG_START="canvas:dragstart",t.DRAG="canvas:drag",t.DRAG_END="canvas:dragend",t.DRAG_ENTER="canvas:dragenter",t.DRAG_OVER="canvas:dragover",t.DRAG_LEAVE="canvas:dragleave",t.DROP="canvas:drop",t.WHEEL="canvas:wheel"}(Yc||(Yc={})),function(t){t.CLICK="combo:click",t.DBLCLICK="combo:dblclick",t.POINTER_OVER="combo:pointerover",t.POINTER_LEAVE="combo:pointerleave",t.POINTER_ENTER="combo:pointerenter",t.POINTER_MOVE="combo:pointermove",t.POINTER_OUT="combo:pointerout",t.POINTER_DOWN="combo:pointerdown",t.POINTER_UP="combo:pointerup",t.CONTEXT_MENU="combo:contextmenu",t.DRAG_START="combo:dragstart",t.DRAG="combo:drag",t.DRAG_END="combo:dragend",t.DRAG_ENTER="combo:dragenter",t.DRAG_OVER="combo:dragover",t.DRAG_LEAVE="combo:dragleave",t.DROP="combo:drop"}(Uc||(Uc={})),function(t){t.CLICK="click",t.DBLCLICK="dblclick",t.POINTER_OVER="pointerover",t.POINTER_LEAVE="pointerleave",t.POINTER_ENTER="pointerenter",t.POINTER_MOVE="pointermove",t.POINTER_OUT="pointerout",t.POINTER_DOWN="pointerdown",t.POINTER_UP="pointerup",t.CONTEXT_MENU="contextmenu",t.DRAG_START="dragstart",t.DRAG="drag",t.DRAG_END="dragend",t.DRAG_ENTER="dragenter",t.DRAG_OVER="dragover",t.DRAG_LEAVE="dragleave",t.DROP="drop",t.KEY_DOWN="keydown",t.KEY_UP="keyup",t.WHEEL="wheel",t.PINCH="pinch"}(qc||(qc={})),function(t){t.KEY_DOWN="keydown",t.KEY_UP="keyup"}(Xc||(Xc={})),function(t){t.CLICK="edge:click",t.DBLCLICK="edge:dblclick",t.POINTER_OVER="edge:pointerover",t.POINTER_LEAVE="edge:pointerleave",t.POINTER_ENTER="edge:pointerenter",t.POINTER_MOVE="edge:pointermove",t.POINTER_OUT="edge:pointerout",t.POINTER_DOWN="edge:pointerdown",t.POINTER_UP="edge:pointerup",t.CONTEXT_MENU="edge:contextmenu",t.DRAG_ENTER="edge:dragenter",t.DRAG_OVER="edge:dragover",t.DRAG_LEAVE="edge:dragleave",t.DROP="edge:drop"}(Kc||(Kc={})),function(t){t.BEFORE_CANVAS_INIT="beforecanvasinit",t.AFTER_CANVAS_INIT="aftercanvasinit",t.BEFORE_SIZE_CHANGE="beforesizechange",t.AFTER_SIZE_CHANGE="aftersizechange",t.BEFORE_ELEMENT_CREATE="beforeelementcreate",t.AFTER_ELEMENT_CREATE="afterelementcreate",t.BEFORE_ELEMENT_UPDATE="beforeelementupdate",t.AFTER_ELEMENT_UPDATE="afterelementupdate",t.BEFORE_ELEMENT_DESTROY="beforeelementdestroy",t.AFTER_ELEMENT_DESTROY="afterelementdestroy",t.BEFORE_ELEMENT_TRANSLATE="beforeelementtranslate",t.AFTER_ELEMENT_TRANSLATE="afterelementtranslate",t.BEFORE_DRAW="beforedraw",t.AFTER_DRAW="afterdraw",t.BEFORE_RENDER="beforerender",t.AFTER_RENDER="afterrender",t.BEFORE_ANIMATE="beforeanimate",t.AFTER_ANIMATE="afteranimate",t.BEFORE_LAYOUT="beforelayout",t.AFTER_LAYOUT="afterlayout",t.BEFORE_STAGE_LAYOUT="beforestagelayout",t.AFTER_STAGE_LAYOUT="afterstagelayout",t.BEFORE_TRANSFORM="beforetransform",t.AFTER_TRANSFORM="aftertransform",t.BATCH_START="batchstart",t.BATCH_END="batchend",t.BEFORE_DESTROY="beforedestroy",t.AFTER_DESTROY="afterdestroy",t.BEFORE_RENDERER_CHANGE="beforerendererchange",t.AFTER_RENDERER_CHANGE="afterrendererchange"}($c||($c={})),function(t){t.UNDO="undo",t.REDO="redo",t.CANCEL="cancel",t.ADD="add",t.CLEAR="clear",t.CHANGE="change"}(Zc||(Zc={})),function(t){t.CLICK="node:click",t.DBLCLICK="node:dblclick",t.POINTER_OVER="node:pointerover",t.POINTER_LEAVE="node:pointerleave",t.POINTER_ENTER="node:pointerenter",t.POINTER_MOVE="node:pointermove",t.POINTER_OUT="node:pointerout",t.POINTER_DOWN="node:pointerdown",t.POINTER_UP="node:pointerup",t.CONTEXT_MENU="node:contextmenu",t.DRAG_START="node:dragstart",t.DRAG="node:drag",t.DRAG_END="node:dragend",t.DRAG_ENTER="node:dragenter",t.DRAG_OVER="node:dragover",t.DRAG_LEAVE="node:dragleave",t.DROP="node:drop"}(Qc||(Qc={}));var el,nl="combo",rl="tree";!function(t){t.NODE="node",t.EDGE="edge",t.COMBO="combo",t.THEME="theme",t.PALETTE="palette",t.LAYOUT="layout",t.BEHAVIOR="behavior",t.PLUGIN="plugin",t.ANIMATION="animation",t.TRANSFORM="transform",t.SHAPE="shape"}(el||(el={}));var il={animation:{},behavior:{},combo:{},edge:{},layout:{},node:{},palette:{},theme:{},plugin:{},transform:{},shape:{}};function al(t,e){var n,r=null===(n=il[t])||void 0===n?void 0:n[e];if(r)return r}function ol(t){return il[t]}var sl="5.0.44",ul="G6";function cl(t){return"[".concat(ul," v").concat(sl,"] ").concat(t)}var ll={mute:!1,debug:function(t){!ll.mute&&console.debug(cl(t))},info:function(t){!ll.mute&&console.info(cl(t))},warn:function(t){!ll.mute&&console.warn(cl(t))},error:function(t){!ll.mute&&console.error(cl(t))}};function hl(t){var e=t.theme;return e?al(el.THEME,e)||(ll.warn("The theme of ".concat(e," is not registered.")),{}):{}}function dl(t,e){if(Array.isArray(t)&&0===t.length)return null;var n=Array.isArray(t)?t[0]:t,r=Array.isArray(t)?t.slice(1):e||[];return new Proxy(n,{get:function(t,e){return"function"!=typeof t[e]||["onframe","onfinish"].includes(e)?"finished"===e?Promise.all([n.finished].concat(w(r.map((function(t){return t.finished}))))):Reflect.get(t,e):function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];t[e].apply(t,i),r.forEach((function(t){var n,r;return null===(r=t[e])||void 0===r?void 0:(n=r).call.apply(n,[t].concat(i))}))}},set:function(t,e,n){return["onframe","onfinish"].includes(e)||r.forEach((function(t){t[e]=n})),Reflect.set(t,e,n)}})}function fl(t){var e=t.reduce((function(t,e){return Object.entries(e).forEach((function(e){var n=h(e,2),r=n[0],i=n[1];void 0===t[r]?t[r]=[i]:t[r].push(i)})),t}),{});Object.entries(e).forEach((function(n){var r=h(n,2),i=r[0],a=r[1];(a.length!==t.length||a.some((function(t){return ue(t)}))||a.every((function(t){return!["sourceNode","targetNode","childrenNode"].includes(i)&&Vc(t,a[0])})))&&delete e[i]}));var n=Object.entries(e).reduce((function(t,e){var n=h(e,2),r=n[0];return n[1].forEach((function(e,n){t[n]?t[n][r]=e:t[n]=v({},r,e)})),t}),[]);return 0!==t.length&&0===n.length&&n.push.apply(n,[{_:0},{_:0}]),n}function vl(t){switch(t){case"opacity":return 1;case"x":case"y":case"z":case"zIndex":return 0;case"visibility":return"visible";case"collapsed":return!1;case"states":return[];default:return}}function pl(t,e){var n=t.animation;if(!1===n||!1===e)return!1;var r=Object.assign({},Jc);return ln(n)&&Object.assign(r,n),ln(e)&&Object.assign(r,e),r}function gl(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(!r&&0===t&&0===e&&0===n)return null;if(Array.isArray(r)){for(var i=-1,a=[],o=0;o<r.length;o++){var s=r[o];if("translate"===s[0]){if(s[1]===t&&s[2]===e)return null;i=o,a.push(["translate",t,e])}else if("translate3d"===s[0]){if(s[1]===t&&s[2]===e&&s[3]===n)return null;i=o,a.push(["translate3d",t,e,null!=n?n:0])}else a.push(s)}return-1===i&&a.splice(0,0,oe(n)?["translate3d",t,e,null!=n?n:0]:["translate",t,e]),0===a.length?null:a}var u=r?r.replace(/translate(3d)?\([^)]*\)/g,""):"";return 0===n?"translate(".concat(t,", ").concat(e,")").concat(u):"translate3d(".concat(t,", ").concat(e,", ").concat(n,")").concat(u)}var yl=function(t,e,n){if(!n.length)return null;var r,i=h(e,2),a=i[0],o=i[1],s=n.map((function(e){var n=e.fields,i=e.shape,s=(e.states,function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(e,["fields","shape","states"])),u=function(e){var n;if(e){var r=t.getShape(e);if(!r)return null;var i="get".concat(Fc(e),"Style"),s=(null===(n=null==t?void 0:t[i])||void 0===n?void 0:n.bind(t))||function(t){return t};return{shape:r,fromStyle:(null==s?void 0:s(a))||{},toStyle:(null==s?void 0:s(o))||{}}}return{shape:t,fromStyle:a,toStyle:o}}(i);if(!u)return null;var c=u.shape,l=u.fromStyle,h=u.toStyle,d=[{},{}];if(n.forEach((function(t){var e,n;Object.assign(d[0],v({},t,null!==(e=l[t])&&void 0!==e?e:vl(t))),Object.assign(d[1],v({},t,null!==(n=h[t])&&void 0!==n?n:vl(t)))})),d.some((function(t){return Object.keys(t).some((function(t){return["x","y","z"].includes(t)}))}))){var f=c.attributes||{},p=f.x,g=void 0===p?0:p,y=f.y,m=void 0===y?0:y,b=f.z,x=f.transform,w=void 0===x?"":x;d.forEach((function(t){var e,n,r;t.transform=gl(null!==(e=t.x)&&void 0!==e?e:g,null!==(n=t.y)&&void 0!==n?n:m,null!==(r=t.z)&&void 0!==r?r:b,w)}))}var E=c.animate(fl(d),s);return void 0===i&&(r=E),E})).filter(Boolean),u=r||(null==s?void 0:s[0]);return u?dl(u,s.filter((function(t){return t!=t}))):null},ml=[{fields:["x","y"]}],bl=ml,xl=[{fields:["sourceNode","targetNode"]}],wl=xl,El=[{fields:["childrenNode","x","y"]}],kl=El,Ml=Object.prototype.hasOwnProperty;const Sl=function(t,e){if(!e||!He(t))return{};for(var n,r={},i=cn(e)?e:function(t){return t[e]},a=0;a<t.length;a++){var o=t[a];n=i(o),Ml.call(r,n)?r[n].push(o):r[n]=[o]}return r},Ol=function(t,e,n){var r,i,a,o,s=0;n||(n={});var u=function(){s=!1===n.leading?0:Date.now(),r=null,o=t.apply(i,a),r||(i=a=null)},c=function(){var c=Date.now();s||!1!==n.leading||(s=c);var l=e-(c-s);return i=this,a=arguments,l<=0||l>e?(r&&(clearTimeout(r),r=null),s=c,o=t.apply(i,a),r||(i=a=null)):r||!1===n.trailing||(r=setTimeout(u,l)),o};return c.cancel=function(){clearTimeout(r),s=0,r=i=a=null},c};var Nl=function(t){if("object"!=typeof t||null===t)return t;var e;if(He(t)){e=[];for(var n=0,r=t.length;n<r;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=Nl(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=Nl(t[i]):e[i]=t[i];return e};const Al=Nl;function Tl(t){return t instanceof Float32Array||!(!Array.isArray(t)||2!==t.length&&3!==t.length)&&t.every((function(t){return"number"==typeof t}))}function Pl(t,e,n){return t>=e&&t<=n}function Cl(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(Array.isArray(t)){var e=h(t,4),n=e[0],r=void 0===n?0:n,i=e[1],a=void 0===i?r:i,o=e[2],s=void 0===o?r:o,u=e[3];return[r,a,s,void 0===u?a:u]}return[t,t,t,t]}function Rl(){var t=Cl(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0);return t[0]+t[2]}function Ll(t){return t.max[0]-t.min[0]}function Dl(t){return t.max[1]-t.min[1]}function _l(t){return[Ll(t),Dl(t)]}function Il(t,e){var n=Tl(t)?jl(t):t.getShape("key").getBounds();return e?Fl(n,e):n}function jl(t){var e=h(t,3),n=e[0],r=e[1],i=e[2],a=void 0===i?0:i,o=new Hn;return o.setMinMax([n,r,a],[n,r,a]),o}function Fl(t,e){var n=h(Cl(e),4),r=n[0],i=n[1],a=n[2],o=n[3],s=h(t.min,3),u=s[0],c=s[1],l=s[2],d=h(t.max,3),f=d[0],v=d[1],p=d[2],g=new Hn;return g.setMinMax([u-o,c-r,l],[f+i,v+a,p]),g}function Bl(t){if(0===t.length)return new Hn;if(1===t.length)return t[0];var e=new Hn;e.setMinMax(t[0].min,t[0].max);for(var n=1;n<t.length;n++){var r=t[n];e.setMinMax([Math.min(e.min[0],r.min[0]),Math.min(e.min[1],r.min[1]),Math.min(e.min[2],r.min[2])],[Math.max(e.max[0],r.max[0]),Math.max(e.max[1],r.max[1]),Math.max(e.max[2],r.max[2])])}return e}function zl(t,e){return Pl(t[0],e.min[0],e.max[0])&&Pl(t[1],e.min[1],e.max[1])}function Gl(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=h(e.min,2),i=r[0],a=r[1],o=h(e.max,2),s=o[0],u=o[1],c=(t[1]===a||t[1]===u)&&(n||Pl(t[0],i,s)),l=(t[0]===i||t[0]===s)&&(n||Pl(t[1],a,u));return c||l}function Vl(t,e){var n=e.center;return t[0]===n[0]&&t[1]===n[1]}function Wl(t,e){var n=h(t,2),r=n[0],i=n[1],a=h(e.min,2),o=a[0],s=a[1],u=h(e.max,2),c=r-o,l=u[0]-r,d=i-s,f=u[1]-i,v=Math.min(c,l,d,f);return v===c?"left":v===l?"right":v===d?"top":v===f?"bottom":"left"}function Hl(t,e){var n=Al(t);if(zl(t,e))switch(Wl(t,e)){case"left":n[0]=e.min[0];break;case"right":n[0]=e.max[0];break;case"top":n[1]=e.min[1];break;case"bottom":n[1]=e.max[1]}else{var r=h(t,2),i=r[0],a=r[1],o=h(e.min,2),s=o[0],u=o[1],c=h(e.max,2),l=c[0],d=c[1];n[0]=Pl(i,s,l)?i:i<s?s:l,n[1]=Pl(a,u,d)?a:a<u?u:d}return n}var Yl=function(t,e){return t===e},Ul=function(){function t(t,e){void 0===e&&(e=null),this.value=t,this.next=e}return t.prototype.toString=function(t){return t?t(this.value):"".concat(this.value)},t}(),ql=function(){function t(t){void 0===t&&(t=Yl),this.head=null,this.tail=null,this.compare=t}return t.prototype.prepend=function(t){var e=new Ul(t,this.head);return this.head=e,this.tail||(this.tail=e),this},t.prototype.append=function(t){var e=new Ul(t);return this.head?(this.tail.next=e,this.tail=e,this):(this.head=e,this.tail=e,this)},t.prototype.delete=function(t){if(!this.head)return null;for(var e=null;this.head&&this.compare(this.head.value,t);)e=this.head,this.head=this.head.next;var n=this.head;if(null!==n)for(;n.next;)this.compare(n.next.value,t)?(e=n.next,n.next=n.next.next):n=n.next;return this.compare(this.tail.value,t)&&(this.tail=n),e},t.prototype.find=function(t){var e=t.value,n=void 0===e?void 0:e,r=t.callback,i=void 0===r?void 0:r;if(!this.head)return null;for(var a=this.head;a;){if(i&&i(a.value))return a;if(void 0!==n&&this.compare(a.value,n))return a;a=a.next}return null},t.prototype.deleteTail=function(){var t=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,t;for(var e=this.head;e.next;)e.next.next?e=e.next:e.next=null;return this.tail=e,t},t.prototype.deleteHead=function(){if(!this.head)return null;var t=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),t},t.prototype.fromArray=function(t){var e=this;return t.forEach((function(t){return e.append(t)})),this},t.prototype.toArray=function(){for(var t=[],e=this.head;e;)t.push(e),e=e.next;return t},t.prototype.reverse=function(){for(var t=this.head,e=null,n=null;t;)n=t.next,t.next=e,e=t,t=n;this.tail=this.head,this.head=e},t.prototype.toString=function(t){return void 0===t&&(t=void 0),this.toArray().map((function(e){return e.toString(t)})).toString()},t}();const Xl=ql;!function(){function t(){this.linkedList=new Xl}t.prototype.isEmpty=function(){return!this.linkedList.head},t.prototype.peek=function(){return this.linkedList.head?this.linkedList.head.value:null},t.prototype.enqueue=function(t){this.linkedList.append(t)},t.prototype.dequeue=function(){var t=this.linkedList.deleteHead();return t?t.value:null},t.prototype.toString=function(t){return this.linkedList.toString(t)}}();var Kl=function(t,e,n){void 0===e&&(e=[]);var r=e.filter((function(e){return e.source===t||e.target===t}));return"target"===n?r.filter((function(e){return e.source===t})).map((function(t){return t.target})):"source"===n?r.filter((function(e){return e.target===t})).map((function(t){return t.source})):r.map((function(e){return e.source===t?e.target:e.source}))};const $l=function(t){var e={},n=t.nodes,r=void 0===n?[]:n,i=t.edges,a=void 0===i?[]:i;return r.forEach((function(t){e[t.id]={degree:0,inDegree:0,outDegree:0}})),a.forEach((function(t){e[t.source].degree++,e[t.source].outDegree++,e[t.target].degree++,e[t.target].inDegree++})),e};var Zl={}.toString;const Ql=function(t,e){return Zl.call(t)==="[object "+e+"]"},Jl=function(t){return Ql(t,"Function")},th=function(t){return Array.isArray?Array.isArray(t):Ql(t,"Array")};Object.keys;var eh=Array.prototype;eh.splice,eh.indexOf,Array.prototype.splice;Object.prototype.hasOwnProperty;Number.isInteger&&Number.isInteger,Math.PI,Math.PI;const nh=Object.values?function(t){return Object.values(t)}:function(t){var e=[];return function(t,e){var n,r;if(t)if(th(t))for(var i=0,a=t.length;i<a&&!1!==e(t[i],i);i++);else if(r=typeof(n=t),null!==n&&"object"===r||"function"===r)for(var o in t)if(t.hasOwnProperty(o)&&!1===e(t[o],o))break}(t,(function(n,r){Jl(t)&&"prototype"===r||e.push(n)})),e};Object.prototype;var rh=function(t){if("object"!=typeof t||null===t)return t;var e;if(th(t)){e=[];for(var n=0,r=t.length;n<r;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=rh(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=rh(t[i]):e[i]=t[i];return e};const ih=rh;var ah;Object.prototype.hasOwnProperty,Object.prototype.hasOwnProperty,function(t,e){if(!Jl(t))throw new TypeError("Expected a function");var n=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var a=e?e.apply(this,r):r[0],o=n.cache;if(o.has(a))return o.get(a);var s=t.apply(this,r);return o.set(a,s),s};n.cache=new Map}((function(t,e){void 0===e&&(e={});var n,r=e.fontSize,i=e.fontFamily,a=e.fontWeight,o=e.fontStyle,s=e.fontVariant;return ah||(ah=document.createElement("canvas").getContext("2d")),ah.font=[o,s,a,r+"px",i].join(" "),ah.measureText((n=t,Ql(n,"String")?t:"")).width}),(function(t,e){return void 0===e&&(e={}),function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}([t],nh(e)).join("")})),function(){function t(){this.map={}}t.prototype.has=function(t){return void 0!==this.map[t]},t.prototype.get=function(t,e){var n=this.map[t];return void 0===n?e:n},t.prototype.set=function(t,e){this.map[t]=e},t.prototype.clear=function(){this.map={}},t.prototype.delete=function(t){delete this.map[t]},t.prototype.size=function(){return Object.keys(this.map).length}}();function oh(t,e,n,r){if(t===e)return[t];if(r[e])return r[e];for(var i=[],a=0,o=n[e];a<o.length;a++){var s=oh(t,o[a],n,r);if(!s)return;for(var u=0,c=s;u<c.length;u++){var l=c[u];th(l)?i.push(me(me([],l,!0),[e],!1)):i.push([l,e])}}return r[e]=i,r[e]}var sh,uh=function(t,e,n,r,i){var a=function(t,e,n,r){var i=t.nodes,a=void 0===i?[]:i,o=t.edges,s=void 0===o?[]:o,u=[],c={},l={},h={};a.forEach((function(t,n){var r=t.id;u.push(r),l[r]=1/0,r===e&&(l[r]=0)}));for(var d=a.length,f=function(t){var e=function(t,e,n){for(var r,i=1/0,a=0;a<e.length;a++){var o=e[a].id;!n[o]&&t[o]<=i&&(i=t[o],r=e[a])}return r}(l,a,c),i=e.id;if(c[i]=!0,l[i]===1/0)return"continue";var o=[];o=n?function(t,e){return e.filter((function(e){return e.source===t}))}(i,s):function(t,e){return e.filter((function(e){return e.source===t||e.target===t}))}(i,s),o.forEach((function(t){var n=t.target,a=t.source,o=n===i?a:n,s=r&&t[r]?t[r]:1;l[o]>l[e.id]+s?(l[o]=l[e.id]+s,h[o]=[e.id]):l[o]===l[e.id]+s&&h[o].push(e.id)}))},v=0;v<d;v++)f();h[e]=[e];var p={};for(var g in l)l[g]!==1/0&&oh(e,g,h,p);var y={};for(var g in p)y[g]=p[g][0];return{length:l,path:y,allPath:p}}(t,e,r,i),o=a.length,s=a.path,u=a.allPath;return{length:o[n],path:s[n],allPath:u[n]}};!function(){function t(t){this.arr=t}t.prototype.getArr=function(){return this.arr||[]},t.prototype.add=function(e){var n,r=e.arr;if(!(null===(n=this.arr)||void 0===n?void 0:n.length))return new t(r);if(!(null==r?void 0:r.length))return new t(this.arr);if(this.arr.length===r.length){var i=[];for(var a in this.arr)i[a]=this.arr[a]+r[a];return new t(i)}},t.prototype.subtract=function(e){var n,r=e.arr;if(!(null===(n=this.arr)||void 0===n?void 0:n.length))return new t(r);if(!(null==r?void 0:r.length))return new t(this.arr);if(this.arr.length===r.length){var i=[];for(var a in this.arr)i[a]=this.arr[a]-r[a];return new t(i)}},t.prototype.avg=function(e){var n=[];if(0!==e)for(var r in this.arr)n[r]=this.arr[r]/e;return new t(n)},t.prototype.negate=function(){var e=[];for(var n in this.arr)e[n]=-this.arr[n];return new t(e)},t.prototype.squareEuclideanDistance=function(t){var e,n=t.arr;if(!(null===(e=this.arr)||void 0===e?void 0:e.length)||!(null==n?void 0:n.length))return 0;if(this.arr.length===n.length){var r=0;for(var i in this.arr)r+=Math.pow(this.arr[i]-t.arr[i],2);return r}},t.prototype.euclideanDistance=function(t){var e,n=t.arr;if(!(null===(e=this.arr)||void 0===e?void 0:e.length)||!(null==n?void 0:n.length))return 0;if(this.arr.length===n.length){var r=0;for(var i in this.arr)r+=Math.pow(this.arr[i]-t.arr[i],2);return Math.sqrt(r)}console.error("The two vectors are unequal in length.")},t.prototype.normalize=function(){var e=[],n=ih(this.arr);n.sort((function(t,e){return t-e}));var r=n[n.length-1],i=n[0];for(var a in this.arr)e[a]=(this.arr[a]-i)/(r-i);return new t(e)},t.prototype.norm2=function(){var t;if(!(null===(t=this.arr)||void 0===t?void 0:t.length))return 0;var e=0;for(var n in this.arr)e+=Math.pow(this.arr[n],2);return Math.sqrt(e)},t.prototype.dot=function(t){var e,n=t.arr;if(!(null===(e=this.arr)||void 0===e?void 0:e.length)||!(null==n?void 0:n.length))return 0;if(this.arr.length===n.length){var r=0;for(var i in this.arr)r+=this.arr[i]*t.arr[i];return r}console.error("The two vectors are unequal in length.")},t.prototype.equal=function(t){var e,n=t.arr;if((null===(e=this.arr)||void 0===e?void 0:e.length)!==(null==n?void 0:n.length))return!1;for(var r in this.arr)if(this.arr[r]!==n[r])return!1;return!0}}(),function(t){t.EuclideanDistance="euclideanDistance"}(sh||(sh={})),function(){function t(t){this.count=t.length,this.parent={};for(var e=0,n=t;e<n.length;e++){var r=n[e];this.parent[r]=r}}t.prototype.find=function(t){for(;this.parent[t]!==t;)t=this.parent[t];return t},t.prototype.union=function(t,e){var n=this.find(t),r=this.find(e);n!==r&&(n<r?(this.parent[e]!==e&&this.union(this.parent[e],t),this.parent[e]=this.parent[t]):(this.parent[t]!==t&&this.union(this.parent[t],e),this.parent[t]=this.parent[e]))},t.prototype.connected=function(t,e){return this.find(t)===this.find(e)}}();var ch=function(t,e){return t-e};!function(){function t(t){void 0===t&&(t=ch),this.compareFn=t,this.list=[]}t.prototype.getLeft=function(t){return 2*t+1},t.prototype.getRight=function(t){return 2*t+2},t.prototype.getParent=function(t){return 0===t?null:Math.floor((t-1)/2)},t.prototype.isEmpty=function(){return this.list.length<=0},t.prototype.top=function(){return this.isEmpty()?void 0:this.list[0]},t.prototype.delMin=function(){var t=this.top(),e=this.list.pop();return this.list.length>0&&(this.list[0]=e,this.moveDown(0)),t},t.prototype.insert=function(t){if(null!==t){this.list.push(t);var e=this.list.length-1;return this.moveUp(e),!0}return!1},t.prototype.moveUp=function(t){for(var e=this.getParent(t);t&&t>0&&this.compareFn(this.list[e],this.list[t])>0;){var n=this.list[e];this.list[e]=this.list[t],this.list[t]=n,t=e,e=this.getParent(t)}},t.prototype.moveDown=function(t){var e,n=t,r=this.getLeft(t),i=this.getRight(t),a=this.list.length;null!==r&&r<a&&this.compareFn(this.list[n],this.list[r])>0?n=r:null!==i&&i<a&&this.compareFn(this.list[n],this.list[i])>0&&(n=i),t!==n&&(e=[this.list[n],this.list[t]],this.list[t]=e[0],this.list[n]=e[1],this.moveDown(n))}}();var lh="-1",hh=function(t,e,n,r){void 0===t&&(t=-1),void 0===e&&(e=-1),void 0===n&&(n=-1),void 0===r&&(r="-1"),this.id=t,this.from=e,this.to=n,this.label=r},dh=function(){function t(t,e){void 0===t&&(t=-1),void 0===e&&(e=lh),this.id=t,this.label=e,this.edges=[],this.edgeMap={}}return t.prototype.addEdge=function(t){this.edges.push(t),this.edgeMap[t.id]=t},t}(),fh=function(){function t(t,e,n){void 0===t&&(t=-1),void 0===e&&(e=!0),void 0===n&&(n=!1),this.id=t,this.edgeIdAutoIncrease=e,this.edges=[],this.nodes=[],this.nodeMap={},this.edgeMap={},this.nodeLabelMap={},this.edgeLabelMap={},this.counter=0,this.directed=n}return t.prototype.getNodeNum=function(){return this.nodes.length},t.prototype.addNode=function(t,e){if(!this.nodeMap[t]){var n=new dh(t,e);this.nodes.push(n),this.nodeMap[t]=n,this.nodeLabelMap[e]||(this.nodeLabelMap[e]=[]),this.nodeLabelMap[e].push(t)}},t.prototype.addEdge=function(t,e,n,r){if((this.edgeIdAutoIncrease||void 0===t)&&(t=this.counter++),!(this.nodeMap[e]&&this.nodeMap[n]&&this.nodeMap[n].edgeMap[t])){var i=new hh(t,e,n,r);if(this.edges.push(i),this.edgeMap[t]=i,this.nodeMap[e].addEdge(i),this.edgeLabelMap[r]||(this.edgeLabelMap[r]=[]),this.edgeLabelMap[r].push(i),!this.directed){var a=new hh(t,n,e,r);this.nodeMap[n].addEdge(a),this.edgeLabelMap[r].push(a)}}},t}(),vh=function(){function t(t,e,n,r,i){this.fromNode=t,this.toNode=e,this.nodeEdgeNodeLabel={nodeLabel1:n||lh,edgeLabel:r||"-1",nodeLabel2:i||lh}}return t.prototype.equalTo=function(t){return this.fromNode===t.formNode&&this.toNode===t.toNode&&this.nodeEdgeNodeLabel===t.nodeEdgeNodeLabel},t.prototype.notEqualTo=function(t){return!this.equalTo(t)},t}(),ph=function(){function t(){this.rmpath=[],this.dfsEdgeList=[]}return t.prototype.equalTo=function(t){var e=this.dfsEdgeList.length;if(e!==t.length)return!1;for(var n=0;n<e;n++)if(this.dfsEdgeList[n]!==t[n])return!1;return!0},t.prototype.notEqualTo=function(t){return!this.equalTo(t)},t.prototype.pushBack=function(t,e,n,r,i){return this.dfsEdgeList.push(new vh(t,e,n,r,i)),this.dfsEdgeList},t.prototype.toGraph=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=!1);var n=new fh(t,!0,e);return this.dfsEdgeList.forEach((function(t){var e=t.fromNode,r=t.toNode,i=t.nodeEdgeNodeLabel,a=i.nodeLabel1,o=i.edgeLabel,s=i.nodeLabel2;a!==lh&&n.addNode(e,a),s!==lh&&n.addNode(r,s),a!==lh&&s!==a&&n.addEdge(void 0,e,r,o)})),n},t.prototype.buildRmpath=function(){this.rmpath=[];for(var t=void 0,e=this.dfsEdgeList.length-1;e>=0;e--){var n=this.dfsEdgeList[e],r=n.fromNode,i=n.toNode;r<i&&(void 0===t||i===t)&&(this.rmpath.push(e),t=r)}return this.rmpath},t.prototype.getNodeNum=function(){var t={};return this.dfsEdgeList.forEach((function(e){t[e.fromNode]||(t[e.fromNode]=!0),t[e.toNode]||(t[e.toNode]=!0)})),Object.keys(t).length},t}(),gh=function(){function t(t){if(this.his={},this.nodesUsed={},this.edgesUsed={},this.edges=[],t){for(;t;){var e=t.edge;this.edges.push(e),this.nodesUsed[e.from]=1,this.nodesUsed[e.to]=1,this.edgesUsed[e.id]=1,t=t.preNode}this.edges=this.edges.reverse()}}return t.prototype.hasNode=function(t){return 1===this.nodesUsed[t.id]},t.prototype.hasEdge=function(t){return 1===this.edgesUsed[t.id]},t}();function yh(t){if(void 0!==t.id)return t.id;if(void 0!==t.source&&void 0!==t.target)return"".concat(t.source,"-").concat(t.target);throw new Error(cl("The datum does not have available id."))}function mh(t){return t.combo}function bh(t,e){var n={nodes:(t.nodes||[]).map(yh),edges:(t.edges||[]).map(yh),combos:(t.combos||[]).map(yh)};return e?Object.values(n).flat():n}!function(){function t(t){var e=t.graphs,n=t.minSupport,r=void 0===n?2:n,i=t.minNodeNum,a=void 0===i?1:i,o=t.maxNodeNum,s=void 0===o?4:o,u=t.top,c=void 0===u?10:u,l=t.directed,h=void 0!==l&&l,d=t.verbose,f=void 0!==d&&d;this.graphs=e,this.dfsCode=new ph,this.support=0,this.frequentSize1Subgraphs=[],this.frequentSubgraphs=[],this.minSupport=r,this.top=c,this.directed=h,this.counter=0,this.maxNodeNum=s,this.minNodeNum=a,this.verbose=f,this.maxNodeNum<this.minNodeNum&&(this.maxNodeNum=this.minNodeNum),this.reportDF=[]}t.prototype.findForwardRootEdges=function(t,e){var n=this,r=[],i=t.nodeMap;return e.edges.forEach((function(t){(n.directed||e.label<=i[t.to].label)&&r.push(t)})),r},t.prototype.findBackwardEdge=function(t,e,n,r){if(!this.directed&&e===n)return null;for(var i=t.nodeMap,a=i[n.to].edges,o=a.length,s=0;s<o;s++){var u=a[s];if(!r.hasEdge(u)&&u.to===e.from)if(this.directed){if(i[e.from].label<i[n.to].label||i[e.from].label===i[n.to].label&&e.label<=u.label)return u}else if(e.label<u.label||e.label===u.label&&i[e.to].label<=i[n.to].label)return u}return null},t.prototype.findForwardPureEdges=function(t,e,n,r){for(var i=[],a=e.to,o=t.nodeMap[a].edges,s=o.length,u=0;u<s;u++){var c=o[u],l=t.nodeMap[c.to];n<=l.label&&!r.hasNode(l)&&i.push(c)}return i},t.prototype.findForwardRmpathEdges=function(t,e,n,r){for(var i=[],a=t.nodeMap,o=a[e.to].label,s=a[e.from].edges,u=s.length,c=0;c<u;c++){var l=s[c],h=a[l.to].label;e.to===l.to||n>h||r.hasNode(a[l.to])||(e.label<l.label||e.label===l.label&&o<=h)&&i.push(l)}return i},t.prototype.getSupport=function(t){var e={};return t.forEach((function(t){e[t.graphId]||(e[t.graphId]=!0)})),Object.keys(e).length},t.prototype.findMinLabel=function(t){var e=void 0;return Object.keys(t).forEach((function(n){var r=t[n],i=r.nodeLabel1,a=r.edgeLabel,o=r.nodeLabel2;e?(i<e.nodeLabel1||i===e.nodeLabel1&&a<e.edgeLabel||i===e.nodeLabel1&&a===e.edgeLabel&&o<e.nodeLabel2)&&(e={nodeLabel1:i,edgeLabel:a,nodeLabel2:o}):e={nodeLabel1:i,edgeLabel:a,nodeLabel2:o}})),e},t.prototype.isMin=function(){var t=this,e=this.dfsCode;if(this.verbose&&console.log("isMin checking",e),1===e.dfsEdgeList.length)return!0;var n=this.directed,r=e.toGraph(-1,n),i=r.nodeMap,a=new ph,o={};r.nodes.forEach((function(e){t.findForwardRootEdges(r,e).forEach((function(t){var n=i[t.to],a="".concat(e.label,"-").concat(t.label,"-").concat(n.label);o[a]||(o[a]={projected:[],nodeLabel1:e.label,edgeLabel:t.label,nodeLabel2:n.label});var s={graphId:r.id,edge:t,preNode:null};o[a].projected.push(s)}))}));var s=this.findMinLabel(o);if(s){a.dfsEdgeList.push(new vh(0,1,s.nodeLabel1,s.edgeLabel,s.nodeLabel2));var u="".concat(s.nodeLabel1,"-").concat(s.edgeLabel,"-").concat(s.nodeLabel2);return function o(s){for(var u=a.buildRmpath(),c=a.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,l=a.dfsEdgeList[u[0]].toNode,h={},d=!1,f=0,v=n?-1:0,p=function(e){if(d)return"break";s.forEach((function(n){var i=new gh(n),o=t.findBackwardEdge(r,i.edges[u[e]],i.edges[u[0]],i);o&&(h[o.label]||(h[o.label]={projected:[],edgeLabel:o.label}),h[o.label].projected.push({graphId:r.id,edge:h,preNode:n}),f=a.dfsEdgeList[u[e]].fromNode,d=!0)}))},g=u.length-1;g>v&&"break"!==p(g);g--);if(d){var y=t.findMinLabel(h);a.dfsEdgeList.push(new vh(l,f,lh,y.edgeLabel,lh));var m=a.dfsEdgeList.length-1;return t.dfsCode.dfsEdgeList[m]===a.dfsEdgeList[m]&&o(h[y.edgeLabel].projected)}var b={};d=!1;var x=0;s.forEach((function(e){var n=new gh(e),a=t.findForwardPureEdges(r,n.edges[u[0]],c,n);a.length>0&&(d=!0,x=l,a.forEach((function(t){var n="".concat(t.label,"-").concat(i[t.to].label);b[n]||(b[n]={projected:[],edgeLabel:t.label,nodeLabel2:i[t.to].label}),b[n].projected.push({graphId:r.id,edge:t,preNode:e})})))}));var w=u.length,E=function(e){if(d)return"break";var n=u[e];s.forEach((function(e){var o=new gh(e),s=t.findForwardRmpathEdges(r,o.edges[n],c,o);s.length>0&&(d=!0,x=a.dfsEdgeList[n].fromNode,s.forEach((function(t){var n="".concat(t.label,"-").concat(i[t.to].label);b[n]||(b[n]={projected:[],edgeLabel:t.label,nodeLabel2:i[t.to].label}),b[n].projected.push({graphId:r.id,edge:t,preNode:e})})))}))};for(g=0;g<w&&"break"!==E(g);g++);if(!d)return!0;var k=t.findMinLabel(b);a.dfsEdgeList.push(new vh(x,l+1,lh,k.edgeLabel,k.nodeLabel2));var M=a.dfsEdgeList.length-1;return e.dfsEdgeList[M]===a.dfsEdgeList[M]&&o(b["".concat(k.edgeLabel,"-").concat(k.nodeLabel2)].projected)}(o[u].projected)}},t.prototype.report=function(){if(!(this.dfsCode.getNodeNum()<this.minNodeNum)){this.counter++;var t=this.dfsCode.toGraph(this.counter,this.directed);this.frequentSubgraphs.push(ih(t))}},t.prototype.subGraphMining=function(t){var e=this;if(!(this.getSupport(t)<this.minSupport)&&this.isMin()){this.report();var n=this.dfsCode.getNodeNum(),r=this.dfsCode.buildRmpath(),i=this.dfsCode.dfsEdgeList[r[0]].toNode,a=this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,o={},s={};t.forEach((function(t){for(var u=e.graphs[t.graphId],c=u.nodeMap,l=new gh(t),h=r.length-1;h>=0;h--){var d=e.findBackwardEdge(u,l.edges[r[h]],l.edges[r[0]],l);if(d){var f="".concat(e.dfsCode.dfsEdgeList[r[h]].fromNode,"-").concat(d.label);s[f]||(s[f]={projected:[],toNodeId:e.dfsCode.dfsEdgeList[r[h]].fromNode,edgeLabel:d.label}),s[f].projected.push({graphId:t.graphId,edge:d,preNode:t})}}if(!(n>=e.maxNodeNum)){e.findForwardPureEdges(u,l.edges[r[0]],a,l).forEach((function(e){var n="".concat(i,"-").concat(e.label,"-").concat(c[e.to].label);o[n]||(o[n]={projected:[],fromNodeId:i,edgeLabel:e.label,nodeLabel2:c[e.to].label}),o[n].projected.push({graphId:t.graphId,edge:e,preNode:t})}));var v=function(n){e.findForwardRmpathEdges(u,l.edges[r[n]],a,l).forEach((function(i){var a="".concat(e.dfsCode.dfsEdgeList[r[n]].fromNode,"-").concat(i.label,"-").concat(c[i.to].label);o[a]||(o[a]={projected:[],fromNodeId:e.dfsCode.dfsEdgeList[r[n]].fromNode,edgeLabel:i.label,nodeLabel2:c[i.to].label}),o[a].projected.push({graphId:t.graphId,edge:i,preNode:t})}))};for(h=0;h<r.length;h++)v(h)}})),Object.keys(s).forEach((function(t){var n=s[t],r=n.toNodeId,a=n.edgeLabel;e.dfsCode.dfsEdgeList.push(new vh(i,r,"-1",a,"-1")),e.subGraphMining(s[t].projected),e.dfsCode.dfsEdgeList.pop()})),Object.keys(o).forEach((function(t){var n=o[t],r=n.fromNodeId,a=n.edgeLabel,s=n.nodeLabel2;e.dfsCode.dfsEdgeList.push(new vh(r,i+1,lh,a,s)),e.subGraphMining(o[t].projected),e.dfsCode.dfsEdgeList.pop()}))}},t.prototype.generate1EdgeFrequentSubGraphs=function(){var t=this.graphs,e=this.directed,n=this.minSupport,r=this.frequentSize1Subgraphs,i={},a={},o={},s={};return Object.keys(t).forEach((function(n){var r=t[n],u=r.nodeMap;r.nodes.forEach((function(t,r){var c=t.label,l="".concat(n,"-").concat(c);if(!o[l]){var h=i[c]||0;h++,i[c]=h}o[l]={graphKey:n,label:c},t.edges.forEach((function(t){var r=c,i=u[t.to].label;if(!e&&r>i){var o=i;i=r,r=o}var l=t.label,h="".concat(n,"-").concat(r,"-").concat(l,"-").concat(i),d="".concat(r,"-").concat(l,"-").concat(i);if(!a[d]){var f=a[d]||0;f++,a[d]=f}s[h]={graphId:n,nodeLabel1:r,edgeLabel:l,nodeLabel2:i}}))}))})),Object.keys(i).forEach((function(t){if(!(i[t]<n)){var e={nodes:[],edges:[]};e.nodes.push({id:"0",label:t}),r.push(e)}})),r},t.prototype.run=function(){var t=this;if(this.frequentSize1Subgraphs=this.generate1EdgeFrequentSubGraphs(),!(this.maxNodeNum<2)){var e=this.graphs,n=(this.directed,{});Object.keys(e).forEach((function(r){var i=e[r],a=i.nodeMap;i.nodes.forEach((function(e){t.findForwardRootEdges(i,e).forEach((function(t){var i=a[t.to],o="".concat(e.label,"-").concat(t.label,"-").concat(i.label);n[o]||(n[o]={projected:[],nodeLabel1:e.label,edgeLabel:t.label,nodeLabel2:i.label});var s={graphId:r,edge:t,preNode:null};n[o].projected.push(s)}))}))})),Object.keys(n).forEach((function(e){var r=n[e],i=r.projected,a=r.nodeLabel1,o=r.edgeLabel,s=r.nodeLabel2;t.dfsCode.dfsEdgeList.push(new vh(0,1,a,o,s)),t.subGraphMining(i),t.dfsCode.dfsEdgeList.pop()}))}}}(),function(){function t(t){void 0===t&&(t=10),this.linkedList=new Xl,this.maxStep=t}Object.defineProperty(t.prototype,"length",{get:function(){return this.linkedList.toArray().length},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return!this.linkedList.head},t.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep},t.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value},t.prototype.push=function(t){this.linkedList.prepend(t),this.length>this.maxStep&&this.linkedList.deleteTail()},t.prototype.pop=function(){var t=this.linkedList.deleteHead();return t?t.value:null},t.prototype.toArray=function(){return this.linkedList.toArray().map((function(t){return t.value}))},t.prototype.clear=function(){for(;!this.isEmpty();)this.pop()}}();var xh=function(t,e,n){var r;switch(n.type){case"degree":var i=new Map;return null===(r=t.nodes)||void 0===r||r.forEach((function(t){var r=e(yh(t),n.direction).length;i.set(yh(t),r)})),i;case"betweenness":return Eh(t,n.directed,n.weightPropertyName);case"closeness":return kh(t,n.directed,n.weightPropertyName);case"eigenvector":return Sh(t,n.directed);case"pagerank":return Mh(t,n.epsilon,n.linkProb);default:return wh(t)}},wh=function(t){var e,n=new Map;return null===(e=t.nodes)||void 0===e||e.forEach((function(t){n.set(yh(t),0)})),n},Eh=function(t,e,n){var r=wh(t),i=t.nodes,a=void 0===i?[]:i;return a.forEach((function(i){a.forEach((function(a){if(i!==a){var o=uh(t,yh(i),yh(a),e,n).allPath,s=o.length;o.flat().forEach((function(t){t!==yh(i)&&t!==yh(a)&&r.set(t,r.get(t)+1/s)}))}}))})),r},kh=function(t,e,n){var r=new Map,i=t.nodes,a=void 0===i?[]:i;return a.forEach((function(i){var o=a.reduce((function(r,a){return i!==a&&(r+=uh(t,yh(i),yh(a),e,n).length),r}),0);r.set(yh(i),1/o)})),r},Mh=function(t,e,n){var r,i=new Map,a=function(t,e,n){"number"!=typeof e&&(e=1e-6),"number"!=typeof n&&(n=.85);for(var r,i=1,a=0,o=1e3,s=t.nodes,u=void 0===s?[]:s,c=t.edges,l=void 0===c?[]:c,h=u.length,d={},f={},v=0;v<h;++v)d[g=(w=u[v]).id]=1/h,f[g]=1/h;for(var p=$l(t);o>0&&i>e;){for(a=0,v=0;v<h;++v){var g=(w=u[v]).id;if(r=0,0===p[w.id].inDegree)d[g]=0;else{for(var y=Kl(g,l,"source"),m=0;m<y.length;++m){var b=y[m],x=p[b].outDegree;x>0&&(r+=f[b]/x)}d[g]=n*r,a+=d[g]}}for(a=(1-a)/h,i=0,v=0;v<h;++v){var w;r=d[g=(w=u[v]).id]+a,i+=Math.abs(r-f[g]),f[g]=r}o-=1}return f}(t,e,n);return null===(r=t.nodes)||void 0===r||r.forEach((function(t){i.set(yh(t),a[yh(t)])})),i},Sh=function(t,e){var n=t.nodes,r=void 0===n?[]:n,i=Oh(t,e),a=Nh(i,r.length),o=new Map;return r.forEach((function(t,e){o.set(yh(t),a[e])})),o},Oh=function(t,e){var n=t.nodes,r=void 0===n?[]:n,i=t.edges,a=void 0===i?[]:i,o=Array(r.length).fill(null).map((function(){return Array(r.length).fill(0)}));return a.forEach((function(t){var n=t.source,i=t.target,a=r.findIndex((function(t){return yh(t)===n})),s=r.findIndex((function(t){return yh(t)===i}));e?o[a][s]=1:(o[a][s]=1,o[s][a]=1)})),o},Nh=function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6,i=Array(e).fill(1),a=1/0,o=0;o<n&&a>r;o++){for(var s=Array(e).fill(0),u=0;u<e;u++)for(var c=0;c<e;c++)s[u]+=t[u][c]*i[c];for(var l=Math.sqrt(s.reduce((function(t,e){return t+e*e}),0)),h=0;h<e;h++)s[h]/=l;a=Math.sqrt(s.reduce((function(t,e,n){return t+(e-i[n])*e}),0)),i=s}return i};function Ah(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Vc,i=new Map(t.map((function(t){return[n(t),t]}))),a=new Map(e.map((function(t){return[n(t),t]}))),o=new Set(i.keys()),s=new Set(a.keys()),u=[],c=[],l=[],h=[];return s.forEach((function(t){o.has(t)?r(i.get(t),a.get(t))?h.push(a.get(t)):c.push(a.get(t)):u.push(a.get(t))})),o.forEach((function(t){s.has(t)||l.push(i.get(t))})),{enter:u,exit:l,keep:h,update:c}}function Th(t,e,n){t.forEach((function(t){!function(t){n&&!n(t)||(t.style.visibility=e)}(t)}))}var Ph=function(){return b((function t(e){y(this,t),this.extensions=[],this.extensionMap={},this.context=e}),[{key:"setExtensions",value:function(t){var e=function(t,e,n){var r={},i=function(t){return t in r||(r[t]=0),"".concat(e,"-").concat(t,"-").concat(r[t]++)};return n.map((function(e){return"string"==typeof e?{type:e,key:i(e)}:"function"==typeof e?e.call(t):e.key?e:Object.assign(Object.assign({},e),{key:i(e.type)})}))}(this.context.graph,this.category,t),n=Ah(this.extensions,e,(function(t){return t.key})),r=n.enter,i=n.update,a=n.exit,o=n.keep;this.createExtensions(r),this.updateExtensions([].concat(w(i),w(o))),this.destroyExtensions(a),this.extensions=e}},{key:"createExtension",value:function(t){var e=this.category,n=t.key,r=t.type,i=al(e,r);if(!i)return ll.warn("The extension ".concat(r," of ").concat(e," is not registered."));var a=new i(this.context,t);this.extensionMap[n]=a}},{key:"createExtensions",value:function(t){var e=this;t.forEach((function(t){return e.createExtension(t)}))}},{key:"updateExtension",value:function(t){var e=t.key,n=this.extensionMap[e];n&&n.update(t)}},{key:"updateExtensions",value:function(t){var e=this;t.forEach((function(t){return e.updateExtension(t)}))}},{key:"destroyExtension",value:function(t){var e=this.extensionMap[t];e&&(e.destroy(),delete this.extensionMap[t])}},{key:"destroyExtensions",value:function(t){var e=this;t.forEach((function(t){var n=t.key;return e.destroyExtension(n)}))}},{key:"destroy",value:function(){Object.values(this.extensionMap).forEach((function(t){return t.destroy()})),this.context={},this.extensions=[],this.extensionMap={}}}])}(),Ch=function(){return b((function t(e,n){y(this,t),this.events=[],this.destroyed=!1,this.context=e,this.options=n}),[{key:"update",value:function(t){this.options=Object.assign(this.options,t)}},{key:"destroy",value:function(){this.context={},this.options={},this.destroyed=!0}}])}(),Rh=function(t){function e(){return y(this,e),S(this,e,arguments)}return N(e,t),b(e)}(Ch),Lh=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).isOverlapping=function(t,e){return e.some((function(e){return t.intersects(e)}))},r.occupiedBounds=[],r.detectLabelCollision=function(t){var e=r.context.viewport,n={show:[],hide:[]};return r.occupiedBounds=[],t.forEach((function(t){var i=t.getShape("label").getRenderBounds();e.isInViewport(i,!0)&&!r.isOverlapping(i,r.occupiedBounds)?(n.show.push(t),r.occupiedBounds.push(Fl(i,r.options.padding))):n.hide.push(t)})),n},r.hideLabelIfExceedViewport=function(t,e){var n=Ah(t,e,(function(t){return t.id})).exit;null==n||n.forEach(r.hideLabel)},r.nodeCentralities=new Map,r.sortNodesByCentrality=function(t,e){var n=r.context.model,i=n.getData(),a=n.getRelatedEdgesData.bind(n),o=t.map((function(t){return r.nodeCentralities.has(t.id)||(r.nodeCentralities=xh(i,a,e)),{node:t,centrality:r.nodeCentralities.get(t.id)}}));return o.sort((function(t,e){return e.centrality-t.centrality})).map((function(t){return t.node}))},r.sortLabelElementsInView=function(t){var e=r.options,n=e.sort,i=e.sortNode,a=e.sortCombo,o=e.sortEdge,s=r.context.model;if(cn(n))return t.sort((function(t,e){return n(s.getElementDataById(t.id),s.getElementDataById(e.id))}));var u=Sl(t,(function(t){return t.type})),c=u.node,l=void 0===c?[]:c,h=u.edge,d=void 0===h?[]:h,f=u.combo,v=void 0===f?[]:f,p=cn(a)?v.sort((function(t,e){return a.apply(void 0,w(s.getComboData([t.id,e.id])))})):v,g=cn(i)?l.sort((function(t,e){return i.apply(void 0,w(s.getNodeData([t.id,e.id])))})):r.sortNodesByCentrality(l,i),y=cn(o)?d.sort((function(t,e){return o.apply(void 0,w(s.getEdgeData([t.id,e.id])))})):d;return[].concat(w(p),w(g),w(y))},r.labelElementsInView=[],r.isFirstRender=!0,r.onToggleVisibility=function(t){var e;if("zIndex"!==(null===(e=t.data)||void 0===e?void 0:e.stage))if(r.validate(t)){var n=r.isFirstRender?r.getLabelElements():r.getLabelElementsInView();r.hideLabelIfExceedViewport(r.labelElementsInView,n),r.labelElementsInView=n;for(var i=r.sortLabelElementsInView(r.labelElementsInView),a=r.detectLabelCollision(i),o=a.show,s=a.hide,u=o.length-1;u>=0;u--)r.showLabel(o[u]);s.forEach(r.hideLabel)}else r.hiddenElements.size>0&&(r.hiddenElements.forEach(r.showLabel),r.hiddenElements.clear())},r.hiddenElements=new Map,r.hideLabel=function(t){var e=t.getShape("label");e&&Th(e,"hidden"),r.hiddenElements.set(t.id,t)},r.showLabel=function(t){var e=t.getShape("label");e&&Th(e,"visible"),t.toFront(),r.hiddenElements.delete(t.id)},r.onTransform=Ol(r.onToggleVisibility,r.options.throttle,{leading:!0}),r.enableToggle=!0,r.toggle=function(t){r.enableToggle&&r.onToggleVisibility(t)},r.onBeforeRender=function(){r.enableToggle=!1},r.onAfterRender=function(t){r.onToggleVisibility(t),r.enableToggle=!0},r.bindEvents(),r}return N(e,t),b(e,[{key:"update",value:function(t){this.unbindEvents(),dn(e,"update",this,3)([t]),this.bindEvents(),this.onToggleVisibility({})}},{key:"getLabelElements",value:function(){var t=this.context.element.elementMap,e=[];for(var n in t){var r=t[n];r.isVisible()&&r.getShape("label")&&e.push(r)}return e}},{key:"getLabelElementsInView",value:function(){var t=this.context.viewport;return this.getLabelElements().filter((function(e){return t.isInViewport(e.getShape("key").getRenderBounds())}))}},{key:"bindEvents",value:function(){var t=this.context.graph;t.on($c.BEFORE_RENDER,this.onBeforeRender),t.on($c.AFTER_RENDER,this.onAfterRender),t.on($c.AFTER_DRAW,this.toggle),t.on($c.AFTER_LAYOUT,this.toggle),t.on($c.AFTER_TRANSFORM,this.onTransform)}},{key:"unbindEvents",value:function(){var t=this.context.graph;t.off($c.BEFORE_RENDER,this.onBeforeRender),t.off($c.AFTER_RENDER,this.onAfterRender),t.off($c.AFTER_DRAW,this.toggle),t.off($c.AFTER_LAYOUT,this.toggle),t.off($c.AFTER_TRANSFORM,this.onTransform)}},{key:"validate",value:function(t){if(this.destroyed)return!1;var e=this.options.enable;return cn(e)?e(t):!!e}},{key:"destroy",value:function(){this.unbindEvents(),dn(e,"destroy",this,3)([])}}])}(Rh);Lh.defaultOptions={enable:!0,throttle:100,padding:0,sortNode:{type:"degree"}};const Dh=function(t){if(!Bc(t)||!sn(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e};function _h(t,e){if(Object.hasOwn)return Object.hasOwn(t,e);if(null==t)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(t),e)}function Ih(t,e,n,r){for(var i in n=n||0,r=r||5,e)if(_h(e,i)){var a=e[i];null!==a&&Dh(a)?(Dh(t[i])||(t[i]={}),n<r?Ih(t[i],a,n+1,r):t[i]=e[i]):He(a)?(t[i]=[],t[i]=t[i].concat(a)):void 0!==a&&(t[i]=a)}}const jh=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r+=1)Ih(t,e[r]);return t};var Fh=[0,0,0];function Bh(t,e){return t.map((function(t,n){return t+e[n]}))}function zh(t,e){return t.map((function(t,n){return t-e[n]}))}function Gh(t,e){return"number"==typeof e?t.map((function(t){return t*e})):t.map((function(t,n){return t*e[n]}))}function Vh(t,e){return"number"==typeof e?t.map((function(t){return t/e})):t.map((function(t,n){return t/e[n]}))}function Wh(t,e){return t.map((function(t){return t*e}))}function Hh(t,e){return Math.sqrt(t.reduce((function(t,n,r){return t+Math.pow(n-e[r]||0,2)}),0))}function Yh(t,e){return t.reduce((function(t,n,r){return t+Math.abs(n-e[r])}),0)}function Uh(t){var e=t.reduce((function(t,e){return t+Math.pow(e,2)}),0);return t.map((function(t){return t/Math.sqrt(e)}))}function qh(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t[0]*e[1]-t[1]*e[0],i=Math.acos(Gh(t,e).reduce((function(t,e){return t+e}),0)/(Hh(t,Fh)*Hh(e,Fh)));return n&&r<0&&(i=2*Math.PI-i),i}function Xh(t){return arguments.length>1&&void 0!==arguments[1]&&!arguments[1]?[t[1],-t[0]]:[-t[1],t[0]]}function Kh(t){return[t[0],t[1]]}function $h(t){return 2===t.length?[t[0],t[1],0]:t}function Zh(t){var e=h(t,2),n=e[0],r=e[1];return n||r?Math.atan2(r,n):0}function Qh(t,e){var n,r,i,a,o=h(t,2),s=o[0],u=o[1],c=h(e,2),l=c[0],d=c[1];return(n=zh(s,u),r=zh(l,d),i=$h(n),a=$h(r),[i[1]*a[2]-i[2]*a[1],i[2]*a[0]-i[0]*a[2],i[0]*a[1]-i[1]*a[0]]).every((function(t){return 0===t}))}function Jh(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!Qh(t,e)){var r=h(t,2),i=r[0],a=r[1],o=h(e,2),s=o[0],u=o[1],c=((i[0]-s[0])*(s[1]-u[1])-(i[1]-s[1])*(s[0]-u[0]))/((i[0]-a[0])*(s[1]-u[1])-(i[1]-a[1])*(s[0]-u[0])),l=u[0]-s[0]?(i[0]-s[0]+c*(a[0]-i[0]))/(u[0]-s[0]):(i[1]-s[1]+c*(a[1]-i[1]))/(u[1]-s[1]);if(n||Pl(c,0,1)&&Pl(l,0,1))return[i[0]+c*(a[0]-i[0]),i[1]+c*(a[1]-i[1])]}}function td(t){if(Array.isArray(t))return Pl(t[0],0,1)&&Pl(t[1],0,1)?t:[.5,.5];var e=t.split("-");return[e.includes("left")?0:e.includes("right")?1:.5,e.includes("top")?0:e.includes("bottom")?1:.5]}function ed(t){var e=t.style||{},n=e.x,r=void 0===n?0:n,i=e.y,a=void 0===i?0:i,o=e.z;return[+r,+a,+(void 0===o?0:o)]}function nd(t){var e=t.style||{},n=e.x,r=e.y,i=e.z;return void 0!==n||void 0!==r||void 0!==i}function rd(t){return function(t,e){var n=h(e,2),r=n[0],i=n[1],a=t.min,o=t.max;return[a[0]+r*(o[0]-a[0]),a[1]+i*(o[1]-a[1])]}(t,td(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"center"))}function id(t){var e;return[t.x,t.y,null!==(e=t.z)&&void 0!==e?e:0]}function ad(t){var e;return{x:t[0],y:t[1],z:null!==(e=t[2])&&void 0!==e?e:0}}function od(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.map((function(t){return parseFloat(t.toFixed(e))}))}function sd(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Vc(t,e))return t;var i=Uh(r?zh(t,e):zh(e,t)),a=[i[0]*n,i[1]*n];return Bh(Kh(t),a)}function ud(t,e){return t[1]===e[1]}function cd(t,e,n){return Qh([t,e],[e,n])}function ld(t,e){return[2*e[0]-t[0],2*e[1]-t[1]]}function hd(t,e,n){for(var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=0;a<n.length;a++){var o=n[a],s=n[(a+1)%n.length];r&&(o=Bh(e,o),s=Bh(e,s));var u=Jh([e,i?ld(t,e):t],[o,s]);if(u)return{point:u,line:[o,s]}}return{point:e,line:void 0}}function dd(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.center,i=zh(n?ld(t,r):t,e.center),a=Math.atan2(i[1],i[0]);if(isNaN(a))return r;var o=Ll(e)/2,s=Dl(e)/2;return[r[0]+o*Math.cos(a),r[1]+s*Math.sin(a)]}function fd(t,e){var n=h(e[0],2),r=n[0],i=n[1],a=h(e[1],2),o=a[0],s=a[1],u=h(t,2),c=u[0],l=u[1],d=o-r,f=s-i;if(0===d&&0===f)return[r,i];var v=((c-r)*d+(l-i)*f)/(d*d+f*f);return v>1?v=1:v<0&&(v=0),[r+v*d,i+v*f]}function vd(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=function(t){return Vh(t.reduce((function(t,e){return Bh(t,e)}),[0,0]),t.length)}(t);return t.sort((function(t,r){var i=h(t,2),a=i[0],o=i[1],s=h(r,2),u=s[0],c=s[1],l=Math.atan2(o-n[1],a-n[0]),d=Math.atan2(c-n[1],u-n[0]);return e?d-l:l-d}))}function pd(t,e){return[t,[t[0],e[1]],e,[e[0],t[1]]]}var gd=function(){function t(e,n,r){if(y(this,t),this.phase=n,this.pointerByTouch=[],this.initialDistance=null,this.emitter=e,t.instance)return t.callbacks[this.phase].push(r),t.instance;this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.bindEvents(),t.instance=this,t.callbacks[this.phase].push(r)}return b(t,[{key:"bindEvents",value:function(){var t=this.emitter;t.on(qc.POINTER_DOWN,this.onPointerDown),t.on(qc.POINTER_MOVE,this.onPointerMove),t.on(qc.POINTER_UP,this.onPointerUp)}},{key:"updatePointerPosition",value:function(t,e,n){var r=this.pointerByTouch.findIndex((function(e){return e.pointerId===t}));r>=0&&(this.pointerByTouch[r]={x:e,y:n,pointerId:t})}},{key:"onPointerDown",value:function(e){var n=e.client||{},r=n.x,i=n.y;if(void 0!==r&&void 0!==i&&(this.pointerByTouch.push({x:r,y:i,pointerId:e.pointerId}),"touch"===e.pointerType&&2===this.pointerByTouch.length)){t.isPinching=!0;var a=this.pointerByTouch[0].x-this.pointerByTouch[1].x,o=this.pointerByTouch[0].y-this.pointerByTouch[1].y;this.initialDistance=Math.sqrt(a*a+o*o),t.callbacks.pinchstart.forEach((function(t){return t(e,{scale:0})}))}}},{key:"onPointerMove",value:function(e){if(2===this.pointerByTouch.length&&null!==this.initialDistance){var n=e.client||{},r=n.x,i=n.y;if(void 0!==r&&void 0!==i){this.updatePointerPosition(e.pointerId,r,i);var a=this.pointerByTouch[0].x-this.pointerByTouch[1].x,o=this.pointerByTouch[0].y-this.pointerByTouch[1].y,s=Math.sqrt(a*a+o*o)/this.initialDistance;t.callbacks.pinchmove.forEach((function(t){return t(e,{scale:5*(s-1)})}))}}}},{key:"onPointerUp",value:function(e){var n;t.callbacks.pinchend.forEach((function(t){return t(e,{scale:0})})),t.isPinching=!1,this.initialDistance=null,this.pointerByTouch=[],null===(n=t.instance)||void 0===n||n.tryDestroy()}},{key:"destroy",value:function(){this.emitter.off(qc.POINTER_DOWN,this.onPointerDown),this.emitter.off(qc.POINTER_MOVE,this.onPointerMove),this.emitter.off(qc.POINTER_UP,this.onPointerUp),t.instance=null}},{key:"off",value:function(e,n){var r=t.callbacks[e].indexOf(n);r>-1&&t.callbacks[e].splice(r,1),this.tryDestroy()}},{key:"tryDestroy",value:function(){Object.values(t.callbacks).every((function(t){return 0===t.length}))&&this.destroy()}}])}();gd.isPinching=!1,gd.instance=null,gd.callbacks={pinchstart:[],pinchmove:[],pinchend:[]};var yd=function(t){return t.map((function(t){return ce(t)?t.toLocaleLowerCase():t}))},md=function(){return b((function t(e){var n=this;y(this,t),this.map=new Map,this.boundHandlePinch=function(){},this.recordKey=new Set,this.onKeyDown=function(t){(null==t?void 0:t.key)&&(n.recordKey.add(t.key),n.trigger(t))},this.onKeyUp=function(t){(null==t?void 0:t.key)&&n.recordKey.delete(t.key)},this.onWheel=function(t){n.triggerExtendKey(qc.WHEEL,t)},this.onDrag=function(t){n.triggerExtendKey(qc.DRAG,t)},this.handlePinch=function(t,e){n.triggerExtendKey(qc.PINCH,Object.assign(Object.assign({},t),e))},this.onFocus=function(){n.recordKey.clear()},this.emitter=e,this.bindEvents()}),[{key:"bind",value:function(t,e){0!==t.length&&(t.includes(qc.PINCH)&&!this.pinchHandler&&(this.boundHandlePinch=this.handlePinch.bind(this),this.pinchHandler=new gd(this.emitter,"pinchmove",this.boundHandlePinch)),this.map.set(t,e))}},{key:"unbind",value:function(t,e){var n=this;this.map.forEach((function(r,i){Vc(i,t)&&(e&&e!==r||n.map.delete(i))}))}},{key:"unbindAll",value:function(){this.map.clear()}},{key:"match",value:function(t){var e=yd(Array.from(this.recordKey)).sort(),n=yd(t).sort();return Vc(e,n)}},{key:"bindEvents",value:function(){var t,e=this.emitter;e.on(qc.KEY_DOWN,this.onKeyDown),e.on(qc.KEY_UP,this.onKeyUp),e.on(qc.WHEEL,this.onWheel),e.on(qc.DRAG,this.onDrag),null===(t=globalThis.addEventListener)||void 0===t||t.call(globalThis,"focus",this.onFocus)}},{key:"trigger",value:function(t){var e=this;this.map.forEach((function(n,r){e.match(r)&&n(t)}))}},{key:"triggerExtendKey",value:function(t,e){var n=this;this.map.forEach((function(r,i){i.includes(t)&&Vc(Array.from(n.recordKey),i.filter((function(e){return e!==t})))&&r(e)}))}},{key:"destroy",value:function(){var t,e;this.unbindAll(),this.emitter.off(qc.KEY_DOWN,this.onKeyDown),this.emitter.off(qc.KEY_UP,this.onKeyUp),this.emitter.off(qc.WHEEL,this.onWheel),this.emitter.off(qc.DRAG,this.onDrag),null===(t=this.pinchHandler)||void 0===t||t.off("pinchmove",this.boundHandlePinch),null===(e=globalThis.removeEventListener)||void 0===e||e.call(globalThis,"blur",this.onFocus)}}])}(),bd=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,jh({},e.defaultOptions,n)])).shortcut=new md(t.graph),r.onPointerDown=r.onPointerDown.bind(r),r.onPointerMove=r.onPointerMove.bind(r),r.onPointerUp=r.onPointerUp.bind(r),r.clearStates=r.clearStates.bind(r),r.bindEvents(),r}return N(e,t),b(e,[{key:"onPointerDown",value:function(t){if(this.validate(t)&&this.isKeydown()&&!this.startPoint){var e=this.context,n=e.canvas,r=e.graph,i=Object.assign({},this.options.style);this.options.style.lineWidth&&(i.lineWidth=+this.options.style.lineWidth/r.getZoom()),this.rectShape=new Ou({id:"g6-brush-select",style:i}),n.appendChild(this.rectShape),this.startPoint=[t.canvas.x,t.canvas.y]}}},{key:"onPointerMove",value:function(t){var e;if(this.startPoint){var n=this.options,r=n.immediately,i=n.mode;this.endPoint=xd(t),null===(e=this.rectShape)||void 0===e||e.attr({x:Math.min(this.endPoint[0],this.startPoint[0]),y:Math.min(this.endPoint[1],this.startPoint[1]),width:Math.abs(this.endPoint[0]-this.startPoint[0]),height:Math.abs(this.endPoint[1]-this.startPoint[1])}),r&&"default"===i&&this.updateElementsStates(pd(this.startPoint,this.endPoint))}}},{key:"onPointerUp",value:function(t){this.startPoint&&(this.endPoint?(this.endPoint=xd(t),this.updateElementsStates(pd(this.startPoint,this.endPoint)),this.clearBrush()):this.clearBrush())}},{key:"clearStates",value:function(){this.endPoint||this.clearElementsStates()}},{key:"clearElementsStates",value:function(){var t=this.context.graph,e=Object.values(t.getData()).reduce((function(t,e){return Object.assign({},t,e.reduce((function(t,e){return t[yh(e)]=[],t}),{}))}),{});t.setElementState(e,this.options.animation)}},{key:"updateElementsStates",value:function(t){var e=this.context.graph,n=this.options,r=n.enableElements,i=n.state,a=n.mode,o=n.onSelect,s=this.selector(e,t,r),u={};switch(a){case"union":s.forEach((function(t){u[t]=[].concat(w(e.getElementState(t)),[i])}));break;case"diff":s.forEach((function(t){var n=e.getElementState(t);u[t]=n.includes(i)?n.filter((function(t){return t!==i})):[].concat(w(n),[i])}));break;case"intersect":s.forEach((function(t){var n=e.getElementState(t);u[t]=n.includes(i)?[i]:[]}));break;default:s.forEach((function(t){u[t]=[i]}))}cn(o)&&(u=o(u)),e.setElementState(u,this.options.animation)}},{key:"selector",value:function(t,e,n){if(!n||0===n.length)return[];var r=[],i=t.getData();if(n.forEach((function(n){i["".concat(n,"s")].forEach((function(n){var i=yh(n);"hidden"!==t.getElementVisibility(i)&&function(t,e,n,r){var i=t[0],a=t[1],o=!1;void 0===n&&(n=0),void 0===r&&(r=e.length);for(var s=r-n,u=0,c=s-1;u<s;c=u++){var l=e[u+n][0],h=e[u+n][1],d=e[c+n][0],f=e[c+n][1];h>a!=f>a&&i<(d-l)*(a-h)/(f-h)+l&&(o=!o)}return o}(t.getElementPosition(i),e)&&r.push(i)}))})),n.includes("edge")){var a=i.edges;null==a||a.forEach((function(t){var e=t.source,n=t.target;r.includes(e)&&r.includes(n)&&r.push(yh(t))}))}return r}},{key:"clearBrush",value:function(){var t;null===(t=this.rectShape)||void 0===t||t.remove(),this.rectShape=void 0,this.startPoint=void 0,this.endPoint=void 0}},{key:"isKeydown",value:function(){var t=this.options.trigger,e=Array.isArray(t)?t:[t];return this.shortcut.match(e.filter((function(t){return"drag"!==t})))}},{key:"validate",value:function(t){if(this.destroyed)return!1;var e=this.options.enable;return cn(e)?e(t):!!e}},{key:"bindEvents",value:function(){var t=this.context.graph;t.on(qc.POINTER_DOWN,this.onPointerDown),t.on(qc.POINTER_MOVE,this.onPointerMove),t.on(qc.POINTER_UP,this.onPointerUp),t.on(Yc.CLICK,this.clearStates)}},{key:"unbindEvents",value:function(){var t=this.context.graph;t.off(qc.POINTER_DOWN,this.onPointerDown),t.off(qc.POINTER_MOVE,this.onPointerMove),t.off(qc.POINTER_UP,this.onPointerUp),t.off(Yc.CLICK,this.clearStates)}},{key:"update",value:function(t){this.unbindEvents(),this.options=jh(this.options,t),this.bindEvents()}},{key:"destroy",value:function(){this.unbindEvents(),dn(e,"destroy",this,3)([])}}])}(Rh);bd.defaultOptions={animation:!1,enable:!0,enableElements:["node","combo","edge"],immediately:!1,mode:"default",state:"selected",trigger:["shift"],style:{width:0,height:0,lineWidth:1,fill:"#1677FF",stroke:"#1677FF",fillOpacity:.1,zIndex:2,pointerEvents:"none"}};var xd=function(t){return[t.canvas.x,t.canvas.y]},wd=.8,Ed=["node","edge","combo"];function kd(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;"TB"===r&&e(t,i);var a=n(t);if(a){var o,s=Rn(a);try{for(s.s();!(o=s.n()).done;)kd(o.value,e,n,r,i+1)}catch(t){s.e(t)}finally{s.f()}}"BT"===r&&e(t,i)}function Md(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"both";if("combo"===e||"node"===e)return Sd(t,n,r,i);var a=t.getEdgeData(n);if(!a)return[];var o=Sd(t,a.source,r-1,i),s=Sd(t,a.target,r-1,i);return Array.from(new Set([].concat(w(o),w(s),[n])))}function Sd(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"both",i=new Set,a=new Set,o=new Set;return function(t,e,n){for(var r=[[t,0]];r.length;){var i=h(r.shift(),2),a=i[0],o=i[1];e(a,o);var s=n(a);if(s){var u,c=Rn(s);try{for(c.s();!(u=c.n()).done;){var l=u.value;r.push([l,o+1])}}catch(t){c.e(t)}finally{c.f()}}}}(e,(function(e,i){i>n||(o.add(e),t.getRelatedEdgesData(e,r).forEach((function(t){var e=yh(t);!a.has(e)&&i<n&&(o.add(e),a.add(e))})))}),(function(e){return t.getRelatedEdgesData(e,r).map((function(t){return t.source===e?t.target:t.source})).filter((function(t){return!i.has(t)&&(i.add(t),!0)}))})),Array.from(o)}function Od(t){return t.states||[]}var Nd=function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},Ad=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).onClickSelect=function(t){return Nd(r,void 0,void 0,Tn().mark((function e(){var n,r;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.validate(t)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.updateState(t);case 4:null===(r=(n=this.options).onClick)||void 0===r||r.call(n,t);case 5:case"end":return e.stop()}}),e,this)})))},r.onClickCanvas=function(t){return Nd(r,void 0,void 0,Tn().mark((function e(){var n,r;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.validate(t)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.clearState();case 4:null===(r=(n=this.options).onClick)||void 0===r||r.call(n,t);case 5:case"end":return e.stop()}}),e,this)})))},r.shortcut=new md(t.graph),r.bindEvents(),r}return N(e,t),b(e,[{key:"bindEvents",value:function(){var t=this,e=this.context.graph;this.unbindEvents(),Ed.forEach((function(n){e.on("".concat(n,":").concat(qc.CLICK),t.onClickSelect)})),e.on(Yc.CLICK,this.onClickCanvas)}},{key:"isMultipleSelect",get:function(){var t=this.options,e=t.multiple,n=t.trigger;return e&&this.shortcut.match(n)}},{key:"getNeighborIds",value:function(t){var e=t.target,n=t.targetType,r=this.context.graph,i=this.options.degree;return Md(r,n,e.id,"function"==typeof i?i(t):i).filter((function(t){return t!==e.id}))}},{key:"updateState",value:function(t){return Nd(this,void 0,void 0,Tn().mark((function e(){var n,r,i,a,o,s,u,c,l,h,d,f,v,p,g,y;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.options,r=n.state,i=n.unselectedState,a=n.neighborState,o=n.animation,r||a||i){e.next=3;break}return e.abrupt("return");case 3:return s=t.target,u=this.context.graph,c=u.getElementData(s.id),l=Od(c).includes(r)?"unselect":"select",h={},d=this.isMultipleSelect,f=[s.id],v=this.getNeighborIds(t),d?(Object.assign(h,this.getDataStates()),"select"===l?(g=function(t,e){t.forEach((function(t){var n=new Set(u.getElementState(t));n.add(e),n.delete(i),h[t]=Array.from(n)}))},g(f,r),g(v,a),i&&Object.keys(h).forEach((function(t){var e=h[t];e.includes(r)||e.includes(a)||e.includes(i)||h[t].push(i)}))):(y=h[s.id],h[s.id]=y.filter((function(t){return t!==r&&t!==a})),y.includes(i)||h[s.id].push(i),v.forEach((function(t){h[t]=h[t].filter((function(t){return t!==a})),h[t].includes(r)||h[t].push(i)})))):"select"===l?(Object.assign(h,this.getClearStates(!!i)),p=function(t,e){t.forEach((function(t){h[t]||(h[t]=u.getElementState(t)),h[t].push(e)}))},p(f,r),p(v,a),i&&Object.keys(h).forEach((function(t){f.includes(t)||v.includes(t)||h[t].push(i)}))):Object.assign(h,this.getClearStates()),e.next=14,u.setElementState(h,o);case 14:case"end":return e.stop()}}),e,this)})))}},{key:"getDataStates",value:function(){var t=this.context.graph.getData(),e=t.nodes,n=t.edges,r=t.combos,i={};return[].concat(w(e),w(n),w(r)).forEach((function(t){i[yh(t)]=Od(t)})),i}},{key:"getClearStates",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.context.graph,n=this.options,r=n.state,i=n.unselectedState,a=n.neighborState,o=new Set([r,i,a]),s=e.getData(),u=s.nodes,c=s.edges,l=s.combos,h={};return[].concat(w(u),w(c),w(l)).forEach((function(e){var n=Od(e),r=n.filter((function(t){return!o.has(t)}));(t||r.length!==n.length)&&(h[yh(e)]=r)})),h}},{key:"clearState",value:function(){return Nd(this,void 0,void 0,Tn().mark((function t(){var e;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.context.graph,t.next=3,e.setElementState(this.getClearStates(),this.options.animation);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"validate",value:function(t){if(this.destroyed)return!1;var e=this.options.enable;return cn(e)?e(t):!!e}},{key:"unbindEvents",value:function(){var t=this,e=this.context.graph;Ed.forEach((function(n){e.off("".concat(n,":").concat(qc.CLICK),t.onClickSelect)})),e.off(Yc.CLICK,this.onClickCanvas)}},{key:"destroy",value:function(){this.unbindEvents(),dn(e,"destroy",this,3)([])}}])}(Rh);function Td(t){var e;return!!(null===(e=t.style)||void 0===e?void 0:e.collapsed)}Ad.defaultOptions={animation:!0,enable:!0,multiple:!1,trigger:["shift"],state:"selected",neighborState:"selected",unselectedState:void 0,degree:0};const Pd=function(t,e,n){for(var r=0,i=ce(e)?e.split("."):e;t&&r<i.length;)t=t[i[r++]];return void 0===t||r<i.length?n:t},Cd=function(t,e,n){var r=t,i=ce(e)?e.split("."):e;return i.forEach((function(t,e){e<i.length-1?(ln(r[t])||(r[t]=oe(i[e+1])?[]:{}),r=r[t]):r[t]=n})),t},Rd=function(t){var e=jc(t);return e.charAt(0).toLowerCase()+e.substring(1)};function Ld(t,e){if(!t.startsWith(e))return!1;var n=t[e.length];return n>="A"&&n<="Z"}function Dd(t,e){var n=Object.entries(t).reduce((function(t,n){var r=h(n,2),i=r[0],a=r[1];return"className"===i||"class"===i||Ld(i,e)&&Object.assign(t,v({},function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e)return t;if(!Ld(t,e))return t;var r=t.slice(e.length);return n?Rd(r):r}(i,e),a)),t}),{});if("opacity"in t){var r=function(t,e){return"".concat(e).concat(Fc(t))}("opacity",e),i=t.opacity;if(r in t){var a=t[r];Object.assign(n,{opacity:i*a})}else Object.assign(n,{opacity:i})}return n}function _d(t,e){var n=e.length;return Object.keys(t).reduce((function(r,i){return i.startsWith(e)&&(r[i.slice(n)]=t[i]),r}),{})}function Id(t,e){var n="string"==typeof e?[e]:e,r={};return Object.keys(t).forEach((function(e){n.find((function(t){return e.startsWith(t)}))||(r[e]=t[e])})),r}function jd(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if("number"==typeof t)return[t,t,t];var e=h(t,3),n=e[0],r=e[1],i=void 0===r?n:r,a=e[2];return[n,i,void 0===a?n:a]}function Fd(t,e){var n=e.datum,r=e.graph;return"function"==typeof t?t.call(r,n):Object.fromEntries(Object.entries(t).map((function(t){var e=h(t,2),i=e[0],a=e[1];return"function"==typeof a?[i,a.call(r,n)]:[i,a]})))}function Bd(t,e){var n=(null==t?void 0:t.style)||{},r=(null==e?void 0:e.style)||{};for(var i in n)i in r||(r[i]=n[i]);return Object.assign({},t,e,{style:r})}function zd(t){if(t)return"string"==typeof t||"function"==typeof t||Array.isArray(t)?{type:"group",field:function(t){return t.id},color:t,invert:!1}:t}function Gd(t){var e="string"==typeof t?al("palette",t):t;if("function"!=typeof e)return e}function Vd(t,e){var n=2*t;return"string"==typeof e?n=t*Number(e.replace("%",""))/100:"number"==typeof e&&(n=e),isNaN(n)&&(n=2*t),n}function Wd(t,e){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3]&&arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Vd((t.max[0]-t.min[0])*n,e)}var Hd={}.toString;var Yd=Object.prototype;var Ud=Object.prototype.hasOwnProperty;const qd=function(t){if(ue(t))return!0;if(zc(t))return!t.length;var e=function(t){return Hd.call(t).replace(/^\[object /,"").replace(/]$/,"")}(t);if("Map"===e||"Set"===e)return!t.size;if(function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Yd)}(t))return!Object.keys(t).length;for(var n in t)if(Ud.call(t,n))return!1;return!0};var Xd=function(t){function e(t){var n;return y(this,e),$d(t.style),(n=S(this,e,[t])).shapeMap={},n.animateMap={},n.render(n.attributes,n),n.setVisibility(),n.bindEvents(),n}return N(e,t),b(e,[{key:"parsedAttributes",get:function(){return this.attributes}},{key:"upsert",value:function(t,e,n,r,i){var a,o,s,u,c,l,h,d,f=this.shapeMap[t];if(!1!==n){var v="string"==typeof e?al(el.SHAPE,e):e;if(!v)throw new Error(cl("Shape ".concat(e," not found")));if(!f||f.destroyed||!(f instanceof v)){f&&(null===(s=null==i?void 0:i.beforeDestroy)||void 0===s||s.call(i,f),null==f||f.destroy(),null===(u=null==i?void 0:i.afterDestroy)||void 0===u||u.call(i,f)),null===(c=null==i?void 0:i.beforeCreate)||void 0===c||c.call(i);var p=new v({className:t,style:n});return r.appendChild(p),this.shapeMap[t]=p,null===(l=null==i?void 0:i.afterCreate)||void 0===l||l.call(i,p),p}return null===(h=null==i?void 0:i.beforeUpdate)||void 0===h||h.call(i,f),mg(f,n),null===(d=null==i?void 0:i.afterUpdate)||void 0===d||d.call(i,f),f}f&&(null===(a=null==i?void 0:i.beforeDestroy)||void 0===a||a.call(i,f),r.removeChild(f),delete this.shapeMap[t],null===(o=null==i?void 0:i.afterDestroy)||void 0===o||o.call(i,f))}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign({},this.attributes,t);$d(e),function(t,e){var n=e.zIndex,r=e.transform,i=e.transformOrigin,a=e.visibility,o=e.cursor,s=e.clipPath,u=e.component,c=ig(e,["zIndex","transform","transformOrigin","visibility","cursor","clipPath","component"]);Object.assign(t.attributes,c),r&&t.setAttribute("transform",r),oe(n)&&t.setAttribute("zIndex",n),i&&t.setAttribute("transformOrigin",i),a&&t.setAttribute("visibility",a),o&&t.setAttribute("cursor",o),s&&t.setAttribute("clipPath",s),u&&t.setAttribute("component",u)}(this,e),this.render(e,this),this.setVisibility()}},{key:"bindEvents",value:function(){}},{key:"getGraphicStyle",value:function(t){return function(t){return t.x,t.y,t.z,t.class,t.className,t.transform,t.transformOrigin,t.zIndex,t.visibility,function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(t,["x","y","z","class","className","transform","transformOrigin","zIndex","visibility"])}(t)}},{key:"compositeShapes",get:function(){return[["badges","badge-"],["ports","port-"]]}},{key:"animate",value:function(t,n){var r=this;if(0===t.length)return null;var i=[];if(void 0!==t[0].x||void 0!==t[0].y||void 0!==t[0].z){var a=this.attributes,o=a.x,s=void 0===o?0:o,u=a.y,c=void 0===u?0:u,l=a.z,d=void 0===l?0:l;t.forEach((function(t){var e=t.x,n=void 0===e?s:e,r=t.y,i=void 0===r?c:r,a=t.z,o=void 0===a?d:a;Object.assign(t,{transform:o?[["translate3d",n,i,o]]:[["translate",n,i]]})}))}var f=dn(e,"animate",this,3)([t,n]);if(f&&(Kd(this,f),i.push(f)),Array.isArray(t)&&t.length>0){var v=["transform","transformOrigin","x","y","z","zIndex"];Object.keys(t[0]).some((function(t){return!v.includes(t)}))&&(Object.entries(this.shapeMap).forEach((function(e){var a=h(e,2),o=a[0],s=a[1],u="get".concat(Fc(o),"Style"),c=r[u];if(cn(c)){var l=t.map((function(t){return c.call(r,Object.assign(Object.assign({},r.attributes),t))})),d=s.animate(fl(l),n);d&&(Kd(s,d),i.push(d))}})),this.compositeShapes.forEach((function(e){var a=h(e,2),o=a[0],s=a[1];!function(e,a){if(!qd(e)){var o="get".concat(Fc(a),"Style"),s=r[o];if(cn(s)){var u=t.map((function(t){return s.call(r,Object.assign(Object.assign({},r.attributes),t))}));Object.entries(u[0]).map((function(t){var r=h(t,1)[0],a=u.map((function(t){return t[r]})),o=e[r];if(o){var s=o.animate(fl(a),n);s&&(Kd(o,s),i.push(s))}}))}}}(_d(r.shapeMap,s),o)})))}return dl(i)}},{key:"getShape",value:function(t){return this.shapeMap[t]}},{key:"setVisibility",value:function(){Th(this,this.attributes.visibility)}},{key:"destroy",value:function(){this.shapeMap={},this.animateMap={},dn(e,"destroy",this,3)([])}}])}(du);function Kd(t,e){null==e||e.finished.then((function(){var n=t.activeAnimations.findIndex((function(t){return t===e}));n>-1&&t.activeAnimations.splice(n,1)}))}function $d(t){if(!t)return{};if("x"in t||"y"in t||"z"in t){var e=t.x,n=void 0===e?0:e,r=t.y,i=gl(n,void 0===r?0:r,t.z,t.transform);i&&(t.transform=i)}return t}var Zd=function(t){function e(t){return y(this,e),S(this,e,[Bd({style:e.defaultStyleProps},t)])}return N(e,t),b(e,[{key:"isTextStyle",value:function(t){return Ld(t,"label")}},{key:"isBackgroundStyle",value:function(t){return Ld(t,"background")}},{key:"getTextStyle",value:function(t){var e=this.getGraphicStyle(t);return e.padding,Id(function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(e,["padding"]),"background")}},{key:"getBackgroundStyle",value:function(t){if(!1===t.background)return!1;var e=this.getGraphicStyle(t),n=e.wordWrap,r=e.wordWrapWidth,i=e.padding,a=Dd(e,"background"),o=this.shapeMap.text.getGeometryBounds(),s=h(o.min,2),u=s[0],c=s[1],l=h(o.center,2),d=l[0],f=l[1],v=h(o.halfExtents,2),p=v[0],g=v[1],y=h(Cl(i),4),m=y[0],b=y[1],x=y[2],w=y[3],E=2*p+w+b,k=a.width,M=a.height;k&&M?Object.assign(a,{x:d-Number(k)/2,y:f-Number(M)/2}):Object.assign(a,{x:u-w,y:c-m,width:n?Math.min(E,r+w+b):E,height:2*g+m+x});var S=a.radius;if("string"==typeof S&&S.endsWith("%")){var O=Number(S.replace("%",""))/100;a.radius=Math.min(+a.width,+a.height)*O}return a}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parsedAttributes,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.upsert("text",Au,this.getTextStyle(t),e),this.upsert("background",Ou,this.getBackgroundStyle(t),e)}},{key:"getGeometryBounds",value:function(){return(this.getShape("background")||this.getShape("text")).getGeometryBounds()}}])}(Xd);Zd.defaultStyleProps={padding:0,fontSize:12,fontFamily:"system-ui, sans-serif",wordWrap:!0,maxLines:1,wordWrapWidth:128,textOverflow:"...",textBaseline:"middle",backgroundOpacity:.75,backgroundZIndex:-1,backgroundLineWidth:0};var Qd=function(t){function e(t){return y(this,e),S(this,e,[Bd({style:e.defaultStyleProps},t)])}return N(e,t),b(e,[{key:"getBadgeStyle",value:function(t){return this.getGraphicStyle(t)}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parsedAttributes,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.upsert("label",Zd,this.getBadgeStyle(t),e)}},{key:"getGeometryBounds",value:function(){var t=this.getShape("label");return(t.getShape("background")||t.getShape("text")).getGeometryBounds()}}])}(Xd);function Jd(t){return s(t)||x(t)||c(t)||l()}Qd.defaultStyleProps={padding:[2,4,2,4],fontSize:10,wordWrap:!1,backgroundRadius:"50%",backgroundOpacity:1};var tf={M:["x","y"],m:["dx","dy"],H:["x"],h:["dx"],V:["y"],v:["dy"],L:["x","y"],l:["dx","dy"],Z:[],z:[],C:["x1","y1","x2","y2","x","y"],c:["dx1","dy1","dx2","dy2","dx","dy"],S:["x2","y2","x","y"],s:["dx2","dy2","dx","dy"],Q:["x1","y1","x","y"],q:["dx1","dy1","dx","dy"],T:["x","y"],t:["dx","dy"],A:["rx","ry","rotation","large-arc","sweep","x","y"],a:["rx","ry","rotation","large-arc","sweep","dx","dy"]};var ef=function(t){if(t.length<2)return[["M",0,0],["L",0,0]];var e=t[0],n=t[1],r=t[t.length-1],i=t[t.length-2];t.unshift(i,r),t.push(e,n);for(var a=[["M",r[0],r[1]]],o=1;o<t.length-2;o+=1){var s=h(t[o-1],2),u=s[0],c=s[1],l=h(t[o],2),d=l[0],f=l[1],v=h(t[o+1],2),p=v[0],g=v[1],y=h(o!==t.length-2?t[o+2]:[p,g],2),m=d+(p-u)/6,b=f+(g-c)/6,x=p-(y[0]-d)/6,w=g-(y[1]-f)/6;a.push(["C",m,b,x,w,p,g])}return a},nf=function(t){function e(t){return y(this,e),S(this,e,[Bd({style:e.defaultStyleProps},t)])}return N(e,t),b(e,[{key:"getLabelStyle",value:function(t){if(!t.label||!t.d||0===t.d.length)return!1;var e=Dd(this.getGraphicStyle(t),"label"),n=e.maxWidth,r=e.offsetX,i=e.offsetY,a=e.autoRotate,o=e.placement,s=e.closeToPath,u=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(e,["maxWidth","offsetX","offsetY","autoRotate","placement","closeToPath"]),c=this.shapeMap.key,l=null==c?void 0:c.getRenderBounds();return Object.assign(function(t,e,n,r,i,a,o){var s=h(rd(t,e),2),u=s[0],c=s[1],l={textAlign:"left"===e?"right":"right"===e?"left":"center",textBaseline:"top"===e?"bottom":"bottom"===e?"top":"middle",transform:[["translate",u+n,c+r]]};if("center"===e||!i)return l;var d=function(t){var e=[],n="string"==typeof t?function(t){for(var e=t.replace(/[\n\r]/g,"").replace(/-/g," -").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ").trim().split(/\s*,|\s+/),n=[],r="",i={},a=function(){var t=e.shift();t in tf?r=t:e.unshift(t),i={type:r},tf[r].forEach((function(n){t=e.shift(),i[n]=t})),"M"===r?r="L":"m"===r&&(r="l");var a=Jd(Object.values(i)),o=a[0],s=a.slice(1);n.push([o].concat(w(s.map(Number))))};e.length>0;)a();return n}(t):t;return n.forEach((function(t){var n=t[0];if("Z"!==n)if("A"!==n)for(var r=1;r<t.length;r+=2)e.push([t[r],t[r+1],0]);else{var i=t.length;e.push([t[i-2],t[i-1],0])}else e.push(e[0])})),e}(a);if(!d||d.length<=3)return l;var f=d.map((function(t,e){var n=t,r=d[(e+1)%d.length];return Vc(n,r)?null:[n,r]})).filter(Boolean),v=function(t,e){var n=1/0,r=[[0,0],[0,0]];return e.forEach((function(e){var i=function(t,e){return Hh(t,fd(t,e))}(t,e);i<n&&(n=i,r=e)})),r}([u,c],f),p=fd([u,c],v);if(p&&v&&(l.transform=[["translate",p[0]+n,p[1]+r]],o)){var g=Math.atan((v[0][1]-v[1][1])/(v[0][0]-v[1][0]));l.transform.push(["rotate",g/Math.PI*180]),l.textAlign="center","right"!==e&&"left"!==e||(l.textBaseline=g>0?"right"===e?"bottom":"top":"right"===e?"top":"bottom")}return l}(l,o,r,i,s,t.d,a),{wordWrapWidth:Wd(l,n)},u)}},{key:"getKeyStyle",value:function(t){return this.getGraphicStyle(t)}},{key:"render",value:function(t,e){this.upsert("key",wu,this.getKeyStyle(t),e),this.upsert("label",Zd,this.getLabelStyle(t),e)}}])}(Xd);nf.defaultStyleProps={label:!0,labelPlacement:"bottom",labelCloseToPath:!0,labelAutoRotate:!0,labelOffsetX:0,labelOffsetY:0};var rf=function(t){function e(t){var n;return y(this,e),(n=S(this,e,[t])).onMounted=function(){n.handleRadius()},n.onAttrModified=function(){n.handleRadius()},of=n,n.isMutationObserved=!0,n.addEventListener(bs.MOUNTED,n.onMounted),n.addEventListener(bs.ATTR_MODIFIED,n.onAttrModified),n}return N(e,t),b(e,[{key:"handleRadius",value:function(){var t=this.attributes,e=t.radius,n=t.clipPath,r=t.width,i=void 0===r?0:r,a=t.height,o=void 0===a?0:a;if(e&&i&&o){var s=h(this.getBounds().min,2),u={x:s[0],y:s[1],radius:e,width:i,height:o};if(n)Object.assign(this.parsedStyle.clipPath.style,u);else{var c=new Ou({style:u});this.style.clipPath=c}}else n&&(this.style.clipPath=null)}}])}(yu),af=new WeakMap,of=null,sf=function(t){if(of&&function(t){for(var e=[],n=t.parentNode;n;)e.push(n),n=n.parentNode;return e}(of).includes(t)){var e=af.get(t);e?e.includes(of)||e.push(of):af.set(t,[of])}},uf=function(t){var e=af.get(t);e&&e.forEach((function(t){return t.handleRadius()}))},cf=function(t){function e(t){return y(this,e),S(this,e,[t])}return N(e,t),b(e,[{key:"isImage",value:function(){return!!this.attributes.src}},{key:"getIconStyle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.attributes,e=t.width,n=void 0===e?0:e,r=t.height,i=void 0===r?0:r,a=this.getGraphicStyle(t);return this.isImage()?Object.assign({x:-n/2,y:-i/2},a):Object.assign({textBaseline:"middle",textAlign:"center"},a)}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.attributes,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.upsert("icon",this.isImage()?rf:Au,this.getIconStyle(t),e)}}])}(Xd),lf=function(t){function e(){return y(this,e),S(this,e,arguments)}return N(e,t),b(e,[{key:"context",get:function(){return this.config.context}},{key:"parsedAttributes",get:function(){return this.attributes}},{key:"onframe",value:function(){}},{key:"animate",value:function(t,n){var r=this,i=dn(e,"animate",this,3)([t,n]);return i&&(i.onframe=function(){return r.onframe()},i.finished.then((function(){return r.onframe()}))),i}}])}(Xd),hf=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},df=function(t){function e(t){var n;return y(this,e),(n=S(this,e,[Bd({style:e.defaultStyleProps},t)])).type="node",n}return N(e,t),b(e,[{key:"getSize",value:function(){return jd((arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.attributes).size)}},{key:"getKeyStyle",value:function(t){var e=this.getGraphicStyle(t);return Object.assign(Id(e,["label","halo","icon","badge","port"]))}},{key:"getLabelStyle",value:function(t){if(!1===t.label||!t.labelText)return!1;var e=Dd(this.getGraphicStyle(t),"label"),n=e.placement,r=e.maxWidth,i=e.offsetX,a=e.offsetY,o=hf(e,["placement","maxWidth","offsetX","offsetY"]),s=this.getShape("key").getLocalBounds();return Object.assign(yg(s,n,i,a),{wordWrapWidth:Wd(s,r)},o)}},{key:"getHaloStyle",value:function(t){if(!1===t.halo)return!1;var e=this.getKeyStyle(t),n=e.fill,r=hf(e,["fill"]),i=Dd(this.getGraphicStyle(t),"halo");return Object.assign(Object.assign(Object.assign({},r),{stroke:n}),i)}},{key:"getIconStyle",value:function(t){if(!1===t.icon||!t.iconText&&!t.iconSrc)return!1;var e=Dd(this.getGraphicStyle(t),"icon");return Object.assign(function(t,e){var n=jd(t),r={};return e.text&&!e.fontSize&&(r={fontSize:.5*Math.min.apply(Math,w(n))}),!e.src||e.width&&e.height||(r={width:.5*n[0],height:.5*n[1]}),r}(t.size,e),e)}},{key:"getBadgesStyle",value:function(t){var e,n=this,r=_d(this.shapeMap,"badge-"),i={};if(Object.keys(r).forEach((function(t){i[t]=!1})),!1===t.badge||!(null===(e=t.badges)||void 0===e?void 0:e.length))return i;var a=t.badges,o=void 0===a?[]:a,s=t.badgePalette,u=t.opacity,c=void 0===u?1:u,l=hf(t,["badges","badgePalette","opacity"]),h=Gd(s),d=Dd(this.getGraphicStyle(l),"badge");return o.forEach((function(t,e){i[e]=Object.assign(Object.assign({backgroundFill:h?h[e%(null==h?void 0:h.length)]:void 0,opacity:c},d),n.getBadgeStyle(t))})),i}},{key:"getBadgeStyle",value:function(t){var e=this.getShape("key"),n=t.placement,r=void 0===n?"top":n,i=t.offsetX,a=t.offsetY,o=hf(t,["placement","offsetX","offsetY"]),s=yg(e.getLocalBounds(),r,i,a,!0);return Object.assign(Object.assign({},s),o)}},{key:"getPortsStyle",value:function(t){var e,n=this,r=this.getPorts(),i={};if(Object.keys(r).forEach((function(t){i[t]=!1})),!1===t.port||!(null===(e=t.ports)||void 0===e?void 0:e.length))return i;var a=Dd(this.getGraphicStyle(t),"port"),o=t.ports;return(void 0===o?[]:o).forEach((function(e,r){var o=e.key||r,s=Object.assign(Object.assign({},a),e);if(hg(s))i[o]=!1;else{var u=h(n.getPortXY(t,e),2),c=u[0],l=u[1];i[o]=Object.assign({transform:[["translate",c,l]]},s)}})),i}},{key:"getPortXY",value:function(t,e){var n=e.placement,r=void 0===n?"left":n,i=this.getShape("key");return cg(function(t,e){if(!t)return e.getLocalBounds();var n=t.canvas.getLayer(),r=e.cloneNode();Th(r,"hidden"),n.appendChild(r);var i=r.getLocalBounds();return r.destroy(),i}(this.context,i),r)}},{key:"getPorts",value:function(){return _d(this.shapeMap,"port-")}},{key:"getCenter",value:function(){return this.getShape("key").getBounds().center}},{key:"getIntersectPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return hd(t,rd(e,"center"),[rd(e,"left-top"),rd(e,"right-top"),rd(e,"right-bottom"),rd(e,"left-bottom")],!1,n).point}(t,this.getShape("key").getBounds(),e)}},{key:"drawHaloShape",value:function(t,e){var n=this.getHaloStyle(t),r=this.getShape("key");this.upsert("halo",r.constructor,n,e)}},{key:"drawIconShape",value:function(t,e){var n=this.getIconStyle(t);this.upsert("icon",cf,n,e),sf(this)}},{key:"drawBadgeShapes",value:function(t,e){var n=this,r=this.getBadgesStyle(t);Object.keys(r).forEach((function(t){var i=r[t];n.upsert("badge-".concat(t),Qd,i,e)}))}},{key:"drawPortShapes",value:function(t,e){var n=this,r=this.getPortsStyle(t);Object.keys(r).forEach((function(t){var i=r[t],a="port-".concat(t);n.upsert(a,lu,i,e)}))}},{key:"drawLabelShape",value:function(t,e){var n=this.getLabelStyle(t);this.upsert("label",Zd,n,e)}},{key:"_drawKeyShape",value:function(t,e){return this.drawKeyShape(t,e)}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parsedAttributes,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this._drawKeyShape(t,e),this.getShape("key")&&(this.drawHaloShape(t,e),this.drawIconShape(t,e),this.drawBadgeShapes(t,e),this.drawLabelShape(t,e),this.drawPortShapes(t,e))}},{key:"update",value:function(t){dn(e,"update",this,3)([t]),t&&("x"in t||"y"in t||"z"in t)&&uf(this)}},{key:"onframe",value:function(){this.drawBadgeShapes(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this)}}])}(lf);df.defaultStyleProps={x:0,y:0,size:32,droppable:!0,draggable:!0,port:!0,ports:[],portZIndex:2,portLinkToCenter:!1,badge:!0,badges:[],badgeZIndex:3,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloStrokeOpacity:.25,haloPointerEvents:"none",haloZIndex:-1,icon:!0,iconZIndex:1,label:!0,labelIsBillboard:!0,labelMaxWidth:"200%",labelPlacement:"bottom",labelWordWrap:!1,labelZIndex:0};var ff=function(t){function e(t){return y(this,e),S(this,e,[Bd({style:e.defaultStyleProps},t)])}return N(e,t),b(e,[{key:"drawKeyShape",value:function(t,e){return this.upsert("key",lu,this.getKeyStyle(t),e)}},{key:"getKeyStyle",value:function(t){var n=dn(e,"getKeyStyle",this,3)([t]);return Object.assign(Object.assign({},n),{r:Math.min.apply(Math,w(this.getSize(t)))/2})}},{key:"getIconStyle",value:function(t){var n=dn(e,"getIconStyle",this,3)([t]),r=2*this.getShape("key").attributes.r*wd;return!!n&&Object.assign({width:r,height:r},n)}},{key:"getIntersectPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return dd(t,this.getShape("key").getBounds(),e)}}])}(df);ff.defaultStyleProps={size:32};var vf=function(t){function e(t){return y(this,e),S(this,e,[t])}return N(e,t),b(e,[{key:"parsedAttributes",get:function(){return this.attributes}},{key:"drawKeyShape",value:function(t,e){return this.upsert("key",ku,this.getKeyStyle(t),e)}},{key:"getKeyStyle",value:function(t){var n=dn(e,"getKeyStyle",this,3)([t]);return Object.assign(Object.assign({},n),{points:this.getPoints(t)})}},{key:"getIntersectPoint",value:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.getShape("key").attributes.points;return hd(t,[+((null===(e=this.attributes)||void 0===e?void 0:e.x)||0),+((null===(n=this.attributes)||void 0===n?void 0:n.y)||0)],i,!0,r).point}}])}(df),pf=function(t){function e(t){return y(this,e),S(this,e,[t])}return N(e,t),b(e,[{key:"getPoints",value:function(t){var e=h(this.getSize(t),2);return function(t,e){return[[0,-e/2],[t/2,0],[0,e/2],[-t/2,0]]}(e[0],e[1])}}])}(vf),gf=function(t){function e(t){return y(this,e),S(this,e,[Bd({style:e.defaultStyleProps},t)])}return N(e,t),b(e,[{key:"parseOuterR",value:function(){var t=this.parsedAttributes.size;return Math.min.apply(Math,w(jd(t)))/2}},{key:"parseInnerR",value:function(){var t=this.parsedAttributes.innerR;return ce(t)?parseInt(t)/100*this.parseOuterR():t}},{key:"drawDonutShape",value:function(t,e){var n=this,r=t.donuts;if(null==r?void 0:r.length){var i=r.map((function(t){return oe(t)?{value:t}:t})),a=Dd(this.getGraphicStyle(t),"donut"),o=Gd(t.donutPalette);if(o){var s=i.reduce((function(t,e){var n;return t+(null!==(n=e.value)&&void 0!==n?n:0)}),0),u=this.parseOuterR(),c=this.parseInnerR(),l=0;i.forEach((function(t,r){var h=t.value,d=void 0===h?0:h,f=t.color,v=void 0===f?o[r%o.length]:f,p=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(t,["value","color"]),g=360*(0===s?1/i.length:d/s);n.upsert("round".concat(r),wu,Object.assign(Object.assign(Object.assign({},a),{d:mf(u,c,l,l+g),fill:v}),p),e),l+=g}))}}}},{key:"render",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;dn(e,"render",this,3)([t,n]),this.drawDonutShape(t,n)}}])}(ff);gf.defaultStyleProps={innerR:"50%",donuts:[],donutPalette:"tableau"};var yf=function(t,e,n,r){return[t+Math.sin(r)*n,e-Math.cos(r)*n]},mf=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return Math.abs(n-r)%360<1e-6?function(t,e,n,r){return r<=0||n<=r?[["M",0-n,0],["A",n,n,0,1,1,0+n,0],["A",n,n,0,1,1,0-n,0],["Z"]]:[["M",0-n,0],["A",n,n,0,1,1,0+n,0],["A",n,n,0,1,1,0-n,0],["Z"],["M",0+r,0],["A",r,r,0,1,0,0-r,0],["A",r,r,0,1,0,0+r,0],["Z"]]}(0,0,t,e):function(t,e,n,r,i,a){var o=i/360*2*Math.PI,s=a/360*2*Math.PI,u=[yf(0,0,r,o),yf(0,0,n,o),yf(0,0,n,s),yf(0,0,r,s)],c=s-o>Math.PI?1:0;return[["M",u[0][0],u[0][1]],["L",u[1][0],u[1][1]],["A",n,n,0,c,1,u[2][0],u[2][1]],["L",u[3][0],u[3][1]],["A",r,r,0,c,0,u[0][0],u[0][1]],["Z"]]}(0,0,t,e,n,r)},bf=function(t){function e(t){return y(this,e),S(this,e,[Bd({style:e.defaultStyleProps},t)])}return N(e,t),b(e,[{key:"drawKeyShape",value:function(t,e){return this.upsert("key",fu,this.getKeyStyle(t),e)}},{key:"getKeyStyle",value:function(t){var n=dn(e,"getKeyStyle",this,3)([t]),r=h(this.getSize(t),2),i=r[0],a=r[1];return Object.assign(Object.assign({},n),{rx:i/2,ry:a/2})}},{key:"getIconStyle",value:function(t){var n=dn(e,"getIconStyle",this,3)([t]),r=this.getShape("key").attributes,i=r.rx,a=r.ry,o=2*Math.min(+i,+a)*wd;return!!n&&Object.assign({width:o,height:o},n)}},{key:"getIntersectPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return dd(t,this.getShape("key").getBounds(),e)}}])}(df);bf.defaultStyleProps={size:[45,35]};var xf=function(t){function e(t){return y(this,e),S(this,e,[t])}return N(e,t),b(e,[{key:"getOuterR",value:function(t){return t.outerR||Math.min.apply(Math,w(this.getSize(t)))/2}},{key:"getPoints",value:function(t){return[[0,e=this.getOuterR(t)],[e*Math.sqrt(3)/2,e/2],[e*Math.sqrt(3)/2,-e/2],[0,-e],[-e*Math.sqrt(3)/2,-e/2],[-e*Math.sqrt(3)/2,e/2]];var e}},{key:"getIconStyle",value:function(t){var n=dn(e,"getIconStyle",this,3)([t]),r=this.getOuterR(t)*wd;return!!n&&Object.assign({width:r,height:r},n)}}])}(vf);function wf(t){return wf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wf(t)}function Ef(t){var e=function(t){if("object"!=wf(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=wf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==wf(e)?e:e+""}function kf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ef(r.key),r)}}function Mf(t,e,n){return e&&kf(t.prototype,e),n&&kf(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Sf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Of(t){return Of=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Of(t)}function Nf(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Nf=function(){return!!t})()}function Af(t,e,n){return e=Of(e),function(t,e){if(e&&("object"==wf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Nf()?Reflect.construct(e,n||[],Of(t).constructor):e.apply(t,n))}function Tf(t,e){return Tf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Tf(t,e)}function Pf(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Tf(t,e)}function Cf(t,e,n){return(e=Ef(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rf(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Lf(t,e){if(t){if("string"==typeof t)return Rf(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Rf(t,e):void 0}}function Df(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,c=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==e);u=!0);}catch(t){c=!0,i=t}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw i}}return s}}(t,e)||Lf(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _f(t,e){var n=e.cx,r=void 0===n?0:n,i=e.cy,a=void 0===i?0:i,o=e.r;t.arc(r,a,o,0,2*Math.PI,!1)}function If(t,e){var n=e.cx,r=void 0===n?0:n,i=e.cy,a=void 0===i?0:i,o=e.rx,s=e.ry;if(t.ellipse)t.ellipse(r,a,o,s,0,0,2*Math.PI,!1);else{var u=o>s?o:s,c=o>s?1:o/s,l=o>s?s/o:1;t.save(),t.scale(c,l),t.arc(r,a,u,0,2*Math.PI)}}function jf(t,e){var n,r,i=e.x1,a=e.y1,o=e.x2,s=e.y2,u=e.markerStart,c=e.markerEnd,l=e.markerStartOffset,h=e.markerEndOffset,d=0,f=0,v=0,p=0,g=0;u&&iu(u)&&l&&(n=o-i,r=s-a,g=Math.atan2(r,n),d=Math.cos(g)*(l||0),f=Math.sin(g)*(l||0)),c&&iu(c)&&h&&(n=i-o,r=a-s,g=Math.atan2(r,n),v=Math.cos(g)*(h||0),p=Math.sin(g)*(h||0)),t.moveTo(i+d,a+f),t.lineTo(o+v,s+p)}function Ff(t,e){var n,r,i=e.markerStart,a=e.markerEnd,o=e.markerStartOffset,s=e.markerEndOffset,u=e.d,c=u.absolutePath,l=u.segments,h=0,d=0,f=0,v=0,p=0;if(i&&iu(i)&&o){var g=Df(i.parentNode.getStartTangent(),2),y=g[0],m=g[1];n=y[0]-m[0],r=y[1]-m[1],p=Math.atan2(r,n),h=Math.cos(p)*(o||0),d=Math.sin(p)*(o||0)}if(a&&iu(a)&&s){var b=Df(a.parentNode.getEndTangent(),2),x=b[0],w=b[1];n=x[0]-w[0],r=x[1]-w[1],p=Math.atan2(r,n),f=Math.cos(p)*(s||0),v=Math.sin(p)*(s||0)}for(var E=0;E<c.length;E++){var k=c[E],M=k[0],S=c[E+1],O=0===E&&(0!==h||0!==d),N=(E===c.length-1||S&&("M"===S[0]||"Z"===S[0]))&&0!==f&&0!==v,A=Df(O?[h,d]:[0,0],2),T=A[0],P=A[1],C=Df(N?[f,v]:[0,0],2),R=C[0],L=C[1];switch(M){case"M":t.moveTo(k[1]+T,k[2]+P);break;case"L":t.lineTo(k[1]+R,k[2]+L);break;case"Q":t.quadraticCurveTo(k[1],k[2],k[3]+R,k[4]+L);break;case"C":t.bezierCurveTo(k[1],k[2],k[3],k[4],k[5]+R,k[6]+L);break;case"A":var D=l[E].arcParams,_=D.cx,I=D.cy,j=D.rx,F=D.ry,B=D.startAngle,z=D.endAngle,G=D.xRotation,V=D.sweepFlag;if(t.ellipse)t.ellipse(_,I,j,F,G,B,z,!!(1-V));else{var W=j>F?j:F,H=j>F?1:j/F,Y=j>F?F/j:1;t.translate(_,I),t.rotate(G),t.scale(H,Y),t.arc(0,0,W,B,z,!!(1-V)),t.scale(1/H,1/Y),t.rotate(-G),t.translate(-_,-I)}N&&t.lineTo(k[6]+f,k[7]+v);break;case"Z":t.closePath()}}}function Bf(t,e){var n,r,i=e.markerStart,a=e.markerEnd,o=e.markerStartOffset,s=e.markerEndOffset,u=e.points.points,c=u.length,l=u[0][0],h=u[0][1],d=u[c-1][0],f=u[c-1][1],v=0,p=0,g=0,y=0,m=0;i&&iu(i)&&o&&(n=u[1][0]-u[0][0],r=u[1][1]-u[0][1],m=Math.atan2(r,n),v=Math.cos(m)*(o||0),p=Math.sin(m)*(o||0)),a&&iu(a)&&s&&(n=u[c-1][0]-u[0][0],r=u[c-1][1]-u[0][1],m=Math.atan2(r,n),g=Math.cos(m)*(s||0),y=Math.sin(m)*(s||0)),t.moveTo(l+(v||g),h+(p||y));for(var b=1;b<c-1;b++){var x=u[b];t.lineTo(x[0],x[1])}t.lineTo(d,f)}function zf(t,e){var n,r,i=e.markerStart,a=e.markerEnd,o=e.markerStartOffset,s=e.markerEndOffset,u=e.points.points,c=u.length,l=u[0][0],h=u[0][1],d=u[c-1][0],f=u[c-1][1],v=0,p=0,g=0,y=0,m=0;i&&iu(i)&&o&&(n=u[1][0]-u[0][0],r=u[1][1]-u[0][1],m=Math.atan2(r,n),v=Math.cos(m)*(o||0),p=Math.sin(m)*(o||0)),a&&iu(a)&&s&&(n=u[c-2][0]-u[c-1][0],r=u[c-2][1]-u[c-1][1],m=Math.atan2(r,n),g=Math.cos(m)*(s||0),y=Math.sin(m)*(s||0)),t.moveTo(l+v,h+p);for(var b=1;b<c-1;b++){var x=u[b];t.lineTo(x[0],x[1])}t.lineTo(d+g,f+y)}function Gf(t,e){var n=e.x,r=void 0===n?0:n,i=e.y,a=void 0===i?0:i,o=e.radius,s=e.width,u=e.height,c=s,l=u;if(o&&o.some((function(t){return 0!==t}))){var h=s>0?1:-1,d=u>0?1:-1,f=h+d===0,v=Df(o.map((function(t){return le(t,0,Math.min(Math.abs(c)/2,Math.abs(l)/2))})),4),p=v[0],g=v[1],y=v[2],m=v[3];t.moveTo(h*p+r,a),t.lineTo(c-h*g+r,a),0!==g&&t.arc(c-h*g+r,d*g+a,g,-d*Math.PI/2,h>0?0:Math.PI,f),t.lineTo(c+r,l-d*y+a),0!==y&&t.arc(c-h*y+r,l-d*y+a,y,h>0?0:Math.PI,d>0?Math.PI/2:1.5*Math.PI,f),t.lineTo(h*m+r,l+a),0!==m&&t.arc(h*m+r,l-d*m+a,m,d>0?Math.PI/2:-Math.PI/2,h>0?Math.PI:0,f),t.lineTo(r,d*p+a),0!==p&&t.arc(h*p+r,d*p+a,p,h>0?Math.PI:0,d>0?1.5*Math.PI:Math.PI/2,f)}else t.rect(r,a,c,l)}var Vf=function(t){function e(){var t;Sf(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=Af(this,e,[].concat(r))).name="canvas-path-generator",t}return Pf(e,t),Mf(e,[{key:"init",value:function(){var t,e=(Cf(Cf(Cf(Cf(Cf(Cf(Cf(Cf(Cf(Cf(t={},In.CIRCLE,_f),In.ELLIPSE,If),In.RECT,Gf),In.LINE,jf),In.POLYLINE,zf),In.POLYGON,Bf),In.PATH,Ff),In.TEXT,void 0),In.GROUP,void 0),In.IMAGE,void 0),Cf(Cf(Cf(t,In.HTML,void 0),In.MESH,void 0),In.FRAGMENT,void 0));this.context.pathGeneratorFactory=e}},{key:"destroy",value:function(){delete this.context.pathGeneratorFactory}}])}(Fn);function Wf(){Wf=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var a=e&&e.prototype instanceof y?e:y,o=Object.create(a.prototype),s=new P(r||[]);return i(o,"_invoke",{value:O(t,n,s)}),o}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var d="suspendedStart",f="suspendedYield",v="executing",p="completed",g={};function y(){}function m(){}function b(){}var x={};c(x,o,(function(){return this}));var w=Object.getPrototypeOf,E=w&&w(w(C([])));E&&E!==n&&r.call(E,o)&&(x=E);var k=b.prototype=y.prototype=Object.create(x);function M(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(i,a,o,s){var u=h(t[i],t,a);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==wf(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,o,s)}),(function(t){n("throw",t,o,s)})):e.resolve(l).then((function(t){c.value=t,o(c)}),(function(t){return n("throw",t,o,s)}))}s(u.arg)}var a;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return a=a?a.then(i,i):i()}})}function O(e,n,r){var i=d;return function(a,o){if(i===v)throw Error("Generator is already running");if(i===p){if("throw"===a)throw o;return{value:t,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var u=N(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=v;var c=h(e,n,r);if("normal"===c.type){if(i=r.done?p:f,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=p,r.method="throw",r.arg=c.arg)}}}function N(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,N(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var a=h(i,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var o=a.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(wf(e)+" is not iterable")}return m.prototype=b,i(k,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:m,configurable:!0}),m.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},M(S.prototype),c(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new S(l(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},M(k),c(k,u,"Generator"),c(k,o,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:C(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}function Hf(t,e,n,r,i,a,o){try{var s=t[a](o),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function Yf(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){Hf(a,r,i,o,s,"next",t)}function s(t){Hf(a,r,i,o,s,"throw",t)}o(void 0)}))}}function Uf(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function qf(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Uf(Object(n),!0).forEach((function(e){Cf(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Uf(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Xf=C(),Kf=C(),$f=C(),Zf=Z(),Qf=function(){function t(){var e=this;Sf(this,t),this.isHit=function(t,n,r,i){var a=e.context.pointInPathPickerFactory[t.nodeName];if(a){var o=it(Zf,r),s=W(Kf,I($f,n[0],n[1],0),o);if(a(t,new Xn(s[0],s[1]),i,e.isPointInPath,e.context,e.runtime))return!0}return!1},this.isPointInPath=function(t,n){var r=e.runtime.offscreenCanvasCreator.getOrCreateContext(e.context.config.offscreenCanvas),i=e.context.pathGeneratorFactory[t.nodeName];return i&&(r.beginPath(),i(r,t.parsedStyle),r.closePath()),r.isPointInPath(n.x,n.y)}}return Mf(t,[{key:"apply",value:function(e,n){var r,i=this,a=e.renderingService,o=e.renderingContext;this.context=e,this.runtime=n;var s=null===(r=o.root)||void 0===r?void 0:r.ownerDocument;a.hooks.pick.tapPromise(t.tag,function(){var t=Yf(Wf().mark((function t(e){return Wf().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i.pick(s,e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),a.hooks.pickSync.tap(t.tag,(function(t){return i.pick(s,t)}))}},{key:"pick",value:function(t,e){var n,r=e.topmost,i=e.position,a=i.x,o=i.y,s=I(Xf,a,o,0),u=[],c=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Lf(t))){e&&(t=e);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,o=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){o=!0,i=t},f:function(){try{a||null==e.return||e.return()}finally{if(o)throw i}}}}(t.elementsFromBBox(s[0],s[1],s[0],s[1]));try{for(c.s();!(n=c.n()).done;){var l=n.value,h=l.getWorldTransform();if(this.isHit(l,s,h,!1)){var d=go(l);if(d){var f=d.parsedStyle.clipPath;if(this.isHit(f,s,f.getWorldTransform(),!0)){if(r)return e.picked=[l],e;u.push(l)}}else{if(r)return e.picked=[l],e;u.push(l)}}}}catch(t){c.e(t)}finally{c.f()}return e.picked=u,e}}])}();function Jf(t,e,n){var r=t.parsedStyle,i=r.cx,a=void 0===i?0:i,o=r.cy,s=void 0===o?0:o,u=r.r,c=r.fill,l=r.stroke,h=r.lineWidth,d=void 0===h?1:h,f=r.increasedLineWidthForHitTesting,v=void 0===f?0:f,p=r.pointerEvents,g=void 0===p?"auto":p,y=(d+v)/2,m=fn(a,s,e.x,e.y),b=Df(wo(g,c,l),2),x=b[0],w=b[1];return x&&w||n?m<=u+y:x?m<=u:!!w&&m>=u-y&&m<=u+y}function tv(t,e,n,r){return t/(n*n)+e/(r*r)}function ev(t,e,n){var r=t.parsedStyle,i=r.cx,a=void 0===i?0:i,o=r.cy,s=void 0===o?0:o,u=r.rx,c=r.ry,l=r.fill,h=r.stroke,d=r.lineWidth,f=void 0===d?1:d,v=r.increasedLineWidthForHitTesting,p=void 0===v?0:v,g=r.pointerEvents,y=void 0===g?"auto":g,m=e.x,b=e.y,x=Df(wo(y,l,h),2),w=x[0],E=x[1],k=(f+p)/2,M=(m-a)*(m-a),S=(b-s)*(b-s);return w&&E||n?tv(M,S,u+k,c+k)<=1:w?tv(M,S,u,c)<=1:!!E&&tv(M,S,u-k,c-k)>=1&&tv(M,S,u+k,c+k)<=1}function nv(t,e,n,r,i,a){return i>=t&&i<=t+n&&a>=e&&a<=e+r}function rv(t,e,n,r,i,a,o,s){var u=(Math.atan2(s-e,o-t)+2*Math.PI)%(2*Math.PI),c={x:t+n*Math.cos(u),y:e+n*Math.sin(u)};return fn(c.x,c.y,o,s)<=a/2}function iv(t,e,n,r,i,a,o){var s=Math.min(t,n),u=Math.max(t,n),c=Math.min(e,r),l=Math.max(e,r),h=i/2;return a>=s-h&&a<=u+h&&o>=c-h&&o<=l+h&&function(t,e,n,r,i,a){var o=[n-t,r-e];if(function(t,e){return t[0]===e[0]&&t[1]===e[1]}(o,[0,0]))return Math.sqrt((i-t)*(i-t)+(a-e)*(a-e));var s=[-o[1],o[0]];!function(t,e){var n=e[0],r=e[1],i=n*n+r*r;i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i}(s,s);var u=[i-t,a-e];return Math.abs(function(t,e){return t[0]*e[0]+t[1]*e[1]}(u,s))}(t,e,n,r,a,o)<=i/2}function av(t,e,n,r,i){var a=t.length;if(a<2)return!1;for(var o=0;o<a-1;o++)if(iv(t[o][0],t[o][1],t[o+1][0],t[o+1][1],e,n,r))return!0;if(i){var s=t[0],u=t[a-1];if(iv(s[0],s[1],u[0],u[1],e,n,r))return!0}return!1}function ov(t){return Math.abs(t)<1e-6?0:t<0?-1:1}function sv(t,e,n){return(n[0]-t[0])*(e[1]-t[1])==(e[0]-t[0])*(n[1]-t[1])&&Math.min(t[0],e[0])<=n[0]&&n[0]<=Math.max(t[0],e[0])&&Math.min(t[1],e[1])<=n[1]&&n[1]<=Math.max(t[1],e[1])}function uv(t,e,n){var r=!1,i=t.length;if(i<=2)return!1;for(var a=0;a<i;a++){var o=t[a],s=t[(a+1)%i];if(sv(o,s,[e,n]))return!0;ov(o[1]-n)>0!=ov(s[1]-n)>0&&ov(e-(n-o[1])*(o[0]-s[0])/(o[1]-s[1])-o[0])<0&&(r=!r)}return r}function cv(t,e,n){for(var r=!1,i=0;i<t.length&&!(r=uv(t[i],e,n));i++);return r}function lv(t,e,n){var r=t.parsedStyle,i=r.x1,a=r.y1,o=r.x2,s=r.y2,u=r.lineWidth,c=void 0===u?1:u,l=r.increasedLineWidthForHitTesting,h=void 0===l?0:l,d=r.pointerEvents;return!(!Df(wo(void 0===d?"auto":d,r.fill,r.stroke),2)[1]&&!n||!c)&&iv(i,a,o,s,c+h,e.x,e.y)}function hv(t,e,n,r,i,a){var o=t.parsedStyle,s=o.lineWidth,u=void 0===s?1:s,c=o.increasedLineWidthForHitTesting,l=void 0===c?0:c,h=o.stroke,d=o.fill,f=o.d,v=o.pointerEvents,p=void 0===v?"auto":v,g=f.segments,y=f.hasArc,m=f.polylines,b=f.polygons,x=Df(wo(p,(null==b?void 0:b.length)&&d,h),2),w=x[0],E=x[1],k=oa(t),M=!1;return w||n?M=y?r(t,e):cv(b,e.x,e.y)||cv(m,e.x,e.y):((E||n)&&(M=function(t,e,n,r,i){for(var a=!1,o=e/2,s=0;s<t.length;s++){var u=t[s],c=u.currentPoint,l=u.params,h=u.prePoint,d=u.box;if(!d||nv(d.x-o,d.y-o,d.width+e,d.height+e,n,r))switch(u.command){case"L":case"Z":if(a=iv(h[0],h[1],c[0],c[1],e,n,r))return!0;break;case"Q":if(a=An(h[0],h[1],l[1],l[2],l[3],l[4],n,r)<=e/2)return!0;break;case"C":if(a=Mn(h[0],h[1],l[1],l[2],l[3],l[4],l[5],l[6],n,r,i)<=e/2)return!0;break;case"A":u.cubicParams||(u.cubicParams=Ze(h[0],h[1],l[1],l[2],l[3],l[4],l[5],l[6],l[7],void 0));for(var f=u.cubicParams,v=h,p=0;p<f.length;p+=6){var g=Mn(v[0],v[1],f[p],f[p+1],f[p+2],f[p+3],f[p+4],f[p+5],n,r,i);if(v=[f[p+4],f[p+5]],a=g<=e/2)return!0}}}return a}(g,u+l,e.x,e.y,k)),M)}function dv(t,e,n){var r=t.parsedStyle,i=r.stroke,a=r.fill,o=r.lineWidth,s=void 0===o?1:o,u=r.increasedLineWidthForHitTesting,c=void 0===u?0:u,l=r.points,h=r.pointerEvents,d=Df(wo(void 0===h?"auto":h,a,i),2),f=d[0],v=!1;return(d[1]||n)&&(v=av(l.points,s+c,e.x,e.y,!0)),v||!f&&!n||(v=uv(l.points,e.x,e.y)),v}function fv(t,e,n){var r=t.parsedStyle,i=r.lineWidth,a=void 0===i?1:i,o=r.increasedLineWidthForHitTesting,s=void 0===o?0:o,u=r.points,c=r.pointerEvents;return!(!Df(wo(void 0===c?"auto":c,r.fill,r.stroke),2)[1]&&!n||!a)&&av(u.points,a+s,e.x,e.y,!1)}function vv(t,e,n,r,i){var a=t.parsedStyle,o=a.radius,s=a.fill,u=a.stroke,c=a.lineWidth,l=void 0===c?1:c,h=a.increasedLineWidthForHitTesting,d=void 0===h?0:h,f=a.x,v=void 0===f?0:f,p=a.y,g=void 0===p?0:p,y=a.width,m=a.height,b=a.pointerEvents,x=Df(wo(void 0===b?"auto":b,s,u),2),w=x[0],E=x[1],k=l+d;if(o&&o.some((function(t){return 0!==t}))){var M=!1;return(E||n)&&(M=function(t,e,n,r,i,a,o,s){var u=Df(i,4),c=u[0],l=u[1],h=u[2],d=u[3];return iv(t+c,e,t+n-l,e,a,o,s)||iv(t+n,e+l,t+n,e+r-h,a,o,s)||iv(t+n-h,e+r,t+d,e+r,a,o,s)||iv(t,e+r-d,t,e+c,a,o,s)||rv(t+n-l,e+l,l,Math.PI,Math.PI,a,o,s)||rv(t+n-h,e+r-h,h,0,Math.PI,a,o,s)||rv(t+d,e+r-d,d,Math.PI,Math.PI,a,o,s)||rv(t+c,e+c,c,Math.PI,Math.PI,a,o,s)}(v,g,y,m,o.map((function(t){return le(t,0,Math.min(Math.abs(y)/2,Math.abs(m)/2))})),k,e.x,e.y)),M||!w&&!n||(M=r(t,e)),M}var S=k/2;return w&&E||n?nv(v-S,g-S,y+S,m+S,e.x,e.y):w?nv(v,g,y,m,e.x,e.y):!!E&&function(t,e,n,r,i,a,o){var s=i/2;return nv(t-s,e-s,n,i,a,o)||nv(t+n-s,e-s,i,r,a,o)||nv(t+s,e+r-s,n,i,a,o)||nv(t-s,e+s,i,r,a,o)}(v,g,y,m,k,e.x,e.y)}function pv(t,e,n,r,i,a){var o=t.parsedStyle,s=o.pointerEvents,u=void 0===s?"auto":s,c=o.x,l=void 0===c?0:c,h=o.y,d=void 0===h?0:h,f=o.width,v=o.height;if("non-transparent-pixel"===u){var p=i.config.offscreenCanvas,g=a.offscreenCanvasCreator.getOrCreateCanvas(p),y=a.offscreenCanvasCreator.getOrCreateContext(p,{willReadFrequently:!0});return g.width=f,g.height=v,i.defaultStyleRendererFactory[In.IMAGE].render(y,qf(qf({},t.parsedStyle),{},{x:0,y:0}),t,void 0,void 0,void 0),y.getImageData(e.x-l,e.y-d,1,1).data.every((function(t){return 0!==t}))}return!0}function gv(t,e,n,r){var i=t.getGeometryBounds();return e.x>=i.min[0]&&e.y>=i.min[1]&&e.x<=i.max[0]&&e.y<=i.max[1]}Qf.tag="CanvasPicker";var yv=function(t){function e(){var t;Sf(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=Af(this,e,[].concat(r))).name="canvas-picker",t}return Pf(e,t),Mf(e,[{key:"init",value:function(){var t,e=(Cf(Cf(Cf(Cf(Cf(Cf(Cf(Cf(Cf(Cf(t={},In.CIRCLE,Jf),In.ELLIPSE,ev),In.RECT,vv),In.LINE,lv),In.POLYLINE,fv),In.POLYGON,dv),In.PATH,hv),In.TEXT,gv),In.GROUP,null),In.IMAGE,pv),Cf(Cf(t,In.HTML,null),In.MESH,null));this.context.pointInPathPickerFactory=e,this.addRenderingPlugin(new Qf)}},{key:"destroy",value:function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()}}])}(Fn);function mv(t,e){if(!{}.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var bv=0;function xv(t){return"__private_"+bv+++"_"+t}var wv=function(){return Mf((function t(){Sf(this,t),this.cacheStore=new Map}),[{key:"onRefAdded",value:function(t){}},{key:"has",value:function(t){return this.cacheStore.has(t)}},{key:"put",value:function(t,e,n){return!this.cacheStore.has(t)&&(this.cacheStore.set(t,{value:e,counter:new Set([n])}),this.onRefAdded(n),!0)}},{key:"get",value:function(t,e){var n=this.cacheStore.get(t);return n?(n.counter.has(e)||(n.counter.add(e),this.onRefAdded(e)),n.value):null}},{key:"update",value:function(t,e,n){var r=this.cacheStore.get(t);return!!r&&(r.value=qf(qf({},r.value),e),r.counter.has(n)||(r.counter.add(n),this.onRefAdded(n)),!0)}},{key:"release",value:function(t,e){var n=this.cacheStore.get(t);return!!n&&(n.counter.delete(e),n.counter.size<=0&&this.cacheStore.delete(t),!0)}},{key:"releaseRef",value:function(t){var e=this;Array.from(this.cacheStore.keys()).forEach((function(n){e.release(n,t)}))}},{key:"getSize",value:function(){return this.cacheStore.size}},{key:"clear",value:function(){this.cacheStore.clear()}}])}(),Ev=[],kv=[],Mv=function(){function t(){Sf(this,t)}return Mf(t,null,[{key:"stop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.api;t.rafId&&(e.cancelAnimationFrame(t.rafId),t.rafId=null)}},{key:"executeTask",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.api;Ev.length<=0&&kv.length<=0||(kv.forEach((function(t){return t()})),kv=Ev.splice(0,t.TASK_NUM_PER_FRAME),t.rafId=e.requestAnimationFrame((function(){t.executeTask(e)})))}},{key:"sliceImage",value:function(e,n,r,i){for(var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:t.api,s=e.naturalWidth||e.width,u=e.naturalHeight||e.height,c=n-a,l=r-a,h=Math.ceil(s/c),d=Math.ceil(u/l),f={tileSize:[n,r],gridSize:[d,h],tiles:Array(d).fill(null).map((function(){return Array(h).fill(null)}))},v=function(t){for(var a=function(a){Ev.push((function(){var h=a*c,d=t*l,v=[Math.min(n,s-h),Math.min(r,u-d)],p=v[0],g=v[1],y=o.createCanvas();y.width=n,y.height=r,y.getContext("2d").drawImage(e,h,d,p,g,0,0,p,g),f.tiles[t][a]={x:h,y:d,tileX:a,tileY:t,data:y},i()}))},d=0;d<h;d++)a(d)},p=0;p<d;p++)v(p);return t.stop(),t.executeTask(),f}}])}();Mv.TASK_NUM_PER_FRAME=10;var Sv=new wv;Sv.onRefAdded=function(t){var e=this;t.addEventListener(bs.DESTROY,(function(){e.releaseRef(t)}),{once:!0})};var Ov=function(){return Mf((function t(e,n){Sf(this,t),this.gradientCache={},this.patternCache={},this.context=e,this.runtime=n}),[{key:"getImageSync",value:function(t,e,n){var r=ce(t)?t:t.src;if(Sv.has(r)){var i=Sv.get(r,e);if(i.img.complete)return null==n||n(i),i}return this.getOrCreateImage(t,e).then((function(t){null==n||n(t)})).catch((function(t){console.error(t)})),null}},{key:"getOrCreateImage",value:function(t,e){var n=this,r=ce(t)?t:t.src;if(!ce(t)&&!Sv.has(r)){var i={img:t,size:[t.naturalWidth||t.width,t.naturalHeight||t.height],tileSize:Nv(t)};Sv.put(r,i,e)}if(Sv.has(r)){var a=Sv.get(r,e);return a.img.complete?Promise.resolve(a):new Promise((function(t,e){a.img.addEventListener("load",(function(){a.size=[a.img.naturalWidth||a.img.width,a.img.naturalHeight||a.img.height],a.tileSize=Nv(a.img),t(a)})),a.img.addEventListener("error",(function(t){e(t)}))}))}return new Promise((function(t,i){var a=n.context.config.createImage();if(a){var o={img:a,size:[0,0],tileSize:Nv(a)};Sv.put(r,o,e),a.onload=function(){o.size=[a.naturalWidth||a.width,a.naturalHeight||a.height],o.tileSize=Nv(o.img),t(o)},a.onerror=function(t){i(t)},a.crossOrigin="Anonymous",a.src=r}}))}},{key:"createDownSampledImage",value:(e=Yf(Wf().mark((function t(e,n){var r,i,a,o,s,u,c,l,h,d,f,v,p,g;return Wf().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getOrCreateImage(e,n);case 2:if(void 0===(r=t.sent).downSamplingRate){t.next=5;break}return t.abrupt("return",r);case 5:if(i=this.context.config.enableLargeImageOptimization,o=(a="boolean"==typeof i?{}:i).maxDownSampledImageSize,s=void 0===o?2048:o,u=a.downSamplingRateThreshold,c=void 0===u?.5:u,l=this.runtime.globalThis.createImageBitmap,h=Df(r.size,2),d=h[0],f=h[1],v=r.img,p=Math.min((s+s)/(d+f),Math.max(.01,Math.min(c,.5))),g=qf(qf({},r),{},{downSamplingRate:p}),Sv.update(r.img.src,g,n),!l){t.next=25;break}return t.prev=14,t.next=17,l(r.img,{resizeWidth:d*p,resizeHeight:f*p});case 17:v=t.sent,t.next=23;break;case 20:t.prev=20,t.t0=t.catch(14),p=1;case 23:t.next=26;break;case 25:p=1;case 26:return g=qf(qf({},this.getImageSync(e,n)),{},{downSampled:v,downSamplingRate:p}),Sv.update(r.img.src,g,n),t.abrupt("return",g);case 29:case"end":return t.stop()}}),t,this,[[14,20]])}))),function(t,n){return e.apply(this,arguments)})},{key:"createImageTiles",value:(t=Yf(Wf().mark((function t(e,n,r,i){var a,o,s,u,c;return Wf().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getOrCreateImage(e,i);case 2:return a=t.sent,o=i.ownerDocument.defaultView,s=o.requestAnimationFrame,u=o.cancelAnimationFrame,Mv.api={requestAnimationFrame:s,cancelAnimationFrame:u,createCanvas:function(){return vs.createCanvas()}},c=qf(qf({},a),Mv.sliceImage(a.img,a.tileSize[0],a.tileSize[0],r)),Sv.update(a.img.src,c,i),t.abrupt("return",c);case 8:case"end":return t.stop()}}),t,this)}))),function(e,n,r,i){return t.apply(this,arguments)})},{key:"releaseImage",value:function(t,e){Sv.release(ce(t)?t:t.src,e)}},{key:"releaseImageRef",value:function(t){Sv.releaseRef(t)}},{key:"getOrCreatePatternSync",value:function(t,e,n,r,i,a,o){var s=this.generatePatternKey(e);if(s&&this.patternCache[s])return this.patternCache[s];var u,c=e.image,l=e.repetition,h=e.transform,d=!1;if(ce(c)){var f=this.getImageSync(c,t,o);u=null==f?void 0:f.img}else r?(u=r,d=!0):u=c;var v,p=u&&n.createPattern(u,l);return p&&(v=h?Uo(Ta(h),new cu({})):nt(Z()),d&&ct(v,v,[1/i,1/i,1]),p.setTransform({a:v[0],b:v[1],c:v[4],d:v[5],e:v[12]+a[0],f:v[13]+a[1]})),s&&p&&(this.patternCache[s]=p),p}},{key:"getOrCreateGradient",value:function(t,e){var n=this.generateGradientKey(t),r=t.type,i=t.steps,a=t.min,o=t.width,s=t.height,u=t.angle,c=t.cx,l=t.cy,h=t.size;if(this.gradientCache[n])return this.gradientCache[n];var d=null;if(r===vi.LinearGradient){var f=function(t,e,n,r){var i=nr(r.value),a=0+e/2,o=0+n/2,s=Math.abs(e*Math.cos(i))+Math.abs(n*Math.sin(i));return{x1:t[0]+a-Math.cos(i)*s/2,y1:t[1]+o-Math.sin(i)*s/2,x2:t[0]+a+Math.cos(i)*s/2,y2:t[1]+o+Math.sin(i)*s/2}}(a,o,s,u),v=f.x1,p=f.y1,g=f.x2,y=f.y2;d=e.createLinearGradient(v,p,g,y)}else if(r===vi.RadialGradient){var m=function(t,e,n,r,i,a){var o=r.value,s=i.value;r.unit===ii.kPercentage&&(o=r.value/100*e),i.unit===ii.kPercentage&&(s=i.value/100*n);var u=Math.max(se([0,0],[o,s]),se([0,n],[o,s]),se([e,n],[o,s]),se([e,0],[o,s]));return a&&(a instanceof mi?u=a.value:a instanceof gi&&("closest-side"===a.value?u=Math.min(o,e-o,s,n-s):"farthest-side"===a.value?u=Math.max(o,e-o,s,n-s):"closest-corner"===a.value&&(u=Math.min(se([0,0],[o,s]),se([0,n],[o,s]),se([e,n],[o,s]),se([e,0],[o,s]))))),{x:o+t[0],y:s+t[1],r:u}}(a,o,s,c,l,h),b=m.x,x=m.y,w=m.r;d=e.createRadialGradient(b,x,0,b,x,w)}return d&&(i.forEach((function(t){var e,n=t.offset,r=t.color;n.unit===ii.kPercentage&&(null===(e=d)||void 0===e||e.addColorStop(n.value/100,r.toString()))})),this.gradientCache[n]=d),this.gradientCache[n]}},{key:"generateGradientKey",value:function(t){var e=t.type,n=t.min,r=t.width,i=t.height,a=t.steps,o=t.angle,s=t.cx,u=t.cy,c=t.size;return"gradient-".concat(e,"-").concat((null==o?void 0:o.toString())||0,"-").concat((null==s?void 0:s.toString())||0,"-").concat((null==u?void 0:u.toString())||0,"-").concat((null==c?void 0:c.toString())||0,"-").concat(n[0],"-").concat(n[1],"-").concat(r,"-").concat(i,"-").concat(a.map((function(t){var e=t.offset,n=t.color;return"".concat(e).concat(n)})).join("-"))}},{key:"generatePatternKey",value:function(t){var e=t.image,n=t.repetition;return ce(e)?"pattern-".concat(e,"-").concat(n):"rect"===e.nodeName?"pattern-".concat(e.entity,"-").concat(n):void 0}}]);var t,e}();function Nv(t){if(!t.complete)return[0,0];var e=t.naturalWidth||t.width,n=t.naturalHeight||t.height,r=256;return[256,512].forEach((function(t){Math.ceil(n/t)*Math.ceil(e/t)<1e3&&(r=t)})),[r,r]}Ov.isSupportTile=!!vs.createCanvas();var Av=function(){function t(){Sf(this,t)}return Mf(t,[{key:"apply",value:function(e){var n=e.renderingService,r=e.renderingContext,i=e.imagePool,a=r.root.ownerDocument.defaultView,o=function(t,e,n){var r=t.parsedStyle,i=r.width,a=r.height;i&&!a?t.setAttribute("height",n/e*i):!i&&a&&t.setAttribute("width",e/n*a)},s=function(t){var e=t.target,r=e.nodeName,a=e.attributes;if(r===In.IMAGE){var s=a.src,u=a.keepAspectRatio;i.getImageSync(s,e,(function(t){var r=t.img,i=r.width,a=r.height;u&&o(e,i,a),e.renderable.dirty=!0,n.dirtify()}))}},u=function(t){var e=t.target,r=t.attrName,a=t.prevValue,s=t.newValue;e.nodeName===In.IMAGE&&"src"===r&&(a!==s&&i.releaseImage(a,e),ce(s)&&i.getOrCreateImage(s,e).then((function(t){var r=t.img,i=r.width,a=r.height;e.attributes.keepAspectRatio&&o(e,i,a),e.renderable.dirty=!0,n.dirtify()})).catch((function(){})))};n.hooks.init.tap(t.tag,(function(){a.addEventListener(bs.MOUNTED,s),a.addEventListener(bs.ATTR_MODIFIED,u)})),n.hooks.destroy.tap(t.tag,(function(){a.removeEventListener(bs.MOUNTED,s),a.removeEventListener(bs.ATTR_MODIFIED,u)}))}}])}();Av.tag="LoadImage";var Tv=function(t){function e(){var t;Sf(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=Af(this,e,[].concat(r))).name="image-loader",t}return Pf(e,t),Mf(e,[{key:"init",value:function(t){this.context.imagePool=new Ov(this.context,t),this.addRenderingPlugin(new Av)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(Fn),Pv=xv("renderState"),Cv=function(){function t(e){Sf(this,t),this.removedRBushNodeAABBs=[],this.renderQueue=[],Object.defineProperty(this,Pv,{writable:!0,value:{restoreStack:[],prevObject:null,currentContext:new Map}}),this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=Z(),this.dprMatrix=Z(),this.tmpMat4=Z(),this.vec3a=C(),this.vec3b=C(),this.vec3c=C(),this.vec3d=C(),this.canvasRendererPluginOptions=e}return Mf(t,[{key:"apply",value:function(e,n){var r=this;this.context=e;var i=this.context,a=i.config,o=i.camera,s=i.renderingService,u=i.renderingContext,c=i.rBushRoot,l=i.pathGeneratorFactory,h=a.renderer.getConfig().enableRenderingOptimization;a.renderer.getConfig().enableDirtyCheck=!1,a.renderer.getConfig().enableDirtyRectangleRendering=!1,this.rBush=c,this.pathGeneratorFactory=l;var d=e.contextService,f=u.root.ownerDocument.defaultView,v=function(t){var e=t.target.rBushNode;e.aabb&&r.removedRBushNodeAABBs.push(e.aabb)},p=function(t){var e=t.target.rBushNode;e.aabb&&r.removedRBushNodeAABBs.push(e.aabb)};s.hooks.init.tap(t.tag,(function(){f.addEventListener(bs.UNMOUNTED,v),f.addEventListener(bs.CULLED,p);var t=d.getDPR(),e=a.width,n=a.height,i=d.getContext();r.clearRect(i,0,0,e*t,n*t,a.background)})),s.hooks.destroy.tap(t.tag,(function(){f.removeEventListener(bs.UNMOUNTED,v),f.removeEventListener(bs.CULLED,p),r.renderQueue=[],r.removedRBushNodeAABBs=[],mv(r,Pv)[Pv]={restoreStack:[],prevObject:null,currentContext:null}})),s.hooks.beginFrame.tap(t.tag,(function(){var t,e=d.getContext(),n=d.getDPR(),i=a.width,o=a.height,u=r.canvasRendererPluginOptions,c=u.dirtyObjectNumThreshold,l=u.dirtyObjectRatioThreshold,h=s.getStats(),v=h.total,p=h.rendered,g=p/v;r.clearFullScreen=r.clearFullScreenLastFrame||!(null!==(t=f.context.renderingPlugins[1])&&void 0!==t&&t.isFirstTimeRenderingFinished)||s.disableDirtyRectangleRendering()||p>c&&g>l,e&&("function"==typeof e.resetTransform?e.resetTransform():e.setTransform(1,0,0,1,0,0),r.clearFullScreen&&r.clearRect(e,0,0,i*n,o*n,a.background))}));var g=function(t,e){for(var i=[t];i.length>0;){var a=i.pop();a.isVisible()&&!a.isCulled()&&(h?r.renderDisplayObjectOptimized(a,e,r.context,mv(r,Pv)[Pv],n):r.renderDisplayObject(a,e,r.context,mv(r,Pv)[Pv],n));for(var o=a.sortable.sorted||a.childNodes,s=o.length-1;s>=0;s--)i.push(o[s])}};s.hooks.endFrame.tap(t.tag,(function(){if(0!==u.root.childNodes.length){h=a.renderer.getConfig().enableRenderingOptimization,mv(r,Pv)[Pv]={restoreStack:[],prevObject:null,currentContext:mv(r,Pv)[Pv].currentContext},mv(r,Pv)[Pv].currentContext.clear(),r.clearFullScreenLastFrame=!1;var t=d.getContext(),e=d.getDPR();if(pt(r.dprMatrix,[e,e,1]),st(r.vpMatrix,r.dprMatrix,o.getOrthoMatrix()),r.clearFullScreen)h?(t.save(),g(u.root,t),t.restore()):g(u.root,t),r.removedRBushNodeAABBs=[];else{var i=r.safeMergeAABB.apply(r,[r.mergeDirtyAABBs(r.renderQueue)].concat((T=r.removedRBushNodeAABBs.map((function(t){var e=t.minX,n=t.minY,r=t.maxX,i=t.maxY,a=new Hn;return a.setMinMax([e,n,0],[r,i,0]),a})),function(t){if(Array.isArray(t))return Rf(t)}(T)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(T)||Lf(T)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())));if(r.removedRBushNodeAABBs=[],Hn.isEmpty(i))return void(r.renderQueue=[]);var s=r.convertAABB2Rect(i),c=s.x,l=s.y,v=s.width,p=s.height,y=W(r.vec3a,[c,l,0],r.vpMatrix),m=W(r.vec3b,[c+v,l,0],r.vpMatrix),b=W(r.vec3c,[c,l+p,0],r.vpMatrix),x=W(r.vec3d,[c+v,l+p,0],r.vpMatrix),w=Math.min(y[0],m[0],x[0],b[0]),E=Math.min(y[1],m[1],x[1],b[1]),k=Math.max(y[0],m[0],x[0],b[0]),M=Math.max(y[1],m[1],x[1],b[1]),S=Math.floor(w),O=Math.floor(E),N=Math.ceil(k-w),A=Math.ceil(M-E);t.save(),r.clearRect(t,S,O,N,A,a.background),t.beginPath(),t.rect(S,O,N,A),t.clip(),t.setTransform(r.vpMatrix[0],r.vpMatrix[1],r.vpMatrix[4],r.vpMatrix[5],r.vpMatrix[12],r.vpMatrix[13]),a.renderer.getConfig().enableDirtyRectangleRenderingDebug&&f.dispatchEvent(new cs(Iu.DIRTY_RECTANGLE,{dirtyRect:{x:S,y:O,width:N,height:A}})),r.searchDirtyObjects(i).sort((function(t,e){return t.sortable.renderOrder-e.sortable.renderOrder})).forEach((function(e){e&&e.isVisible()&&!e.isCulled()&&r.renderDisplayObject(e,t,r.context,mv(r,Pv)[Pv],n)})),t.restore(),r.renderQueue.forEach((function(t){r.saveDirtyAABB(t)})),r.renderQueue=[]}mv(r,Pv)[Pv].restoreStack.forEach((function(){t.restore()})),mv(r,Pv)[Pv].restoreStack=[]}else r.clearFullScreenLastFrame=!0;var T})),s.hooks.render.tap(t.tag,(function(t){r.clearFullScreen||r.renderQueue.push(t)}))}},{key:"clearRect",value:function(t,e,n,r,i,a){t.clearRect(e,n,r,i),a&&(t.fillStyle=a,t.fillRect(e,n,r,i))}},{key:"renderDisplayObjectOptimized",value:function(t,e,n,r,i){var a=t.nodeName,o=!1,s=this.context.styleRendererFactory[a],u=this.pathGeneratorFactory[a],c=t.parsedStyle.clipPath;if(c){(!r.prevObject||!Ht(c.getWorldTransform(),r.prevObject.getWorldTransform()))&&(this.applyWorldTransform(e,c),r.prevObject=null);var l=this.pathGeneratorFactory[c.nodeName];l&&(e.save(),o=!0,e.beginPath(),l(e,c.parsedStyle),e.closePath(),e.clip())}if(s){(!r.prevObject||!Ht(t.getWorldTransform(),r.prevObject.getWorldTransform()))&&this.applyWorldTransform(e,t);var h=!r.prevObject;if(!h){var d=r.prevObject.nodeName;h=a===In.TEXT?d!==In.TEXT:a===In.IMAGE?d!==In.IMAGE:d===In.TEXT||d===In.IMAGE}s.applyStyleToContext(e,t,h,r),r.prevObject=t}u&&(e.beginPath(),u(e,t.parsedStyle),a!==In.LINE&&a!==In.PATH&&a!==In.POLYLINE&&e.closePath()),s&&s.drawToContext(e,t,mv(this,Pv)[Pv],this,i),o&&e.restore(),t.renderable.dirty=!1}},{key:"renderDisplayObject",value:function(t,e,n,r,i){var a=t.nodeName,o=r.restoreStack[r.restoreStack.length-1];!o||t.compareDocumentPosition(o)&ds.DOCUMENT_POSITION_CONTAINS||(e.restore(),r.restoreStack.pop());var s=this.context.styleRendererFactory[a],u=this.pathGeneratorFactory[a],c=t.parsedStyle.clipPath;if(c){this.applyWorldTransform(e,c);var l=this.pathGeneratorFactory[c.nodeName];l&&(e.save(),r.restoreStack.push(t),e.beginPath(),l(e,c.parsedStyle),e.closePath(),e.clip())}s&&(this.applyWorldTransform(e,t),e.save(),this.applyAttributesToContext(e,t)),u&&(e.beginPath(),u(e,t.parsedStyle),a!==In.LINE&&a!==In.PATH&&a!==In.POLYLINE&&e.closePath()),s&&(s.render(e,t.parsedStyle,t,n,this,i),e.restore()),t.renderable.dirty=!1}},{key:"applyAttributesToContext",value:function(t,e){var n=e.parsedStyle,r=n.stroke,i=n.fill,a=n.opacity,o=n.lineDash,s=n.lineDashOffset;o&&t.setLineDash(o),ue(s)||(t.lineDashOffset=s),ue(a)||(t.globalAlpha*=a),ue(r)||Array.isArray(r)||r.isNone||(t.strokeStyle=e.attributes.stroke),ue(i)||Array.isArray(i)||i.isNone||(t.fillStyle=e.attributes.fill)}},{key:"convertAABB2Rect",value:function(t){var e=t.getMin(),n=t.getMax(),r=Math.floor(e[0]),i=Math.floor(e[1]);return{x:r,y:i,width:Math.ceil(n[0])-r,height:Math.ceil(n[1])-i}}},{key:"mergeDirtyAABBs",value:function(t){var e=new Hn;return t.forEach((function(t){var n=t.getRenderBounds();e.add(n);var r=t.renderable.dirtyRenderBounds;r&&e.add(r)})),e}},{key:"searchDirtyObjects",value:function(t){var e=Df(t.getMin(),2),n=e[0],r=e[1],i=Df(t.getMax(),2),a=i[0],o=i[1];return this.rBush.search({minX:n,minY:r,maxX:a,maxY:o}).map((function(t){return t.displayObject}))}},{key:"saveDirtyAABB",value:function(t){var e=t.renderable;e.dirtyRenderBounds||(e.dirtyRenderBounds=new Hn);var n=t.getRenderBounds();n&&e.dirtyRenderBounds.update(n.center,n.halfExtents)}},{key:"applyWorldTransform",value:function(t,e,n){n?(J(this.tmpMat4,e.getLocalTransform()),st(this.tmpMat4,n,this.tmpMat4),st(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(J(this.tmpMat4,e.getWorldTransform()),st(this.tmpMat4,this.vpMatrix,this.tmpMat4)),t.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])}},{key:"safeMergeAABB",value:function(){for(var t=new Hn,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach((function(e){t.add(e)})),t}}])}();function Rv(t,e,n,r,i,a,o){var s,u;if("rect"===t.image.nodeName){var c=t.image.parsedStyle,l=c.width,h=c.height;u=r.contextService.getDPR();var d=r.config.offscreenCanvas;(s=a.offscreenCanvasCreator.getOrCreateCanvas(d)).width=l*u,s.height=h*u;var f=a.offscreenCanvasCreator.getOrCreateContext(d),v={restoreStack:[],prevObject:null,currentContext:new Map};t.image.forEach((function(t){i.renderDisplayObject(t,f,r,v,a)})),v.restoreStack.forEach((function(){f.restore()}))}return o.getOrCreatePatternSync(e,t,n,s,u,e.getGeometryBounds().min,(function(){e.renderable.dirty=!0,r.renderingService.dirtify()}))}function Lv(t,e,n,r){var i;if(t.type===vi.LinearGradient||t.type===vi.RadialGradient){var a=e.getGeometryBounds(),o=a&&2*a.halfExtents[0]||1,s=a&&2*a.halfExtents[1]||1,u=a&&a.min||[0,0];i=r.getOrCreateGradient(qf(qf({type:t.type},t.value),{},{min:u,width:o,height:s}),n)}return i}Cv.tag="CanvasRenderer";var Dv=["shadowBlur","shadowOffsetX","shadowOffsetY"],_v=["lineCap","lineJoin","miterLimit"],Iv={globalAlpha:1,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",filter:"none",globalCompositeOperation:"source-over",strokeStyle:"#000",strokeOpacity:1,lineWidth:1,lineDash:[],lineDashOffset:0,lineCap:"butt",lineJoin:"miter",miterLimit:10,fillStyle:"#000",fillOpacity:1},jv={};function Fv(t,e,n,r){var i=r.has(e)?r.get(e):Iv[e];return i!==n&&("lineDash"===e?t.setLineDash(n):t[e]=n,r.set(e,n)),i}var Bv=function(t){function e(){return Sf(this,e),Af(this,e,arguments)}return Pf(e,t),Mf(e,[{key:"render",value:function(t,e,n,r,i,a){var o=e.fill,s=e.fillRule,u=e.opacity,c=void 0===u?1:u,l=e.fillOpacity,h=void 0===l?1:l,d=e.stroke,f=e.strokeOpacity,v=void 0===f?1:f,p=e.lineWidth,g=void 0===p?1:p,y=e.lineCap,m=e.lineJoin,b=e.shadowType,x=e.shadowColor,w=e.shadowBlur,E=e.filter,k=e.miterLimit,M=o&&!o.isNone,S=d&&!d.isNone&&g>0,O=0===(null==o?void 0:o.alpha),N=!(!E||!E.length),A=!ue(x)&&w>0,T=n.nodeName,P="inner"===b,C=S&&A&&(T===In.PATH||T===In.LINE||T===In.POLYLINE||O||P);M&&(t.globalAlpha=c*h,C||zv(n,t,A),Gv(t,n,o,s,r,i,a,this.imagePool),C||this.clearShadowAndFilter(t,N,A)),S&&(t.globalAlpha=c*v,t.lineWidth=g,ue(k)||(t.miterLimit=k),ue(y)||(t.lineCap=y),ue(m)||(t.lineJoin=m),C&&(P&&(t.globalCompositeOperation="source-atop"),zv(n,t,!0),P&&(Vv(t,n,d,r,i,a,this.imagePool),t.globalCompositeOperation=Iv.globalCompositeOperation,this.clearShadowAndFilter(t,N,!0))),Vv(t,n,d,r,i,a,this.imagePool))}},{key:"clearShadowAndFilter",value:function(t,e,n){if(n&&(t.shadowColor="transparent",t.shadowBlur=0),e){var r=t.filter;!ue(r)&&r.indexOf("drop-shadow")>-1&&(t.filter=r.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}}}])}(function(){return Mf((function t(e){Sf(this,t),this.imagePool=e}),[{key:"applyAttributesToContext",value:function(t,e){}},{key:"render",value:function(t,e,n,r,i,a){}},{key:"applyCommonStyleToContext",value:function(t,e,n,r){var i=n?jv:r.prevObject.parsedStyle,a=e.parsedStyle;(n||a.opacity!==i.opacity)&&Fv(t,"globalAlpha",ue(a.opacity)?Iv.globalAlpha:a.opacity,r.currentContext),(n||a.blend!==i.blend)&&Fv(t,"globalCompositeOperation",ue(a.blend)?Iv.globalCompositeOperation:a.blend,r.currentContext)}},{key:"applyStrokeFillStyleToContext",value:function(t,e,n,r){var i=n?jv:r.prevObject.parsedStyle,a=e.parsedStyle,o=a.lineWidth,s=void 0===o?Iv.lineWidth:o,u=a.fill&&!a.fill.isNone;if(a.stroke&&!a.stroke.isNone&&s>0){(n||e.attributes.stroke!==r.prevObject.attributes.stroke)&&Fv(t,"strokeStyle",ue(a.stroke)||Array.isArray(a.stroke)||a.stroke.isNone?Iv.strokeStyle:e.attributes.stroke,r.currentContext),(n||a.lineWidth!==i.lineWidth)&&Fv(t,"lineWidth",ue(a.lineWidth)?Iv.lineWidth:a.lineWidth,r.currentContext),(n||a.lineDash!==i.lineDash)&&Fv(t,"lineDash",a.lineDash||Iv.lineDash,r.currentContext),(n||a.lineDashOffset!==i.lineDashOffset)&&Fv(t,"lineDashOffset",ue(a.lineDashOffset)?Iv.lineDashOffset:a.lineDashOffset,r.currentContext);for(var c=0;c<_v.length;c++){var l=_v[c];(n||a[l]!==i[l])&&Fv(t,l,ue(a[l])?Iv[l]:a[l],r.currentContext)}}u&&(n||e.attributes.fill!==r.prevObject.attributes.fill)&&Fv(t,"fillStyle",ue(a.fill)||Array.isArray(a.fill)||a.fill.isNone?Iv.fillStyle:e.attributes.fill,r.currentContext)}},{key:"applyStyleToContext",value:function(t,e,n,r){var i=e.nodeName;this.applyCommonStyleToContext(t,e,n,r),i===In.IMAGE||this.applyStrokeFillStyleToContext(t,e,n,r)}},{key:"applyShadowAndFilterStyleToContext",value:function(t,e,n,r){var i=e.parsedStyle;if(n){Fv(t,"shadowColor",i.shadowColor.toString(),r.currentContext);for(var a=0;a<Dv.length;a++){var o=Dv[a];Fv(t,o,i[o]||Iv[o],r.currentContext)}}i.filter&&i.filter.length&&Fv(t,"filter",e.attributes.filter,r.currentContext)}},{key:"clearShadowAndFilterStyleForContext",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(e){Fv(t,"shadowColor",Iv.shadowColor,r.currentContext);for(var a=0;a<Dv.length;a++){var o=Dv[a];Fv(t,o,Iv[o],r.currentContext)}}if(n)if(e&&i){var s=t.filter;!ue(s)&&s.indexOf("drop-shadow")>-1&&Fv(t,"filter",s.replace(/drop-shadow\([^)]*\)/,"").trim()||Iv.filter,r.currentContext)}else Fv(t,"filter",Iv.filter,r.currentContext)}},{key:"fillToContext",value:function(t,e,n,r,i){var a=this,o=e.parsedStyle,s=o.fill,u=o.fillRule,c=null;if(Array.isArray(s)&&s.length>0)s.forEach((function(r){var i=Fv(t,"fillStyle",Lv(r,e,t,a.imagePool),n.currentContext);c=null!=c?c:i,u?t.fill(u):t.fill()}));else{if(Fi(s)){var l=Rv(s,e,t,e.ownerDocument.defaultView.context,r,i,this.imagePool);l&&(t.fillStyle=l,c=!0)}u?t.fill(u):t.fill()}null!==c&&Fv(t,"fillStyle",c,n.currentContext)}},{key:"strokeToContext",value:function(t,e,n,r,i){var a=this,o=e.parsedStyle.stroke,s=null;if(Array.isArray(o)&&o.length>0)o.forEach((function(r){var i=Fv(t,"strokeStyle",Lv(r,e,t,a.imagePool),n.currentContext);s=null!=s?s:i,t.stroke()}));else{if(Fi(o)){var u=Rv(o,e,t,e.ownerDocument.defaultView.context,r,i,this.imagePool);if(u){var c=Fv(t,"strokeStyle",u,n.currentContext);s=null!=s?s:c}}t.stroke()}null!==s&&Fv(t,"strokeStyle",s,n.currentContext)}},{key:"drawToContext",value:function(t,e,n,r,i){var a,o=e.nodeName,s=e.parsedStyle,u=s.opacity,c=void 0===u?Iv.globalAlpha:u,l=s.fillOpacity,h=void 0===l?Iv.fillOpacity:l,d=s.strokeOpacity,f=void 0===d?Iv.strokeOpacity:d,v=s.lineWidth,p=void 0===v?Iv.lineWidth:v,g=s.fill&&!s.fill.isNone,y=s.stroke&&!s.stroke.isNone&&p>0;if(g||y){var m=!ue(s.shadowColor)&&s.shadowBlur>0,b="inner"===s.shadowType,x=0===(null===(a=s.fill)||void 0===a?void 0:a.alpha),w=!(!s.filter||!s.filter.length),E=m&&y&&(o===In.PATH||o===In.LINE||o===In.POLYLINE||x||b),k=null;if(g&&(E||this.applyShadowAndFilterStyleToContext(t,e,m,n),k=Fv(t,"globalAlpha",c*h,n.currentContext),this.fillToContext(t,e,n,r,i),E||this.clearShadowAndFilterStyleForContext(t,m,w,n)),y){var M=!1,S=Fv(t,"globalAlpha",c*f,n.currentContext);if(k=g?k:S,E&&(this.applyShadowAndFilterStyleToContext(t,e,m,n),M=!0,b)){var O=t.globalCompositeOperation;t.globalCompositeOperation="source-atop",this.strokeToContext(t,e,n,r,i),t.globalCompositeOperation=O,this.clearShadowAndFilterStyleForContext(t,m,w,n,!0)}this.strokeToContext(t,e,n,r,i),M&&this.clearShadowAndFilterStyleForContext(t,m,w,n)}null!==k&&Fv(t,"globalAlpha",k,n.currentContext)}}}])}());function zv(t,e,n){var r=t.parsedStyle,i=r.filter,a=r.shadowColor,o=r.shadowBlur,s=r.shadowOffsetX,u=r.shadowOffsetY;i&&i.length&&(e.filter=t.style.filter),n&&(e.shadowColor=a.toString(),e.shadowBlur=o||0,e.shadowOffsetX=s||0,e.shadowOffsetY=u||0)}function Gv(t,e,n,r,i,a,o,s){var u=arguments.length>8&&void 0!==arguments[8]&&arguments[8];Array.isArray(n)?n.forEach((function(n){t.fillStyle=Lv(n,e,t,s),u||(r?t.fill(r):t.fill())})):(Fi(n)&&(t.fillStyle=Rv(n,e,t,i,a,o,s)),u||(r?t.fill(r):t.fill()))}function Vv(t,e,n,r,i,a,o){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];Array.isArray(n)?n.forEach((function(n){t.strokeStyle=Lv(n,e,t,o),s||t.stroke()})):(Fi(n)&&(t.strokeStyle=Rv(n,e,t,r,i,a,o)),s||t.stroke())}var Wv=function(t){function e(){return Sf(this,e),Af(this,e,arguments)}return Pf(e,t),Mf(e,[{key:"renderDownSampled",value:function(t,e,n,r){var i=r.src,a=r.imageCache;a.downSampled?t.drawImage(a.downSampled,Math.floor(r.drawRect[0]),Math.floor(r.drawRect[1]),Math.ceil(r.drawRect[2]),Math.ceil(r.drawRect[3])):this.imagePool.createDownSampledImage(i,n).then((function(){n.ownerDocument&&(n.renderable.dirty=!0,n.ownerDocument.defaultView.context.renderingService.dirtify())})).catch((function(t){console.error(t)}))}},{key:"renderTile",value:function(t,e,n,r){var i=r.src,a=r.imageCache,o=r.imageRect,s=r.drawRect,u=a.size,c=t.getTransform(),l=c.a,h=c.b,d=c.c,f=c.d,v=c.e,p=c.f;if(t.resetTransform(),null!=a&&a.gridSize){for(var g=[u[0]/o[2],u[1]/o[3]],y=[a.tileSize[0]/g[0],a.tileSize[1]/g[1]],m=[Math.floor((s[0]-o[0])/y[0]),Math.ceil((s[0]+s[2]-o[0])/y[0])],b=m[0],x=m[1],w=[Math.floor((s[1]-o[1])/y[1]),Math.ceil((s[1]+s[3]-o[1])/y[1])],E=w[1],k=w[0];k<=E;k++)for(var M=b;M<=x;M++){var S=a.tiles[k][M];if(S){var O=[Math.floor(o[0]+S.tileX*y[0]),Math.floor(o[1]+S.tileY*y[1]),Math.ceil(y[0]),Math.ceil(y[1])];t.drawImage(S.data,O[0],O[1],O[2],O[3])}}t.setTransform(l,h,d,f,v,p)}else this.imagePool.createImageTiles(i,[],(function(){n.ownerDocument&&(n.renderable.dirty=!0,n.ownerDocument.defaultView.context.renderingService.dirtify())}),n).catch((function(t){console.error(t)}))}},{key:"render",value:function(t,n,r){var i=n.x,a=void 0===i?0:i,o=n.y,s=void 0===o?0:o,u=n.width,c=n.height,l=n.src,h=n.shadowColor,d=n.shadowBlur,f=this.imagePool.getImageSync(l,r),v=null==f?void 0:f.img,p=u,g=c;if(v){var y,m,b,x,w,E,k,M,S,O,N,A,T,P,R;p||(p=v.width),g||(g=v.height),zv(r,t,!ue(h)&&d>0);try{var L=r.ownerDocument.defaultView.getContextService().getDomElement(),D=L.width,_=L.height,I=t.getTransform(),j=I.a,F=I.b,B=function(t,e){var n=W(C(),[t[0],t[1],0],e),r=W(C(),[t[0]+t[2],t[1],0],e),i=W(C(),[t[0],t[1]+t[3],0],e),a=W(C(),[t[0]+t[2],t[1]+t[3],0],e);return[Math.min(n[0],r[0],i[0],a[0]),Math.min(n[1],r[1],i[1],a[1]),Math.max(n[0],r[0],i[0],a[0])-Math.min(n[0],r[0],i[0],a[0]),Math.max(n[1],r[1],i[1],a[1])-Math.min(n[1],r[1],i[1],a[1])]}([a,s,p,g],tt(j,I.c,0,0,F,I.d,0,0,0,0,1,0,I.e,I.f,0,1)),z=(y=B,b=(m=Df([0,0,D,_],4))[0],x=m[1],w=m[2],E=m[3],M=(k=Df(y,4))[0],S=k[1],O=k[2],N=k[3],A=Math.max(b,M),T=Math.max(x,S),P=Math.min(b+w,M+O),R=Math.min(x+E,S+N),P<=A||R<=T?null:[A,T,P-A,R-T]);if(!z)return;if(!r.ownerDocument.defaultView.getConfig().enableLargeImageOptimization)return void e.renderFull(t,n,r,{image:v,drawRect:[a,s,p,g]});if(B[2]/f.size[0]<(f.downSamplingRate||.5))return void this.renderDownSampled(t,n,r,{src:l,imageCache:f,drawRect:[a,s,p,g]});if(!Ov.isSupportTile)return void e.renderFull(t,n,r,{image:v,drawRect:[a,s,p,g]});this.renderTile(t,n,r,{src:l,imageCache:f,imageRect:B,drawRect:z})}catch(t){}}}},{key:"drawToContext",value:function(t,e,n,r,i){this.render(t,e.parsedStyle,e)}}],[{key:"renderFull",value:function(t,e,n,r){t.drawImage(r.image,Math.floor(r.drawRect[0]),Math.floor(r.drawRect[1]),Math.ceil(r.drawRect[2]),Math.ceil(r.drawRect[3]))}}])}(Bv),Hv=function(t){function e(){return Sf(this,e),Af(this,e,arguments)}return Pf(e,t),Mf(e,[{key:"render",value:function(t,e,n,r,i,a){n.getBounds();var o=e.lineWidth,s=void 0===o?1:o,u=e.textAlign,c=void 0===u?"start":u,l=e.textBaseline,h=void 0===l?"alphabetic":l,d=e.lineJoin,f=void 0===d?"miter":d,v=e.miterLimit,p=void 0===v?10:v,g=e.letterSpacing,y=void 0===g?0:g,m=e.stroke,b=e.fill,x=e.fillRule,w=e.fillOpacity,E=void 0===w?1:w,k=e.strokeOpacity,M=void 0===k?1:k,S=e.opacity,O=void 0===S?1:S,N=e.metrics,A=e.x,T=void 0===A?0:A,P=e.y,C=void 0===P?0:P,R=e.dx,L=e.dy,D=e.shadowColor,_=e.shadowBlur,I=N.font,j=N.lines,F=N.height,B=N.lineHeight,z=N.lineMetrics;t.font=I,t.lineWidth=s,t.textAlign="middle"===c?"center":c;var G=h;"alphabetic"===G&&(G="bottom"),t.lineJoin=f,ue(p)||(t.miterLimit=p);var V=C;"middle"===h?V+=-F/2-B/2:"bottom"===h||"alphabetic"===h||"ideographic"===h?V+=-F:"top"!==h&&"hanging"!==h||(V+=-B);var W=T+(R||0);V+=L||0,1===j.length&&("bottom"===G?(G="middle",V-=.5*F):"top"===G&&(G="middle",V+=.5*F)),t.textBaseline=G,zv(n,t,!ue(D)&&_>0);for(var H=0;H<j.length;H++){var Y=s/2+W;V+=B,ue(m)||m.isNone||!s||this.drawLetterSpacing(t,n,j[H],z[H],c,Y,V,y,b,x,E,m,M,O,!0,r,i,a),ue(b)||this.drawLetterSpacing(t,n,j[H],z[H],c,Y,V,y,b,x,E,m,M,O,!1,r,i,a)}}},{key:"drawLetterSpacing",value:function(t,e,n,r,i,a,o,s,u,c,l,h,d,f,v,p,g,y){if(0!==s){var m=t.textAlign;t.textAlign="left";var b=a;"center"===i||"middle"===i?b=a-r.width/2:"right"!==i&&"end"!==i||(b=a-r.width);for(var x=Array.from(n),w=t.measureText(n).width,E=0,k=0;k<x.length;++k){var M=x[k];v?this.strokeText(t,e,M,b,o,h,d,p,g,y):this.fillText(t,e,M,b,o,u,c,l,f,p,g,y),b+=w-(E=t.measureText(n.substring(k+1)).width)+s,w=E}t.textAlign=m}else v?this.strokeText(t,e,n,a,o,h,d,p,g,y):this.fillText(t,e,n,a,o,u,c,l,f,p,g,y)}},{key:"fillText",value:function(t,e,n,r,i,a,o,s,u,c,l,h){var d;Gv(t,e,a,o,c,l,h,this.imagePool,!0);var f=!ue(s)&&1!==s;f&&(d=t.globalAlpha,t.globalAlpha=s*u),t.fillText(n,r,i),f&&(t.globalAlpha=d)}},{key:"strokeText",value:function(t,e,n,r,i,a,o,s,u,c){var l;Vv(t,e,a,s,u,c,this.imagePool,!0);var h=!ue(o)&&1!==o;h&&(l=t.globalAlpha,t.globalAlpha=o),t.strokeText(n,r,i),h&&(t.globalAlpha=l)}},{key:"drawToContext",value:function(t,e,n,r,i){this.render(t,e.parsedStyle,e,e.ownerDocument.defaultView.context,r,i)}}])}(Bv),Yv=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Sf(this,e),(t=Af(this,e)).name="canvas-renderer",t.options=n,t}return Pf(e,t),Mf(e,[{key:"init",value:function(){var t,e=qf({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),n=this.context.imagePool,r=new Bv(n),i=(Cf(Cf(Cf(Cf(Cf(Cf(Cf(Cf(Cf(Cf(t={},In.CIRCLE,r),In.ELLIPSE,r),In.RECT,r),In.IMAGE,new Wv(n)),In.TEXT,new Hv(n)),In.LINE,r),In.POLYLINE,r),In.POLYGON,r),In.PATH,r),In.GROUP,void 0),Cf(Cf(Cf(t,In.HTML,void 0),In.MESH,void 0),In.FRAGMENT,void 0));this.context.defaultStyleRendererFactory=i,this.context.styleRendererFactory=i,this.addRenderingPlugin(new Cv(e))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory}}])}(Fn),Uv=function(){function t(){Sf(this,t)}return Mf(t,[{key:"apply",value:function(e,n){var r=this,i=e.renderingService,a=e.renderingContext,o=e.config;this.context=e;var s=a.root.ownerDocument.defaultView,u=function(t){i.hooks.pointerMove.call(t)},c=function(t){i.hooks.pointerUp.call(t)},l=function(t){i.hooks.pointerDown.call(t)},h=function(t){i.hooks.pointerOver.call(t)},d=function(t){i.hooks.pointerOut.call(t)},f=function(t){i.hooks.pointerCancel.call(t)},v=function(t){i.hooks.pointerWheel.call(t)},p=function(t){i.hooks.click.call(t)};i.hooks.init.tap(t.tag,(function(){var t=r.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(t.style.msContentZooming="none",t.style.msTouchAction="none"):s.supportsPointerEvents&&(t.style.touchAction="none"),s.supportsPointerEvents?function(t){n.globalThis.document.addEventListener("pointermove",u,!0),t.addEventListener("pointerdown",l,!0),t.addEventListener("pointerleave",d,!0),t.addEventListener("pointerover",h,!0),n.globalThis.addEventListener("pointerup",c,!0),n.globalThis.addEventListener("pointercancel",f,!0)}(t):function(t){n.globalThis.document.addEventListener("mousemove",u,!0),t.addEventListener("mousedown",l,!0),t.addEventListener("mouseout",d,!0),t.addEventListener("mouseover",h,!0),n.globalThis.addEventListener("mouseup",c,!0)}(t),s.supportsTouchEvents&&function(t){t.addEventListener("touchstart",l,!0),t.addEventListener("touchend",c,!0),t.addEventListener("touchmove",u,!0),t.addEventListener("touchcancel",f,!0)}(t),o.useNativeClickEvent&&t.addEventListener("click",p,!0),t.addEventListener("wheel",v,{passive:!0,capture:!0})})),i.hooks.destroy.tap(t.tag,(function(){var t=r.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(t.style.msContentZooming="",t.style.msTouchAction=""):s.supportsPointerEvents&&(t.style.touchAction=""),s.supportsPointerEvents?function(t){n.globalThis.document.removeEventListener("pointermove",u,!0),t.removeEventListener("pointerdown",l,!0),t.removeEventListener("pointerleave",d,!0),t.removeEventListener("pointerover",h,!0),n.globalThis.removeEventListener("pointerup",c,!0),n.globalThis.removeEventListener("pointercancel",f,!0)}(t):function(t){n.globalThis.document.removeEventListener("mousemove",u,!0),t.removeEventListener("mousedown",l,!0),t.removeEventListener("mouseout",d,!0),t.removeEventListener("mouseover",h,!0),n.globalThis.removeEventListener("mouseup",c,!0)}(t),s.supportsTouchEvents&&function(t){t.removeEventListener("touchstart",l,!0),t.removeEventListener("touchend",c,!0),t.removeEventListener("touchmove",u,!0),t.removeEventListener("touchcancel",f,!0)}(t),o.useNativeClickEvent&&t.removeEventListener("click",p,!0),t.removeEventListener("wheel",v,!0)}))}}])}();Uv.tag="DOMInteraction";var qv=function(t){function e(){var t;Sf(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=Af(this,e,[].concat(r))).name="dom-interaction",t}return Pf(e,t),Mf(e,[{key:"init",value:function(){this.addRenderingPlugin(new Uv)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(Fn),Xv=function(){function t(){Sf(this,t),this.displayObjectHTMLElementMap=new WeakMap}return Mf(t,[{key:"joinTransformMatrix",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return"matrix(".concat([t[0],t[1],t[4],t[5],t[12]+e[0],t[13]+e[1]].join(","),")")}},{key:"apply",value:function(e,n){var r=this,i=e.camera,a=e.renderingContext,o=e.renderingService;this.context=e;var s=a.root.ownerDocument.defaultView,u=s.context.eventService.nativeHTMLMap,c=function(t,e){e.style.transform=r.joinTransformMatrix(t.getWorldTransform(),t.getOrigin())},l=function(t){var e=t.target;if(e.nodeName===In.HTML){r.$camera||(r.$camera=r.createCamera(i));var n=r.getOrCreateEl(e);r.$camera.appendChild(n),Object.keys(e.attributes).forEach((function(t){r.updateAttribute(t,e)})),c(e,n),u.set(n,e)}},h=function(t){var e=t.target;if(e.nodeName===In.HTML&&r.$camera){var n=r.getOrCreateEl(e);n&&(n.remove(),u.delete(n))}},d=function(t){var e=t.target;if(e.nodeName===In.HTML){var n=t.attrName;r.updateAttribute(n,e)}},f=function(t){var e=t.target;(e.nodeName===In.FRAGMENT?e.childNodes:[e]).forEach((function(t){if(t.nodeName===In.HTML){var e=r.getOrCreateEl(t);c(t,e)}}))},v=function(){if(r.$camera){var t=r.context.config,e=t.width,n=t.height;r.$camera.parentElement.style.width="".concat(e||0,"px"),r.$camera.parentElement.style.height="".concat(n||0,"px")}};o.hooks.init.tap(t.tag,(function(){s.addEventListener(Iu.RESIZE,v),s.addEventListener(bs.MOUNTED,l),s.addEventListener(bs.UNMOUNTED,h),s.addEventListener(bs.ATTR_MODIFIED,d),s.addEventListener(bs.BOUNDS_CHANGED,f)})),o.hooks.endFrame.tap(t.tag,(function(){r.$camera&&a.renderReasons.has(ps.CAMERA_CHANGED)&&(r.$camera.style.transform=r.joinTransformMatrix(i.getOrthoMatrix()))})),o.hooks.destroy.tap(t.tag,(function(){r.$camera&&r.$camera.remove(),s.removeEventListener(Iu.RESIZE,v),s.removeEventListener(bs.MOUNTED,l),s.removeEventListener(bs.UNMOUNTED,h),s.removeEventListener(bs.ATTR_MODIFIED,d),s.removeEventListener(bs.BOUNDS_CHANGED,f)}))}},{key:"createCamera",value:function(t){var e=this.context.config,n=e.document,r=e.width,i=e.height,a=this.context.contextService.getDomElement(),o=a.parentNode;if(o){var s="g-canvas-camera",u=o.querySelector("#".concat(s));if(!u){var c=(n||document).createElement("div");c.style.overflow="hidden",c.style.pointerEvents="none",c.style.position="absolute",c.style.left="0px",c.style.top="0px",c.style.width="".concat(r||0,"px"),c.style.height="".concat(i||0,"px");var l=(n||document).createElement("div");u=l,l.id=s,l.style.position="absolute",l.style.left="".concat(a.offsetLeft||0,"px"),l.style.top="".concat(a.offsetTop||0,"px"),l.style.transformOrigin="left top",l.style.transform=this.joinTransformMatrix(t.getOrthoMatrix()),l.style.pointerEvents="none",l.style.width="100%",l.style.height="100%",c.appendChild(l),o.appendChild(c)}return u}return null}},{key:"getOrCreateEl",value:function(t){var e=this.context.config.document,n=this.displayObjectHTMLElementMap.get(t);return n||(n=(e||document).createElement("div"),t.parsedStyle.$el=n,this.displayObjectHTMLElementMap.set(t,n),t.id&&(n.id=t.id),t.name&&n.setAttribute("name",t.name),t.className&&(n.className=t.className),n.style.position="absolute",n.style["will-change"]="transform",n.style.transform=this.joinTransformMatrix(t.getWorldTransform(),t.getOrigin())),n}},{key:"updateAttribute",value:function(t,e){var n=this.getOrCreateEl(e);switch(t){case"innerHTML":var r=e.parsedStyle.innerHTML;ce(r)?n.innerHTML=r:(n.innerHTML="",n.appendChild(r));break;case"x":n.style.left="".concat(e.parsedStyle.x,"px");break;case"y":n.style.top="".concat(e.parsedStyle.y,"px");break;case"transformOrigin":var i=e.parsedStyle.transformOrigin;n.style["transform-origin"]="".concat(i[0].buildCSSText(null,null,"")," ").concat(i[1].buildCSSText(null,null,""));break;case"width":var a=e.parsedStyle.width;n.style.width=oe(a)?"".concat(a,"px"):a.toString();break;case"height":var o=e.parsedStyle.height;n.style.height=oe(o)?"".concat(o,"px"):o.toString();break;case"zIndex":var s=e.parsedStyle.zIndex;n.style["z-index"]="".concat(s);break;case"visibility":var u=e.parsedStyle.visibility;n.style.visibility=u;break;case"pointerEvents":var c=e.parsedStyle.pointerEvents,l=void 0===c?"auto":c;n.style.pointerEvents=l;break;case"opacity":var h=e.parsedStyle.opacity;n.style.opacity="".concat(h);break;case"fill":var d=e.parsedStyle.fill,f="";Bi(d)?f=d.isNone?"transparent":e.getAttribute("fill"):Array.isArray(d)?f=e.getAttribute("fill"):Fi(d),n.style.background=f;break;case"stroke":var v=e.parsedStyle.stroke,p="";Bi(v)?p=v.isNone?"transparent":e.getAttribute("stroke"):Array.isArray(v)?p=e.getAttribute("stroke"):Fi(v),n.style["border-color"]=p,n.style["border-style"]="solid";break;case"lineWidth":var g=e.parsedStyle.lineWidth;n.style["border-width"]="".concat(g||0,"px");break;case"lineDash":n.style["border-style"]="dashed";break;case"filter":var y=e.style.filter;n.style.filter=y;break;default:ue(e.style[t])||""===e.style[t]||(n.style[t]=e.style[t])}}}])}();Xv.tag="HTMLRendering";var Kv=function(t){function e(){var t;Sf(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=Af(this,e,[].concat(r))).name="html-renderer",t}return Pf(e,t),Mf(e,[{key:"init",value:function(){this.addRenderingPlugin(new Xv)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(Fn),$v=function(){return Mf((function t(e){Sf(this,t),this.renderingContext=e.renderingContext,this.canvasConfig=e.config}),[{key:"init",value:function(){var t=this.canvasConfig,e=t.container,n=t.canvas;if(n)this.$canvas=n,e&&n.parentElement!==e&&e.appendChild(n),this.$container=n.parentElement,this.canvasConfig.container=this.$container;else if(e&&(this.$container=ce(e)?document.getElementById(e):e,this.$container)){var r=document.createElement("canvas");this.$container.appendChild(r),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=r}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)}},{key:"getContext",value:function(){return this.context}},{key:"getDomElement",value:function(){return this.$canvas}},{key:"getDPR",value:function(){return this.dpr}},{key:"getBoundingClientRect",value:function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()}},{key:"destroy",value:function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)}},{key:"resize",value:function(t,e){var n=this.canvasConfig.devicePixelRatio;this.dpr=n,this.$canvas&&(this.$canvas.width=this.dpr*t,this.$canvas.height=this.dpr*e,function(t,e,n){fo&&t.style&&(t.style.width=e+"px",t.style.height=n+"px")}(this.$canvas,t,e)),this.renderingContext.renderReasons.add(ps.CAMERA_CHANGED)}},{key:"applyCursorStyle",value:function(t){this.$container&&this.$container.style&&(this.$container.style.cursor=t)}},{key:"toDataURL",value:(t=Yf(Wf().mark((function t(){var e,n,r,i=arguments;return Wf().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(e=i.length>0&&void 0!==i[0]?i[0]:{}).type,r=e.encoderOptions,t.abrupt("return",this.context.canvas.toDataURL(n,r));case 3:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})}]);var t}(),Zv=function(t){function e(){var t;Sf(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=Af(this,e,[].concat(r))).name="canvas-context-register",t}return Pf(e,t),Mf(e,[{key:"init",value:function(){this.context.ContextService=$v}},{key:"destroy",value:function(){delete this.context.ContextService}}])}(Fn),Qv=function(t){function e(t){var n;return Sf(this,e),(n=Af(this,e,[t])).registerPlugin(new Zv),n.registerPlugin(new Tv),n.registerPlugin(new Vf),n.registerPlugin(new Yv),n.registerPlugin(new qv),n.registerPlugin(new yv),n.registerPlugin(new Kv),n}return Pf(e,t),Mf(e)}(Bn);const Jv=function(t,e){if(t)if(He(t))for(var n=0,r=t.length;n<r&&!1!==e(t[n],n);n++);else if(ln(t))for(var i in t)if(t.hasOwnProperty(i)&&!1===e(t[i],i))break};var tp=Object.prototype.hasOwnProperty;const ep=function(t,e){if(null===t||!Dh(t))return{};var n={};return Jv(e,(function(e){tp.call(t,e)&&(n[e]=t[e])})),n};var np=function(t){function e(t){var n;return y(this,e),(n=S(this,e,[Object.assign(Object.assign({},t),{style:Object.assign({},e.defaultStyleProps,t.style)})])).rootPointerEvent=new ss(null),n.forwardEvents=function(t){var e=n.context.canvas,r=e.context.renderingContext.root.ownerDocument.defaultView;n.normalizeToPointerEvent(t,r).forEach((function(i){var a=n.bootstrapEvent(n.rootPointerEvent,i,r,t);Cd(e.context.eventService,"mappingTable.pointerupoutside",[]),e.context.eventService.mapEvent(a)}))},n}return N(e,t),b(e,[{key:"eventService",get:function(){return this.context.canvas.context.eventService}},{key:"events",get:function(){return[qc.CLICK,qc.POINTER_DOWN,qc.POINTER_MOVE,qc.POINTER_UP,qc.POINTER_OVER,qc.POINTER_LEAVE]}},{key:"getDomElement",value:function(){return this.getShape("key").getDomElement()}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parsedAttributes,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.drawKeyShape(t,e),this.drawPortShapes(t,e)}},{key:"getKeyStyle",value:function(t){var e=ep(t,["dx","dy","innerHTML","pointerEvents","cursor"]),n=e.dx,r=void 0===n?0:n,i=e.dy,a=void 0===i?0:i,o=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(e,["dx","dy"]),s=h(this.getSize(t),2),u=s[0],c=s[1];return Object.assign(Object.assign({x:r,y:a},o),{width:u,height:c})}},{key:"drawKeyShape",value:function(t,e){var n=this.getKeyStyle(t),r=n.x,i=n.y,a=n.width,o=void 0===a?0:a,s=n.height,u=void 0===s?0:s,c=this.upsert("key-container",Ou,{x:r,y:i,width:o,height:u,opacity:0},e);return this.upsert("key",gu,n,c)}},{key:"connectedCallback",value:function(){var t=this;if(this.context.canvas.getRenderer("main")instanceof Qv){var e=this.getDomElement();this.events.forEach((function(n){e.addEventListener(n,t.forwardEvents)}))}}},{key:"attributeChangedCallback",value:function(t,e,n){"zIndex"===t&&e!==n&&(this.getDomElement().style.zIndex=n)}},{key:"destroy",value:function(){var t=this,n=this.getDomElement();this.events.forEach((function(e){n.removeEventListener(e,t.forwardEvents)})),dn(e,"destroy",this,3)([])}},{key:"normalizeToPointerEvent",value:function(t,e){var n=[];if(e.isTouchEvent(t))for(var r=0;r<t.changedTouches.length;r++){var i=t.changedTouches[r];an(i.button)&&(i.button=0),an(i.buttons)&&(i.buttons=1),an(i.isPrimary)&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),an(i.width)&&(i.width=i.radiusX||1),an(i.height)&&(i.height=i.radiusY||1),an(i.tiltX)&&(i.tiltX=0),an(i.tiltY)&&(i.tiltY=0),an(i.pointerType)&&(i.pointerType="touch"),an(i.pointerId)&&(i.pointerId=i.identifier||0),an(i.pressure)&&(i.pressure=i.force||.5),an(i.twist)&&(i.twist=0),an(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=t.type,n.push(i)}else if(e.isMouseEvent(t)){var a=t;an(a.isPrimary)&&(a.isPrimary=!0),an(a.width)&&(a.width=1),an(a.height)&&(a.height=1),an(a.tiltX)&&(a.tiltX=0),an(a.tiltY)&&(a.tiltY=0),an(a.pointerType)&&(a.pointerType="mouse"),an(a.pointerId)&&(a.pointerId=1),an(a.pressure)&&(a.pressure=.5),an(a.twist)&&(a.twist=0),an(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,n.push(a)}else n.push(t);return n}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null}},{key:"bootstrapEvent",value:function(t,e,n,r){t.view=n,t.originalEvent=null,t.nativeEvent=r,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var i=this.getViewportXY(e),a=i.x,o=i.y;t.viewport.x=a,t.viewport.y=o;var s=h(this.context.canvas.getCanvasByViewport([a,o]),2),u=s[0],c=s[1];return t.canvas.x=u,t.canvas.y=c,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=r.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t}},{key:"getViewportXY",value:function(t){var e,n,r=t.offsetX,i=t.offsetY,a=t.clientX,o=t.clientY;if(ue(r)||ue(i)){var s=this.eventService.client2Viewport({x:a,y:o});e=s.x,n=s.y}else e=r,n=i;return{x:e,y:n}}},{key:"onframe",value:function(){dn(e,"onframe",this,3)([]);var t=this.attributes.opacity;this.getDomElement().style.opacity="".concat(t)}}])}(df);np.defaultStyleProps={size:[160,80],halo:!1,icon:!1,label:!1,pointerEvents:"auto"};var rp=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},ip=function(t){function e(t){return y(this,e),S(this,e,[Bd({style:e.defaultStyleProps},t)])}return N(e,t),b(e,[{key:"getKeyStyle",value:function(t){var n=h(this.getSize(t),2),r=n[0],i=n[1],a=dn(e,"getKeyStyle",this,3)([t]),o=a.fillOpacity,s=a.opacity,u=void 0===s?o:s,c=rp(a,["fillOpacity","opacity"]);return Object.assign(Object.assign({opacity:u},c),{width:r,height:i,x:-r/2,y:-i/2})}},{key:"getHaloStyle",value:function(t){if(!1===t.halo)return!1;var e=this.getShape("key").attributes,n=(e.fill,e.stroke,rp(e,["fill","stroke"]),Dd(this.getGraphicStyle(t),"halo")),r=Number(n.lineWidth),i=h(Bh(this.getSize(t),[r,r]),2),a=i[0],o=i[1];return Object.assign(Object.assign({},n),{width:a,height:o,fill:"transparent",x:-a/2,y:-o/2})}},{key:"getIconStyle",value:function(t){var n=dn(e,"getIconStyle",this,3)([t]),r=h(this.getSize(t),2),i=r[0],a=r[1];return!!n&&Object.assign({width:i*wd,height:a*wd},n)}},{key:"drawKeyShape",value:function(t,e){var n=this.upsert("key",rf,this.getKeyStyle(t),e);return sf(this),n}},{key:"drawHaloShape",value:function(t,e){this.upsert("halo",Ou,this.getHaloStyle(t),e)}},{key:"update",value:function(t){dn(e,"update",this,3)([t]),t&&("x"in t||"y"in t||"z"in t)&&uf(this)}}])}(df);ip.defaultStyleProps={size:32};var ap=function(t){function e(t){return y(this,e),S(this,e,[t])}return N(e,t),b(e,[{key:"getKeyStyle",value:function(t){var n=h(this.getSize(t),2),r=n[0],i=n[1];return Object.assign(Object.assign({},dn(e,"getKeyStyle",this,3)([t])),{width:r,height:i,x:-r/2,y:-i/2})}},{key:"getIconStyle",value:function(t){var n=dn(e,"getIconStyle",this,3)([t]),r=this.getShape("key").attributes,i=r.width,a=r.height;return!!n&&Object.assign({width:i*wd,height:a*wd},n)}},{key:"drawKeyShape",value:function(t,e){return this.upsert("key",Ou,this.getKeyStyle(t),e)}}])}(df),op=function(t){function e(t){return y(this,e),S(this,e,[t])}return N(e,t),b(e,[{key:"getInnerR",value:function(t){return t.innerR||3*this.getOuterR(t)/8}},{key:"getOuterR",value:function(t){return Math.min.apply(Math,w(this.getSize(t)))/2}},{key:"getPoints",value:function(t){return[[0,-(e=this.getOuterR(t))],[(n=this.getInnerR(t))*Math.cos(3*Math.PI/10),-n*Math.sin(3*Math.PI/10)],[e*Math.cos(Math.PI/10),-e*Math.sin(Math.PI/10)],[n*Math.cos(Math.PI/10),n*Math.sin(Math.PI/10)],[e*Math.cos(3*Math.PI/10),e*Math.sin(3*Math.PI/10)],[0,n],[-e*Math.cos(3*Math.PI/10),e*Math.sin(3*Math.PI/10)],[-n*Math.cos(Math.PI/10),n*Math.sin(Math.PI/10)],[-e*Math.cos(Math.PI/10),-e*Math.sin(Math.PI/10)],[-n*Math.cos(3*Math.PI/10),-n*Math.sin(3*Math.PI/10)]];var e,n}},{key:"getIconStyle",value:function(t){var n=dn(e,"getIconStyle",this,3)([t]),r=2*this.getInnerR(t)*wd;return!!n&&Object.assign({width:r,height:r},n)}},{key:"getPortXY",value:function(t,e){var n,r,i,a=e.placement,o=void 0===a?"top":a;return cg(this.getShape("key").getLocalBounds(),o,(n=this.getOuterR(t),r=this.getInnerR(t),(i={}).top=[0,-n],i.left=[-n*Math.cos(Math.PI/10),-n*Math.sin(Math.PI/10)],i["left-bottom"]=[-n*Math.cos(3*Math.PI/10),n*Math.sin(3*Math.PI/10)],i.bottom=[0,r],i["right-bottom"]=[n*Math.cos(3*Math.PI/10),n*Math.sin(3*Math.PI/10)],i.right=i.default=[n*Math.cos(Math.PI/10),-n*Math.sin(Math.PI/10)],i),!1)}}])}(vf),sp=function(t){function e(t){return y(this,e),S(this,e,[Bd({style:e.defaultStyleProps},t)])}return N(e,t),b(e,[{key:"getPoints",value:function(t){var e=t.direction,n=h(this.getSize(t),2);return function(t,e,n){var r=e/2,i=t/2,a={up:[[-i,r],[i,r],[0,-r]],left:[[-i,0],[i,r],[i,-r]],right:[[-i,r],[-i,-r],[i,0]],down:[[-i,-r],[i,-r],[0,r]]};return a[n]||a.up}(n[0],n[1],e)}},{key:"getPortXY",value:function(t,e){var n=t.direction,r=e.placement,i=void 0===r?"top":r,a=this.getShape("key").getLocalBounds(),o=h(this.getSize(t),2),s=function(t,e,n){var r=e/2,i=t/2,a={};return"down"===n?(a.bottom=a.default=[0,r],a.right=[i,-r],a.left=[-i,-r]):"left"===n?(a.top=[i,-r],a.bottom=[i,r],a.left=a.default=[-i,0]):"right"===n?(a.top=[-i,-r],a.bottom=[-i,r],a.right=a.default=[i,0]):(a.left=[-i,r],a.top=a.default=[0,-r],a.right=[i,r]),a}(o[0],o[1],n);return cg(a,i,s,!1)}},{key:"getIconStyle",value:function(t){var e=t.icon,n=t.iconText,r=t.iconSrc,i=t.direction;if(!1===e||qd(n||r))return!1;var a=Dd(this.getGraphicStyle(t),"icon"),o=this.getShape("key").getLocalBounds(),s=function(t,e){var n=t.center,r=h(_l(t),2),i=r[0],a=r[1];return["up"===e||"down"===e?n[0]:"right"===e?n[0]-i/6:n[0]+i/6,"left"===e||"right"===e?n[1]:"down"===e?n[1]-a/6:n[1]+a/6]}(o,i),u=h(s,2),c=u[0],l=u[1],d=2*function(t,e){var n=h(_l(t),2),r=n[0],i=n[1],a=h("up"===e||"down"===e?[r,i]:[i,r],2);return r=a[0],i=a[1],(Math.pow(i,2)-Math.pow(Math.sqrt(Math.pow(r/2,2)+Math.pow(i,2))-r/2,2))/(2*i)}(o,i)*wd;return Object.assign({x:c,y:l,width:d,height:d},a)}}])}(vf);sp.defaultStyleProps={size:40,direction:"up"};var up=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},cp=function(t){function e(t){var n;return y(this,e),(n=S(this,e,[Bd({style:e.defaultStyleProps},t)])).type="combo",n.updateComboPosition(n.parsedAttributes),n}return N(e,t),b(e,[{key:"getKeySize",value:function(t){var e=t.collapsed,n=t.childrenNode;return 0===(void 0===n?[]:n).length?this.getEmptyKeySize(t):e?this.getCollapsedKeySize(t):this.getExpandedKeySize(t)}},{key:"getEmptyKeySize",value:function(t){var e=t.padding,n=t.collapsedSize,r=h(Cl(e),4),i=r[0],a=r[1],o=r[2],s=r[3];return Bh(jd(n),[s+a,i+o,0])}},{key:"getCollapsedKeySize",value:function(t){return jd(t.collapsedSize)}},{key:"getExpandedKeySize",value:function(t){var e=this.getContentBBox(t);return[Ll(e),Dl(e),0]}},{key:"getContentBBox",value:function(t){var e=this,n=t.childrenNode,r=void 0===n?[]:n,i=t.padding,a=r.map((function(t){return e.context.element.getElement(t)})).filter(Boolean);if(0===a.length){var o=new Hn,s=t.x,u=void 0===s?0:s,c=t.y,l=void 0===c?0:c,d=h(jd(t.size),2),f=d[0],v=d[1];return o.setMinMax([u-f/2,l-v/2,0],[u+f/2,l+v/2,0]),o}var p=Bl(a.map((function(t){return t.getBounds()})));return i?Fl(p,i):p}},{key:"drawCollapsedMarkerShape",value:function(t,e){var n=this.getCollapsedMarkerStyle(t);this.upsert("collapsed-marker",cf,n,e),sf(this)}},{key:"getCollapsedMarkerStyle",value:function(t){if(!t.collapsed||!t.collapsedMarker)return!1;var e=Dd(this.getGraphicStyle(t),"collapsedMarker"),n=e.type,r=up(e,["type"]),i=h(rd(this.getShape("key").getLocalBounds(),"center"),2),a=i[0],o=i[1],s=Object.assign(Object.assign({},r),{x:a,y:o});if(n){var u=this.getCollapsedMarkerText(n,t);Object.assign(s,{text:u})}return s}},{key:"getCollapsedMarkerText",value:function(t,e){var n=e.childrenData,r=void 0===n?[]:n,i=this.context.model;return"descendant-count"===t?i.getDescendantsData(this.id).length.toString():"child-count"===t?r.length.toString():"node-count"===t?i.getDescendantsData(this.id).filter((function(t){return"node"===i.getElementType(yh(t))})).length.toString():cn(t)?t(r):""}},{key:"getComboPosition",value:function(t){var e=t.x,n=void 0===e?0:e,r=t.y,i=void 0===r?0:r,a=t.collapsed,o=t.childrenData;if(0===(void 0===o?[]:o).length)return[+n,+i,0];if(a){var s=this.context.model,u=s.getDescendantsData(this.id).filter((function(t){return!s.isCombo(yh(t))}));return u.length>0&&u.some(nd)?Vh(u.reduce((function(t,e){return Bh(t,ed(e))}),[0,0,0]),u.length):[+n,+i,0]}return this.getContentBBox(t).center}},{key:"getComboStyle",value:function(t){var e=h(this.getComboPosition(t),2),n=e[0],r=e[1];return{x:n,y:r,transform:[["translate",n,r]]}}},{key:"updateComboPosition",value:function(t){var e=this.getComboStyle(t);Object.assign(this.style,e);var n=e.x,r=e.y;this.context.model.syncNodeLikeDatum({id:this.id,style:{x:n,y:r}}),uf(this)}},{key:"render",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;dn(e,"render",this,3)([t,n]),this.drawCollapsedMarkerShape(t,n)}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};dn(e,"update",this,3)([t]),this.updateComboPosition(this.parsedAttributes)}},{key:"onframe",value:function(){dn(e,"onframe",this,3)([]),this.attributes.collapsed||this.updateComboPosition(this.parsedAttributes),this.drawKeyShape(this.parsedAttributes,this)}},{key:"animate",value:function(t,n){var r=this,i=dn(e,"animate",this,3)([this.attributes.collapsed?t:t.map((function(t){return t.x,t.y,t.z,t.transform,up(t,["x","y","z","transform"])})),n]);return i?new Proxy(i,{set:function(t,e,n){return"currentTime"===e&&Promise.resolve().then((function(){return r.onframe()})),Reflect.set(t,e,n)}}):i}}])}(df);cp.defaultStyleProps={childrenNode:[],droppable:!0,draggable:!0,collapsed:!1,collapsedSize:32,collapsedMarker:!0,collapsedMarkerZIndex:1,collapsedMarkerFontSize:12,collapsedMarkerTextAlign:"center",collapsedMarkerTextBaseline:"middle",collapsedMarkerType:"child-count"};var lp=function(t){function e(t){return y(this,e),S(this,e,[t])}return N(e,t),b(e,[{key:"drawKeyShape",value:function(t,e){return this.upsert("key",lu,this.getKeyStyle(t),e)}},{key:"getKeyStyle",value:function(t){var n=t.collapsed,r=dn(e,"getKeyStyle",this,3)([t]),i=h(this.getKeySize(t),1)[0];return Object.assign(Object.assign(Object.assign({},r),n&&Dd(r,"collapsed")),{r:i/2})}},{key:"getCollapsedKeySize",value:function(t){var e=h(jd(t.collapsedSize),2),n=e[0],r=e[1],i=Math.max(n,r)/2;return[2*i,2*i,0]}},{key:"getExpandedKeySize",value:function(t){var e=h(_l(this.getContentBBox(t)),2),n=e[0],r=e[1],i=Math.sqrt(Math.pow(n,2)+Math.pow(r,2))/2;return[2*i,2*i,0]}},{key:"getIntersectPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return dd(t,this.getShape("key").getBounds(),e)}}])}(cp),hp=function(t){function e(t){return y(this,e),S(this,e,[t])}return N(e,t),b(e,[{key:"drawKeyShape",value:function(t,e){return this.upsert("key",Ou,this.getKeyStyle(t),e)}},{key:"getKeyStyle",value:function(t){var n=dn(e,"getKeyStyle",this,3)([t]),r=h(this.getKeySize(t),2),i=r[0],a=r[1];return Object.assign(Object.assign(Object.assign({},n),t.collapsed&&Dd(n,"collapsed")),{width:i,height:a,x:-i/2,y:-a/2})}}])}(cp);const dp=function(t,e){return void 0===e&&(e=[]),function(t,e){if(!zc(t))return t;for(var n=[],r=0;r<t.length;r++){var i=t[r];e(i,r)&&n.push(i)}return n}(t,(function(t){return!function(t,e){return!!zc(t)&&t.indexOf(e)>-1}(e,t)}))};var fp={padding:10};function vp(t,e,n,r,i,a){for(var o,s,u=Object.assign(fp,a).padding,c=Il(n,u),l=Il(r,u),h=[t].concat(w(i),[e]),d=null,f=[],v=0,p=h.length;v<p-1;v++){var g=v+1,y=h[v],m=h[g],b=ud(o=y,s=m)||function(t,e){return t[0]===e[0]}(o,s),x=null;if(0===v)if(g===p-1)if(c.intersects(l))x=kp(y,m,c,l);else if(Vl(y,c)||Vl(m,l))b||(x=Ep(y,m,c,l));else{var E=Hl(y,c),k=Hl(m,l);(x=bp(E,k,yp(E,k))).points.unshift(E),x.points.push(k)}else zl(m,c)?x=kp(y,m,c,Il(m,u),d):b||(x=xp(y,m,c));else g===p-1?zl(y,l)?x=kp(y,m,Il(y,u),l,d):b||(x=wp(y,m,l,d)):b||(x=bp(y,m,d));x?(f.push.apply(f,w(x.points)),d=x.direction):d=yp(y,m),g<p-1&&f.push(m)}return f.map(Kh)}var pp={N:"S",S:"N",W:"E",E:"W"},gp={N:-Math.PI/2,S:Math.PI/2,E:0,W:Math.PI};function yp(t,e){var n=h(t,2),r=n[0],i=n[1],a=h(e,2),o=a[0],s=a[1];return r===o?i>s?"N":"S":i===s?r>o?"W":"E":null}function mp(t,e){return"N"===e||"S"===e?Dl(t):Ll(t)}function bp(t,e,n){var r=[t[0],e[1]],i=[e[0],t[1]],a=yp(t,r),o=yp(t,i),s=n?pp[n]:null,u=a===n||a!==s&&o!==n?r:i;return{points:[u],direction:yp(u,e)}}function xp(t,e,n){if(Vl(t,n)){var r=Mp(t,e,n);return{points:[r],direction:yp(r,e)}}var i=Hl(t,n),a=["left","right"].includes(Wl(t,n))?[e[0],i[1]]:[i[0],e[1]];return{points:[a],direction:yp(a,e)}}function wp(t,e,n,r){var i=Vl(e,n)?e:Hl(e,n),a=[[i[0],t[1]],[t[0],i[1]]],o=a.filter((function(t){return function(t,e){return!zl(t,e)}(t,n)&&!Gl(t,n,!0)})),s=o.filter((function(e){return yp(e,t)!==r}));if(s.length>0){var u=s.find((function(e){return yp(t,e)===r}))||s[0];return{points:[u],direction:yp(u,e)}}var c=sd(e,dp(a,o)[0],mp(n,r)/2);return{points:[Mp(c,t,n),c],direction:yp(c,e)}}function Ep(t,e,n,r){var i=xp(t,e,n),a=$h(i.points[0]);if(zl(a,r)){var o=$h((i=xp(e,t,r)).points[0]);if(zl(o,n)){var s=sd(t,a,mp(n,yp(t,a))/2),u=sd(e,o,mp(r,yp(e,o))/2),c=[(s[0]+u[0])/2,(s[1]+u[1])/2],l=xp(t,c,n),h=wp(c,e,r,l.direction);i.points=[l.points[0],h.points[0]],i.direction=h.direction}}return i}function kp(t,e,n,r,i){var a,o=Bl([n,r]),s=Hh(e,o.center)>Hh(t,o.center),u=h(s?[e,t]:[t,e],2),c=u[0],l=u[1],d=Dl(o)+Ll(o);if(i){var f=[c[0]+d*Math.cos(gp[i]),c[1]+d*Math.sin(gp[i])];a=sd(Hl(f,o),f,.01)}else a=sd(Hl(c,o),c,-.01);var v=Mp(a,l,o),p=[od(a,2),od(v,2)];if(Vc(od(a),od(v))){var g=qh(zh(a,c),[1,0,0])+Math.PI/2;p=[a,Mp(a,v=od(sd(Hl(v=[l[0]+d*Math.cos(g),l[1]+d*Math.sin(g),0],o),l,-.01),2),o),v]}return{points:s?p.reverse():p,direction:yp(s?a:v,e)}}function Mp(t,e,n){var r=[t[0],e[1]];return zl(r,n)&&(r=[e[0],t[1]]),r}function Sp(t,e,n,r,i){var a="number"==typeof e?e:.5;"start"===e&&(a=0),"end"===e&&(a=.99);var o=id(t.getPoint(a)),s=id(t.getPoint(a+.01)),u="start"===e?"left":"end"===e?"right":"center";if(ud(o,s)||!n){var c=h(Op(t,a,r,i),2);return{transform:[["translate",c[0],c[1]]],textAlign:u}}var l=Math.atan2(s[1]-o[1],s[0]-o[0]);s[0]<o[0]&&(u="center"===u?u:"left"===u?"right":"left",r*=-1,l+=Math.PI);var d=h(Op(t,a,r,i,l),2);return{textAlign:u,transform:[["translate",d[0],d[1]],["rotate",l/Math.PI*180]]}}function Op(t,e,n,r,i){var a=h(id(t.getPoint(e)),2),o=a[0],s=a[1],u=n,c=r;return i&&(u=n*Math.cos(i)-r*Math.sin(i),c=n*Math.sin(i)+r*Math.cos(i)),[o+u,s+c]}function Np(t,e,n,r){if(Vc(t,e))return t;var i=zh(e,t),a=[t[0]+n*i[0],t[1]+n*i[1]],o=Uh(Xh(i,!1));return a[0]+=r*o[0],a[1]+=r*o[1],a}function Ap(t,e,n){return[["M",t[0],t[1]],["C",n[0][0],n[0][1],n[1][0],n[1][1],e[0],e[1]]]}function Tp(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t[0],i=t[t.length-1],a=t.slice(1,t.length-1),o=[["M",r[0],r[1]]];return a.forEach((function(t,n){var s=a[n-1]||r,u=a[n+1]||i;if(!cd(s,t,u)&&e){var c=function(t,e,n,r){var i=Yh(t,e),a=Yh(n,e),o=Math.min(r,Math.min(i,a)/2);return[[e[0]-o/i*(e[0]-t[0]),e[1]-o/i*(e[1]-t[1])],[e[0]-o/a*(e[0]-n[0]),e[1]-o/a*(e[1]-n[1])]]}(s,t,u,e),l=h(c,2),d=l[0],f=l[1];o.push(["L",d[0],d[1]],["Q",t[0],t[1],f[0],f[1]],["L",f[0],f[1]])}else o.push(["L",t[0],t[1]])})),o.push(["L",i[0],i[1]]),n&&o.push(["Z"]),o}function Pp(t,e,n,r,i){var a=Il(t),o=t.getCenter(),s=r&&dg(r),u=i&&dg(i);if(!s||!u){var c=function(t){var e=Math.PI/2,n=Dl(t)/2,r=Ll(t)/2,i=Math.atan2(n,r)/2,a=Math.atan2(r,n)/2;return{top:[-e-a,-e+a],"top-right":[-e+a,-i],"right-top":[-e+a,-i],right:[-i,i],"bottom-right":[i,e-a],"right-bottom":[i,e-a],bottom:[e-a,e+a],"bottom-left":[e+a,Math.PI-i],"left-bottom":[e+a,Math.PI-i],left:[Math.PI-i,Math.PI+i],"top-left":[Math.PI+i,-e-a],"left-top":[Math.PI+i,-e-a]}}(a),l=c[e][0],d=c[e][1],f=h(_l(a),2),v=f[0],p=f[1],g=Math.max(v,p),y=Bh(o,[g*Math.cos(l),g*Math.sin(l),0]),m=Bh(o,[g*Math.cos(d),g*Math.sin(d),0]);if(s=gg(t,y),u=gg(t,m),!n){var b=[u,s];s=b[0],u=b[1]}}return[s,u]}function Cp(t,e){var n=new Set,r=new Set,i=new Set;return t.forEach((function(a){e(a).forEach((function(e){n.add(e),t.includes(e.source)&&t.includes(e.target)?r.add(e):i.add(e)}))})),{edges:Array.from(n),internal:Array.from(r),external:Array.from(i)}}function Rp(t,e){for(var n=[],r=t;r;){n.push(r);var i=e(yh(r));if(!i)break;r=i}if(n.some((function(t){var e;return null===(e=t.style)||void 0===e?void 0:e.collapsed}))){var a=n.reverse().findIndex(Td);return n[a]||n.at(-1)}return t}var Lp=function(t,e){var n=Math.max(t,e)/2;return[["M",-t/2,0],["A",n,n,0,1,0,2*n-t/2,0],["A",n,n,0,1,0,-t/2,0],["Z"]]},Dp=function(t,e){return[["M",-t/2,0],["L",t/2,-e/2],["L",t/2,e/2],["Z"]]},_p=function(t,e){return[["M",-t/2,0],["L",0,-e/2],["L",t/2,0],["L",0,e/2],["Z"]]},Ip=function(t,e){return[["M",-t/2,0],["L",t/2,-e/2],["L",4*t/5-t/2,0],["L",t/2,e/2],["Z"]]},jp=function(t,e){return[["M",-t/2,-e/2],["L",t/2,-e/2],["L",t/2,e/2],["L",-t/2,e/2],["Z"]]},Fp=function(t,e){var n=t/2,r=t/7,i=t-r;return[["M",-n,0],["L",0,-e/2],["L",0,e/2],["Z"],["M",i-n,-e/2],["L",i+r-n,-e/2],["L",i+r-n,e/2],["L",i-n,e/2],["Z"]]},Bp=function(t,e){return[["M",t/2,-e/2],["L",-t/2,0],["L",t/2,0],["L",-t/2,0],["L",t/2,e/2]]},zp=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},Gp=function(t){function n(t){var e;return y(this,n),(e=S(this,n,[Bd({style:n.defaultStyleProps},t)])).type="edge",e}return N(n,t),b(n,[{key:"sourceNode",get:function(){var t=this.parsedAttributes.sourceNode;return this.context.element.getElement(t)}},{key:"targetNode",get:function(){var t=this.parsedAttributes.targetNode;return this.context.element.getElement(t)}},{key:"getKeyStyle",value:function(t){var e,n,r=this.getGraphicStyle(t),i=r.loop,a=zp(r,["loop"]),o=this.sourceNode,s=this.targetNode,u={d:i&&(n=s,(e=o)&&n&&e===n)?this.getLoopPath(t):this.getKeyPath(t)};return wu.PARSED_STYLE_LIST.forEach((function(t){t in a&&(u[t]=a[t])})),u}},{key:"getLoopPath",value:function(t){var e=t.sourcePort,n=t.targetPort,r=this.sourceNode,i=Il(r),a=Math.max(Ll(i),Dl(i)),o=Dd(this.getGraphicStyle(t),"loop"),s=o.placement,u=o.clockwise,c=o.dist;return function(t,e,n,r,i,a){var o=t.getPorts()[i||a],s=t.getPorts()[a||i],u=h(Pp(t,e,n,o,s),2),c=u[0],l=u[1],d=function(t,e,n,r){var i=t.getCenter();if(Vc(e,n)){var a=zh(e,i),o=[r*Math.sign(a[0])||r/2,r*Math.sign(a[1])||-r/2,0];return[Bh(e,o),Bh(n,Gh(o,[1,-1,1]))]}return[sd(i,e,Hh(i,e)+r),sd(i,n,Hh(i,n)+r)]}(t,c,l,r);return o&&(c=pg(o,d[0])),s&&(l=pg(s,d[d.length-1])),Ap(c,l,d)}(r,s,u,void 0===c?a:c,e,n)}},{key:"getEndpoints",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=t.sourcePort,i=t.targetPort,a=this.sourceNode,o=this.targetNode,s=function(t,e,n,r){return[fg(t,e,n,r),fg(e,t,r,n)]}(a,o,r,i),u=h(s,2),c=u[0],l=u[1];if(!e)return[c?dg(c):a.getCenter(),l?dg(l):o.getCenter()];var d="function"==typeof n?n():n;return[vg(c||a,d[0]||l||o),vg(l||o,d[d.length-1]||c||a)]}},{key:"getHaloStyle",value:function(t){if(!1===t.halo)return!1;var e=this.getKeyStyle(t),n=Dd(this.getGraphicStyle(t),"halo");return Object.assign(Object.assign({},e),n)}},{key:"getLabelStyle",value:function(t){if(!1===t.label||!t.labelText)return!1;var e=Dd(this.getGraphicStyle(t),"label"),n=e.placement,r=e.offsetX,i=e.offsetY,a=e.autoRotate,o=e.maxWidth,s=zp(e,["placement","offsetX","offsetY","autoRotate","maxWidth"]),u=Sp(this.shapeMap.key,n,a,r,i),c=this.shapeMap.key.getLocalBounds(),l=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Vd(Hh(t[0],t[1])*n,e)}([c.min,c.max],o);return Object.assign({wordWrapWidth:l},u,s)}},{key:"getBadgeStyle",value:function(t){if(!1===t.badge||!t.badgeText)return!1;var e=Dd(t,"badge"),n=e.offsetX,r=e.offsetY,i=e.placement,a=zp(e,["offsetX","offsetY","placement"]);return Object.assign(a,function(t,e,n,r,i){var a,o,s=2*(null===(a=t.badge)||void 0===a?void 0:a.getGeometryBounds().halfExtents[0])||0,u=2*(null===(o=t.label)||void 0===o?void 0:o.getGeometryBounds().halfExtents[0])||0;return Sp(t.key,n,!0,(u?(u/2+s/2)*("suffix"===e?1:-1):0)+r,i)}(this.shapeMap,i,t.labelPlacement,n,r))}},{key:"drawArrow",value:function(t,e){var n,r="start"===e,i=t["start"===e?"startArrow":"endArrow"],a=this.shapeMap.key;if(i){var o=this.getArrowStyle(t,r),s=h(r?["markerStart","markerStartOffset","startArrowOffset"]:["markerEnd","markerEndOffset","endArrowOffset"],3),u=s[0],c=s[1],l=s[2],d=a.parsedStyle[u];if(d)d.attr(o);else{var f=new(o.src?yu:wu)({style:o});a.style[u]=f}a.style[c]=t[l]||o.width/2+ +o.lineWidth}else{var v=r?"markerStart":"markerEnd";null===(n=a.style[v])||void 0===n||n.destroy(),a.style[v]=null}}},{key:"getArrowStyle",value:function(t,n){var r=this.getShape("key").attributes,i=n?"startArrow":"endArrow",a=Dd(this.getGraphicStyle(t),i),o=a.size,s=a.type,u=zp(a,["size","type"]),c=jd(function(t,e){return e||(t<4?10:4===t?12:2.5*t)}(r.lineWidth,o)),l=h(c,2),d=l[0],f=l[1],v=(cn(s)?s:e[s]||Dp)(d,f);return Object.assign(ep(r,["stroke","strokeOpacity","fillOpacity"]),{width:d,height:f},Object.assign({},v&&{d:v,fill:"simple"===s?"":r.stroke}),u)}},{key:"drawLabelShape",value:function(t,e){var n=this.getLabelStyle(t);this.upsert("label",Zd,n,e)}},{key:"drawHaloShape",value:function(t,e){var n=this.getHaloStyle(t);this.upsert("halo",wu,n,e)}},{key:"drawBadgeShape",value:function(t,e){var n=this.getBadgeStyle(t);this.upsert("badge",Qd,n,e)}},{key:"drawSourceArrow",value:function(t){this.drawArrow(t,"start")}},{key:"drawTargetArrow",value:function(t){this.drawArrow(t,"end")}},{key:"drawKeyShape",value:function(t,e){var n=this.getKeyStyle(t);return this.upsert("key",wu,n,e)}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parsedAttributes,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.drawKeyShape(t,e),this.getShape("key")&&(this.drawSourceArrow(t),this.drawTargetArrow(t),this.drawLabelShape(t,e),this.drawHaloShape(t,e),this.drawBadgeShape(t,e))}},{key:"onframe",value:function(){this.drawKeyShape(this.parsedAttributes,this),this.drawSourceArrow(this.parsedAttributes),this.drawTargetArrow(this.parsedAttributes),this.drawHaloShape(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this),this.drawBadgeShape(this.parsedAttributes,this)}},{key:"animate",value:function(t,e){var r=this,i=dn(n,"animate",this,3)([t,e]);return i?new Proxy(i,{set:function(t,e,n){return"currentTime"===e&&Promise.resolve().then((function(){return r.onframe()})),Reflect.set(t,e,n)}}):i}}])}(lf);Gp.defaultStyleProps={badge:!0,badgeOffsetX:0,badgeOffsetY:0,badgePlacement:"suffix",isBillboard:!0,label:!0,labelAutoRotate:!0,labelIsBillboard:!0,labelMaxWidth:"80%",labelOffsetX:4,labelOffsetY:0,labelPlacement:"center",labelTextBaseline:"middle",labelWordWrap:!1,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloPointerEvents:"none",haloStrokeOpacity:.25,haloZIndex:-1,loop:!0,startArrow:!1,startArrowLineDash:0,startArrowLineJoin:"round",startArrowLineWidth:1,startArrowTransformOrigin:"center",startArrowType:"vee",endArrow:!1,endArrowLineDash:0,endArrowLineJoin:"round",endArrowLineWidth:1,endArrowTransformOrigin:"center",endArrowType:"vee",loopPlacement:"top",loopClockwise:!0};var Vp=function(t){function e(t){return y(this,e),S(this,e,[Bd({style:e.defaultStyleProps},t)])}return N(e,t),b(e,[{key:"getKeyPath",value:function(t){var e=h(this.getEndpoints(t),2),n=e[0],r=e[1],i=t.controlPoints,a=t.curvePosition,o=t.curveOffset,s=this.getControlPoints(n,r,function(t){return oe(t)?[t,1-t]:t}(a),function(t){return oe(t)?[t,-t]:t}(o),i);return Ap(n,r,s)}},{key:"getControlPoints",value:function(t,e,n,r,i){return 2===(null==i?void 0:i.length)?i:[Np(t,e,n[0],r[0]),Np(t,e,n[1],r[1])]}}])}(Gp);Vp.defaultStyleProps={curvePosition:.5,curveOffset:20};var Wp=function(t){function e(t){return y(this,e),S(this,e,[Bd({style:e.defaultStyleProps},t)])}return N(e,t),b(e,[{key:"getControlPoints",value:function(t,e,n,r){var i=e[0]-t[0];return[[t[0]+i*n[0]+r[0],t[1]],[e[0]-i*n[1]+r[1],e[1]]]}}])}(Vp);Wp.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};var Hp=function(t){function e(t){return y(this,e),S(this,e,[Bd({style:e.defaultStyleProps},t)])}return N(e,t),b(e,[{key:"ref",get:function(){return this.context.model.getRootsData()[0]}},{key:"getEndpoints",value:function(t){if(this.sourceNode.id===this.ref.id)return dn(e,"getEndpoints",this,3)([t]);var n=ed(this.ref);return[this.sourceNode.getIntersectPoint(n,!0),this.targetNode.getIntersectPoint(n)]}},{key:"toRadialCoordinate",value:function(t){var e=ed(this.ref);return[Hh(t,e),Zh(zh(t,e))]}},{key:"getControlPoints",value:function(t,e,n,r){var i=h(this.toRadialCoordinate(t),2),a=i[0],o=i[1],s=h(this.toRadialCoordinate(e),1)[0]-a;return[[t[0]+(s*n[0]+r[0])*Math.cos(o),t[1]+(s*n[0]+r[0])*Math.sin(o)],[e[0]-(s*n[1]-r[0])*Math.cos(o),e[1]-(s*n[1]-r[0])*Math.sin(o)]]}}])}(Vp);Hp.defaultStyleProps={curvePosition:.5,curveOffset:20};var Yp=function(t){function e(t){return y(this,e),S(this,e,[Bd({style:e.defaultStyleProps},t)])}return N(e,t),b(e,[{key:"getControlPoints",value:function(t,e,n,r){var i=e[1]-t[1];return[[t[0],t[1]+i*n[0]+r[0]],[e[0],e[1]-i*n[1]+r[1]]]}}])}(Vp);Yp.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};var Up=function(t){function e(t){return y(this,e),S(this,e,[Bd({style:e.defaultStyleProps},t)])}return N(e,t),b(e,[{key:"getKeyPath",value:function(t){var e=h(this.getEndpoints(t),2),n=e[0],r=e[1];return[["M",n[0],n[1]],["L",r[0],r[1]]]}}])}(Gp);Up.defaultStyleProps={};var qp={enableObstacleAvoidance:!1,offset:10,maxAllowedDirectionChange:Math.PI/2,maximumLoops:3e3,gridSize:5,startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{right:{stepX:1,stepY:0},left:{stepX:-1,stepY:0},bottom:{stepX:0,stepY:1},top:{stepX:0,stepY:-1}},penalties:{0:0,90:0},distFunc:Yh},Xp=function(t){return"".concat(Math.round(t[0]),"|||").concat(Math.round(t[1]))};function Kp(t,e){var n=function(t){return Math.round(t/e)};return oe(t)?n(t):t.map(n)}function $p(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n||r?Math.atan2(r,n):0}function Zp(t,e,n,r){var i,a,o,s=$p(t,e);return i=$p(n[Xp(t)]||r,t),a=s,(o=Math.abs(i-a))>Math.PI?2*Math.PI-o:o}function Qp(t,e,n){return Math.min.apply(Math,w(e.map((function(e){return n(t,e)}))))}var Jp=function(t,e,n,r){if(!e)return[t];var i=r.directionMap,a=r.offset,o=Fl(e.getRenderBounds(),a),s=Object.keys(i).reduce((function(e,r){if(n.includes(r))for(var a=i[r],s=h(_l(o),2),u=s[0],c=s[1],l=[t[0]+a.stepX*u,t[1]+a.stepY*c],d=(y=(g=h((p=o).min,2))[0],m=g[1],x=(b=h(p.max,2))[0],[[E=[y,w=b[1]],k=[x,w]],[k,M=[x,m]],[M,S=[y,m]],[S,E]]),f=0;f<d.length;f++){var v=Jh([t,l],d[f]);v&&Gl(v,o)&&e.push(v)}var p,g,y,m,b,x,w,E,k,M,S;return e}),[]);return zl(t,o)||s.push(t),s.map((function(t){return Kp(t,r.gridSize)}))},tg=function(t,e,n,r,i,a,o){var s=[],u=[a[0]===r[0]?r[0]:t[0]*o,a[1]===r[1]?r[1]:t[1]*o];s.unshift(u);for(var c=t,l=e[Xp(c)];l;){var h=l,d=c;Zp(h,d,e,n)&&(u=[h[0]===d[0]?u[0]:h[0]*o,h[1]===d[1]?u[1]:h[1]*o],s.unshift(u)),l=e[Xp(h)],c=h}var f=i.map((function(t){return[t[0]*o,t[1]*o]})),v=function(t,e,n){for(var r=t[0],i=n(t[0],e),a=0;a<t.length;a++){var o=t[a],s=n(o,e);s<i&&(r=o,i=s)}return r}(f,u,Yh);return s.unshift(v),s};var eg=function(){return b((function t(){y(this,t),this.arr=[],this.map={},this.arr=[],this.map={}}),[{key:"_innerAdd",value:function(t,e){for(var n=0,r=e-1;r-n>1;){var i=Math.floor((n+r)/2);if(this.arr[i].value>t.value)r=i;else{if(!(this.arr[i].value<t.value))return this.arr.splice(i,0,t),void(this.map[t.id]=!0);n=i}}this.arr.splice(r,0,t),this.map[t.id]=!0}},{key:"add",value:function(t){delete this.map[t.id];var e=this.arr.length;if(!e||this.arr[e-1].value<t.value)return this.arr.push(t),void(this.map[t.id]=!0);this._innerAdd(t,e)}},{key:"remove",value:function(t){this.map[t]&&delete this.map[t]}},{key:"_clearAndGetMinId",value:function(){for(var t,e=this.arr.length-1;e>=0;e--)this.map[this.arr[e].id]?t=this.arr[e].id:this.arr.splice(e,1);return t}},{key:"_findFirstId",value:function(){for(;this.arr.length;){var t=this.arr.shift();if(this.map[t.id])return t.id}}},{key:"minId",value:function(t){return t?this._clearAndGetMinId():this._findFirstId()}}])}(),ng=function(t){function e(t){return y(this,e),S(this,e,[Bd({style:e.defaultStyleProps},t)])}return N(e,t),b(e,[{key:"getControlPoints",value:function(t){var e=t.router,n=this.sourceNode,r=this.targetNode,i=h(this.getEndpoints(t,!1),2),a=i[0],o=i[1],s=[];return e?"shortest-path"===e.type?(s=function(t,e,n,r){var i=Kh(t.getCenter()),a=Kh(e.getCenter()),o=Object.assign(qp,r),s=o.gridSize,u=function(t,e){var n=e.offset,r=e.gridSize,i={};return t.forEach((function(t){if(t&&!t.destroyed&&t.isVisible())for(var e=Fl(t.getRenderBounds(),n),a=Kp(e.min[0],r);a<=Kp(e.max[0],r);a+=1)for(var o=Kp(e.min[1],r);o<=Kp(e.max[1],r);o+=1)i["".concat(a,"|||").concat(o)]=!0})),i}(o.enableObstacleAvoidance?n:[t,e],o),c=Kp(i,s),l=Kp(a,s),d=Jp(i,t,o.startDirections,o),f=Jp(a,e,o.endDirections,o);d.forEach((function(t){return delete u[Xp(t)]})),f.forEach((function(t){return delete u[Xp(t)]}));for(var v={},p={},g={},y={},m={},b=new eg,x=0;x<d.length;x++){var w=d[x],E=Xp(w);v[E]=w,y[E]=0,m[E]=Qp(w,f,o.distFunc),b.add({id:E,value:m[E]})}for(var k,M=f.map((function(t){return Xp(t)})),S=o.maximumLoops,O=1/0,N=0,A=Object.entries(v);N<A.length;N++){var T=h(A[N],2),P=T[0],C=T[1];m[P]<=O&&(O=m[P],k=C)}for(;Object.keys(v).length>0&&S>0;){var R=b.minId(!1);if(!R)break;k=v[R];var L=Xp(k);if(M.includes(L))return tg(k,g,c,a,d,l,s);delete v[L],b.remove(L),p[L]=!0;for(var D=0,_=Object.values(o.directionMap);D<_.length;D++){var I=_[D],j=Bh(k,[I.stepX,I.stepY]),F=Xp(j);if(!p[F]){var B=Zp(k,j,g,c);if(!(B>o.maxAllowedDirectionChange||u[F])){v[F]||(v[F]=j);var z=o.penalties[B],G=o.distFunc(k,j)+(isNaN(z)?s:z),V=y[L]+G,W=y[F];W&&V>=W||(g[F]=k,y[F]=V,m[F]=V+Qp(j,f,o.distFunc),b.add({id:F,value:m[F]}))}}}S-=1}return[]}(n,r,this.context.element.getNodes(),e)).length||(s=vp(a,o,n,r,t.controlPoints,{padding:e.offset})):"orth"===e.type&&(s=vp(a,o,n,r,t.controlPoints,e)):s=t.controlPoints,s}},{key:"getPoints",value:function(t){var e=this.getControlPoints(t),n=h(this.getEndpoints(t,!0,e),2),r=n[0],i=n[1];return[r].concat(w(e),[i])}},{key:"getKeyPath",value:function(t){return Tp(this.getPoints(t),t.radius)}},{key:"getLoopPath",value:function(t){var e=t.sourcePort,n=t.targetPort,r=t.radius,i=this.sourceNode,a=Il(i),o=Math.max(Ll(a),Dl(a))/4,s=Dd(this.getGraphicStyle(t),"loop"),u=s.placement,c=s.clockwise,l=s.dist;return function(t,e,n,r,i,a,o){var s=lg(t),u=s[a||o],c=s[o||a],l=h(Pp(t,n,r,u,c),2),d=l[0],f=l[1],v=function(t,e,n,r){var i=[],a=Il(t);if(Vc(e,n))switch(Wl(e,a)){case"left":i.push([e[0]-r,e[1]]),i.push([e[0]-r,e[1]+r]),i.push([e[0],e[1]+r]);break;case"right":i.push([e[0]+r,e[1]]),i.push([e[0]+r,e[1]+r]),i.push([e[0],e[1]+r]);break;case"top":i.push([e[0],e[1]-r]),i.push([e[0]+r,e[1]-r]),i.push([e[0]+r,e[1]]);break;case"bottom":i.push([e[0],e[1]+r]),i.push([e[0]+r,e[1]+r]),i.push([e[0]+r,e[1]])}else{var o=Wl(e,a),s=Wl(n,a);if(o===s){var u,c;switch(o){case"left":u=Math.min(e[0],n[0])-r,i.push([u,e[1]]),i.push([u,n[1]]);break;case"right":u=Math.max(e[0],n[0])+r,i.push([u,e[1]]),i.push([u,n[1]]);break;case"top":c=Math.min(e[1],n[1])-r,i.push([e[0],c]),i.push([n[0],c]);break;case"bottom":c=Math.max(e[1],n[1])+r,i.push([e[0],c]),i.push([n[0],c])}}else{var l=function(t,e){return{left:[e[0]-r,e[1]],right:[e[0]+r,e[1]],top:[e[0],e[1]-r],bottom:[e[0],e[1]+r]}[t]},h=l(o,e),d=l(s,n),f=Mp(h,d,a);i.push(h,f,d)}}return i}(t,d,f,i);return u&&(d=pg(u,v[0])),c&&(f=pg(c,v[v.length-1])),Tp([d].concat(w(v),[f]),e)}(i,r,u,c,void 0===l?o:l,e,n)}}])}(Gp);ng.defaultStyleProps={radius:0,controlPoints:[],router:!1};var rg=function(t){function e(t){return y(this,e),S(this,e,[Bd({style:e.defaultStyleProps},t)])}return N(e,t),b(e,[{key:"getKeyPath",value:function(t){var e=t.curvePosition,n=t.curveOffset,r=h(this.getEndpoints(t),2),i=r[0],a=r[1];return function(t,e,n){return[["M",t[0],t[1]],["Q",n[0],n[1],e[0],e[1]]]}(i,a,t.controlPoint||Np(i,a,e,n))}}])}(Gp);rg.defaultStyleProps={curvePosition:.5,curveOffset:30};var ig=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function ag(t){return t instanceof df&&"node"===t.type}function og(t){return t instanceof Gp}function sg(t){return t instanceof cp}var ug={top:[.5,0],right:[1,.5],bottom:[.5,1],left:[0,.5],default:[.5,.5]};function cg(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ug,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=[.5,.5],a=ce(e)?Pd(n,e.toLocaleLowerCase(),i):e;if(!r&&ce(e))return a;var o=h(a||i,2),s=o[0],u=o[1];return[t.min[0]+Ll(t)*s,t.min[1]+Dl(t)*u]}function lg(t){if(!t)return{};var e=t.getPorts();return(t.attributes.ports||[]).forEach((function(n,r){var i,a=n.key,o=n.placement;hg(n)&&(e[i=a||r]||(e[i]=rd(t.getShape("key").getBounds(),o)))})),e}function hg(t){var e=t.r;return!e||0===Number(e)}function dg(t){return Tl(t)?t:t.getPosition()}function fg(t,e,n,r){var i=lg(t);if(n)return i[n];var a=Object.values(i);if(0!==a.length){var o,s,u,c,l=a.map((function(t){return dg(t)})),d=function(t,e){var n=lg(t);if(e)return[dg(n[e])];var r=Object.values(n);return r.length>0?r.map((function(t){return dg(t)})):[t.getCenter()]}(e,r),f=h((s=d,u=1/0,c=[(o=l)[0],s[0]],o.forEach((function(t){s.forEach((function(e){var n=Hh(t,e);n<u&&(u=n,c=[t,e])}))})),c),1)[0];return a.find((function(t){return dg(t)===f}))}}function vg(t,e){return sg(t)||ag(t)?gg(t,e):pg(t,e)}function pg(t,e){return t&&e?Tl(t)?t:t.attributes.linkToCenter?t.getPosition():dd(Tl(e)?e:ag(e)?e.getCenter():e.getPosition(),t.getBounds()):[0,0,0]}function gg(t,e){if(!t||!e)return[0,0,0];var n=Tl(e)?e:ag(e)?e.getCenter():e.getPosition();return t.getIntersectPoint(n)||t.getCenter()}function yg(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bottom",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=e.split("-"),o=h(rd(t,e),2),s=o[0],u=o[1],c=a.includes("left")?"right":a.includes("right")?"left":"center",l=a.includes("top")?"bottom":a.includes("bottom")?"top":"middle";return i&&(l="top"===l?"bottom":"bottom"===l?"top":l),{transform:[["translate",s+n,u+r]],textBaseline:l,textAlign:c}}function mg(t,e){"update"in t?t.update(e):t.attr(e)}function bg(t){return Pd(t,"__to_be_destroyed__",!1)}var xg=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).onCollapseExpand=function(t){return e=r,n=void 0,i=void 0,a=Tn().mark((function e(){var n,r,i,a,o,s,u,c,l,h,d;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.validate(t)){e.next=2;break}return e.abrupt("return");case 2:if(ag(f=n=t.target)||og(f)||sg(f)){e.next=5;break}return e.abrupt("return");case 5:if(r=n.id,i=this.context,a=i.model,o=i.graph,s=a.getElementDataById(r)){e.next=10;break}return e.abrupt("return",!1);case 10:if(u=this.options,c=u.onCollapse,l=u.onExpand,h=u.animation,d=u.align,!Td(s)){e.next=17;break}return e.next=14,o.expandElement(r,{animation:h,align:d});case 14:null==l||l(r),e.next=20;break;case 17:return e.next=19,o.collapseElement(r,{animation:h,align:d});case 19:null==c||c(r);case 20:case"end":return e.stop()}var f}),e,this)})),new(i||(i=Promise))((function(t,r){function o(t){try{u(a.next(t))}catch(t){r(t)}}function s(t){try{u(a.throw(t))}catch(t){r(t)}}function u(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(o,s)}u((a=a.apply(e,n||[])).next())}));var e,n,i,a},r.bindEvents(),r}return N(e,t),b(e,[{key:"update",value:function(t){this.unbindEvents(),dn(e,"update",this,3)([t]),this.bindEvents()}},{key:"bindEvents",value:function(){var t=this.context.graph,e=this.options.trigger;t.on("node:".concat(e),this.onCollapseExpand),t.on("combo:".concat(e),this.onCollapseExpand)}},{key:"unbindEvents",value:function(){var t=this.context.graph,e=this.options.trigger;t.off("node:".concat(e),this.onCollapseExpand),t.off("combo:".concat(e),this.onCollapseExpand)}},{key:"validate",value:function(t){if(this.destroyed)return!1;var e=this.options.enable;return cn(e)?e(t):!!e}},{key:"destroy",value:function(){this.unbindEvents(),dn(e,"destroy",this,3)([])}}])}(Rh);xg.defaultOptions={enable:!0,animation:!0,trigger:qc.DBLCLICK,align:!0};var wg={},Eg=function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},kg="g6-create-edge-assist-node-id",Mg=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).drop=function(t){return Eg(r,void 0,void 0,Tn().mark((function e(){var n;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.targetType,!["combo","node"].includes(n)||!this.source){e.next=6;break}return e.next=4,this.handleCreateEdge(t);case 4:e.next=8;break;case 6:return e.next=8,this.cancelEdge();case 8:case"end":return e.stop()}}),e,this)})))},r.handleCreateEdge=function(t){return Eg(r,void 0,void 0,Tn().mark((function e(){var n,r,i,a,o,s,u,c,l,h;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.validate(t)){e.next=2;break}return e.abrupt("return");case 2:if(a=this.context,o=a.graph,s=a.canvas,u=a.batch,c=a.element,l=this.options.style,!this.source){e.next=9;break}return this.createEdge(t),e.next=8,this.cancelEdge();case 8:return e.abrupt("return");case 9:return u.startBatch(),s.setCursor("crosshair"),this.source=this.getSelectedNodeIDs([t.target.id])[0],h=o.getElementData(this.source),o.addNodeData([{id:kg,style:{visibility:"hidden",ports:[{key:"port-1",placement:[.5,.5]}],x:null===(n=h.style)||void 0===n?void 0:n.x,y:null===(r=h.style)||void 0===r?void 0:r.y}}]),o.addEdgeData([{id:"g6-create-edge-assist-edge-id",source:this.source,target:kg,style:Object.assign({pointerEvents:"none"},l)}]),e.next=17,null===(i=c.draw({animation:!1}))||void 0===i?void 0:i.finished;case 17:case"end":return e.stop()}}),e,this)})))},r.updateAssistEdge=function(t){return Eg(r,void 0,void 0,Tn().mark((function e(){var n,r,i,a;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.source){e.next=2;break}return e.abrupt("return");case 2:return r=this.context,i=r.model,a=r.element,i.translateNodeTo(kg,[t.canvas.x,t.canvas.y]),e.next=6,null===(n=a.draw({animation:!1,silence:!0}))||void 0===n?void 0:n.finished;case 6:case"end":return e.stop()}}),e,this)})))},r.createEdge=function(t){var e,n,i=r.context.graph,a=r.options,o=a.style,s=a.onFinish,u=a.onCreate;if(void 0!==(null===(e=t.target)||void 0===e?void 0:e.id)&&void 0!==r.source){var c=null===(n=r.getSelectedNodeIDs([t.target.id]))||void 0===n?void 0:n[0],l="".concat(r.source,"-").concat(c,"-").concat(function(t){return wg[t=t||"g"]?wg[t]+=1:wg[t]=1,t+wg[t]}()),h=u({id:l,source:r.source,target:c,style:o});i.addEdgeData([h]),s(h)}},r.cancelEdge=function(){return Eg(r,void 0,void 0,Tn().mark((function t(){var e,n,r,i,a;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.source){t.next=2;break}return t.abrupt("return");case 2:return n=this.context,r=n.graph,i=n.element,a=n.batch,r.removeNodeData([kg]),this.source=void 0,t.next=7,null===(e=i.draw({animation:!1}))||void 0===e?void 0:e.finished;case 7:a.endBatch();case 8:case"end":return t.stop()}}),t,this)})))},r.bindEvents(),r}return N(e,t),b(e,[{key:"update",value:function(t){dn(e,"update",this,3)([t]),this.bindEvents()}},{key:"bindEvents",value:function(){var t=this.context.graph,e=this.options.trigger;this.unbindEvents(),"click"===e?(t.on(Qc.CLICK,this.handleCreateEdge),t.on(Uc.CLICK,this.handleCreateEdge),t.on(Yc.CLICK,this.cancelEdge),t.on(Kc.CLICK,this.cancelEdge)):(t.on(Qc.DRAG_START,this.handleCreateEdge),t.on(Uc.DRAG_START,this.handleCreateEdge),t.on(qc.POINTER_UP,this.drop)),t.on(qc.POINTER_MOVE,this.updateAssistEdge)}},{key:"getSelectedNodeIDs",value:function(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map((function(t){return t.id})).concat(t)))}},{key:"validate",value:function(t){if(this.destroyed)return!1;var e=this.options.enable;return cn(e)?e(t):!!e}},{key:"unbindEvents",value:function(){var t=this.context.graph;t.off(Qc.CLICK,this.handleCreateEdge),t.off(Uc.CLICK,this.handleCreateEdge),t.off(Yc.CLICK,this.cancelEdge),t.off(Kc.CLICK,this.cancelEdge),t.off(Qc.DRAG_START,this.handleCreateEdge),t.off(Uc.DRAG_START,this.handleCreateEdge),t.off(qc.POINTER_UP,this.drop),t.off(qc.POINTER_MOVE,this.updateAssistEdge)}},{key:"destroy",value:function(){this.unbindEvents(),dn(e,"destroy",this,3)([])}}])}(Rh);Mg.defaultOptions={animation:!0,enable:!0,style:{},trigger:"drag",onCreate:function(t){return t},onFinish:function(){}};const Sg=function(t,e,n){var r;return function(){var i=this,a=arguments,o=n&&!r;clearTimeout(r),r=setTimeout((function(){r=null,n||t.apply(i,a)}),e),o&&t.apply(i,a)}};var Og=function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},Ng=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).isDragging=!1,r.onDragStart=function(t){r.validate(t)&&(r.isDragging=!0,r.context.canvas.setCursor("grabbing"))},r.onDrag=function(t){var e,n,i,a;if(r.isDragging&&!gd.isPinching){var o=null!==(n=null===(e=t.movement)||void 0===e?void 0:e.x)&&void 0!==n?n:t.dx,s=null!==(a=null===(i=t.movement)||void 0===i?void 0:i.y)&&void 0!==a?a:t.dy;o|s&&r.translate([o,s],!1)}},r.onDragEnd=function(){var t,e;r.isDragging=!1,r.context.canvas.setCursor(r.defaultCursor),null===(e=(t=r.options).onFinish)||void 0===e||e.call(t)},r.invokeOnFinish=Sg((function(){var t,e;null===(e=(t=r.options).onFinish)||void 0===e||e.call(t)}),300),r.shortcut=new md(t.graph),r.bindEvents(),r.defaultCursor=r.context.canvas.getConfig().cursor||"default",r}return N(e,t),b(e,[{key:"update",value:function(t){this.unbindEvents(),dn(e,"update",this,3)([t]),this.bindEvents()}},{key:"bindEvents",value:function(){var t=this,e=this.options.trigger;if(ln(e)){var n=e.up,r=void 0===n?[]:n,i=e.down,a=void 0===i?[]:i,o=e.left,s=void 0===o?[]:o,u=e.right,c=void 0===u?[]:u;this.shortcut.bind(r,(function(e){return t.onTranslate([0,1],e)})),this.shortcut.bind(a,(function(e){return t.onTranslate([0,-1],e)})),this.shortcut.bind(s,(function(e){return t.onTranslate([1,0],e)})),this.shortcut.bind(c,(function(e){return t.onTranslate([-1,0],e)}))}else{var l=this.context.graph;l.on(qc.DRAG_START,this.onDragStart),l.on(qc.DRAG,this.onDrag),l.on(qc.DRAG_END,this.onDragEnd)}}},{key:"onTranslate",value:function(t,e){return Og(this,void 0,void 0,Tn().mark((function n(){var r,i;return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.validate(e)){n.next=2;break}return n.abrupt("return");case 2:return r=this.options.sensitivity,i=-1*r,n.next=6,this.translate(Gh(t,i),this.options.animation);case 6:this.invokeOnFinish();case 7:case"end":return n.stop()}}),n,this)})))}},{key:"translate",value:function(t,e){return Og(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=this.clampByDirection(t),t=this.clampByRange(t),n.next=4,this.context.graph.translateBy(t,e);case 4:case"end":return n.stop()}}),n,this)})))}},{key:"clampByDirection",value:function(t){var e=h(t,2),n=e[0],r=e[1],i=this.options.direction;return"x"===i?r=0:"y"===i&&(n=0),[n,r]}},{key:"clampByRange",value:function(t){var e=h(t,2),n=e[0],r=e[1],i=this.context,a=i.viewport,o=h(i.canvas.getSize(),2),s=o[0],u=o[1],c=h(Cl(this.options.range),4),l=[u*c[0],s*c[1],u*c[2],s*c[3]],d=Fl(jl(a.getCanvasCenter()),l),f=zh(a.getViewportCenter(),[n,r,0]);if(!zl(f,d)){var v=h(d.min,2),p=v[0],g=v[1],y=h(d.max,2),m=y[0],b=y[1];(f[0]<p&&n>0||f[0]>m&&n<0)&&(n=0),(f[1]<g&&r>0||f[1]>b&&r<0)&&(r=0)}return[n,r]}},{key:"validate",value:function(t){if(this.destroyed)return!1;var e=this.options.enable;return"function"==typeof e?e(t):!!e}},{key:"unbindEvents",value:function(){this.shortcut.unbindAll();var t=this.context.graph;t.off(qc.DRAG_START,this.onDragStart),t.off(qc.DRAG,this.onDrag),t.off(qc.DRAG_END,this.onDragEnd)}},{key:"destroy",value:function(){this.shortcut.destroy(),this.unbindEvents(),this.context.canvas.setCursor(this.defaultCursor),dn(e,"destroy",this,3)([])}}])}(Rh);Ng.defaultOptions={enable:function(t){return!("targetType"in t)||"canvas"===t.targetType},sensitivity:10,direction:"both",range:1/0};var Ag=function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},Tg=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).enable=!1,r.enableElements=["node","combo"],r.target=[],r.shadowOrigin=[0,0],r.hiddenEdges=[],r.isDragging=!1,r.onDrop=function(t){return Ag(r,void 0,void 0,Tn().mark((function e(){var n,r,i,a,o;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("link"===this.options.dropEffect){e.next=2;break}return e.abrupt("return");case 2:return r=this.context,i=r.model,a=r.element,o=t.target.id,this.target.forEach((function(t){var e=i.getParentData(t,nl);e&&yh(e)===o&&i.refreshComboData(o),i.setParent(t,o,nl)})),e.next=7,null===(n=null==a?void 0:a.draw({animation:!0}))||void 0===n?void 0:n.finished;case 7:case"end":return e.stop()}}),e,this)})))},r.setCursor=function(t){if(!r.isDragging){var e=t.type,n=r.context.canvas,i=r.options.cursor;e===qc.POINTER_ENTER?n.setCursor((null==i?void 0:i.grab)||"grab"):n.setCursor((null==i?void 0:i.default)||"default")}},r.onDragStart=r.onDragStart.bind(r),r.onDrag=r.onDrag.bind(r),r.onDragEnd=r.onDragEnd.bind(r),r.onDrop=r.onDrop.bind(r),r.bindEvents(),r}return N(e,t),b(e,[{key:"update",value:function(t){this.unbindEvents(),dn(e,"update",this,3)([t]),this.bindEvents()}},{key:"bindEvents",value:function(){var t=this,e=this.context,n=e.graph,r=e.canvas.getLayer().getContextService().$canvas;r&&(r.addEventListener("blur",this.onDragEnd),r.addEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach((function(e){n.on("".concat(e,":").concat(qc.DRAG_START),t.onDragStart),n.on("".concat(e,":").concat(qc.DRAG),t.onDrag),n.on("".concat(e,":").concat(qc.DRAG_END),t.onDragEnd),n.on("".concat(e,":").concat(qc.POINTER_ENTER),t.setCursor),n.on("".concat(e,":").concat(qc.POINTER_LEAVE),t.setCursor)})),["link"].includes(this.options.dropEffect)&&(n.on(Uc.DROP,this.onDrop),n.on(Yc.DROP,this.onDrop))}},{key:"getSelectedNodeIDs",value:function(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map((function(t){return t.id})).concat(t)))}},{key:"getDelta",value:function(t){var e=this.context.graph.getZoom();return Vh([t.dx,t.dy],e)}},{key:"onDragStart",value:function(t){var e;if(this.enable=this.validate(t),this.enable){var n=this.context,r=n.batch,i=n.canvas,a=n.graph;i.setCursor((null===(e=this.options.cursor)||void 0===e?void 0:e.grabbing)||"grabbing"),this.isDragging=!0,r.startBatch();var o=t.target.id;a.getElementState(o).includes(this.options.state)?this.target=this.getSelectedNodeIDs([o]):this.target=[o],this.hideEdge(),this.context.graph.frontElement(this.target),this.options.shadow&&this.createShadow(this.target)}}},{key:"onDrag",value:function(t){if(this.enable){var e=this.getDelta(t);this.options.shadow?this.moveShadow(e):this.moveElement(this.target,e)}}},{key:"onDragEnd",value:function(){var t,e,n;if(this.enable=!1,this.options.shadow){if(!this.shadow)return;this.shadow.style.visibility="hidden";var r=this.shadow.attributes,i=r.x,a=void 0===i?0:i,o=r.y,s=h(zh([+a,+(void 0===o?0:o)],this.shadowOrigin),2),u=s[0],c=s[1];this.moveElement(this.target,[u,c])}this.showEdges(),null===(e=(t=this.options).onFinish)||void 0===e||e.call(t,this.target);var l=this.context,d=l.batch,f=l.canvas;d.endBatch(),f.setCursor((null===(n=this.options.cursor)||void 0===n?void 0:n.grab)||"grab"),this.isDragging=!1,this.target=[]}},{key:"validate",value:function(t){if(this.destroyed)return!1;var e=this.options.enable;return cn(e)?e(t):!!e}},{key:"moveElement",value:function(t,e){return Ag(this,void 0,void 0,Tn().mark((function n(){var r,i,a;return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=this.context,i=r.graph,a=r.model,"move"===this.options.dropEffect&&t.forEach((function(t){return a.refreshComboData(t)})),i.translateElementBy(Object.fromEntries(t.map((function(t){return[t,e]}))),!1);case 4:case"end":return n.stop()}}),n,this)})))}},{key:"moveShadow",value:function(t){if(this.shadow){var e=this.shadow.attributes,n=e.x,r=void 0===n?0:n,i=e.y,a=void 0===i?0:i,o=h(t,2),s=o[0],u=o[1];this.shadow.attr({x:+r+s,y:+a+u})}}},{key:"createShadow",value:function(t){var e=this,n=Dd(this.options,"shadow"),r=Bl(t.map((function(t){return e.context.element.getElement(t).getBounds()}))),i=h(r.min,2),a=i[0],o=i[1];this.shadowOrigin=[a,o];var s=h(_l(r),2),u={width:s[0],height:s[1],x:a,y:o};this.shadow?this.shadow.attr(Object.assign(Object.assign(Object.assign({},n),u),{visibility:"visible"})):(this.shadow=new Ou({style:Object.assign(Object.assign(Object.assign({$layer:"transient"},n),u),{pointerEvents:"none"})}),this.context.canvas.appendChild(this.shadow))}},{key:"showEdges",value:function(){this.options.shadow||0===this.hiddenEdges.length||(this.context.graph.showElement(this.hiddenEdges),this.hiddenEdges=[])}},{key:"hideEdge",value:function(){var t=this.options,e=t.hideEdge,n=t.shadow;if("none"!==e&&!n){var r=this.context.graph;this.hiddenEdges="all"===e?r.getEdgeData().map(yh):Array.from(new Set(this.target.map((function(t){return r.getRelatedEdgesData(t,e).map(yh)})).flat())),r.hideElement(this.hiddenEdges)}}},{key:"unbindEvents",value:function(){var t=this,e=this.context,n=e.graph,r=e.canvas.getLayer().getContextService().$canvas;r&&(r.removeEventListener("blur",this.onDragEnd),r.removeEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach((function(e){n.off("".concat(e,":").concat(qc.DRAG_START),t.onDragStart),n.off("".concat(e,":").concat(qc.DRAG),t.onDrag),n.off("".concat(e,":").concat(qc.DRAG_END),t.onDragEnd),n.off("".concat(e,":").concat(qc.POINTER_ENTER),t.setCursor),n.off("".concat(e,":").concat(qc.POINTER_LEAVE),t.setCursor)})),n.off("combo:".concat(qc.DROP),this.onDrop),n.off("canvas:".concat(qc.DROP),this.onDrop)}},{key:"destroy",value:function(){var t;this.unbindEvents(),null===(t=this.shadow)||void 0===t||t.destroy(),dn(e,"destroy",this,3)([])}}])}(Rh);Tg.defaultOptions={animation:!0,enable:function(t){return["node","combo"].includes(t.targetType)},dropEffect:"move",state:"selected",hideEdge:"none",shadow:!1,shadowZIndex:100,shadowFill:"#F3F9FF",shadowFillOpacity:.5,shadowStroke:"#1890FF",shadowStrokeOpacity:.9,shadowLineDash:[5,5],cursor:{default:"default",grab:"grab",grabbing:"grabbing"}};const Pg=function(){function t(){this._events={}}return t.prototype.on=function(t,e,n){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!n}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this._events[t]||[],a=this._events["*"]||[],o=function(r){for(var i=r.length,a=0;a<i;a++)if(r[a]){var o=r[a],s=o.callback;o.once&&(r.splice(a,1),0===r.length&&delete e._events[t],i--,a--),s.apply(e,n)}};o(i),o(a)},t.prototype.off=function(t,e){if(t)if(e){for(var n=this._events[t]||[],r=n.length,i=0;i<r;i++)n[i].callback===e&&(n.splice(i,1),r--,i--);0===n.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function Cg(t,e,n,r){for(;t.length;){var i=t.shift();if(n(i))return!0;e.add(i.id),r(i.id).forEach((function(n){e.has(n.id)||(e.add(n.id),t.push(n))}))}return!1}function Rg(t,e,n,r){if(n(t))return!0;e.add(t.id);var i,a=Rn(r(t.id));try{for(a.s();!(i=a.n()).done;){var o=i.value;if(!e.has(o.id)&&Rg(o,e,n,r))return!0}}catch(t){a.e(t)}finally{a.f()}return!1}var Lg=function(){return!0},Dg=function(){return b((function t(e){var n=this;y(this,t),v(this,"graph",void 0),v(this,"nodeFilter",void 0),v(this,"edgeFilter",void 0),v(this,"cacheEnabled",void 0),v(this,"inEdgesMap",new Map),v(this,"outEdgesMap",new Map),v(this,"bothEdgesMap",new Map),v(this,"allNodesMap",new Map),v(this,"allEdgesMap",new Map),v(this,"clearCache",(function(){n.inEdgesMap.clear(),n.outEdgesMap.clear(),n.bothEdgesMap.clear(),n.allNodesMap.clear(),n.allEdgesMap.clear()})),v(this,"refreshCache",(function(){n.clearCache(),n.updateCache(n.graph.getAllNodes().map((function(t){return t.id})))})),v(this,"updateCache",(function(t){var e=new Set;t.forEach((function(t){var r=n.bothEdgesMap.get(t);if(r&&r.forEach((function(t){return e.add(t.id)})),n.hasNode(t)){var i=n.graph.getRelatedEdges(t,"in").filter(n.edgeFilter),a=n.graph.getRelatedEdges(t,"out").filter(n.edgeFilter),o=Array.from(new Set([].concat(w(i),w(a))));o.forEach((function(t){return e.add(t.id)})),n.inEdgesMap.set(t,i),n.outEdgesMap.set(t,a),n.bothEdgesMap.set(t,o),n.allNodesMap.set(t,n.graph.getNode(t))}else n.inEdgesMap.delete(t),n.outEdgesMap.delete(t),n.bothEdgesMap.delete(t),n.allNodesMap.delete(t)})),e.forEach((function(t){n.hasEdge(t)?n.allEdgesMap.set(t,n.graph.getEdge(t)):n.allEdgesMap.delete(t)}))})),v(this,"handleGraphChanged",(function(t){var e=new Set;t.changes.forEach((function(n){switch(n.type){case"NodeAdded":case"NodeRemoved":e.add(n.value.id);break;case"NodeDataUpdated":e.add(n.id);break;case"EdgeAdded":case"EdgeRemoved":e.add(n.value.source),e.add(n.value.target);break;case"EdgeUpdated":"source"!==n.propertyName&&"target"!==n.propertyName||(e.add(n.oldValue),e.add(n.newValue));break;case"EdgeDataUpdated":if(t.graph.hasEdge(n.id)){var r=t.graph.getEdge(n.id);e.add(r.source),e.add(r.target)}}})),n.updateCache(e)})),this.graph=e.graph;var r=e.nodeFilter||Lg,i=e.edgeFilter||Lg;this.nodeFilter=r,this.edgeFilter=function(t){var e=n.graph.getEdgeDetail(t.id),a=e.source,o=e.target;return!(!r(a)||!r(o))&&i(t,a,o)},"auto"===e.cache?(this.cacheEnabled=!0,this.startAutoCache()):"manual"===e.cache?this.cacheEnabled=!0:this.cacheEnabled=!1}),[{key:"startAutoCache",value:function(){this.refreshCache(),this.graph.on("changed",this.handleGraphChanged)}},{key:"stopAutoCache",value:function(){this.graph.off("changed",this.handleGraphChanged)}},{key:"checkNodeExistence",value:function(t){this.getNode(t)}},{key:"hasNode",value:function(t){if(!this.graph.hasNode(t))return!1;var e=this.graph.getNode(t);return this.nodeFilter(e)}},{key:"areNeighbors",value:function(t,e){return this.checkNodeExistence(t),this.getNeighbors(e).some((function(e){return e.id===t}))}},{key:"getNode",value:function(t){var e=this.graph.getNode(t);if(!this.nodeFilter(e))throw new Error("Node not found for id: "+t);return e}},{key:"getRelatedEdges",value:function(t,e){return this.checkNodeExistence(t),this.cacheEnabled?"in"===e?this.inEdgesMap.get(t):"out"===e?this.outEdgesMap.get(t):this.bothEdgesMap.get(t):this.graph.getRelatedEdges(t,e).filter(this.edgeFilter)}},{key:"getDegree",value:function(t,e){return this.getRelatedEdges(t,e).length}},{key:"getSuccessors",value:function(t){var e=this,n=this.getRelatedEdges(t,"out").map((function(t){return e.getNode(t.target)}));return Array.from(new Set(n))}},{key:"getPredecessors",value:function(t){var e=this,n=this.getRelatedEdges(t,"in").map((function(t){return e.getNode(t.source)}));return Array.from(new Set(n))}},{key:"getNeighbors",value:function(t){var e=this.getPredecessors(t),n=this.getSuccessors(t);return Array.from(new Set([].concat(w(e),w(n))))}},{key:"hasEdge",value:function(t){if(!this.graph.hasEdge(t))return!1;var e=this.graph.getEdge(t);return this.edgeFilter(e)}},{key:"getEdge",value:function(t){var e=this.graph.getEdge(t);if(!this.edgeFilter(e))throw new Error("Edge not found for id: "+t);return e}},{key:"getEdgeDetail",value:function(t){var e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}},{key:"hasTreeStructure",value:function(t){return this.graph.hasTreeStructure(t)}},{key:"getRoots",value:function(t){return this.graph.getRoots(t).filter(this.nodeFilter)}},{key:"getChildren",value:function(t,e){return this.checkNodeExistence(t),this.graph.getChildren(t,e).filter(this.nodeFilter)}},{key:"getParent",value:function(t,e){this.checkNodeExistence(t);var n=this.graph.getParent(t,e);return n&&this.nodeFilter(n)?n:null}},{key:"getAllNodes",value:function(){return this.cacheEnabled?Array.from(this.allNodesMap.values()):this.graph.getAllNodes().filter(this.nodeFilter)}},{key:"getAllEdges",value:function(){return this.cacheEnabled?Array.from(this.allEdgesMap.values()):this.graph.getAllEdges().filter(this.edgeFilter)}},{key:"bfs",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"out",r={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];Cg([this.getNode(t)],new Set,e,r)}},{key:"dfs",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"out",r={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];Rg(this.getNode(t),new Set,e,r)}}])}(),_g=function(t){function e(t){var n;return y(this,e),v(n=S(this,e),"nodeMap",new Map),v(n,"edgeMap",new Map),v(n,"inEdgesMap",new Map),v(n,"outEdgesMap",new Map),v(n,"bothEdgesMap",new Map),v(n,"treeIndices",new Map),v(n,"changes",[]),v(n,"batchCount",0),v(n,"onChanged",(function(){})),v(n,"batch",(function(t){n.batchCount+=1,t(),n.batchCount-=1,n.batchCount||n.commit()})),t?(t.nodes&&n.addNodes(t.nodes),t.edges&&n.addEdges(t.edges),t.tree&&n.addTree(t.tree),t.onChanged&&(n.onChanged=t.onChanged),n):M(n)}return N(e,t),b(e,[{key:"commit",value:function(){var t=this.changes;this.changes=[];var e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}},{key:"reduceChanges",value:function(t){var e=[];return t.forEach((function(t){switch(t.type){case"NodeRemoved":var n=!1;e=e.filter((function(e){if("NodeAdded"===e.type){var r=e.value.id===t.value.id;return r&&(n=!0),!r}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id})),n||e.push(t);break;case"EdgeRemoved":var r=!1;e=e.filter((function(e){if("EdgeAdded"===e.type){var n=e.value.id===t.value.id;return n&&(r=!0),!n}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id})),r||e.push(t);break;case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":var i=e.findIndex((function(e){return e.type===t.type&&e.id===t.id&&(void 0===t.propertyName||e.propertyName===t.propertyName)})),a=e[i];a?void 0!==t.propertyName?a.newValue=t.newValue:(e.splice(i,1),e.push(t)):e.push(t);break;case"TreeStructureDetached":(e=e.filter((function(e){return"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey}))).push(t);break;case"TreeStructureChanged":var o=e.find((function(e){return"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId}));o?o.newParentId=t.newParentId:e.push(t);break;default:e.push(t)}})),e}},{key:"checkNodeExistence",value:function(t){this.getNode(t)}},{key:"hasNode",value:function(t){return this.nodeMap.has(t)}},{key:"areNeighbors",value:function(t,e){return this.getNeighbors(e).some((function(e){return e.id===t}))}},{key:"getNode",value:function(t){var e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}},{key:"getRelatedEdges",value:function(t,e){if(this.checkNodeExistence(t),"in"===e){var n=this.inEdgesMap.get(t);return Array.from(n)}if("out"===e){var r=this.outEdgesMap.get(t);return Array.from(r)}var i=this.bothEdgesMap.get(t);return Array.from(i)}},{key:"getDegree",value:function(t,e){return this.getRelatedEdges(t,e).length}},{key:"getSuccessors",value:function(t){var e=this,n=this.getRelatedEdges(t,"out").map((function(t){return e.getNode(t.target)}));return Array.from(new Set(n))}},{key:"getPredecessors",value:function(t){var e=this,n=this.getRelatedEdges(t,"in").map((function(t){return e.getNode(t.source)}));return Array.from(new Set(n))}},{key:"getNeighbors",value:function(t){var e=this.getPredecessors(t),n=this.getSuccessors(t);return Array.from(new Set([].concat(w(e),w(n))))}},{key:"doAddNode",value:function(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach((function(e){e.childrenMap.set(t.id,new Set)})),this.changes.push({type:"NodeAdded",value:t})}},{key:"addNodes",value:function(t){var e=this;this.batch((function(){var n,r=Rn(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.doAddNode(i)}}catch(t){r.e(t)}finally{r.f()}}))}},{key:"addNode",value:function(t){this.addNodes([t])}},{key:"doRemoveNode",value:function(t){var e=this,n=this.getNode(t),r=this.bothEdgesMap.get(t);null==r||r.forEach((function(t){return e.doRemoveEdge(t.id)})),this.nodeMap.delete(t),this.treeIndices.forEach((function(e){var r,i;null===(r=e.childrenMap.get(t))||void 0===r||r.forEach((function(t){e.parentMap.delete(t.id)}));var a=e.parentMap.get(t);a&&(null===(i=e.childrenMap.get(a.id))||void 0===i||i.delete(n)),e.parentMap.delete(t),e.childrenMap.delete(t)})),this.bothEdgesMap.delete(t),this.inEdgesMap.delete(t),this.outEdgesMap.delete(t),this.changes.push({type:"NodeRemoved",value:n})}},{key:"removeNodes",value:function(t){var e=this;this.batch((function(){t.forEach((function(t){return e.doRemoveNode(t)}))}))}},{key:"removeNode",value:function(t){this.removeNodes([t])}},{key:"updateNodeDataProperty",value:function(t,e,n){var r=this,i=this.getNode(t);this.batch((function(){var a=i.data[e],o=n;i.data[e]=o,r.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:a,newValue:o})}))}},{key:"mergeNodeData",value:function(t,e){var n=this;this.batch((function(){Object.entries(e).forEach((function(e){var r=h(e,2),i=r[0],a=r[1];n.updateNodeDataProperty(t,i,a)}))}))}},{key:"updateNodeData",value:function(){var t,e=this,n=arguments.length<=0?void 0:arguments[0],r=this.getNode(n);"string"!=typeof(arguments.length<=1?void 0:arguments[1])?("function"==typeof(arguments.length<=1?void 0:arguments[1])?t=(arguments.length<=1?void 0:arguments[1])(r.data):"object"==typeof(arguments.length<=1?void 0:arguments[1])&&(t=arguments.length<=1?void 0:arguments[1]),this.batch((function(){var i=r.data,a=t;r.data=t,e.changes.push({type:"NodeDataUpdated",id:n,oldValue:i,newValue:a})}))):this.updateNodeDataProperty(n,arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},{key:"checkEdgeExistence",value:function(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}},{key:"hasEdge",value:function(t){return this.edgeMap.has(t)}},{key:"getEdge",value:function(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}},{key:"getEdgeDetail",value:function(t){var e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}},{key:"doAddEdge",value:function(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);var e=this.inEdgesMap.get(t.target),n=this.outEdgesMap.get(t.source),r=this.bothEdgesMap.get(t.source),i=this.bothEdgesMap.get(t.target);e.add(t),n.add(t),r.add(t),i.add(t),this.changes.push({type:"EdgeAdded",value:t})}},{key:"addEdges",value:function(t){var e=this;this.batch((function(){var n,r=Rn(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.doAddEdge(i)}}catch(t){r.e(t)}finally{r.f()}}))}},{key:"addEdge",value:function(t){this.addEdges([t])}},{key:"doRemoveEdge",value:function(t){var e=this.getEdge(t),n=this.outEdgesMap.get(e.source),r=this.inEdgesMap.get(e.target),i=this.bothEdgesMap.get(e.source),a=this.bothEdgesMap.get(e.target);n.delete(e),r.delete(e),i.delete(e),a.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}},{key:"removeEdges",value:function(t){var e=this;this.batch((function(){t.forEach((function(t){return e.doRemoveEdge(t)}))}))}},{key:"removeEdge",value:function(t){this.removeEdges([t])}},{key:"updateEdgeSource",value:function(t,e){var n=this,r=this.getEdge(t);this.checkNodeExistence(e);var i=r.source,a=e;this.outEdgesMap.get(i).delete(r),this.bothEdgesMap.get(i).delete(r),this.outEdgesMap.get(a).add(r),this.bothEdgesMap.get(a).add(r),r.source=e,this.batch((function(){n.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:i,newValue:a})}))}},{key:"updateEdgeTarget",value:function(t,e){var n=this,r=this.getEdge(t);this.checkNodeExistence(e);var i=r.target,a=e;this.inEdgesMap.get(i).delete(r),this.bothEdgesMap.get(i).delete(r),this.inEdgesMap.get(a).add(r),this.bothEdgesMap.get(a).add(r),r.target=e,this.batch((function(){n.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:i,newValue:a})}))}},{key:"updateEdgeDataProperty",value:function(t,e,n){var r=this,i=this.getEdge(t);this.batch((function(){var a=i.data[e],o=n;i.data[e]=o,r.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:a,newValue:o})}))}},{key:"updateEdgeData",value:function(){var t,e=this,n=arguments.length<=0?void 0:arguments[0],r=this.getEdge(n);"string"!=typeof(arguments.length<=1?void 0:arguments[1])?("function"==typeof(arguments.length<=1?void 0:arguments[1])?t=(arguments.length<=1?void 0:arguments[1])(r.data):"object"==typeof(arguments.length<=1?void 0:arguments[1])&&(t=arguments.length<=1?void 0:arguments[1]),this.batch((function(){var i=r.data,a=t;r.data=t,e.changes.push({type:"EdgeDataUpdated",id:n,oldValue:i,newValue:a})}))):this.updateEdgeDataProperty(n,arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},{key:"mergeEdgeData",value:function(t,e){var n=this;this.batch((function(){Object.entries(e).forEach((function(e){var r=h(e,2),i=r[0],a=r[1];n.updateEdgeDataProperty(t,i,a)}))}))}},{key:"checkTreeExistence",value:function(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}},{key:"hasTreeStructure",value:function(t){return this.treeIndices.has(t)}},{key:"attachTreeStructure",value:function(t){var e=this;this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch((function(){e.changes.push({type:"TreeStructureAttached",treeKey:t})})))}},{key:"detachTreeStructure",value:function(t){var e=this;this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch((function(){e.changes.push({type:"TreeStructureDetached",treeKey:t})}))}},{key:"addTree",value:function(t,e){var n=this;this.batch((function(){n.attachTreeStructure(e);for(var r=[],i=Array.isArray(t)?t:[t];i.length;){var a=i.shift();r.push(a),a.children&&i.push.apply(i,w(a.children))}n.addNodes(r),r.forEach((function(t){var r;null===(r=t.children)||void 0===r||r.forEach((function(r){n.setParent(r.id,t.id,e)}))}))}))}},{key:"getRoots",value:function(t){var e=this;return this.checkTreeExistence(t),this.getAllNodes().filter((function(n){return!e.getParent(n.id,t)}))}},{key:"getChildren",value:function(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);var n=this.treeIndices.get(e).childrenMap.get(t);return Array.from(n||[])}},{key:"getParent",value:function(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}},{key:"getAncestors",value:function(t,e){for(var n,r=[],i=this.getNode(t);n=this.getParent(i.id,e);)r.push(n),i=n;return r}},{key:"setParent",value:function(t,e,n){var r=this;this.checkTreeExistence(n);var i=this.treeIndices.get(n);if(i){var a=this.getNode(t),o=i.parentMap.get(t);if((null==o?void 0:o.id)!==e)if(null!=e){var s,u=this.getNode(e);i.parentMap.set(t,u),o&&(null===(s=i.childrenMap.get(o.id))||void 0===s||s.delete(a));var c=i.childrenMap.get(u.id);c||(c=new Set,i.childrenMap.set(u.id,c)),c.add(a),this.batch((function(){r.changes.push({type:"TreeStructureChanged",treeKey:n,nodeId:t,oldParentId:null==o?void 0:o.id,newParentId:u.id})}))}else{var l;o&&(null===(l=i.childrenMap.get(o.id))||void 0===l||l.delete(a)),i.parentMap.delete(t)}}}},{key:"dfsTree",value:function(t,e,n){var r=this;return Rg(this.getNode(t),new Set,e,(function(t){return r.getChildren(t,n)}))}},{key:"bfsTree",value:function(t,e,n){var r=this;return Cg([this.getNode(t)],new Set,e,(function(t){return r.getChildren(t,n)}))}},{key:"getAllNodes",value:function(){return Array.from(this.nodeMap.values())}},{key:"getAllEdges",value:function(){return Array.from(this.edgeMap.values())}},{key:"bfs",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"out",r={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];return Cg([this.getNode(t)],new Set,e,r)}},{key:"dfs",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"out",r={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];return Rg(this.getNode(t),new Set,e,r)}},{key:"clone",value:function(){var t=new e({nodes:this.getAllNodes().map((function(t){return g(g({},t),{},{data:g({},t.data)})})),edges:this.getAllEdges().map((function(t){return g(g({},t),{},{data:g({},t.data)})}))});return this.treeIndices.forEach((function(e,n){var r=e.parentMap,i=e.childrenMap,a=new Map;r.forEach((function(e,n){a.set(n,t.getNode(e.id))}));var o=new Map;i.forEach((function(e,n){o.set(n,new Set(Array.from(e).map((function(e){return t.getNode(e.id)}))))})),t.treeIndices.set(n,{parentMap:a,childrenMap:o})})),t}},{key:"toJSON",value:function(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}},{key:"createView",value:function(t){return new Dg(g({graph:this},t))}}])}(Pg),Ig=b((function t(e,n){y(this,t),this.context=e,this.options=n||{}}));function jg(t){var e=t.type;return["compact-box","mindmap","dendrogram","indented"].includes(e)}function Fg(t){var e=t.nodes,n=t.edges,r={nodes:[],edges:[],combos:[]};return e.forEach((function(t){var e=t.data._isCombo?r.combos:r.nodes,n=t.data,i=n.x,a=n.y,o=n.z,s=void 0===o?0:o;null==e||e.push({id:t.id,style:{x:i,y:a,z:s}})})),n.forEach((function(t){var e=t.id,n=t.source,i=t.target,a=t.data,o=a.points,s=void 0===o?[]:o,u=a.controlPoints,c=void 0===u?s.slice(1,s.length-1):u;r.edges.push({id:e,source:n,target:i,style:Object.assign({},(null==c?void 0:c.length)?{controlPoints:c.map(id)}:{})})})),r}function Bg(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e in t)return t[e].apply(t,r);if("instance"in t){var a=t.instance;if(e in a)return a[e].apply(a,r)}return null}function zg(t,e){if(e in t)return t[e];if("instance"in t){var n=t.instance;if(e in n)return n[e]}return null}var Gg=function(t){function e(){return y(this,e),S(this,e,arguments)}return N(e,t),b(e,[{key:"forceLayoutInstance",get:function(){return this.context.layout.getLayoutInstance().find((function(t){return["d3-force","d3-force-3d"].includes(null==t?void 0:t.id)}))}},{key:"validate",value:function(t){return!!this.context.layout&&(this.forceLayoutInstance?dn(e,"validate",this,3)([t]):(ll.warn("DragElementForce only works with d3-force or d3-force-3d layout"),!1))}},{key:"moveElement",value:function(t,e){return n=this,r=void 0,i=void 0,a=Tn().mark((function n(){var r;return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=this.forceLayoutInstance,this.context.graph.getNodeData(t).forEach((function(n,i){var a=n.style||{},o=a.x,s=void 0===o?0:o,u=a.y,c=void 0===u?0:u;r&&Bg(r,"setFixedPosition",t[i],w(Bh([+s,+c],e)))}));case 2:case"end":return n.stop()}}),n,this)})),new(i||(i=Promise))((function(t,e){function o(t){try{u(a.next(t))}catch(t){e(t)}}function s(t){try{u(a.throw(t))}catch(t){e(t)}}function u(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(o,s)}u((a=a.apply(n,r||[])).next())}));var n,r,i,a}},{key:"onDragStart",value:function(t){if(this.enable=this.validate(t),this.enable){this.target=this.getSelectedNodeIDs([t.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target);var e=this.forceLayoutInstance;e&&zg(e,"simulation").alphaTarget(.3).restart(),this.context.graph.getNodeData(this.target).forEach((function(t){var n=t.style||{},r=n.x,i=void 0===r?0:r,a=n.y,o=void 0===a?0:a;e&&Bg(e,"setFixedPosition",yh(t),[+i,+o])}))}}},{key:"onDrag",value:function(t){if(this.enable){var e=this.getDelta(t);this.moveElement(this.target,e)}}},{key:"onDragEnd",value:function(){var t=this.forceLayoutInstance;t&&zg(t,"simulation").alphaTarget(0),this.options.fixed||this.context.graph.getNodeData(this.target).forEach((function(e){t&&Bg(t,"setFixedPosition",yh(e),[null,null,null])}))}}])}(Tg),Vg=function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},Wg=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).isZoomEvent=function(t){return Boolean(t.data&&"scale"in t.data)},r.relatedEdgeToUpdate=new Set,r.zoom=r.context.graph.getZoom(),r.fixElementSize=function(t){return Vg(r,void 0,void 0,Tn().mark((function e(){var n,r,i,a,o,s,u,c,l,h,d,f=this;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.validate(t)){e.next=2;break}return e.abrupt("return");case 2:n=this.context.graph,r=this.options,i=r.state,a=r.nodeFilter,o=r.edgeFilter,s=r.comboFilter,u=(i?n.getElementDataByState("node",i):n.getNodeData()).filter(a),c=(i?n.getElementDataByState("edge",i):n.getEdgeData()).filter(o),l=(i?n.getElementDataByState("combo",i):n.getComboData()).filter(s),h=this.isZoomEvent(t)?this.zoom=Math.max(.01,Math.min(t.data.scale,10)):this.zoom,(d=[].concat(w(u),w(l))).length>0&&d.forEach((function(t){return f.fixNodeLike(t,h)})),this.updateRelatedEdges(),c.length>0&&c.forEach((function(t){return f.fixEdge(t,h)}));case 12:case"end":return e.stop()}}),e,this)})))},r.cachedStyles=new Map,r.getOriginalFieldValue=function(t,e,n){var i,a=r.cachedStyles.get(t)||[],o=(null===(i=a.find((function(t){return t.shape===e})))||void 0===i?void 0:i.style)||{};return n in o||(o[n]=e.attributes[n],r.cachedStyles.set(t,[].concat(w(a.filter((function(t){return t.shape!==e}))),[{shape:e,style:o}]))),o[n]},r.scaleEntireElement=function(t,e,n){e.setLocalScale(1/n);var i=r.cachedStyles.get(t)||[];i.push({shape:e}),r.cachedStyles.set(t,i)},r.scaleSpecificShapes=function(t,e,n){var i,a,o=(i=[],(a=function(t){(null==t?void 0:t.children.length)&&t.children.forEach((function(t){i.push(t),a(t)}))})(t),i);(Array.isArray(n)?n:[n]).forEach((function(n){var i=n.shape,a=n.fields,s="function"==typeof i?i(o):t.getShape(i);s&&(a?a.forEach((function(n){var i=r.getOriginalFieldValue(t.id,s,n);oe(i)&&(s.style[n]=i/e)})):r.scaleEntireElement(t.id,s,e))}))},r.skipIfExceedViewport=function(t){var e=r.context.viewport;return!(null==e?void 0:e.isInViewport(t.getRenderBounds(),!1,30))},r.fixNodeLike=function(t,e){var n=yh(t),i=r.context,a=i.element,o=i.model,s=a.getElement(n);if(s&&!r.skipIfExceedViewport(s)){o.getRelatedEdgesData(n).forEach((function(t){return r.relatedEdgeToUpdate.add(yh(t))}));var u=r.options[s.type];u?r.scaleSpecificShapes(s,e,u):r.scaleEntireElement(n,s,e)}},r.fixEdge=function(t,e){var n=yh(t),i=r.context.element.getElement(n);if(i&&!r.skipIfExceedViewport(i)){var a=r.options.edge;if(!a)return i.style.transformOrigin="center",void r.scaleEntireElement(n,i,e);r.scaleSpecificShapes(i,e,a)}},r.updateRelatedEdges=function(){var t=r.context.element;r.relatedEdgeToUpdate.size>0&&r.relatedEdgeToUpdate.forEach((function(e){var n=t.getElement(e);null==n||n.update({})})),r.relatedEdgeToUpdate.clear()},r.resetTransform=function(t){return Vg(r,void 0,void 0,Tn().mark((function e(){var n;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(n=t.data)||void 0===n?void 0:n.firstRender)){e.next=2;break}return e.abrupt("return");case 2:this.options.reset?this.restoreCachedStyles():this.fixElementSize({data:{scale:this.zoom}});case 3:case"end":return e.stop()}}),e,this)})))},r.bindEvents(),r}return N(e,t),b(e,[{key:"restoreCachedStyles",value:function(){var t=this;if(this.cachedStyles.size>0){this.cachedStyles.forEach((function(e){e.forEach((function(e){var n=e.shape,r=e.style;if(qd(r))n.setLocalScale(1);else{if(t.options.state)return;Object.entries(r).forEach((function(t){var e=h(t,2),r=e[0],i=e[1];return n.style[r]=i}))}}))}));var e=this.context,n=e.graph,r=e.element,i=Object.keys(Object.fromEntries(this.cachedStyles)).filter((function(t){return t&&"node"===n.getElementType(t)}));if(i.length>0){var a=new Set;i.forEach((function(t){n.getRelatedEdgesData(t).forEach((function(t){return a.add(yh(t))}))})),a.forEach((function(t){var e=null==r?void 0:r.getElement(t);null==e||e.update({})}))}}}},{key:"bindEvents",value:function(){var t=this.context.graph;t.on($c.AFTER_DRAW,this.resetTransform),t.on($c.AFTER_TRANSFORM,this.fixElementSize)}},{key:"unbindEvents",value:function(){var t=this.context.graph;t.off($c.AFTER_DRAW,this.resetTransform),t.off($c.AFTER_TRANSFORM,this.fixElementSize)}},{key:"validate",value:function(t){if(this.destroyed)return!1;var e=this.options.enable;return cn(e)?e(t):!!e}},{key:"destroy",value:function(){this.unbindEvents(),dn(e,"destroy",this,3)([])}}])}(Rh);Wg.defaultOptions={enable:function(t){return t.data.scale<1},nodeFilter:function(){return!0},edgeFilter:function(){return!0},comboFilter:function(){return!0},edge:[{shape:"key",fields:["lineWidth"]},{shape:"halo",fields:["lineWidth"]},{shape:"label"}],reset:!1};var Hg=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).focus=function(t){return e=r,n=void 0,i=void 0,a=Tn().mark((function e(){var n;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.validate(t)){e.next=2;break}return e.abrupt("return");case 2:return n=this.context.graph,e.next=5,n.focusElement(t.target.id,this.options.animation);case 5:case"end":return e.stop()}}),e,this)})),new(i||(i=Promise))((function(t,r){function o(t){try{u(a.next(t))}catch(t){r(t)}}function s(t){try{u(a.throw(t))}catch(t){r(t)}}function u(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(o,s)}u((a=a.apply(e,n||[])).next())}));var e,n,i,a},r.bindEvents(),r}return N(e,t),b(e,[{key:"bindEvents",value:function(){var t=this,e=this.context.graph;this.unbindEvents(),Ed.forEach((function(n){e.on("".concat(n,":").concat(qc.CLICK),t.focus)}))}},{key:"validate",value:function(t){if(this.destroyed)return!1;var e=this.options.enable;return cn(e)?e(t):!!e}},{key:"unbindEvents",value:function(){var t=this,e=this.context.graph;Ed.forEach((function(n){e.off("".concat(n,":").concat(qc.CLICK),t.focus)}))}},{key:"destroy",value:function(){this.unbindEvents(),dn(e,"destroy",this,3)([])}}])}(Rh);Hg.defaultOptions={animation:{easing:"ease-in",duration:500},enable:!0};var Yg=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).isFrozen=!1,r.toggleFrozen=function(t){r.isFrozen="dragstart"===t.type},r.hoverElement=function(t){if(r.validate(t)){var e=t.type===qc.POINTER_ENTER;r.updateElementsState(t,e);var n=r.options,i=n.onHover,a=n.onHoverEnd;e?null==i||i(t):null==a||a(t)}},r.updateElementsState=function(t,e){if(r.options.state||r.options.inactiveState){var n=r.context.graph,i=r.options,a=i.state,o=i.animation,s=i.inactiveState,u=r.getActiveIds(t),c={};if(a&&Object.assign(c,r.getElementsState(u,a,e)),s){var l=bh(n.getData(),!0).filter((function(t){return!u.includes(t)}));Object.assign(c,r.getElementsState(l,s,e))}n.setElementState(c,o)}},r.getElementsState=function(t,e,n){var i=r.context.graph,a={};return t.forEach((function(t){var r=i.getElementState(t);a[t]=n?r.includes(e)?r:[].concat(w(r),[e]):r.filter((function(t){return t!==e}))})),a},r.bindEvents(),r}return N(e,t),b(e,[{key:"bindEvents",value:function(){var t=this,e=this.context.graph;this.unbindEvents(),Ed.forEach((function(n){e.on("".concat(n,":").concat(qc.POINTER_ENTER),t.hoverElement),e.on("".concat(n,":").concat(qc.POINTER_LEAVE),t.hoverElement)}));var n=this.context.canvas.document;n.addEventListener("".concat(qc.DRAG_START),this.toggleFrozen),n.addEventListener("".concat(qc.DRAG_END),this.toggleFrozen)}},{key:"getActiveIds",value:function(t){var e=this.context.graph,n=this.options,r=n.degree,i=n.direction,a=t.target.id;return r?Md(e,t.targetType,a,"function"==typeof r?r(t):r,i):[a]}},{key:"validate",value:function(t){if(this.destroyed||this.isFrozen||bg(t.target)||this.context.graph.isCollapsingExpanding)return!1;var e=this.options.enable;return cn(e)?e(t):!!e}},{key:"unbindEvents",value:function(){var t=this,e=this.context.graph;Ed.forEach((function(n){e.off("".concat(n,":").concat(qc.POINTER_ENTER),t.hoverElement),e.off("".concat(n,":").concat(qc.POINTER_LEAVE),t.hoverElement)}));var n=this.context.canvas.document;n.removeEventListener("".concat(qc.DRAG_START),this.toggleFrozen),n.removeEventListener("".concat(qc.DRAG_END),this.toggleFrozen)}},{key:"destroy",value:function(){this.unbindEvents(),dn(e,"destroy",this,3)([])}}])}(Rh);Yg.defaultOptions={animation:!1,enable:!0,degree:0,direction:"both",state:"active",inactiveState:void 0};var Ug=function(t){function e(){return y(this,e),S(this,e,arguments)}return N(e,t),b(e,[{key:"onPointerDown",value:function(t){if(dn(e,"validate",this,3)([t])&&dn(e,"isKeydown",this,3)([])&&!this.points){var n=this.context.canvas;this.pathShape=new wu({id:"g6-lasso-select",style:this.options.style}),n.appendChild(this.pathShape),this.points=[xd(t)]}}},{key:"onPointerMove",value:function(t){var n;if(this.points){var r=this.options,i=r.immediately,a=r.mode;this.points.push(xd(t)),null===(n=this.pathShape)||void 0===n||n.setAttribute("d",function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=[];return t.forEach((function(t,e){n.push([0===e?"M":"L"].concat(w(t)))})),e&&n.push(["Z"]),n}(this.points)),i&&"default"===a&&this.points.length>2&&dn(e,"updateElementsStates",this,3)([this.points])}}},{key:"onPointerUp",value:function(){this.points&&(this.points.length<2||dn(e,"updateElementsStates",this,3)([this.points]),this.clearLasso())}},{key:"clearLasso",value:function(){var t;null===(t=this.pathShape)||void 0===t||t.remove(),this.pathShape=void 0,this.points=void 0}}])}(bd),qg=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).hiddenShapes=[],r.isVisible=!0,r.setElementsVisibility=function(t,e,n){t.filter(Boolean).forEach((function(t){"hidden"!==e||t.isVisible()?"visible"===e&&r.hiddenShapes.includes(t)?r.hiddenShapes.splice(r.hiddenShapes.indexOf(t),1):Th(t,e,n):r.hiddenShapes.push(t)}))},r.filterShapes=function(t,e){if(cn(e))return function(n){return!e(t,n)};var n=null==e?void 0:e[t];return function(t){return!t.className||!(null==n?void 0:n.includes(t.className))}},r.hideShapes=function(t){if(r.validate(t)&&r.isVisible){var e=r.context.element,n=r.options.shapes,i=void 0===n?{}:n;r.setElementsVisibility(e.getNodes(),"hidden",r.filterShapes("node",i)),r.setElementsVisibility(e.getEdges(),"hidden",r.filterShapes("edge",i)),r.setElementsVisibility(e.getCombos(),"hidden",r.filterShapes("combo",i)),r.isVisible=!1}},r.showShapes=Sg((function(t){if(r.validate(t)&&!r.isVisible){var e=r.context.element;r.setElementsVisibility(e.getNodes(),"visible"),r.setElementsVisibility(e.getEdges(),"visible"),r.setElementsVisibility(e.getCombos(),"visible"),r.isVisible=!0}}),r.options.debounce),r.bindEvents(),r}return N(e,t),b(e,[{key:"bindEvents",value:function(){var t=this.context.graph;t.on($c.BEFORE_TRANSFORM,this.hideShapes),t.on($c.AFTER_TRANSFORM,this.showShapes)}},{key:"unbindEvents",value:function(){var t=this.context.graph;t.off($c.BEFORE_TRANSFORM,this.hideShapes),t.off($c.AFTER_TRANSFORM,this.showShapes)}},{key:"validate",value:function(t){if(this.destroyed)return!1;var e=this.options.enable;return cn(e)?e(t):!!e}},{key:"update",value:function(t){this.unbindEvents(),dn(e,"update",this,3)([t]),this.bindEvents()}},{key:"destroy",value:function(){this.unbindEvents(),dn(e,"destroy",this,3)([])}}])}(Rh);qg.defaultOptions={enable:!0,debounce:200,shapes:function(t){return"node"===t}};var Xg=function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},Kg=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).onWheel=function(t){return Xg(r,void 0,void 0,Tn().mark((function e(){var n,r;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.options.preventDefault&&t.preventDefault(),n=t.deltaX,r=t.deltaY,e.next=5,this.scroll([-n,-r],t);case 5:case"end":return e.stop()}}),e,this)})))},r.shortcut=new md(t.graph),r.bindEvents(),r}return N(e,t),b(e,[{key:"update",value:function(t){dn(e,"update",this,3)([t]),this.bindEvents()}},{key:"bindEvents",value:function(){var t,e,n=this,r=this.options.trigger;if(this.shortcut.unbindAll(),ln(r)){null===(t=this.graphDom)||void 0===t||t.removeEventListener(qc.WHEEL,this.onWheel);var i=r.up,a=void 0===i?[]:i,o=r.down,s=void 0===o?[]:o,u=r.left,c=void 0===u?[]:u,l=r.right,h=void 0===l?[]:l;this.shortcut.bind(a,(function(t){return n.scroll([0,-10],t)})),this.shortcut.bind(s,(function(t){return n.scroll([0,10],t)})),this.shortcut.bind(c,(function(t){return n.scroll([-10,0],t)})),this.shortcut.bind(h,(function(t){return n.scroll([10,0],t)}))}else null===(e=this.graphDom)||void 0===e||e.addEventListener(qc.WHEEL,this.onWheel,{passive:!1})}},{key:"graphDom",get:function(){return this.context.graph.getCanvas().getContextService().getDomElement()}},{key:"formatDisplacement",value:function(t){return t=Gh(t,this.options.sensitivity),t=this.clampByDirection(t),this.clampByRange(t)}},{key:"clampByDirection",value:function(t){var e=h(t,2),n=e[0],r=e[1],i=this.options.direction;return"x"===i?r=0:"y"===i&&(n=0),[n,r]}},{key:"clampByRange",value:function(t){var e=h(t,2),n=e[0],r=e[1],i=this.context,a=i.viewport,o=h(i.canvas.getSize(),2),s=o[0],u=o[1],c=h(Cl(this.options.range),4),l=[u*c[0],s*c[1],u*c[2],s*c[3]],d=Fl(jl(a.getCanvasCenter()),l),f=zh(a.getViewportCenter(),[n,r,0]);if(!zl(f,d)){var v=h(d.min,2),p=v[0],g=v[1],y=h(d.max,2),m=y[0],b=y[1];(f[0]<p&&n>0||f[0]>m&&n<0)&&(n=0),(f[1]<g&&r>0||f[1]>b&&r<0)&&(r=0)}return[n,r]}},{key:"scroll",value:function(t,e){return Xg(this,void 0,void 0,Tn().mark((function n(){var r,i,a;return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.validate(e)){n.next=2;break}return n.abrupt("return");case 2:return r=this.options.onFinish,i=this.context.graph,a=this.formatDisplacement(t),n.next=7,i.translateBy(a,!1);case 7:null==r||r();case 8:case"end":return n.stop()}}),n,this)})))}},{key:"validate",value:function(t){if(this.destroyed)return!1;var e=this.options.enable;return cn(e)?e(t):!!e}},{key:"destroy",value:function(){var t;this.shortcut.destroy(),null===(t=this.graphDom)||void 0===t||t.removeEventListener(qc.WHEEL,this.onWheel),dn(e,"destroy",this,3)([])}}])}(Rh);Kg.defaultOptions={enable:!0,sensitivity:1,preventDefault:!0,range:1/0};var $g=function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},Zg=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).zoom=function(t,e,n){return $g(r,void 0,void 0,Tn().mark((function r(){var i,a,o,s,u,c,l;return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.validate(e)){r.next=2;break}return r.abrupt("return");case 2:return i=this.context.graph,"viewport"in e&&(a=id(e.viewport)),o=this.options,s=o.sensitivity,u=o.onFinish,c=1+le(t,-50,50)*s/100,l=i.getZoom(),r.next=9,i.zoomTo(l*c,n,a);case 9:null==u||u();case 10:case"end":return r.stop()}}),r,this)})))},r.onReset=function(){return $g(r,void 0,void 0,Tn().mark((function t(){return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.context.graph.zoomTo(1,this.options.animation);case 2:case"end":return t.stop()}}),t,this)})))},r.preventDefault=function(t){r.options.preventDefault&&t.preventDefault()},r.shortcut=new md(t.graph),r.bindEvents(),r}return N(e,t),b(e,[{key:"update",value:function(t){dn(e,"update",this,3)([t]),this.bindEvents()}},{key:"bindEvents",value:function(){var t=this,e=this.options.trigger;if(this.shortcut.unbindAll(),Array.isArray(e))if(e.includes(qc.PINCH))this.shortcut.bind([qc.PINCH],(function(e){t.zoom(e.scale,e,!1)}));else{var n=this.context.canvas.getContainer();null==n||n.addEventListener(qc.WHEEL,this.preventDefault),this.shortcut.bind([].concat(w(e),[qc.WHEEL]),(function(e){var n=e.deltaX,r=e.deltaY;t.zoom(-(null!=r?r:n),e,!1)}))}if("object"==typeof e){var r=e.zoomIn,i=void 0===r?[]:r,a=e.zoomOut,o=void 0===a?[]:a,s=e.reset,u=void 0===s?[]:s;this.shortcut.bind(i,(function(e){return t.zoom(10,e,t.options.animation)})),this.shortcut.bind(o,(function(e){return t.zoom(-10,e,t.options.animation)})),this.shortcut.bind(u,this.onReset)}}},{key:"validate",value:function(t){if(this.destroyed)return!1;var e=this.options.enable;return cn(e)?e(t):!!e}},{key:"destroy",value:function(){var t;this.shortcut.destroy(),null===(t=this.context.canvas.getContainer())||void 0===t||t.removeEventListener(qc.WHEEL,this.preventDefault),dn(e,"destroy",this,3)([])}}])}(Rh);Zg.defaultOptions={animation:{duration:200},enable:!0,sensitivity:1,trigger:[],preventDefault:!0};var Qg=a(1423),Jg=function(t,e){if("next"!==t&&"prev"!==t)return e},ty=function(t){t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev},ey=function(t){function e(){return y(this,e),S(this,e,arguments)}return N(e,t),b(e)}(function(){return b((function t(){y(this,t);var e={};e.prev=e,e.next=e.prev,this.shortcut=e}),[{key:"dequeue",value:function(){var t=this.shortcut,e=t.prev;if(e&&e!==t)return ty(e),e}},{key:"enqueue",value:function(t){var e=this.shortcut;t.prev&&t.next&&ty(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e}},{key:"toString",value:function(){for(var t=[],e=this.shortcut,n=e.prev;n!==e;)t.push(JSON.stringify(n,Jg)),n=null==n?void 0:n.prev;return"[".concat(t.join(", "),"]")}}])}()),ny=function(){return 1},ry=function(t,e,n,r,i){var a,o,s=[];return t.hasNode(r.v)&&(null===(a=t.getRelatedEdges(r.v,"in"))||void 0===a||a.forEach((function(r){var a=r.data.weight,o=t.getNode(r.source);i&&s.push({v:r.source,w:r.target,in:0,out:0}),void 0===o.data.out&&(o.data.out=0),o.data.out-=a,iy(e,n,Object.assign({v:o.id},o.data))})),null===(o=t.getRelatedEdges(r.v,"out"))||void 0===o||o.forEach((function(r){var i=r.data.weight,a=r.target,o=t.getNode(a);void 0===o.data.in&&(o.data.in=0),o.data.in-=i,iy(e,n,Object.assign({v:o.id},o.data))})),t.removeNode(r.v)),i?s:void 0},iy=function(t,e,n){n.out?n.in?t[n.out-n.in+e].enqueue(n):t[t.length-1].enqueue(n):t[0].enqueue(n)},ay=function(t,e){var n="greedy"===e?function(t){var e;if(t.getAllNodes().length<=1)return[];var n=function(t,e){var n=new _g,r=0,i=0;t.getAllNodes().forEach((function(t){n.addNode({id:t.id,data:{v:t.id,in:0,out:0}})})),t.getAllEdges().forEach((function(t){var a=n.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target})),o=(null==e?void 0:e(t))||1;a?n.updateEdgeData(null==a?void 0:a.id,Object.assign(Object.assign({},a.data),{weight:a.data.weight+o})):n.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:o}}),i=Math.max(i,n.getNode(t.source).data.out+=o),r=Math.max(r,n.getNode(t.target).data.in+=o)}));for(var a=[],o=i+r+3,s=0;s<o;s++)a.push(new ey);var u=r+1;return n.getAllNodes().forEach((function(t){iy(a,u,Object.assign({v:t.id},n.getNode(t.id).data))})),{buckets:a,zeroIdx:u,graph:n}}(t,function(t){return t.data.weight||1}||ny);return null===(e=function(t,e,n){for(var r,i=[],a=e[e.length-1],o=e[0];t.getAllNodes().length;){for(;r=o.dequeue();)ry(t,e,n,r);for(;r=a.dequeue();)ry(t,e,n,r);if(t.getAllNodes().length)for(var s=e.length-2;s>0;--s)if(r=e[s].dequeue()){i=i.concat(ry(t,e,n,r,!0));break}}return i}(n.graph,n.buckets,n.zeroIdx).map((function(e){return t.getRelatedEdges(e.v,"out").filter((function(t){return t.target===e.w}))})))||void 0===e?void 0:e.flat()}(t):oy(t);null==n||n.forEach((function(e){var n=e.data;t.removeEdge(e.id),n.forwardName=e.data.name,n.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:Object.assign({},n)})}))},oy=function(t){var e=[],n={},r={},i=function(a){r[a]||(r[a]=!0,n[a]=!0,t.getRelatedEdges(a,"out").forEach((function(t){n[t.target]?e.push(t):i(t.target)})),delete n[a])};return t.getAllNodes().forEach((function(t){return i(t.id)})),e},sy=function(t,e,n,r){var i;do{i="".concat(r).concat(Math.random())}while(t.hasNode(i));return n.dummy=e,t.addNode({id:i,data:n}),i},uy=function(t){var e=new _g;return t.getAllNodes().forEach((function(n){t.getChildren(n.id).length||e.addNode(Object.assign({},n))})),t.getAllEdges().forEach((function(t){e.addEdge(t)})),e},cy=function(t,e){var n,r,i=Number(t.x),a=Number(t.y),o=Number(e.x)-i,s=Number(e.y)-a,u=Number(t.width)/2,c=Number(t.height)/2;return o||s?(Math.abs(s)*u>Math.abs(o)*c?(s<0&&(c=-c),n=c*o/s,r=c):(o<0&&(u=-u),n=u,r=u*s/o),{x:i+n,y:a+r}):{x:0,y:0}},ly=function(t){for(var e=[],n=dy(t)+1,r=0;r<n;r++)e.push([]);t.getAllNodes().forEach((function(t){var n=t.data.rank;void 0!==n&&e[n]&&e[n].push(t.id)}));for(var i=0;i<n;i++)e[i]=e[i].sort((function(e,n){return r=t.getNode(e).data.order,i=t.getNode(n).data.order,Number(r)-Number(i);var r,i}));return e},hy=function(t,e,n,r){var i={width:0,height:0};return oe(n)&&oe(r)&&(i.rank=n,i.order=r),sy(t,"border",i,e)},dy=function(t){var e;return t.getAllNodes().forEach((function(t){var n=t.data.rank;void 0!==n&&(void 0===e||n>e)&&(e=n)})),e||(e=0),e},fy=function(t,e){return t.reduce((function(t,n){return e(t)>e(n)?n:t}))},vy=function(t,e,n,r,i,a){r.includes(e.id)||(r.push(e.id),n||a.push(e.id),i(e.id).forEach((function(e){return vy(t,e,n,r,i,a)})),n&&a.push(e.id))},py=function(t,e,n,r){var i=Array.isArray(e)?e:[e],a=function(e){return r?t.getSuccessors(e):t.getNeighbors(e)},o=[],s=[];return i.forEach((function(e){if(!t.hasNode(e.id))throw new Error("Graph does not have node: ".concat(e));vy(t,e,"post"===n,s,a,o)})),o},gy=function(t,e,n,r,i,a){var o={rank:a,borderType:e,width:0,height:0},s=i.data[e][a-1],u=sy(t,"border",o,n);i.data[e][a]=u,t.setParent(u,r),s&&t.addEdge({id:"e".concat(Math.random()),source:s,target:u,data:{weight:1}})},yy=function(t){t.getAllNodes().forEach((function(t){my(t)})),t.getAllEdges().forEach((function(t){my(t)}))},my=function(t){var e=t.data.width;t.data.width=t.data.height,t.data.height=e},by=function(t){(null==t?void 0:t.y)&&(t.y=-t.y)},xy=function(t){var e=t.x;t.x=t.y,t.y=e},wy=function(t,e,n,r,i,a,o){var s=t.getChildren(o);if(null==s?void 0:s.length){var u=hy(t,"_bt"),c=hy(t,"_bb"),l=t.getNode(o);t.setParent(u,o),l.data.borderTop=u,t.setParent(c,o),l.data.borderBottom=c,null==s||s.forEach((function(s){wy(t,e,n,r,i,a,s.id);var l=s.data.borderTop?s.data.borderTop:s.id,h=s.data.borderBottom?s.data.borderBottom:s.id,d=s.data.borderTop?r:2*r,f=l!==h?1:i-a[o]+1;t.addEdge({id:"e".concat(Math.random()),source:u,target:l,data:{minlen:f,weight:d,nestingEdge:!0}}),t.addEdge({id:"e".concat(Math.random()),source:h,target:c,data:{minlen:f,weight:d,nestingEdge:!0}})})),t.getParent(o)||t.addEdge({id:"e".concat(Math.random()),source:e,target:u,data:{weight:0,minlen:i+a[o]}})}else o!==e&&t.addEdge({id:"e".concat(Math.random()),source:e,target:o,data:{weight:0,minlen:n}})},Ey="edge-label",ky=function(t,e,n){for(var r=function(t,e){return null==t?void 0:t.reduce((function(t,n,r){return t[n]=e[r],t}),{})}(n,n.map((function(t,e){return e}))),i=e.map((function(e){var n=t.getRelatedEdges(e,"out").map((function(t){return{pos:r[t.target]||0,weight:t.data.weight}}));return null==n?void 0:n.sort((function(t,e){return t.pos-e.pos}))})),a=i.flat().filter((function(t){return void 0!==t})),o=1;o<n.length;)o<<=1;var s=2*o-1;o-=1;var u=Array(s).fill(0,0,s),c=0;return null==a||a.forEach((function(t){if(t){var e=t.pos+o;u[e]+=t.weight;for(var n=0;e>0;)e%2&&(n+=u[e+1]),u[e=e-1>>1]+=t.weight;c+=t.weight*n}})),c},My=function(t,e){for(var n=0,r=1;r<(null==e?void 0:e.length);r+=1)n+=ky(t,e[r-1],e[r]);return n},Sy=function(t){for(var e={},n=t.getAllNodes(),r=n.map((function(t){var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),i=Math.max.apply(Math,w(r)),a=[],o=0;o<i+1;o++)a.push([]);var s=n.sort((function(e,n){return t.getNode(e.id).data.rank-t.getNode(n.id).data.rank})),u=s.filter((function(e){return void 0!==t.getNode(e.id).data.fixorder})).sort((function(e,n){return t.getNode(e.id).data.fixorder-t.getNode(n.id).data.fixorder}));return null==u||u.forEach((function(n){isNaN(t.getNode(n.id).data.rank)||a[t.getNode(n.id).data.rank].push(n.id),e[n.id]=!0})),null==s||s.forEach((function(n){return t.dfsTree(n.id,(function(t){if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||a[t.data.rank].push(t.id)}))})),a},Oy=function(t,e){var n,r=0,i=0;t.weight&&(r+=t.barycenter*t.weight,i+=t.weight),e.weight&&(r+=e.barycenter*e.weight,i+=e.weight),t.vs=null===(n=e.vs)||void 0===n?void 0:n.concat(t.vs),t.barycenter=r/i,t.weight=i,t.i=Math.min(e.i,t.i),e.merged=!0};const Ny=function(t,e){var n,r,i,a={};return null==t||t.forEach((function(t,e){a[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};var n=a[t.v];void 0!==t.barycenter&&(n.barycenter=t.barycenter,n.weight=t.weight)})),null===(n=e.getAllEdges())||void 0===n||n.forEach((function(t){var e=a[t.source],n=a[t.target];void 0!==e&&void 0!==n&&(n.indegree++,e.out.push(a[t.target]))})),function(t){for(var e,n,r=[],i=function(){var i=t.pop();r.push(i),null===(e=i.in.reverse())||void 0===e||e.forEach((function(t){return(e=i,function(t){t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&Oy(e,t)})(t);var e})),null===(n=i.out)||void 0===n||n.forEach((function(e){return(n=i,function(e){e.in.push(n),0==--e.indegree&&t.push(e)})(e);var n}))};null==t?void 0:t.length;)i();var a=r.filter((function(t){return!t.merged})),o=["vs","i","barycenter","weight"];return a.map((function(t){var e={};return null==o||o.forEach((function(n){void 0!==t[n]&&(e[n]=t[n])})),e}))}(null===(i=(r=Object.values(a)).filter)||void 0===i?void 0:i.call(r,(function(t){return!t.indegree})))};var Ay=function(t,e,n){for(var r,i=n;e.length&&(r=e[e.length-1]).i<=i;)e.pop(),null==t||t.push(r.vs),i++;return i},Ty=function(t,e,n,r,i,a){var o,s,u,c,l=t.getChildren(e).map((function(t){return t.id})),h=t.getNode(e),d=h?h.data.borderLeft:void 0,f=h?h.data.borderRight:void 0,v={};d&&(l=null==l?void 0:l.filter((function(t){return t!==d&&t!==f})));var p=function(t,e){return e.map((function(e){var n=t.getRelatedEdges(e,"in");if(!(null==n?void 0:n.length))return{v:e};var r={sum:0,weight:0};return null==n||n.forEach((function(e){var n=t.getNode(e.source);r.sum+=e.data.weight*n.data.order,r.weight+=e.data.weight})),{v:e,barycenter:r.sum/r.weight,weight:r.weight}}))}(t,l||[]);null==p||p.forEach((function(e){var i;if(null===(i=t.getChildren(e.v))||void 0===i?void 0:i.length){var o=Ty(t,e.v,n,r,a);v[e.v]=o,o.hasOwnProperty("barycenter")&&Cy(e,o)}}));var g=Ny(p,n);Py(g,v),null===(o=g.filter((function(t){return t.vs.length>0})))||void 0===o||o.forEach((function(e){var n=t.getNode(e.vs[0]);n&&(e.fixorder=n.data.fixorder,e.order=n.data.order)}));var y=function(t,e,n,r){var i=function(t){var e={lhs:[],rhs:[]};return null==t||t.forEach((function(t){var n,i;i=(n=t).hasOwnProperty("fixorder")&&!isNaN(n.fixorder),(r?!i&&n.hasOwnProperty("barycenter"):i||n.hasOwnProperty("barycenter"))?e.lhs.push(t):e.rhs.push(t)})),e}(t),a=i.lhs,o=i.rhs.sort((function(t,e){return-t.i- -e.i})),s=[],u=0,c=0,l=0;null==a||a.sort(function(t,e){return function(n,r){if(void 0!==n.fixorder&&void 0!==r.fixorder)return n.fixorder-r.fixorder;if(n.barycenter<r.barycenter)return-1;if(n.barycenter>r.barycenter)return 1;if(e&&void 0!==n.order&&void 0!==r.order){if(n.order<r.order)return-1;if(n.order>r.order)return 1}return t?r.i-n.i:n.i-r.i}}(!!e,!!n)),l=Ay(s,o,l),null==a||a.forEach((function(t){var e;l+=null===(e=t.vs)||void 0===e?void 0:e.length,s.push(t.vs),u+=t.barycenter*t.weight,c+=t.weight,l=Ay(s,o,l)}));var h={vs:s.flat()};return c&&(h.barycenter=u/c,h.weight=c),h}(g,r,i,a);if(d&&(y.vs=[d,y.vs,f].flat(),null===(s=t.getPredecessors(d))||void 0===s?void 0:s.length)){var m=t.getNode((null===(u=t.getPredecessors(d))||void 0===u?void 0:u[0].id)||""),b=t.getNode((null===(c=t.getPredecessors(f))||void 0===c?void 0:c[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+m.data.order+b.data.order)/(y.weight+2),y.weight+=2}return y},Py=function(t,e){null==t||t.forEach((function(t){var n,r=null===(n=t.vs)||void 0===n?void 0:n.map((function(t){return e[t]?e[t].vs:t}));t.vs=r.flat()}))},Cy=function(t,e){void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},Ry=function(t,e,n){return e.map((function(e){return function(t,e,n){var r=function(t){for(var e;t.hasNode(e="_root".concat(Math.random())););return e}(t),i=new _g({tree:[{id:r,children:[],data:{}}]});return t.getAllNodes().forEach((function(a){var o=t.getParent(a.id);(a.data.rank===e||a.data.minRank<=e&&e<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(Object.assign({},a)),(null==o?void 0:o.id)&&!i.hasNode(null==o?void 0:o.id)&&i.addNode(Object.assign({},o)),i.setParent(a.id,(null==o?void 0:o.id)||r),t.getRelatedEdges(a.id,n).forEach((function(e){var n=e.source===a.id?e.target:e.source;i.hasNode(n)||i.addNode(Object.assign({},t.getNode(n)));var r=i.getRelatedEdges(n,"out").find((function(t){return t.target===a.id})),o=void 0!==r?r.data.weight:0;r?i.updateEdgeData(r.id,Object.assign(Object.assign({},r.data),{weight:e.data.weight+o})):i.addEdge({id:e.id,source:n,target:a.id,data:{weight:e.data.weight+o}})})),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,Object.assign(Object.assign({},a.data),{borderLeft:a.data.borderLeft[e],borderRight:a.data.borderRight[e]})))})),i}(t,e,n)}))},Ly=function(t,e,n,r){var i=new _g;null==t||t.forEach((function(t){for(var a,o=t.getRoots()[0].id,s=Ty(t,o,i,e,n,r),u=0;u<(null===(a=s.vs)||void 0===a?void 0:a.length);u++){var c=t.getNode(s.vs[u]);c&&(c.data.order=u)}!function(t,e,n){var r,i={};null==n||n.forEach((function(n){for(var a,o,s=t.getParent(n);s;){if((a=t.getParent(s.id))?(o=i[a.id],i[a.id]=s.id):(o=r,r=s.id),o&&o!==s.id)return e.hasNode(o)||e.addNode({id:o,data:{}}),e.hasNode(s.id)||e.addNode({id:s.id,data:{}}),void(e.hasEdge("e".concat(o,"-").concat(s.id))||e.addEdge({id:"e".concat(o,"-").concat(s.id),source:o,target:s.id,data:{}}));s=a}}))}(t,i,s.vs)}))},Dy=function(t,e){null==e||e.forEach((function(e){null==e||e.forEach((function(e,n){t.getNode(e).data.order=n}))}))},_y=function(t,e){var n={};function r(e,r,i,a,o){for(var s,u,c,l=r;l<i;l++)c=e[l],(null===(s=t.getNode(c))||void 0===s?void 0:s.data.dummy)&&(null===(u=t.getPredecessors(c))||void 0===u||u.forEach((function(e){var r=t.getNode(e.id);r.data.dummy&&(r.data.order<a||r.data.order>o)&&jy(n,e.id,c)})))}function i(t,e){var n=function(t){return JSON.stringify(t.slice(1))}(t);e.get(n)||(r.apply(void 0,w(t)),e.set(n,!0))}return(null==e?void 0:e.length)&&e.reduce((function(e,n){var r,a=-1,o=0,s=new Map;return null==n||n.forEach((function(u,c){var l;if("border"===(null===(l=t.getNode(u))||void 0===l?void 0:l.data.dummy)){var h=t.getPredecessors(u)||[];h.length&&(r=t.getNode(h[0].id).data.order,i([n,o,c,a,r],s),o=c,a=r)}i([n,o,n.length,r,e.length],s)})),n})),n},Iy=function(t,e){var n,r;if(null===(n=t.getNode(e))||void 0===n?void 0:n.data.dummy)return null===(r=t.getPredecessors(e))||void 0===r?void 0:r.find((function(e){return t.getNode(e.id).data.dummy}))},jy=function(t,e,n){var r=e,i=n;if(r>i){var a=r;r=i,i=a}var o=t[r];o||(t[r]=o={}),o[i]=!0},Fy=function(t,e,n){var r=e;return r>n&&(r=n),!!t[r]},By=function(t,e,n,r,i,a){var o=new _g,s=zy(r,i,a);return null==e||e.forEach((function(e){var r;null==e||e.forEach((function(e){var i=n[e];if(o.hasNode(i)||o.addNode({id:i,data:{}}),r){var a=n[r],u=o.getRelatedEdges(a,"out").find((function(t){return t.target===i}));u?o.updateEdgeData(u.id,Object.assign(Object.assign({},u.data),{weight:Math.max(s(t,e,r),u.data.weight||0)})):o.addEdge({id:"e".concat(Math.random()),source:a,target:i,data:{weight:Math.max(s(t,e,r),0)}})}r=e}))})),o};var zy=function(t,e,n){return function(r,i,a){var o=r.getNode(i),s=r.getNode(a),u=0,c=0;if(u+=o.data.width/2,o.data.hasOwnProperty("labelpos"))switch((o.data.labelpos||"").toLowerCase()){case"l":c=-o.data.width/2;break;case"r":c=o.data.width/2}if(c&&(u+=n?c:-c),c=0,u+=(o.data.dummy?e:t)/2,u+=(s.data.dummy?e:t)/2,u+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||"").toLowerCase()){case"l":c=s.data.width/2;break;case"r":c=-s.data.width/2}return c&&(u+=n?c:-c),c=0,u}},Gy=function(t,e){return t.getNode(e).data.width||0},Vy=function(t,e){var n,r=uy(t);!function(t,e){var n=(e||{}).ranksep,r=void 0===n?0:n,i=ly(t),a=0;null==i||i.forEach((function(e){var n=e.map((function(e){return t.getNode(e).data.height})),i=Math.max.apply(Math,w(n).concat([0]));null==e||e.forEach((function(e){t.getNode(e).data.y=a+i/2})),a+=i+r}))}(r,e);var i=function(t,e){var n=e||{},r=n.align,i=n.nodesep,a=void 0===i?0:i,o=n.edgesep,s=void 0===o?0:o,u=ly(t),c=Object.assign(function(t,e){var n={};return(null==e?void 0:e.length)&&e.reduce((function(e,r){var i=0,a=0,o=e.length,s=null==r?void 0:r[(null==r?void 0:r.length)-1];return null==r||r.forEach((function(e,u){var c,l=Iy(t,e),h=l?t.getNode(l.id).data.order:o;(l||e===s)&&(null===(c=r.slice(a,u+1))||void 0===c||c.forEach((function(e){var r;null===(r=t.getPredecessors(e))||void 0===r||r.forEach((function(r){var a,o=t.getNode(r.id),s=o.data.order;!(s<i||h<s)||o.data.dummy&&(null===(a=t.getNode(e))||void 0===a?void 0:a.data.dummy)||jy(n,r.id,e)}))})),a=u+1,i=h)})),r})),n}(t,u),_y(t,u)),l={},h=[];["u","d"].forEach((function(e){h="u"===e?u:Object.values(u).reverse(),["l","r"].forEach((function(n){"r"===n&&(h=h.map((function(t){return Object.values(t).reverse()})));var r=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),i=function(t,e,n,r){var i={},a={},o={};return null==e||e.forEach((function(t){null==t||t.forEach((function(t,e){i[t]=t,a[t]=t,o[t]=e}))})),null==e||e.forEach((function(t){var e=-1;null==t||t.forEach((function(t){var s=r(t).map((function(t){return t.id}));if(s.length)for(var u=((s=s.sort((function(t,e){return o[t]-o[e]}))).length-1)/2,c=Math.floor(u),l=Math.ceil(u);c<=l;++c){var h=s[c];a[t]===t&&e<o[h]&&!Fy(n,t,h)&&(a[h]=t,a[t]=i[t]=i[h],e=o[h])}}))})),{root:i,align:a}}(0,h,c,r),o=function(t,e,n,r,i,a,o){var s,u={},c=By(t,e,n,i,a,o),l=o?"borderLeft":"borderRight",h=function(t,e){for(var n=c.getAllNodes(),r=n.pop(),i={};r;)i[r.id]?t(r.id):(i[r.id]=!0,n.push(r),n=n.concat(e(r.id))),r=n.pop()};return h((function(t){u[t]=(c.getRelatedEdges(t,"in")||[]).reduce((function(t,e){return Math.max(t,(u[e.source]||0)+e.data.weight)}),0)}),c.getPredecessors.bind(c)),h((function(e){var n=(c.getRelatedEdges(e,"out")||[]).reduce((function(t,e){return Math.min(t,(u[e.target]||0)-e.data.weight)}),Number.POSITIVE_INFINITY),r=t.getNode(e);n!==Number.POSITIVE_INFINITY&&r.data.borderType!==l&&(u[e]=Math.max(u[e],n))}),c.getSuccessors.bind(c)),null===(s=Object.values(r))||void 0===s||s.forEach((function(t){u[t]=u[n[t]]})),u}(t,h,i.root,i.align,a,s,"r"===n);"r"===n&&Object.keys(o).forEach((function(t){return o[t]=-o[t]})),l[e+n]=o}))}));var d=function(t,e){return fy(Object.values(e),(function(e){var n,r=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return null===(n=Object.keys(e))||void 0===n||n.forEach((function(n){var a=e[n],o=Gy(t,n)/2;r=Math.max(a+o,r),i=Math.min(a-o,i)})),r-i}))}(t,l);return d&&function(t,e){var n=Object.values(e),r=Math.min.apply(Math,n),i=Math.max.apply(Math,n);["u","d"].forEach((function(n){["l","r"].forEach((function(a){var o,s=n+a,u=t[s];if(u!==e){var c=Object.values(u);(o="l"===a?r-Math.min.apply(Math,c):i-Math.max.apply(Math,c))&&(t[s]={},Object.keys(u).forEach((function(e){t[s][e]=u[e]+o})))}}))}))}(l,d),function(t,e){var n={};return Object.keys(t.ul).forEach((function(r){if(e)n[r]=t[e.toLowerCase()][r];else{var i=Object.values(t).map((function(t){return t[r]}));n[r]=(i[0]+i[1])/2}})),n}(l,r)}(r,e);null===(n=Object.keys(i))||void 0===n||n.forEach((function(t){r.getNode(t).data.x=i[t]}))},Wy=function(t){var e={},n=function(r){var i,a,o=t.getNode(r);return o?e[r]?o.data.rank:(e[r]=!0,null===(i=t.getRelatedEdges(r,"out"))||void 0===i||i.forEach((function(t){var e=n(t.target)-t.data.minlen;e&&(void 0===a||e<a)&&(a=e)})),a||(a=0),o.data.rank=a,a):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){return n(t.id)}))},Hy=function(t,e){return t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen},Yy=function(t,e){var n=function(r){e.getRelatedEdges(r,"both").forEach((function(i){var a=i.source,o=r===a?i.target:a;t.hasNode(o)||Hy(e,i)||(t.addNode({id:o,data:{}}),t.addEdge({id:i.id,source:r,target:o,data:{}}),n(o))}))};return t.getAllNodes().forEach((function(t){return n(t.id)})),t.getAllNodes().length},Uy=function(t,e){var n=function(r){var i;null===(i=e.getRelatedEdges(r,"both"))||void 0===i||i.forEach((function(i){var a=i.source,o=r===a?i.target:a;t.hasNode(o)||void 0===e.getNode(o).data.layer&&Hy(e,i)||(t.addNode({id:o,data:{}}),t.addEdge({id:i.id,source:r,target:o,data:{}}),n(o))}))};return t.getAllNodes().forEach((function(t){return n(t.id)})),t.getAllNodes().length},qy=function(t,e){return fy(e.getAllEdges(),(function(n){return t.hasNode(n.source)!==t.hasNode(n.target)?Hy(e,n):1/0}))},Xy=function(t,e,n){t.getAllNodes().forEach((function(t){var r=e.getNode(t.id);r.data.rank||(r.data.rank=0),r.data.rank+=n}))},Ky=function(t,e){var n=py(t,t.getAllNodes(),"post",!1);(n=n.slice(0,(null==n?void 0:n.length)-1)).forEach((function(n){$y(t,e,n)}))},$y=function(t,e,n){var r=t.getNode(n).data.parent;t.getRelatedEdges(n,"both").find((function(t){return t.target===r||t.source===r})).data.cutvalue=Zy(t,e,n)},Zy=function(t,e,n){var r=t.getNode(n).data.parent,i=!0,a=e.getRelatedEdges(n,"out").find((function(t){return t.target===r})),o=0;return a||(i=!1,a=e.getRelatedEdges(r,"out").find((function(t){return t.target===n}))),o=a.data.weight,e.getRelatedEdges(n,"both").forEach((function(e){var a=e.source===n,s=a?e.target:e.source;if(s!==r){var u=a===i,c=e.data.weight;if(o+=u?c:-c,im(t,n,s)){var l=t.getRelatedEdges(n,"both").find((function(t){return t.source===s||t.target===s})).data.cutvalue;o+=u?-l:l}}})),o},Qy=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.getAllNodes()[0].id;Jy(t,{},1,e)},Jy=function(t,e,n,r,i){var a,o=n,s=n,u=t.getNode(r);return e[r]=!0,null===(a=t.getNeighbors(r))||void 0===a||a.forEach((function(n){e[n.id]||(s=Jy(t,e,s,n.id,r))})),u.data.low=o,u.data.lim=s++,i?u.data.parent=i:delete u.data.parent,s},tm=function(t){return t.getAllEdges().find((function(t){return t.data.cutvalue<0}))},em=function(t,e,n){var r=n.source,i=n.target;e.getRelatedEdges(r,"out").find((function(t){return t.target===i}))||(r=n.target,i=n.source);var a=t.getNode(r),o=t.getNode(i),s=a,u=!1;a.data.lim>o.data.lim&&(s=o,u=!0);var c=e.getAllEdges().filter((function(e){return u===am(t.getNode(e.source),s)&&u!==am(t.getNode(e.target),s)}));return fy(c,(function(t){return Hy(e,t)}))},nm=function(t,e,n,r){var i=t.getRelatedEdges(n.source,"both").find((function(t){return t.source===n.target||t.target===n.target}));i&&t.removeEdge(i.id),t.addEdge({id:"e".concat(Math.random()),source:r.source,target:r.target,data:{}}),Qy(t),Ky(t,e),rm(t,e)},rm=function(t,e){var n=t.getAllNodes().find((function(t){return!t.data.parent})),r=py(t,n,"pre",!1);(r=r.slice(1)).forEach((function(n){var r=t.getNode(n).data.parent,i=e.getRelatedEdges(n,"out").find((function(t){return t.target===r})),a=!1;!i&&e.hasNode(r)&&(i=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),a=!0),e.getNode(n).data.rank=(e.hasNode(r)&&e.getNode(r).data.rank||0)+(a?null==i?void 0:i.data.minlen:-(null==i?void 0:i.data.minlen))}))},im=function(t,e,n){return t.getRelatedEdges(e,"both").find((function(t){return t.source===n||t.target===n}))},am=function(t,e){return e.data.low<=t.data.lim&&t.data.lim<=e.data.lim},om=Wy,sm=function(t){!function(t){var e=function(t){var e=new _g;return t.getAllNodes().forEach((function(t){e.addNode(Object.assign({},t))})),t.getAllEdges().forEach((function(t){var n=e.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target}));n?e.updateEdgeData(null==n?void 0:n.id,Object.assign(Object.assign({},n.data),{weight:n.data.weight+t.data.weight||0,minlen:Math.max(n.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})})),e}(t);Wy(e);var n,r,i=function(t){var e,n,r=new _g({tree:[]}),i=t.getAllNodes()[0],a=t.getAllNodes().length;for(r.addNode(i);Yy(r,t)<a;)e=qy(r,t),n=r.hasNode(e.source)?Hy(t,e):-Hy(t,e),Xy(r,t,n);return r}(e);for(Qy(i),Ky(i,e);n=tm(i);)r=em(i,e,n),nm(i,e,n,r)}(t)},um=function(t,e){var n=e.edgeLabelSpace,r=e.keepNodeOrder,i=e.prevGraph,a=e.rankdir,o=e.ranksep;!r&&i&&lm(t,i);var s,u=ym(t);n&&(e.ranksep=mm(u,{rankdir:a,ranksep:o}));try{s=cm(u,e)}catch(t){if("Not possible to find intersection inside of the rectangle"===t.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:\n",t);throw t}return hm(t,u),s},cm=function(t,e){var n=e.acyclicer,r=e.ranker,i=e.rankdir,a=void 0===i?"tb":i,o=e.nodeOrder,s=e.keepNodeOrder,u=e.align,c=e.nodesep,l=void 0===c?50:c,h=e.edgesep,d=void 0===h?20:h,f=e.ranksep,v=void 0===f?50:f;Nm(t),ay(t,n);var p=function(t){var e=sy(t,"root",{},"_root"),n=function(t){var e={},n=function(r,i){var a=t.getChildren(r);null==a||a.forEach((function(t){return n(t.id,i+1)})),e[r]=i};return t.getRoots().forEach((function(t){return n(t.id,1)})),e}(t),r=Math.max.apply(Math,w(Object.values(n)));Math.abs(r)===1/0&&(r=1);var i=r-1,a=2*i+1;t.getAllEdges().forEach((function(t){t.data.minlen*=a}));var o=function(t){var e=0;return t.getAllEdges().forEach((function(t){e+=t.data.weight})),e}(t)+1;return t.getRoots().forEach((function(r){wy(t,e,a,o,i,n,r.id)})),{nestingRoot:e,nodeRankFactor:a}}(t),g=p.nestingRoot,y=p.nodeRankFactor;!function(t,e){switch(e){case"network-simplex":sm(t);break;case"tight-tree":default:!function(t){!function(t){var e,n={},r=function(i){var a,o,s=t.getNode(i);return s?n[i]?s.data.rank:(n[i]=!0,null===(a=t.getRelatedEdges(i,"out"))||void 0===a||a.forEach((function(t){var e=r(t.target)-t.data.minlen;e&&(void 0===o||e<o)&&(o=e)})),o||(o=0),(void 0===e||o<e)&&(e=o),s.data.rank=o,o):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){t&&r(t.id)})),void 0===e&&(e=0);var i={},a=function(e,n){var r,o=t.getNode(e),s=isNaN(o.data.layer)?n:o.data.layer;(void 0===o.data.rank||o.data.rank<s)&&(o.data.rank=s),i[e]||(i[e]=!0,null===(r=t.getRelatedEdges(e,"out"))||void 0===r||r.forEach((function(t){a(t.target,s+t.data.minlen)})))};t.getAllNodes().forEach((function(t){var n=t.data;n&&(isNaN(n.layer)?n.rank-=e:a(t.id,n.layer))}))}(t),function(t){var e,n,r=new _g({tree:[]}),i=t.getAllNodes()[0],a=t.getAllNodes().length;for(r.addNode(i);Uy(r,t)<a;)e=qy(r,t),n=r.hasNode(e.source)?Hy(t,e):-Hy(t,e),Xy(r,t,n)}(t)}(t);break;case"longest-path":om(t)}}(uy(t),r),bm(t),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t.getAllNodes(),r=n.filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),i=Math.min.apply(Math,w(r)),a=[];n.forEach((function(t){var e=(t.data.rank||0)-i;a[e]||(a[e]=[]),a[e].push(t.id)}));for(var o=0,s=0;s<a.length;s++){var u=a[s];void 0===u?s%e!=0&&(o-=1):o&&(null==u||u.forEach((function(e){var n=t.getNode(e);n&&(n.data.rank=n.data.rank||0,n.data.rank+=o)})))}}(t,y),function(t,e){e&&t.removeNode(e),t.getAllEdges().forEach((function(e){e.data.nestingEdge&&t.removeEdge(e.id)}))}(t,g),function(t){var e=t.getAllNodes().filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),n=Math.min.apply(Math,w(e));t.getAllNodes().forEach((function(t){t.data.hasOwnProperty("rank")&&n!==1/0&&(t.data.rank-=n)}))}(t),xm(t),wm(t);var m=[];!function(t,e){t.getAllEdges().forEach((function(n){return function(t,e,n){var r=e.source,i=t.getNode(r).data.rank,a=e.target,o=t.getNode(a).data.rank,s=e.data.labelRank;if(o!==i+1){var u,c,l;for(t.removeEdge(e.id),l=0,++i;i<o;++l,++i)e.data.points=[],u=sy(t,"edge",c={originalEdge:e,width:0,height:0,rank:i},"_d"),i===s&&(c.width=e.data.width,c.height=e.data.height,c.dummy=Ey,c.labelpos=e.data.labelpos),t.addEdge({id:"e".concat(Math.random()),source:r,target:u,data:{weight:e.data.weight}}),0===l&&n.push(u),r=u;t.addEdge({id:"e".concat(Math.random()),source:r,target:a,data:{weight:e.data.weight}})}}(t,n,e)}))}(t,m),function(t,e){var n=function(t){var e={},n=0,r=function(i){var a=n;t.getChildren(i).forEach((function(t){return r(t.id)})),e[i]={low:a,lim:n++}};return t.getRoots().forEach((function(t){return r(t.id)})),e}(t);e.forEach((function(e){var r,i,a=e,o=t.getNode(a),s=o.data.originalEdge;if(s)for(var u=function(t,e,n,r){var i,a,o,s,u=[],c=[],l=Math.min(e[n].low,e[r].low),h=Math.max(e[n].lim,e[r].lim);o=n;do{o=null===(i=t.getParent(o))||void 0===i?void 0:i.id,u.push(o)}while(o&&(e[o].low>l||h>e[o].lim));for(s=o,o=r;o&&o!==s;)c.push(o),o=null===(a=t.getParent(o))||void 0===a?void 0:a.id;return{lca:s,path:u.concat(c.reverse())}}(t,n,s.source,s.target),c=u.path,l=u.lca,h=0,d=c[h],f=!0;a!==s.target;){if(o=t.getNode(a),f){for(;d!==l&&(null===(r=t.getNode(d))||void 0===r?void 0:r.data.maxRank)<o.data.rank;)d=c[++h];d===l&&(f=!1)}if(!f){for(;h<c.length-1&&(null===(i=t.getNode(c[h+1]))||void 0===i?void 0:i.data.minRank)<=o.data.rank;)h++;d=c[h]}t.hasNode(d)&&t.setParent(a,d),a=t.getSuccessors(a)[0].id}}))}(t,m),function(t){var e=function(n){var r=t.getChildren(n),i=t.getNode(n);if((null==r?void 0:r.length)&&r.forEach((function(t){return e(t.id)})),i.data.hasOwnProperty("minRank")){i.data.borderLeft=[],i.data.borderRight=[];for(var a=i.data.minRank,o=i.data.maxRank+1;a<o;a+=1)gy(t,"borderLeft","_bl",n,i,a),gy(t,"borderRight","_br",n,i,a)}};t.getRoots().forEach((function(t){return e(t.id)}))}(t),s&&function(t,e){for(var n=t.getAllNodes().filter((function(e){var n;return!(null===(n=t.getChildren(e.id))||void 0===n?void 0:n.length)})),r=n.map((function(t){return t.data.rank})),i=Math.max.apply(Math,w(r)),a=[],o=0;o<i+1;o++)a[o]=[];null==e||e.forEach((function(e){var n=t.getNode(e);n&&!n.data.dummy&&(isNaN(n.data.rank)||(n.data.fixorder=a[n.data.rank].length,a[n.data.rank].push(e)))}))}(t,o),function(t,e){for(var n=dy(t),r=[],i=[],a=1;a<n+1;a++)r.push(a);for(var o=n-1;o>-1;o--)i.push(o);var s=Ry(t,r,"in"),u=Ry(t,i,"out"),c=Sy(t);Dy(t,c);for(var l,h=Number.POSITIVE_INFINITY,d=0,f=0;f<4;++d,++f){Ly(d%2?s:u,d%4>=2,!1,e),c=ly(t);var v=My(t,c);v<h&&(f=0,l=Al(c),h=v)}c=Sy(t),Dy(t,c);for(var p=0,g=0;g<4;++p,++g){Ly(p%2?s:u,p%4>=2,!0,e),c=ly(t);var y=My(t,c);y<h&&(g=0,l=Al(c),h=y)}Dy(t,l)}(t,s),Am(t),function(t,e){var n=e.toLowerCase();"lr"!==n&&"rl"!==n||yy(t)}(t,a),Vy(t,{align:u,nodesep:l,edgesep:d,ranksep:v}),Tm(t),Om(t),function(t,e){e.forEach((function(e){var n,r=t.getNode(e),i=r.data.originalEdge;i&&t.addEdge(i);for(var a=e;r.data.dummy;)n=t.getSuccessors(a)[0],t.removeNode(a),i.data.points.push({x:r.data.x,y:r.data.y}),r.data.dummy===Ey&&(i.data.x=r.data.x,i.data.y=r.data.y,i.data.width=r.data.width,i.data.height=r.data.height),a=n.id,r=t.getNode(a)}))}(t,m),Mm(t),function(t,e){var n=e.toLowerCase();"bt"!==n&&"rl"!==n||function(t){t.getAllNodes().forEach((function(t){by(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return by(t)})),t.data.hasOwnProperty("y")&&by(t.data)}))}(t),"lr"!==n&&"rl"!==n||(function(t){t.getAllNodes().forEach((function(t){xy(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return xy(t)})),t.data.hasOwnProperty("x")&&xy(t.data)}))}(t),yy(t))}(t,a);var b=Em(t),x=b.width,E=b.height;return km(t),Sm(t),function(t){t.getAllEdges().forEach((function(e){var n=e.data;if(n.reversed){t.removeEdge(e.id);var r=n.forwardName;delete n.reversed,delete n.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:Object.assign(Object.assign({},n),{forwardName:r})})}}))}(t),{width:x,height:E}},lm=function(t,e){t.getAllNodes().forEach((function(n){var r=t.getNode(n.id);if(e.hasNode(n.id)){var i=e.getNode(n.id);r.data.fixorder=i.data._order,delete i.data._order}else delete r.data.fixorder}))},hm=function(t,e){t.getAllNodes().forEach((function(n){var r,i=t.getNode(n.id);if(i){var a=e.getNode(n.id);i.data.x=a.data.x,i.data.y=a.data.y,i.data._order=a.data.order,i.data._rank=a.data.rank,(null===(r=e.getChildren(n.id))||void 0===r?void 0:r.length)&&(i.data.width=a.data.width,i.data.height=a.data.height)}})),t.getAllEdges().forEach((function(n){var r=t.getEdge(n.id),i=e.getEdge(n.id);r.data.points=i?i.data.points:[],i&&i.data.hasOwnProperty("x")&&(r.data.x=i.data.x,r.data.y=i.data.y)}))},dm=["width","height","layer","fixorder"],fm={width:0,height:0},vm=["minlen","weight","width","height","labeloffset"],pm={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},gm=["labelpos"],ym=function(t){var e=new _g({tree:[]});return t.getAllNodes().forEach((function(n){var r=Cm(t.getNode(n.id).data),i=Object.assign(Object.assign({},fm),r),a=Pm(i,dm);e.hasNode(n.id)||e.addNode({id:n.id,data:Object.assign({},a)});var o=t.hasTreeStructure("combo")?t.getParent(n.id,"combo"):t.getParent(n.id);ue(o)||(e.hasNode(o.id)||e.addNode(Object.assign({},o)),e.setParent(n.id,o.id))})),t.getAllEdges().forEach((function(n){var r=Cm(t.getEdge(n.id).data),i={};null==gm||gm.forEach((function(t){void 0!==r[t]&&(i[t]=r[t])})),e.addEdge({id:n.id,source:n.source,target:n.target,data:Object.assign({},pm,Pm(r,vm),i)})})),e},mm=function(t,e){var n=e.ranksep,r=void 0===n?0:n,i=e.rankdir;return t.getAllNodes().forEach((function(t){isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)})),t.getAllEdges().forEach((function(t){var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===i||"BT"===i?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)})),r/2},bm=function(t){t.getAllEdges().forEach((function(e){if(e.data.width&&e.data.height){var n=t.getNode(e.source),r={e,rank:(t.getNode(e.target).data.rank-n.data.rank)/2+n.data.rank};sy(t,"edge-proxy",r,"_ep")}}))},xm=function(t){var e=0;return t.getAllNodes().forEach((function(n){var r,i;n.data.borderTop&&(n.data.minRank=null===(r=t.getNode(n.data.borderTop))||void 0===r?void 0:r.data.rank,n.data.maxRank=null===(i=t.getNode(n.data.borderBottom))||void 0===i?void 0:i.data.rank,e=Math.max(e,n.data.maxRank||-1/0))})),e},wm=function(t){t.getAllNodes().forEach((function(e){"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))}))},Em=function(t,e){var n,r,i=0,a=0,o=e||{},s=o.marginx,u=void 0===s?0:s,c=o.marginy,l=void 0===c?0:c,h=function(t){if(t.data){var e=t.data.x,o=t.data.y,s=t.data.width,u=t.data.height;isNaN(e)||isNaN(s)||(void 0===n&&(n=e-s/2),n=Math.min(n,e-s/2),i=Math.max(i,e+s/2)),isNaN(o)||isNaN(u)||(void 0===r&&(r=o-u/2),r=Math.min(r,o-u/2),a=Math.max(a,o+u/2))}};return t.getAllNodes().forEach((function(t){h(t)})),t.getAllEdges().forEach((function(t){(null==t?void 0:t.data.hasOwnProperty("x"))&&h(t)})),n-=u,r-=l,t.getAllNodes().forEach((function(t){t.data.x-=n,t.data.y-=r})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){t.x-=n,t.y-=r})),t.data.hasOwnProperty("x")&&(t.data.x-=n),t.data.hasOwnProperty("y")&&(t.data.y-=r)})),{width:i-n+u,height:a-r+l}},km=function(t){t.getAllEdges().forEach((function(e){var n,r,i=t.getNode(e.source),a=t.getNode(e.target);e.data.points?(n=e.data.points[0],r=e.data.points[e.data.points.length-1]):(e.data.points=[],n={x:a.data.x,y:a.data.y},r={x:i.data.x,y:i.data.y}),e.data.points.unshift(cy(i.data,n)),e.data.points.push(cy(a.data,r))}))},Mm=function(t){t.getAllEdges().forEach((function(t){if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}}))},Sm=function(t){t.getAllEdges().forEach((function(t){var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())}))},Om=function(t){t.getAllNodes().forEach((function(e){var n,r,i;if(null===(n=t.getChildren(e.id))||void 0===n?void 0:n.length){var a=t.getNode(e.id),o=t.getNode(a.data.borderTop),s=t.getNode(a.data.borderBottom),u=t.getNode(a.data.borderLeft[(null===(r=a.data.borderLeft)||void 0===r?void 0:r.length)-1]),c=t.getNode(a.data.borderRight[(null===(i=a.data.borderRight)||void 0===i?void 0:i.length)-1]);a.data.width=Math.abs((null==c?void 0:c.data.x)-(null==u?void 0:u.data.x))||10,a.data.height=Math.abs((null==s?void 0:s.data.y)-(null==o?void 0:o.data.y))||10,a.data.x=((null==u?void 0:u.data.x)||0)+a.data.width/2,a.data.y=((null==o?void 0:o.data.y)||0)+a.data.height/2}})),t.getAllNodes().forEach((function(e){"border"===e.data.dummy&&t.removeNode(e.id)}))},Nm=function(t){t.getAllEdges().forEach((function(e){if(e.source===e.target){var n=t.getNode(e.source);n.data.selfEdges||(n.data.selfEdges=[]),n.data.selfEdges.push(e),t.removeEdge(e.id)}}))},Am=function(t){var e=ly(t);null==e||e.forEach((function(e){var n=0;null==e||e.forEach((function(e,r){var i,a=t.getNode(e);a.data.order=r+n,null===(i=a.data.selfEdges)||void 0===i||i.forEach((function(e){sy(t,"selfedge",{width:e.data.width,height:e.data.height,rank:a.data.rank,order:r+ ++n,e},"_se")})),delete a.data.selfEdges}))}))},Tm=function(t){t.getAllNodes().forEach((function(e){var n=t.getNode(e.id);if("selfedge"===n.data.dummy){var r=t.getNode(n.data.e.source),i=r.data.x+r.data.width/2,a=r.data.y,o=n.data.x-i,s=r.data.height/2;t.hasEdge(n.data.e.id)?t.updateEdgeData(n.data.e.id,n.data.e.data):t.addEdge({id:n.data.e.id,source:n.data.e.source,target:n.data.e.target,data:n.data.e.data}),t.removeNode(e.id),n.data.e.data.points=[{x:i+2*o/3,y:a-s},{x:i+5*o/6,y:a-s},{y:a,x:i+o},{x:i+5*o/6,y:a+s},{x:i+2*o/3,y:a+s}],n.data.e.data.x=n.data.x,n.data.e.data.y=n.data.y}}))},Pm=function(t,e){var n={};return null==e||e.forEach((function(e){void 0!==t[e]&&(n[e]=+t[e])})),n},Cm=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={};return Object.keys(t).forEach((function(n){e[n.toLowerCase()]=t[n]})),e};function Rm(t){if(!t)return[0,0,0];if(oe(t))return[t,t,t];if(0===t.length)return[0,0,0];var e=h(t,3),n=e[0],r=e[1],i=void 0===r?n:r,a=e[2];return[n,i,void 0===a?n:a]}function Lm(t,e){return cn(e)?e:oe(e)?function(){return e}:function(){return t}}function Dm(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e||0===e?cn(e)?e:oe(e)?function(){return e}:Array.isArray(e)?function(){return n?Math.max.apply(Math,w(e))||t:e}:ln(e)&&e.width&&e.height?function(){return n?Math.max(e.width,e.height)||t:[e.width,e.height]}:function(){return t}:function(e){var r=(e.data||{}).size;return r?Array.isArray(r)?n?Math.max.apply(Math,w(r))||t:r:ln(r)&&r.width&&r.height?n?Math.max(r.width,r.height)||t:[r.width,r.height]:r:t}}var _m=function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,i="function"==typeof e?e:function(){return e||0};return n=t?Array.isArray(t)?function(e){return t}:cn(t)?t:function(e){return t}:function(t){var e,n,i;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return null===(n=t.data)||void 0===n?void 0:n.bboxSize;if(null===(i=t.data)||void 0===i?void 0:i.size){var a=t.data.size;return Array.isArray(a)?a:ln(a)?[a.width,a.height]:a}return r},function(t){var e=n(t),r=i(t);return Math.max.apply(Math,w(Rm(e)))+r}},Im=function(t){if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){var e=[];return t.forEach((function(t){e.push(t)})),e.map((function(t){return Im(t)}))}if("object"==typeof t){var n={};return Object.keys(t).forEach((function(e){n[e]=Im(t[e])})),n}return t},jm=function(t,e){var n=Im(t);return n.data=n.data||{},e&&(oe(n.data.x)||(n.data.x=Math.random()*e[0]),oe(n.data.y)||(n.data.y=Math.random()*e[1])),n},Fm={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,ranker:"tight-tree",controlPoints:!1,radial:!1,focusNode:null},Bm=function(){return b((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y(this,t),this.options=e,this.id="antv-dagre",this.options=Object.assign(Object.assign({},Fm),e)}),[{key:"execute",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.genericDagreLayout(!1,t,e));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"assign",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.genericDagreLayout(!0,t,e);case 2:case"end":return n.stop()}}),n,this)})))}},{key:"genericDagreLayout",value:function(t,e,n){return pe(this,void 0,void 0,Tn().mark((function r(){var i,a,o,s,u,c,l,h,d,f,v,p,g,y,m,b,x,w,E,k,M,S,O,N,A,T,P,C,R,L,D,_,I,j,F,B,z,G;return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=Object.assign(Object.assign({},this.options),n),a=i.nodeSize,o=i.align,s=i.rankdir,u=void 0===s?"TB":s,c=i.ranksep,l=i.nodesep,h=i.ranksepFunc,d=i.nodesepFunc,f=i.edgeLabelSpace,v=i.ranker,p=i.nodeOrder,g=i.begin,y=i.controlPoints,m=i.radial,b=i.sortByCombo,x=i.preset,w=new _g({tree:[]}),E=Lm(c||50,h),k=Lm(l||50,d),M=k,S=E,"LR"!==u&&"RL"!==u||(M=E,S=k),O=Dm(10,a,!1),N=e.getAllNodes(),A=e.getAllEdges(),N.forEach((function(t){var e=Rm(O(t)),n=S(t),r=M(t),i=e[0]+2*r,a=e[1]+2*n,o=t.data.layer;oe(o)?w.addNode({id:t.id,data:{width:i,height:a,layer:o}}):w.addNode({id:t.id,data:{width:i,height:a}})})),b&&(w.attachTreeStructure("combo"),N.forEach((function(t){var e=t.data.parentId;void 0!==e&&w.hasNode(e)&&w.setParent(t.id,e,"combo")}))),A.forEach((function(t){w.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})})),T=void 0,(null==x?void 0:x.length)&&(T=new _g({nodes:x})),um(w,{prevGraph:T,edgeLabelSpace:f,keepNodeOrder:!!p,nodeOrder:p||[],acyclicer:"greedy",ranker:v,rankdir:u,nodesep:l,align:o}),P=[0,0],g&&(C=1/0,R=1/0,w.getAllNodes().forEach((function(t){C>t.data.x&&(C=t.data.x),R>t.data.y&&(R=t.data.y)})),w.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){C>t.x&&(C=t.x),R>t.y&&(R=t.y)}))})),P[0]=g[0]-C,P[1]=g[1]-R),L="LR"===u||"RL"===u,m||(D=new Set,_="BT"===u||"RL"===u?function(t,e){return e-t}:function(t,e){return t-e},w.getAllNodes().forEach((function(t){t.data.x=t.data.x+P[0],t.data.y=t.data.y+P[1],D.add(L?t.data.x:t.data.y)})),I=Array.from(D).sort(_),j=L?function(t,e){return t.x!==e.x}:function(t,e){return t.y!==e.y},F=L?function(t,e,n){var r=Math.max(e.y,n.y),i=Math.min(e.y,n.y);return t.filter((function(t){return t.y<=r&&t.y>=i}))}:function(t,e,n){var r=Math.max(e.x,n.x),i=Math.min(e.x,n.x);return t.filter((function(t){return t.x<=r&&t.x>=i}))},w.getAllEdges().forEach((function(t,e){var n;f&&y&&"loop"!==t.data.type&&(t.data.controlPoints=zm(null===(n=t.data.points)||void 0===n?void 0:n.map((function(t){var e=t.x,n=t.y;return{x:e+P[0],y:n+P[1]}})),w.getNode(t.source),w.getNode(t.target),I,L,j,F))}))),B=[],B=w.getAllNodes().map((function(t){return jm(t)})),z=w.getAllEdges(),t&&(B.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),z.forEach((function(t){e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})}))),G={nodes:B,edges:z},r.abrupt("return",G);case 27:case"end":return r.stop()}}),r,this)})))}}])}(),zm=function(t,e,n,r,i,a,o){var s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&n){var u=e.data,c=u.x,l=u.y,h=n.data,d=h.x,f=h.y;if(i&&(c=e.data.y,l=e.data.x,d=n.data.y,f=n.data.x),f!==l&&c!==d){var v=r.indexOf(l),p=r[v+1];if(p){var g=s[0],y=i?{x:(l+p)/2,y:(null==g?void 0:g.y)||d}:{x:(null==g?void 0:g.x)||d,y:(l+p)/2};g&&!a(g,y)||s.unshift(y)}var m=r.indexOf(f),b=Math.abs(m-v);if(1===b)(s=o(s,e.data,n.data)).length||s.push(i?{x:(l+f)/2,y:c}:{x:c,y:(l+f)/2});else if(b>1){var x=r[m-1];if(x){var w=s[s.length-1],E=i?{x:(f+x)/2,y:(null==w?void 0:w.y)||d}:{x:(null==w?void 0:w.x)||c,y:(f+x)/2};w&&!a(w,E)||s.push(E)}}}}return s},Gm=function(t,e,n){var r=t.getAllNodes(),i=t.getAllEdges();return(null==r?void 0:r.length)?1===r.length?(e&&t.mergeNodeData(r[0].id,{x:n[0],y:n[1]}),{nodes:[Object.assign(Object.assign({},r[0]),{data:Object.assign(Object.assign({},r[0].data),{x:n[0],y:n[1]})})],edges:i}):void 0:{nodes:[],edges:i}},Vm={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},Wm=function(){return b((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y(this,t),this.options=e,this.id="circular",this.options=Object.assign(Object.assign({},Vm),e)}),[{key:"execute",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.genericCircularLayout(!1,t,e));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"assign",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.genericCircularLayout(!0,t,e);case 2:case"end":return n.stop()}}),n,this)})))}},{key:"genericCircularLayout",value:function(t,e,n){return pe(this,void 0,void 0,Tn().mark((function r(){var i,a,o,s,u,c,l,d,f,v,p,g,y,m,b,x,w,E,k,M,S,O,N,A,T,P,C,R,L,D,_,I,j,F,B,z,G;return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=Object.assign(Object.assign({},this.options),n),a=i.width,o=i.height,s=i.center,u=i.divisions,c=i.startAngle,l=void 0===c?0:c,d=i.endAngle,f=void 0===d?2*Math.PI:d,v=i.angleRatio,p=i.ordering,g=i.clockwise,y=i.nodeSpacing,m=i.nodeSize,b=e.getAllNodes(),x=e.getAllEdges(),w=Um(a,o,s),E=h(w,3),k=E[0],M=E[1],S=E[2],(O=null==b?void 0:b.length)&&1!==O){r.next=8;break}return r.abrupt("return",Gm(e,t,S));case 8:for(N=(f-l)/O,A=i.radius,T=i.startRadius,P=i.endRadius,y?(C=Lm(10,y),R=Dm(10,m),L=-1/0,b.forEach((function(t){var e=R(t);L<e&&(L=e)})),D=0,b.forEach((function(t,e){D+=0===e?L||10:(C(t)||0)+(L||10)})),A=D/(2*Math.PI)):A||T||P?!T&&P?T=P:T&&!P&&(P=T):A=Math.min(M,k)/2,_=N*v,I=[],I="topology"===p?Hm(e,b):"topology-directed"===p?Hm(e,b,!0):"degree"===p?Ym(e,b):b.map((function(t){return jm(t)})),j=Math.ceil(O/u),F=0;F<O;++F)(B=A)||null===T||null===P||(B=T+F*(P-T)/(O-1)),B||(B=10+100*F/(O-1)),z=l+F%j*_+2*Math.PI/u*Math.floor(F/j),g||(z=f-F%j*_-2*Math.PI/u*Math.floor(F/j)),I[F].data.x=S[0]+Math.cos(z)*B,I[F].data.y=S[1]+Math.sin(z)*B;return t&&I.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),G={nodes:I,edges:x},r.abrupt("return",G);case 19:case"end":return r.stop()}}),r,this)})))}}])}(),Hm=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[jm(e[0])],i={},a=e.length;i[e[0].id]=!0;var o=0;return e.forEach((function(s,u){if(0!==u)if(u!==a-1&&t.getDegree(s.id,"both")===t.getDegree(e[u+1].id,"both")&&!t.areNeighbors(r[o].id,s.id)||i[s.id]){for(var c=n?t.getSuccessors(r[o].id):t.getNeighbors(r[o].id),l=!1,h=0;h<c.length;h++){var d=c[h];if(t.getDegree(d.id)===t.getDegree(s.id)&&!i[d.id]){r.push(jm(d)),i[d.id]=!0,l=!0;break}}for(var f=0;!l&&(i[e[f].id]||(r.push(jm(e[f])),i[e[f].id]=!0,l=!0),++f!==a););}else r.push(jm(s)),i[s.id]=!0,o++})),r};function Ym(t,e){var n=[];return e.forEach((function(t,e){n.push(jm(t))})),n.sort((function(e,n){return t.getDegree(e.id,"both")-t.getDegree(n.id,"both")})),n}var Um=function(t,e,n){var r=t,i=e,a=n;return r||"undefined"==typeof window||(r=window.innerWidth),i||"undefined"==typeof window||(i=window.innerHeight),a||(a=[r/2,i/2]),[r,i,a]},qm=Array.isArray,Xm={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},Km=function(){return b((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y(this,t),this.options=e,this.id="concentric",this.options=Object.assign(Object.assign({},Xm),e)}),[{key:"execute",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.genericConcentricLayout(!1,t,e));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"assign",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.genericConcentricLayout(!0,t,e);case 2:case"end":return n.stop()}}),n,this)})))}},{key:"genericConcentricLayout",value:function(t,e,n){return pe(this,void 0,void 0,Tn().mark((function r(){var i,a,o,s,u,c,l,h,d,f,v,p,g,y,m,b,x,E,k,M,S,O,N,A,T,P,C,R,L,D,_,I,j,F,B,z,G,V,W;return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=Object.assign(Object.assign({},this.options),n),a=i.center,o=i.width,s=i.height,u=i.sortBy,c=i.maxLevelDiff,l=i.sweep,h=i.clockwise,d=i.equidistant,f=i.preventOverlap,v=i.startAngle,p=void 0===v?1.5*Math.PI:v,g=i.nodeSize,y=i.nodeSpacing,m=e.getAllNodes(),b=e.getAllEdges(),x=o||"undefined"==typeof window?o:window.innerWidth,E=s||"undefined"==typeof window?s:window.innerHeight,k=a||[x/2,E/2],(null==m?void 0:m.length)&&1!==m.length){r.next=9;break}return r.abrupt("return",Gm(e,t,k));case 9:if(M=[],O=0,qm(g)?S=Math.max(g[0],g[1]):cn(g)?(S=-1/0,m.forEach((function(t){var e=Math.max.apply(Math,w(Rm(g(t))));e>S&&(S=e)}))):S=g,qm(y)?O=Math.max(y[0],y[1]):oe(y)&&(O=y),m.forEach((function(t){var e=jm(t);M.push(e);var n=S,r=e.data;qm(r.size)?n=Math.max(r.size[0],r.size[1]):oe(r.size)?n=r.size:ln(r.size)&&(n=Math.max(r.size.width,r.size.height)),S=Math.max(S,n),cn(y)&&(O=Math.max(y(t),O))})),N={},M.forEach((function(t,e){N[t.id]=e})),ce(A=u)&&void 0!==M[0].data[A]||(A="degree"),"degree"===A?M.sort((function(t,n){return e.getDegree(n.id,"both")-e.getDegree(t.id,"both")})):M.sort((function(t,e){return e.data[A]-t.data[A]})),T=M[0],P=(c||("degree"===A?e.getDegree(T.id,"both"):T.data[A]))/4,R=(C=[{nodes:[]}])[0],M.forEach((function(t){if(R.nodes.length>0){var n="degree"===A?Math.abs(e.getDegree(R.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(R.nodes[0].data[A]-t.data[A]);P&&n>=P&&(R={nodes:[]},C.push(R))}R.nodes.push(t)})),L=S+O,f||(D=C.length>0&&C[0].nodes.length>1,_=Math.min(x,E)/2-L,I=_/(C.length+(D?1:0)),L=Math.min(L,I)),j=0,C.forEach((function(t){var e=void 0===l?2*Math.PI-2*Math.PI/t.nodes.length:l;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&f){var n=Math.cos(t.dTheta)-Math.cos(0),r=Math.sin(t.dTheta)-Math.sin(0),i=Math.sqrt(L*L/(n*n+r*r));j=Math.max(i,j)}t.r=j,j+=L})),d){for(F=0,B=0,z=0;z<C.length;z++)G=C[z],V=(G.r||0)-B,F=Math.max(F,V);B=0,C.forEach((function(t,e){0===e&&(B=t.r||0),t.r=B,B+=F}))}return C.forEach((function(t){var e=t.dTheta||0,n=t.r||0;t.nodes.forEach((function(t,r){var i=p+(h?1:-1)*e*r;t.data.x=k[0]+n*Math.cos(i),t.data.y=k[1]+n*Math.sin(i)}))})),t&&M.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),W={nodes:M,edges:b},r.abrupt("return",W);case 33:case"end":return r.stop()}}),r,this)})))}}])}();function $m(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,a,o,s,u,c,l,h,d,f=t._root,v={data:r},p=t._x0,g=t._y0,y=t._x1,m=t._y1;if(!f)return t._root=v,t;for(;f.length;)if((c=e>=(a=(p+y)/2))?p=a:y=a,(l=n>=(o=(g+m)/2))?g=o:m=o,i=f,!(f=f[h=l<<1|c]))return i[h]=v,t;if(s=+t._x.call(null,f.data),u=+t._y.call(null,f.data),e===s&&n===u)return v.next=f,i?i[h]=v:t._root=v,t;do{i=i?i[h]=new Array(4):t._root=new Array(4),(c=e>=(a=(p+y)/2))?p=a:y=a,(l=n>=(o=(g+m)/2))?g=o:m=o}while((h=l<<1|c)==(d=(u>=o)<<1|s>=a));return i[d]=f,i[h]=v,t}function Zm(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function Qm(t){return t[0]}function Jm(t){return t[1]}function tb(t,e,n){var r=new eb(null==e?Qm:e,null==n?Jm:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function eb(t,e,n,r,i,a){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function nb(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var rb=tb.prototype=eb.prototype;function ib(t,e,n,r,i){if(isNaN(e)||isNaN(n)||isNaN(r))return t;var a,o,s,u,c,l,h,d,f,v,p,g,y=t._root,m={data:i},b=t._x0,x=t._y0,w=t._z0,E=t._x1,k=t._y1,M=t._z1;if(!y)return t._root=m,t;for(;y.length;)if((d=e>=(o=(b+E)/2))?b=o:E=o,(f=n>=(s=(x+k)/2))?x=s:k=s,(v=r>=(u=(w+M)/2))?w=u:M=u,a=y,!(y=y[p=v<<2|f<<1|d]))return a[p]=m,t;if(c=+t._x.call(null,y.data),l=+t._y.call(null,y.data),h=+t._z.call(null,y.data),e===c&&n===l&&r===h)return m.next=y,a?a[p]=m:t._root=m,t;do{a=a?a[p]=new Array(8):t._root=new Array(8),(d=e>=(o=(b+E)/2))?b=o:E=o,(f=n>=(s=(x+k)/2))?x=s:k=s,(v=r>=(u=(w+M)/2))?w=u:M=u}while((p=v<<2|f<<1|d)==(g=(h>=u)<<2|(l>=s)<<1|c>=o));return a[g]=y,a[p]=m,t}function ab(t,e,n,r,i,a,o){this.node=t,this.x0=e,this.y0=n,this.z0=r,this.x1=i,this.y1=a,this.z1=o}rb.copy=function(){var t,e,n=new eb(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=nb(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=nb(e));return n},rb.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return $m(this.cover(e,n),e,n,t)},rb.addAll=function(t){var e,n,r,i,a=t.length,o=new Array(a),s=new Array(a),u=1/0,c=1/0,l=-1/0,h=-1/0;for(n=0;n<a;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(o[n]=r,s[n]=i,r<u&&(u=r),r>l&&(l=r),i<c&&(c=i),i>h&&(h=i));if(u>l||c>h)return this;for(this.cover(u,c).cover(l,h),n=0;n<a;++n)$m(this,o[n],s[n],t[n]);return this},rb.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,a=(r=Math.floor(e))+1;else{for(var o,s,u=i-n||1,c=this._root;n>t||t>=i||r>e||e>=a;)switch(s=(e<r)<<1|t<n,(o=new Array(4))[s]=c,c=o,u*=2,s){case 0:i=n+u,a=r+u;break;case 1:n=i-u,a=r+u;break;case 2:i=n+u,r=a-u;break;case 3:n=i-u,r=a-u}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this},rb.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},rb.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},rb.find=function(t,e,n){var r,i,a,o,s,u,c,l=this._x0,h=this._y0,d=this._x1,f=this._y1,v=[],p=this._root;for(p&&v.push(new Zm(p,l,h,d,f)),null==n?n=1/0:(l=t-n,h=e-n,d=t+n,f=e+n,n*=n);u=v.pop();)if(!(!(p=u.node)||(i=u.x0)>d||(a=u.y0)>f||(o=u.x1)<l||(s=u.y1)<h))if(p.length){var g=(i+o)/2,y=(a+s)/2;v.push(new Zm(p[3],g,y,o,s),new Zm(p[2],i,y,g,s),new Zm(p[1],g,a,o,y),new Zm(p[0],i,a,g,y)),(c=(e>=y)<<1|t>=g)&&(u=v[v.length-1],v[v.length-1]=v[v.length-1-c],v[v.length-1-c]=u)}else{var m=t-+this._x.call(null,p.data),b=e-+this._y.call(null,p.data),x=m*m+b*b;if(x<n){var w=Math.sqrt(n=x);l=t-w,h=e-w,d=t+w,f=e+w,r=p.data}}return r},rb.remove=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,r,i,a,o,s,u,c,l,h,d,f=this._root,v=this._x0,p=this._y0,g=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((c=a>=(s=(v+g)/2))?v=s:g=s,(l=o>=(u=(p+y)/2))?p=u:y=u,e=f,!(f=f[h=l<<1|c]))return this;if(!f.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,d=h)}for(;f.data!==t;)if(r=f,!(f=f.next))return this;return(i=f.next)&&delete f.next,r?(i?r.next=i:delete r.next,this):e?(i?e[h]=i:delete e[h],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(n?n[d]=f:this._root=f),this):(this._root=i,this)},rb.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},rb.root=function(){return this._root},rb.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},rb.visit=function(t){var e,n,r,i,a,o,s=[],u=this._root;for(u&&s.push(new Zm(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,r=e.x0,i=e.y0,a=e.x1,o=e.y1)&&u.length){var c=(r+a)/2,l=(i+o)/2;(n=u[3])&&s.push(new Zm(n,c,l,a,o)),(n=u[2])&&s.push(new Zm(n,r,l,c,o)),(n=u[1])&&s.push(new Zm(n,c,i,a,l)),(n=u[0])&&s.push(new Zm(n,r,i,c,l))}return this},rb.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new Zm(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var a,o=e.x0,s=e.y0,u=e.x1,c=e.y1,l=(o+u)/2,h=(s+c)/2;(a=i[0])&&n.push(new Zm(a,o,s,l,h)),(a=i[1])&&n.push(new Zm(a,l,s,u,h)),(a=i[2])&&n.push(new Zm(a,o,h,l,c)),(a=i[3])&&n.push(new Zm(a,l,h,u,c))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},rb.x=function(t){return arguments.length?(this._x=t,this):this._x},rb.y=function(t){return arguments.length?(this._y=t,this):this._y};var ob=function(t,e,n,r,i,a){return Math.sqrt(Math.pow(t-r,2)+Math.pow(e-i,2)+Math.pow(n-a,2))};function sb(t){return t[0]}function ub(t){return t[1]}function cb(t){return t[2]}function lb(t,e,n,r){var i=new hb(null==e?sb:e,null==n?ub:n,null==r?cb:r,NaN,NaN,NaN,NaN,NaN,NaN);return null==t?i:i.addAll(t)}function hb(t,e,n,r,i,a,o,s,u){this._x=t,this._y=e,this._z=n,this._x0=r,this._y0=i,this._z0=a,this._x1=o,this._y1=s,this._z1=u,this._root=void 0}function db(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var fb=lb.prototype=hb.prototype;function vb(t){var e=0,n=0,r=0,i=0,a=0,o=t.length;if(o){for(var s=0;s<o;s++){var u=t[s];u&&u.weight&&(e+=u.weight,n+=u.x*u.weight,r+=u.y*u.weight,i+=u.z*u.weight,a+=u.size*u.weight)}t.x=n/e,t.y=r/e,t.z=i/e,t.size=a/e,t.weight=e}else{var c=t;t.x=c.data.x,t.y=c.data.y,t.z=c.data.z,t.size=c.data.size,t.weight=c.data.weight}}fb.copy=function(){var t,e,n=new hb(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),r=this._root;if(!r)return n;if(!r.length)return n._root=db(r),n;for(t=[{source:r,target:n._root=new Array(8)}];r=t.pop();)for(var i=0;i<8;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(8)}):r.target[i]=db(e));return n},fb.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t),r=+this._z.call(null,t);return ib(this.cover(e,n,r),e,n,r,t)},fb.addAll=function(t){Array.isArray(t)||(t=Array.from(t));for(var e,n,r,i,a=t.length,o=new Float64Array(a),s=new Float64Array(a),u=new Float64Array(a),c=1/0,l=1/0,h=1/0,d=-1/0,f=-1/0,v=-1/0,p=0;p<a;++p)isNaN(n=+this._x.call(null,e=t[p]))||isNaN(r=+this._y.call(null,e))||isNaN(i=+this._z.call(null,e))||(o[p]=n,s[p]=r,u[p]=i,n<c&&(c=n),n>d&&(d=n),r<l&&(l=r),r>f&&(f=r),i<h&&(h=i),i>v&&(v=i));if(c>d||l>f||h>v)return this;this.cover(c,l,h).cover(d,f,v);for(var g=0;g<a;++g)ib(this,o[g],s[g],u[g],t[g]);return this},fb.cover=function(t,e,n){if(isNaN(t=+t)||isNaN(e=+e)||isNaN(n=+n))return this;var r=this._x0,i=this._y0,a=this._z0,o=this._x1,s=this._y1,u=this._z1;if(isNaN(r))o=(r=Math.floor(t))+1,s=(i=Math.floor(e))+1,u=(a=Math.floor(n))+1;else{for(var c,l,h=o-r||1,d=this._root;r>t||t>=o||i>e||e>=s||a>n||n>=u;)switch(l=(n<a)<<2|(e<i)<<1|t<r,(c=new Array(8))[l]=d,d=c,h*=2,l){case 0:o=r+h,s=i+h,u=a+h;break;case 1:r=o-h,s=i+h,u=a+h;break;case 2:o=r+h,i=s-h,u=a+h;break;case 3:r=o-h,i=s-h,u=a+h;break;case 4:o=r+h,s=i+h,a=u-h;break;case 5:r=o-h,s=i+h,a=u-h;break;case 6:o=r+h,i=s-h,a=u-h;break;case 7:r=o-h,i=s-h,a=u-h}this._root&&this._root.length&&(this._root=d)}return this._x0=r,this._y0=i,this._z0=a,this._x1=o,this._y1=s,this._z1=u,this},fb.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},fb.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1],+t[0][2]).cover(+t[1][0],+t[1][1],+t[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},fb.find=function(t,e,n,r){var i,a,o,s,u,c,l,h,d,f=this._x0,v=this._y0,p=this._z0,g=this._x1,y=this._y1,m=this._z1,b=[],x=this._root;for(x&&b.push(new ab(x,f,v,p,g,y,m)),null==r?r=1/0:(f=t-r,v=e-r,p=n-r,g=t+r,y=e+r,m=n+r,r*=r);h=b.pop();)if(!(!(x=h.node)||(a=h.x0)>g||(o=h.y0)>y||(s=h.z0)>m||(u=h.x1)<f||(c=h.y1)<v||(l=h.z1)<p))if(x.length){var w=(a+u)/2,E=(o+c)/2,k=(s+l)/2;b.push(new ab(x[7],w,E,k,u,c,l),new ab(x[6],a,E,k,w,c,l),new ab(x[5],w,o,k,u,E,l),new ab(x[4],a,o,k,w,E,l),new ab(x[3],w,E,s,u,c,k),new ab(x[2],a,E,s,w,c,k),new ab(x[1],w,o,s,u,E,k),new ab(x[0],a,o,s,w,E,k)),(d=(n>=k)<<2|(e>=E)<<1|t>=w)&&(h=b[b.length-1],b[b.length-1]=b[b.length-1-d],b[b.length-1-d]=h)}else{var M=t-+this._x.call(null,x.data),S=e-+this._y.call(null,x.data),O=n-+this._z.call(null,x.data),N=M*M+S*S+O*O;if(N<r){var A=Math.sqrt(r=N);f=t-A,v=e-A,p=n-A,g=t+A,y=e+A,m=n+A,i=x.data}}return i},fb.findAllWithinRadius=function(t,e,n,r){var i=this,a=[],o=t-r,s=e-r,u=n-r,c=t+r,l=e+r,h=n+r;return this.visit((function(d,f,v,p,g,y,m){if(!d.length)do{var b=d.data;ob(t,e,n,i._x(b),i._y(b),i._z(b))<=r&&a.push(b)}while(d=d.next);return f>c||v>l||p>h||g<o||y<s||m<u})),a},fb.remove=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t))||isNaN(s=+this._z.call(null,t)))return this;var e,n,r,i,a,o,s,u,c,l,h,d,f,v,p,g=this._root,y=this._x0,m=this._y0,b=this._z0,x=this._x1,w=this._y1,E=this._z1;if(!g)return this;if(g.length)for(;;){if((h=a>=(u=(y+x)/2))?y=u:x=u,(d=o>=(c=(m+w)/2))?m=c:w=c,(f=s>=(l=(b+E)/2))?b=l:E=l,e=g,!(g=g[v=f<<2|d<<1|h]))return this;if(!g.length)break;(e[v+1&7]||e[v+2&7]||e[v+3&7]||e[v+4&7]||e[v+5&7]||e[v+6&7]||e[v+7&7])&&(n=e,p=v)}for(;g.data!==t;)if(r=g,!(g=g.next))return this;return(i=g.next)&&delete g.next,r?(i?r.next=i:delete r.next,this):e?(i?e[v]=i:delete e[v],(g=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&g===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!g.length&&(n?n[p]=g:this._root=g),this):(this._root=i,this)},fb.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},fb.root=function(){return this._root},fb.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},fb.visit=function(t){var e,n,r,i,a,o,s,u,c=[],l=this._root;for(l&&c.push(new ab(l,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=c.pop();)if(!t(l=e.node,r=e.x0,i=e.y0,a=e.z0,o=e.x1,s=e.y1,u=e.z1)&&l.length){var h=(r+o)/2,d=(i+s)/2,f=(a+u)/2;(n=l[7])&&c.push(new ab(n,h,d,f,o,s,u)),(n=l[6])&&c.push(new ab(n,r,d,f,h,s,u)),(n=l[5])&&c.push(new ab(n,h,i,f,o,d,u)),(n=l[4])&&c.push(new ab(n,r,i,f,h,d,u)),(n=l[3])&&c.push(new ab(n,h,d,a,o,s,f)),(n=l[2])&&c.push(new ab(n,r,d,a,h,s,f)),(n=l[1])&&c.push(new ab(n,h,i,a,o,d,f)),(n=l[0])&&c.push(new ab(n,r,i,a,h,d,f))}return this},fb.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new ab(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=n.pop();){var i=e.node;if(i.length){var a,o=e.x0,s=e.y0,u=e.z0,c=e.x1,l=e.y1,h=e.z1,d=(o+c)/2,f=(s+l)/2,v=(u+h)/2;(a=i[0])&&n.push(new ab(a,o,s,u,d,f,v)),(a=i[1])&&n.push(new ab(a,d,s,u,c,f,v)),(a=i[2])&&n.push(new ab(a,o,f,u,d,l,v)),(a=i[3])&&n.push(new ab(a,d,f,u,c,l,v)),(a=i[4])&&n.push(new ab(a,o,s,v,d,f,h)),(a=i[5])&&n.push(new ab(a,d,s,v,c,f,h)),(a=i[6])&&n.push(new ab(a,o,f,v,d,l,h)),(a=i[7])&&n.push(new ab(a,d,f,v,c,l,h))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.z0,e.x1,e.y1,e.z1);return this},fb.x=function(t){return arguments.length?(this._x=t,this):this._x},fb.y=function(t){return arguments.length?(this._y=t,this):this._y},fb.z=function(t){return arguments.length?(this._z=t,this):this._z};var pb=function(t,e,n,r,i,a,o){var s;if((null===(s=t.data)||void 0===s?void 0:s.id)!==a.id){for(var u=[n,r,i][o-1],c=a.x-t.x||.1,l=a.y-t.y||.1,h=a.z-t.z||.1,d=[c,l,h],f=u-e,v=0,p=0;p<o;p++)v+=d[p]*d[p];var g=Math.sqrt(v)*v;if(f*f*.81<v){var y=t.weight/g;return a.vx+=c*y,a.vy+=l*y,a.vz+=h*y,!0}if(t.length)return!1;if(t.data!==a){var m=t.data.weight/g;a.vx+=c*m,a.vy+=l*m,a.vz+=h*m}}},gb={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:50,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:200,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},yb=function(){return b((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y(this,t),this.options=e,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=Object.assign(Object.assign({},gb),e)}),[{key:"execute",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.genericForceLayout(!1,t,e));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"assign",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.genericForceLayout(!0,t,e);case 2:case"end":return n.stop()}}),n,this)})))}},{key:"stop",value:function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1}},{key:"tick",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.maxIteration||1;if(this.lastResult)return this.lastResult;for(var n=0;(this.judgingDistance>this.lastOptions.minMovement||n<1)&&n<e;n++)this.runOneStep(this.lastCalcGraph,this.lastGraph,n,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var r={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&r.nodes.forEach((function(e){return t.lastGraph.mergeNodeData(e.id,{x:e.data.x,y:e.data.y,z:3===t.options.dimensions?e.data.z:void 0})})),r}},{key:"genericForceLayout",value:function(t,e,n){return pe(this,void 0,void 0,Tn().mark((function r(){var i,a,o,s,u,c,l,h,d,f,v,p,g,y,m,b,x,w,E,k,M=this;return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=Object.assign(Object.assign({},this.options),n),a=e.getAllNodes(),o=e.getAllEdges(),s=this.formatOptions(i,e),u=s.dimensions,c=s.width,l=s.height,h=s.nodeSize,d=s.getMass,f=s.nodeStrength,v=s.edgeStrength,p=s.linkDistance,g=a.map((function(t,e){return Object.assign(Object.assign({},t),{data:Object.assign(Object.assign({},t.data),{x:oe(t.data.x)?t.data.x:Math.random()*c,y:oe(t.data.y)?t.data.y:Math.random()*l,z:oe(t.data.z)?t.data.z:Math.random()*Math.sqrt(c*l),size:h(t)||30,mass:d(t),nodeStrength:f(t)})})})),y=o.map((function(t){return Object.assign(Object.assign({},t),{data:Object.assign(Object.assign({},t.data),{edgeStrength:v(t),linkDistance:p(t,e.getNode(t.source),e.getNode(t.target))})})})),null==a?void 0:a.length){r.next=10;break}return this.lastResult={nodes:[],edges:o},r.abrupt("return",{nodes:[],edges:o});case 10:if(m={},a.forEach((function(t,e){m[t.id]={x:0,y:0,z:0}})),b=new _g({nodes:g,edges:y}),this.formatCentripetal(s,b),x=s.maxIteration,w=s.minMovement,E=s.onTick,this.lastLayoutNodes=g,this.lastLayoutEdges=y,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=b,this.lastOptions=s,this.lastVelMap=m,"undefined"!=typeof window){r.next=24;break}return r.abrupt("return");case 24:return k=0,r.abrupt("return",new Promise((function(n){M.timeInterval=window.setInterval((function(){a&&M.running||n({nodes:Eb(e,g),edges:o}),M.runOneStep(b,e,k,m,s),M.updatePosition(e,b,m,s),t&&g.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===u?t.data.z:void 0})})),null==E||E({nodes:Eb(e,g),edges:o}),(++k>=x||M.judgingDistance<w)&&(window.clearInterval(M.timeInterval),n({nodes:Eb(e,g),edges:o}))}),0),M.running=!0})));case 26:case"end":return r.stop()}}),r,this)})))}},{key:"formatOptions",value:function(t,e){var n=Object.assign({},t),r=t.width,i=t.height,a=t.getMass;n.width=r||"undefined"==typeof window?r:window.innerWidth,n.height=i||"undefined"==typeof window?i:window.innerHeight,t.center||(n.center=[n.width/2,n.height/2]),a||(n.getMass=function(t){var n=1;oe(null==t?void 0:t.data.mass)&&(n=null==t?void 0:t.data.mass);var r=e.getDegree(t.id,"both");return!r||r<5?n:5*r*n}),n.nodeSize=_m(t.nodeSize,t.nodeSpacing);var o=t.linkDistance?Lm(1,t.linkDistance):function(t){return 1+n.nodeSize(e.getNode(t.source))+n.nodeSize(e.getNode(t.target))};return n.linkDistance=o,n.nodeStrength=Lm(1,t.nodeStrength),n.edgeStrength=Lm(1,t.edgeStrength),n}},{key:"formatCentripetal",value:function(t,e){var n,r,i=t.dimensions,a=t.centripetalOptions,o=t.center,s=t.clusterNodeStrength,u=t.leafCluster,c=t.clustering,l=t.nodeClusterBy,h=e.getAllNodes(),d=a||{leaf:2,single:2,others:1,center:function(t){return{x:o[0],y:o[1],z:3===i?o[2]:void 0}}};if("function"!=typeof s&&(t.clusterNodeStrength=function(t){return s}),u&&l&&(n=mb(e,l),r=Array.from(new Set(null==h?void 0:h.map((function(t){return t.data[l]}))))||[],t.centripetalOptions=Object.assign(d,{single:100,leaf:function(e){var i=n[e.id]||{},a=i.siblingLeaves,o=i.sameTypeLeaves;return(null==o?void 0:o.length)===(null==a?void 0:a.length)||1===(null==r?void 0:r.length)?1:t.clusterNodeStrength(e)},others:1,center:function(t){var r,i=e.getDegree(t.id,"both");if(!i)return{x:100,y:100,z:0};if(1===i){var a=(n[t.id]||{}).sameTypeLeaves,o=void 0===a?[]:a;1===o.length?r=void 0:o.length>1&&(r=wb(o))}else r=void 0;return{x:null==r?void 0:r.x,y:null==r?void 0:r.y,z:null==r?void 0:r.z}}})),c&&l){n||(n=mb(e,l)),r||(r=Array.from(new Set(h.map((function(t){return t.data[l]}))))),r=r.filter((function(t){return void 0!==t}));var f={};r.forEach((function(t){var n=h.filter((function(e){return e.data[l]===t})).map((function(t){return e.getNode(t.id)}));f[t]=wb(n)})),t.centripetalOptions=Object.assign(d,{single:function(e){return t.clusterNodeStrength(e)},leaf:function(e){return t.clusterNodeStrength(e)},others:function(e){return t.clusterNodeStrength(e)},center:function(t){var e=f[t.data[l]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y,z:null==e?void 0:e.z}}})}var v=t.centripetalOptions||{},p=v.leaf,g=v.single,y=v.others;p&&"function"!=typeof p&&(t.centripetalOptions.leaf=function(){return p}),g&&"function"!=typeof g&&(t.centripetalOptions.single=function(){return g}),y&&"function"!=typeof y&&(t.centripetalOptions.others=function(){return y})}},{key:"runOneStep",value:function(t,e,n,r,i){var a={},o=t.getAllNodes(),s=t.getAllEdges();if(null==o?void 0:o.length){var u=i.monitor;this.calRepulsive(t,a,i),s&&this.calAttractive(t,a,i),this.calGravity(t,e,a,i),this.updateVelocity(t,a,r,i),u&&u({energy:this.calTotalEnergy(a,o),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:n})}}},{key:"calTotalEnergy",value:function(t,e){var n=this;if(!(null==e?void 0:e.length))return 0;var r=0;return e.forEach((function(e,i){var a=t[e.id].x,o=t[e.id].y,s=3===n.options.dimensions?t[e.id].z:0,u=a*a+o*o+s*s,c=e.data.mass;r+=(void 0===c?1:c)*u*.5})),r}},{key:"calRepulsive",value:function(t,e,n){var r=n.dimensions,i=n.factor,a=n.coulombDisScale;!function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,a=e/n,o=t.getAllNodes(),s=o.map((function(t,e){var n=t.data,r=n.nodeStrength;return{x:n.x,y:n.y,z:n.z,size:n.size,index:e,id:t.id,vx:0,vy:0,vz:0,weight:a*r}})),u=(2===i?tb(s,(function(t){return t.x}),(function(t){return t.y})):lb(s,(function(t){return t.x}),(function(t){return t.y}),(function(t){return t.z}))).visitAfter(vb),c=new Map;s.forEach((function(t){c.set(t.id,t),function(t,e,n){e.visit((function(e,r,i,a,o){return pb(e,r,i,a,o,t,n)}))}(t,u,i)})),s.map((function(t,e){var n=o[e],i=n.id,a=n.data.mass,s=void 0===a?1:a;r[i]={x:t.vx/s,y:t.vy/s,z:t.vz/s}}))}(t,i,a*a,e,r)}},{key:"calAttractive",value:function(t,e,n){var r=n.dimensions,i=n.nodeSize;t.getAllEdges().forEach((function(n,a){var o=n.source,s=n.target,u=t.getNode(o),c=t.getNode(s);if(u&&c){var l=c.data.x-u.data.x,h=c.data.y-u.data.y,d=3===r?c.data.z-u.data.z:0;l||h||(l=.01*Math.random(),h=.01*Math.random(),3!==r||d||(d=.01*Math.random()));var f=Math.sqrt(l*l+h*h+d*d);if(!(f<i(u)+i(c))){var v=l/f,p=h/f,g=d/f,y=n.data||{},m=y.linkDistance,b=void 0===m?200:m,x=y.edgeStrength,w=(b-f)*(void 0===x?200:x),E=1/(u.data.mass||1),k=1/(c.data.mass||1),M=v*w,S=p*w,O=g*w;e[o].x-=M*E,e[o].y-=S*E,e[o].z-=O*E,e[s].x+=M*k,e[s].y+=S*k,e[s].z+=O*k}}}))}},{key:"calGravity",value:function(t,e,n,r){var i=r.getCenter,a=t.getAllNodes(),o=e.getAllNodes(),s=e.getAllEdges(),u=r.width,c=r.height,l=r.center,d=r.gravity,f=r.centripetalOptions;a&&a.forEach((function(r){var a=r.id,v=r.data,p=v.mass,g=v.x,y=v.y,m=v.z,b=e.getNode(a),x=0,w=0,E=0,k=d,M=t.getDegree(a,"in"),S=t.getDegree(a,"out"),O=t.getDegree(a,"both"),N=null==i?void 0:i(b,O);if(N){var A=h(N,3);x=g-A[0],w=y-A[1],k=A[2]}else x=g-l[0],w=y-l[1],E=m-l[2];if(k&&(n[a].x-=k*x/p,n[a].y-=k*w/p,n[a].z-=k*E/p),f){var T=f.leaf,P=f.single,C=f.others,R=f.center,L=(null==R?void 0:R(b,o,s,u,c))||{x:0,y:0,z:0,centerStrength:0},D=L.x,_=L.y,I=L.z,j=L.centerStrength;if(!oe(D)||!oe(_))return;var F=(g-D)/p,B=(y-_)/p,z=(m-I)/p;if(j&&(n[a].x-=j*F,n[a].y-=j*B,n[a].z-=j*z),0===O){var G=P(b);if(!G)return;return n[a].x-=G*F,n[a].y-=G*B,void(n[a].z-=G*z)}if(0===M||0===S){var V=T(b,o,s);if(!V)return;return n[a].x-=V*F,n[a].y-=V*B,void(n[a].z-=V*z)}var W=C(b);if(!W)return;n[a].x-=W*F,n[a].y-=W*B,n[a].z-=W*z}}))}},{key:"updateVelocity",value:function(t,e,n,r){var i=r.damping,a=r.maxSpeed,o=r.interval,s=r.dimensions,u=t.getAllNodes();(null==u?void 0:u.length)&&u.forEach((function(t){var r=t.id,u=(n[r].x+e[r].x*o)*i||.01,c=(n[r].y+e[r].y*o)*i||.01,l=3===s?(n[r].z+e[r].z*o)*i||.01:0,h=Math.sqrt(u*u+c*c+l*l);if(h>a){var d=a/h;u*=d,c*=d,l*=d}n[r]={x:u,y:c,z:l}}))}},{key:"updatePosition",value:function(t,e,n,r){var i=this,a=r.distanceThresholdMode,o=r.interval,s=r.dimensions,u=e.getAllNodes();if(null==u?void 0:u.length){var c=0;"max"===a?this.judgingDistance=-1/0:"min"===a&&(this.judgingDistance=1/0),u.forEach((function(r){var u=r.id,l=t.getNode(u);if(oe(l.data.fx)&&oe(l.data.fy))e.mergeNodeData(u,{x:l.data.fx,y:l.data.fy,z:3===s?l.data.fz:void 0});else{var h=n[u].x*o,d=n[u].y*o,f=3===s?n[u].z*o:0;e.mergeNodeData(u,{x:r.data.x+h,y:r.data.y+d,z:r.data.z+f});var v=Math.sqrt(h*h+d*d+f*f);switch(a){case"max":i.judgingDistance<v&&(i.judgingDistance=v);break;case"min":i.judgingDistance>v&&(i.judgingDistance=v);break;default:c+=v}}})),a&&"mean"!==a||(this.judgingDistance=c/u.length)}else this.judgingDistance=0}}])}(),mb=function(t,e){var n=t.getAllNodes();if(!(null==n?void 0:n.length))return{};var r={};return n.forEach((function(n,i){1===t.getDegree(n.id,"both")&&(r[n.id]=bb(t,"leaf",n,e))})),r},bb=function(t,e,n,r){var i=t.getDegree(n.id,"in"),a=t.getDegree(n.id,"out"),o=n,s=[];return 0===i?(o=t.getSuccessors(n.id)[0],s=t.getNeighbors(o.id)):0===a&&(o=t.getPredecessors(n.id)[0],s=t.getNeighbors(o.id)),s=s.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")})),{coreNode:o,siblingLeaves:s,sameTypeLeaves:xb(t,e,r,n,s)}},xb=function(t,e,n,r,i){var a=r.data[n]||"",o=(null==i?void 0:i.filter((function(t){return t.data[n]===a})))||[];return"leaf"===e&&(o=o.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")}))),o},wb=function(t){var e={x:0,y:0};t.forEach((function(t){var n=t.data,r=n.x,i=n.y;e.x+=r||0,e.y+=i||0}));var n=t.length||1;return{x:e.x/n,y:e.y/n}},Eb=function(t,e){return e.map((function(e){var n=e.id,r=e.data,i=t.getNode(n);return Object.assign(Object.assign({},i),{data:Object.assign(Object.assign({},i.data),{x:r.x,y:r.y,z:r.z})})}))},kb=a(9547),Mb=(kb.y3,kb.jy,kb.oN,kb.Hc,kb.cg,kb.hj,kb.LU,kb.Tb,kb.uq),Sb=(kb.Zm,kb.Dq,kb.__,kb.q0,kb.lh,kb.pI,kb.zC,kb.zg,kb.g6,kb.OL,kb.ks,kb.QR,kb.jp,kb.mk,kb.W2);kb.l,kb.KY,kb.dv,kb.BR,kb.Wu,kb.uq,kb.uq,kb.a4,kb.DI,kb.Jo,kb.Zi,kb.kH,kb.LV;var Ob=function(t){for(var e=[],n=t.length,r=0;r<n;r+=1){e[r]=[];for(var i=0;i<n;i+=1)r===i?e[r][i]=0:0!==t[r][i]&&t[r][i]?e[r][i]=t[r][i]:e[r][i]=1/0}for(var a=0;a<n;a+=1)for(var o=0;o<n;o+=1)for(var s=0;s<n;s+=1)e[o][s]>e[o][a]+e[a][s]&&(e[o][s]=e[o][a]+e[a][s]);return e},Nb=function(t,e){var n=t.nodes,r=t.edges,i=[],a={};if(!n)throw new Error("invalid nodes data!");return n&&n.forEach((function(t,e){a[t.id]=e,i.push([])})),null==r||r.forEach((function(t){var n=t.source,r=t.target,o=a[n],s=a[r];void 0!==o&&void 0!==s&&(i[o][s]=1,e||(i[s][o]=1))})),i},Ab=function(t,e){var n=[];return t.forEach((function(t){var r=[];t.forEach((function(t){r.push(t*e)})),n.push(r)})),n},Tb=function(t){var e=1/0,n=1/0,r=-1/0,i=-1/0;return t.forEach((function(t){var a=t.data.size;qm(a)?1===a.length&&(a=[a[0],a[0]]):oe(a)?a=[a,a]:(void 0===a||isNaN(a))&&(a=[30,30]);var o=[a[0]/2,a[1]/2],s=t.data.x-o[0],u=t.data.x+o[0],c=t.data.y-o[1],l=t.data.y+o[1];e>s&&(e=s),n>c&&(n=c),r<u&&(r=u),i<l&&(i=l)})),{minX:e,minY:n,maxX:r,maxY:i}},Pb=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},Cb=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"TB",i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};if(null==e?void 0:e.length)for(var o=a.stopBranchFn,s=a.stopAllFn,u=0;u<e.length;u++){var c=e[u];if(t.hasNode(c.id)&&!(null==o?void 0:o(c))){if(null==s?void 0:s(c))return;"TB"===r&&n(c),Cb(t,t.getChildren(c.id,i),n,r,i,a),"TB"!==r&&n(c)}}},Rb={center:[0,0],linkDistance:50},Lb=function(){return b((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y(this,t),this.options=e,this.id="mds",this.options=Object.assign(Object.assign({},Rb),e)}),[{key:"execute",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.genericMDSLayout(!1,t,e));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"assign",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.genericMDSLayout(!0,t,e);case 2:case"end":return n.stop()}}),n,this)})))}},{key:"genericMDSLayout",value:function(t,e,n){return pe(this,void 0,void 0,Tn().mark((function r(){var i,a,o,s,u,c,l,h,d,f,v,p,g;return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=Object.assign(Object.assign({},this.options),n),a=i.center,o=void 0===a?[0,0]:a,s=i.linkDistance,u=void 0===s?50:s,c=e.getAllNodes(),l=e.getAllEdges(),(null==c?void 0:c.length)&&1!==c.length){r.next=6;break}return r.abrupt("return",Gm(e,t,o));case 6:return h=Nb({nodes:c,edges:l},!1),d=Ob(h),Db(d),f=Ab(d,u),v=_b(f),p=[],v.forEach((function(t,e){var n=jm(c[e]);n.data.x=t[0]+o[0],n.data.y=t[1]+o[1],p.push(n)})),t&&p.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),g={nodes:p,edges:l},r.abrupt("return",g);case 16:case"end":return r.stop()}}),r,this)})))}}])}(),Db=function(t){var e=-999999;t.forEach((function(t){t.forEach((function(t){t!==1/0&&e<t&&(e=t)}))})),t.forEach((function(n,r){n.forEach((function(n,i){n===1/0&&(t[r][i]=e)}))}))},_b=function(t){var e=Mb.mul(Mb.pow(t,2),-.5),n=e.mean("row"),r=e.mean("column"),i=e.mean();e.add(i).subRowVector(n).subColumnVector(r);var a=new Sb(e),o=Mb.sqrt(a.diagonalMatrix).diagonal();return a.leftSingularVectors.toJSON().map((function(t){return Mb.mul([t],[o]).toJSON()[0].splice(0,2)}))};function Ib(t){return!!t.tick&&!!t.stop}var jb={gForce:!0,force2:!0,d3force:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0},Fb={center:[0,0],comboPadding:10,treeKey:"combo"},Bb=function(){return b((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y(this,t),this.options=e,this.id="comboCombined",this.options=Object.assign(Object.assign({},Fb),e)}),[{key:"execute",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.genericComboCombinedLayout(!1,t,e));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"assign",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.genericComboCombinedLayout(!0,t,e);case 2:case"end":return n.stop()}}),n,this)})))}},{key:"genericComboCombinedLayout",value:function(t,e,n){return pe(this,void 0,void 0,Tn().mark((function r(){var i,a,o,s,u,c,l,h,d,f,v,p,g,y,m,b,x,E,k,M,S,O,N,A;return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=this.initVals(Object.assign(Object.assign({},this.options),n)),a=i.center,o=i.treeKey,s=i.outerLayout,u=e.getAllNodes().filter((function(t){return!t.data._isCombo})),c=e.getAllNodes().filter((function(t){return t.data._isCombo})),l=e.getAllEdges(),(h=null==u?void 0:u.length)&&1!==h){r.next=8;break}return r.abrupt("return",Gm(e,t,a));case 8:return d=[],f=new Map,u.forEach((function(t){f.set(t.id,t)})),v=new Map,c.forEach((function(t){v.set(t.id,t)})),p=new Map,g=this.getInnerGraphs(e,o,f,v,l,i,p),r.next=17,Promise.all(g);case 17:if(y=new Map,m=[],b=new Map,x=!0,e.getRoots(o).forEach((function(t){var n=p.get(t.id),r=v.get(t.id)||f.get(t.id),i={id:t.id,data:Object.assign(Object.assign({},t.data),{x:n.data.x||r.data.x,y:n.data.y||r.data.y,fx:n.data.fx||r.data.fx,fy:n.data.fy||r.data.fy,mass:n.data.mass||r.data.mass,size:n.data.size})};m.push(i),y.set(t.id,!0),isNaN(i.data.x)||0===i.data.x||isNaN(i.data.y)||0===i.data.y?(i.data.x=100*Math.random(),i.data.y=100*Math.random()):x=!1,Cb(e,[t],(function(e){e.id!==t.id&&b.set(e.id,t.id)}),"TB",o)})),E=[],l.forEach((function(t){var e=b.get(t.source)||t.source,n=b.get(t.target)||t.target;e!==n&&y.has(e)&&y.has(n)&&E.push({id:t.id,source:e,target:n,data:{}})})),!(null==m?void 0:m.length)){r.next=42;break}if(1!==m.length){r.next=30;break}m[0].data.x=a[0],m[0].data.y=a[1],r.next=40;break;case 30:if(M=new _g({nodes:m,edges:E}),S=s||new yb,!x||!jb[S.id]){r.next=36;break}return O=m.length<100?new Lb:new Km,r.next=36,O.assign(M);case 36:return N=Object.assign({center:a,kg:5,preventOverlap:!0,animate:!1},"force"===S.id?{gravity:1,factor:4,linkDistance:function(t,e,n){return(Math.max.apply(Math,w(e.data.size))||32)/2+(Math.max.apply(Math,w(n.data.size))||32)/2+200}}:{}),r.next=39,zb(S,M,N);case 39:k=r.sent;case 40:p.forEach((function(t){var e,n=k.nodes.find((function(e){return e.id===t.id}));if(n){var r=n.data,i=r.x,a=r.y;t.data.visited=!0,t.data.x=i,t.data.y=a,d.push({id:t.id,data:{x:i,y:a}})}var o=t.data,s=o.x,u=o.y;null===(e=t.data.nodes)||void 0===e||e.forEach((function(t){d.push({id:t.id,data:{x:t.data.x+s,y:t.data.y+u}})}))})),p.forEach((function(t){var e=t.data,n=e.x,r=e.y,i=e.visited,a=e.nodes;null==a||a.forEach((function(t){if(!i){var e=d.find((function(e){return e.id===t.id}));e.data.x+=n||0,e.data.y+=r||0}}))}));case 42:return t&&d.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),A={nodes:d,edges:l},r.abrupt("return",A);case 45:case"end":return r.stop()}}),r,this)})))}},{key:"initVals",value:function(t){var e,n,r,i=Object.assign({},t),a=t.nodeSize,o=t.spacing,s=t.comboPadding;if(n=oe(o)?function(){return o}:cn(o)?o:function(){return 0},i.spacing=n,a)if(cn(a))e=function(t){var e=a(t),r=n(t);return qm(t.size)?((t.size[0]>t.size[1]?t.size[0]:t.size[1])+r)/2:((e||32)+r)/2};else if(qm(a)){var u=(a[0]>a[1]?a[0]:a[1])/2;e=function(t){return u+n(t)/2}}else{var c=a/2;e=function(t){return c+n(t)/2}}else e=function(t){var e=n(t);return t.size?qm(t.size)?((t.size[0]>t.size[1]?t.size[0]:t.size[1])+e)/2:ln(t.size)?((t.size.width>t.size.height?t.size.width:t.size.height)+e)/2:(t.size+e)/2:32+e/2};return i.nodeSize=e,r=oe(s)?function(){return s}:qm(s)?function(){return Math.max.apply(null,s)}:cn(s)?s:function(){return 0},i.comboPadding=r,i}},{key:"getInnerGraphs",value:function(t,e,n,r,i,a,o){var s=this,u=a.nodeSize,c=a.comboPadding,l=a.spacing,d=a.innerLayout||new Km({}),f={center:[0,0],preventOverlap:!0,nodeSpacing:l},v=[],p=function(t){var e=(null==c?void 0:c(t))||10;return qm(e)&&(e=Math.max.apply(Math,w(e))),{size:e?[2*e,2*e]:[30,30],padding:e}};return t.getRoots(e).forEach((function(a){o.set(a.id,{id:a.id,data:{nodes:[],size:p(a).size}});var c=Promise.resolve();Cb(t,[a],(function(a){var l;if(a.data._isCombo){var v=p(a),g=v.size,y=v.padding;if(null===(l=t.getChildren(a.id,e))||void 0===l?void 0:l.length){var m=o.get(a.id);o.set(a.id,{id:a.id,data:Object.assign({nodes:[]},null==m?void 0:m.data)});var b=new Map,x=t.getChildren(a.id,e).map((function(t){if(t.data._isCombo)return o.has(t.id)||o.set(t.id,{id:t.id,data:Object.assign({},t.data)}),b.set(t.id,!0),o.get(t.id);var e=n.get(t.id)||r.get(t.id);return b.set(t.id,!0),{id:t.id,data:Object.assign(Object.assign({},e.data),t.data)}})),w={nodes:x,edges:i.filter((function(t){return b.has(t.source)&&b.has(t.target)}))},E=1/0;x.forEach((function(t){var e,n=t.data.size;n||(n=(null===(e=o.get(t.id))||void 0===e?void 0:e.data.size)||(null==u?void 0:u(t))||[30,30]),oe(n)&&(n=[n,n]);var r=h(n,2),i=r[0],a=r[1];E>i&&(E=i),E>a&&(E=a),t.data.size=n})),c=c.then((function(){return pe(s,void 0,void 0,Tn().mark((function t(){var e,n,r,i,s,u,c,l;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new _g(w),t.next=3,zb(d,e,f,!0);case 3:n=Tb(x),r=n.minX,i=n.minY,s=n.maxX,u=n.maxY,c={x:(s+r)/2,y:(u+i)/2},w.nodes.forEach((function(t){t.data.x-=c.x,t.data.y-=c.y})),l=[Math.max(s-r,E)+2*y,Math.max(u-i,E)+2*y],o.get(a.id).data.size=l,o.get(a.id).data.nodes=x;case 9:case"end":return t.stop()}}),t)})))}))}else o.set(a.id,{id:a.id,data:Object.assign(Object.assign({},a.data),{size:g})});return!0}}),"BT",e),v.push(c)})),v}}])}();function zb(t,e,n,r){var i;return pe(this,void 0,void 0,Tn().mark((function a(){return Tn().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!Ib(t)){a.next=4;break}return t.execute(e,n),t.stop(),a.abrupt("return",t.tick(null!==(i=n.iterations)&&void 0!==i?i:300));case 4:if(!r){a.next=8;break}return a.next=7,t.assign(e,n);case 7:case 10:return a.abrupt("return",a.sent);case 8:return a.next=10,t.execute(e,n);case 11:case"end":return a.stop()}}),a)})))}function Gb(t){return function(){return t}}function Vb(t){return 1e-6*(t()-.5)}function Wb(t){return t.index}function Hb(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function Yb(t){var e,n,r,i,a,o,s=Wb,u=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},c=Gb(30),l=1;function h(r){for(var i=0,s=t.length;i<l;++i)for(var u,c,h,d,f,v,p,g=0;g<s;++g)c=(u=t[g]).source,d=(h=u.target).x+h.vx-c.x-c.vx||Vb(o),f=h.y+h.vy-c.y-c.vy||Vb(o),d*=v=((v=Math.sqrt(d*d+f*f))-n[g])/v*r*e[g],f*=v,h.vx-=d*(p=a[g]),h.vy-=f*p,c.vx+=d*(p=1-p),c.vy+=f*p}function d(){if(r){var o,u,c=r.length,l=t.length,h=new Map(r.map((function(t,e){return[s(t,e,r),t]})));for(o=0,i=new Array(c);o<l;++o)(u=t[o]).index=o,"object"!=typeof u.source&&(u.source=Hb(h,u.source)),"object"!=typeof u.target&&(u.target=Hb(h,u.target)),i[u.source.index]=(i[u.source.index]||0)+1,i[u.target.index]=(i[u.target.index]||0)+1;for(o=0,a=new Array(l);o<l;++o)u=t[o],a[o]=i[u.source.index]/(i[u.source.index]+i[u.target.index]);e=new Array(l),f(),n=new Array(l),v()}}function f(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+u(t[n],n,t)}function v(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+c(t[e],e,t)}return null==t&&(t=[]),h.initialize=function(t,e){r=t,o=e,d()},h.links=function(e){return arguments.length?(t=e,d(),h):t},h.id=function(t){return arguments.length?(s=t,h):s},h.iterations=function(t){return arguments.length?(l=+t,h):l},h.strength=function(t){return arguments.length?(u="function"==typeof t?t:Gb(+t),f(),h):u},h.distance=function(t){return arguments.length?(c="function"==typeof t?t:Gb(+t),v(),h):c},h}var Ub={value:function(){}};function qb(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new Xb(r)}function Xb(t){this._=t}function Kb(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function $b(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Ub,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}Xb.prototype=qb.prototype={constructor:Xb,on:function(t,e){var n,r,i=this._,a=(r=i,(t+"").trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),o=-1,s=a.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(n=(t=a[o]).type)i[n]=$b(i[n],t.name,e);else if(null==e)for(n in i)i[n]=$b(i[n],t.name,null);return this}for(;++o<s;)if((n=(t=a[o]).type)&&(n=Kb(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Xb(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(r=this._[t]).length;a<n;++a)r[a].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};const Zb=qb;var Qb,Jb,tx=0,ex=0,nx=0,rx=0,ix=0,ax=0,ox="object"==typeof performance&&performance.now?performance:Date,sx="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ux(){return ix||(sx(cx),ix=ox.now()+ax)}function cx(){ix=0}function lx(){this._call=this._time=this._next=null}function hx(t,e,n){var r=new lx;return r.restart(t,e,n),r}function dx(){ix=(rx=ox.now())+ax,tx=ex=0;try{!function(){ux(),++tx;for(var t,e=Qb;e;)(t=ix-e._time)>=0&&e._call.call(void 0,t),e=e._next;--tx}()}finally{tx=0,function(){for(var t,e,n=Qb,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Qb=e);Jb=t,vx(r)}(),ix=0}}function fx(){var t=ox.now(),e=t-rx;e>1e3&&(ax-=e,rx=t)}function vx(t){tx||(ex&&(ex=clearTimeout(ex)),t-ix>24?(t<1/0&&(ex=setTimeout(dx,t-ox.now()-ax)),nx&&(nx=clearInterval(nx))):(nx||(rx=ox.now(),nx=setInterval(fx,1e3)),tx=1,sx(dx)))}lx.prototype=hx.prototype={constructor:lx,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?ux():+n)+(null==e?0:+e),this._next||Jb===this||(Jb?Jb._next=this:Qb=this,Jb=this),this._call=t,this._time=n,vx()},stop:function(){this._call&&(this._call=null,this._time=1/0,vx())}};var px=4294967296;function gx(t){return t.x}function yx(t){return t.y}var mx=Math.PI*(3-Math.sqrt(5));function bx(){var t,e,n,r,i,a=Gb(-30),o=1,s=1/0,u=.81;function c(n){var i,a=t.length,o=tb(t,gx,yx).visitAfter(h);for(r=n,i=0;i<a;++i)e=t[i],o.visit(d)}function l(){if(t){var e,n,r=t.length;for(i=new Array(r),e=0;e<r;++e)n=t[e],i[n.index]=+a(n,e,t)}}function h(t){var e,n,r,a,o,s=0,u=0;if(t.length){for(r=a=o=0;o<4;++o)(e=t[o])&&(n=Math.abs(e.value))&&(s+=e.value,u+=n,r+=n*e.x,a+=n*e.y);t.x=r/u,t.y=a/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=i[e.data.index]}while(e=e.next)}t.value=s}function d(t,a,c,l){if(!t.value)return!0;var h=t.x-e.x,d=t.y-e.y,f=l-a,v=h*h+d*d;if(f*f/u<v)return v<s&&(0===h&&(v+=(h=Vb(n))*h),0===d&&(v+=(d=Vb(n))*d),v<o&&(v=Math.sqrt(o*v)),e.vx+=h*t.value*r/v,e.vy+=d*t.value*r/v),!0;if(!(t.length||v>=s)){(t.data!==e||t.next)&&(0===h&&(v+=(h=Vb(n))*h),0===d&&(v+=(d=Vb(n))*d),v<o&&(v=Math.sqrt(o*v)));do{t.data!==e&&(f=i[t.data.index]*r/v,e.vx+=h*f,e.vy+=d*f)}while(t=t.next)}}return c.initialize=function(e,r){t=e,n=r,l()},c.strength=function(t){return arguments.length?(a="function"==typeof t?t:Gb(+t),l(),c):a},c.distanceMin=function(t){return arguments.length?(o=t*t,c):Math.sqrt(o)},c.distanceMax=function(t){return arguments.length?(s=t*t,c):Math.sqrt(s)},c.theta=function(t){return arguments.length?(u=t*t,c):Math.sqrt(u)},c}function xx(t,e){var n,r=1;function i(){var i,a,o=n.length,s=0,u=0;for(i=0;i<o;++i)s+=(a=n[i]).x,u+=a.y;for(s=(s/o-t)*r,u=(u/o-e)*r,i=0;i<o;++i)(a=n[i]).x-=s,a.y-=u}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(t){n=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i.strength=function(t){return arguments.length?(r=+t,i):r},i}function wx(t){return t.x+t.vx}function Ex(t){return t.y+t.vy}function kx(t){var e,n,r,i=1,a=1;function o(){for(var t,o,u,c,l,h,d,f=e.length,v=0;v<a;++v)for(o=tb(e,wx,Ex).visitAfter(s),t=0;t<f;++t)u=e[t],h=n[u.index],d=h*h,c=u.x+u.vx,l=u.y+u.vy,o.visit(p);function p(t,e,n,a,o){var s=t.data,f=t.r,v=h+f;if(!s)return e>c+v||a<c-v||n>l+v||o<l-v;if(s.index>u.index){var p=c-s.x-s.vx,g=l-s.y-s.vy,y=p*p+g*g;y<v*v&&(0===p&&(y+=(p=Vb(r))*p),0===g&&(y+=(g=Vb(r))*g),y=(v-(y=Math.sqrt(y)))/y*i,u.vx+=(p*=y)*(v=(f*=f)/(d+f)),u.vy+=(g*=y)*v,s.vx-=p*(v=1-v),s.vy-=g*v)}}}function s(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var r,i,a=e.length;for(n=new Array(a),r=0;r<a;++r)i=e[r],n[i.index]=+t(i,r,e)}}return"function"!=typeof t&&(t=Gb(null==t?1:+t)),o.initialize=function(t,n){e=t,r=n,u()},o.iterations=function(t){return arguments.length?(a=+t,o):a},o.strength=function(t){return arguments.length?(i=+t,o):i},o.radius=function(e){return arguments.length?(t="function"==typeof e?e:Gb(+e),u(),o):t},o}function Mx(t,e,n){var r,i,a,o=Gb(.1);function s(t){for(var o=0,s=r.length;o<s;++o){var u=r[o],c=u.x-e||1e-6,l=u.y-n||1e-6,h=Math.sqrt(c*c+l*l),d=(a[o]-h)*i[o]*t/h;u.vx+=c*d,u.vy+=l*d}}function u(){if(r){var e,n=r.length;for(i=new Array(n),a=new Array(n),e=0;e<n;++e)a[e]=+t(r[e],e,r),i[e]=isNaN(a[e])?0:+o(r[e],e,r)}}return"function"!=typeof t&&(t=Gb(+t)),null==e&&(e=0),null==n&&(n=0),s.initialize=function(t){r=t,u()},s.strength=function(t){return arguments.length?(o="function"==typeof t?t:Gb(+t),u(),s):o},s.radius=function(e){return arguments.length?(t="function"==typeof e?e:Gb(+e),u(),s):t},s.x=function(t){return arguments.length?(e=+t,s):e},s.y=function(t){return arguments.length?(n=+t,s):n},s}function Sx(t){var e,n,r,i=Gb(.1);function a(t){for(var i,a=0,o=e.length;a<o;++a)(i=e[a]).vx+=(r[a]-i.x)*n[a]*t}function o(){if(e){var a,o=e.length;for(n=new Array(o),r=new Array(o),a=0;a<o;++a)n[a]=isNaN(r[a]=+t(e[a],a,e))?0:+i(e[a],a,e)}}return"function"!=typeof t&&(t=Gb(null==t?0:+t)),a.initialize=function(t){e=t,o()},a.strength=function(t){return arguments.length?(i="function"==typeof t?t:Gb(+t),o(),a):i},a.x=function(e){return arguments.length?(t="function"==typeof e?e:Gb(+e),o(),a):t},a}function Ox(t){var e,n,r,i=Gb(.1);function a(t){for(var i,a=0,o=e.length;a<o;++a)(i=e[a]).vy+=(r[a]-i.y)*n[a]*t}function o(){if(e){var a,o=e.length;for(n=new Array(o),r=new Array(o),a=0;a<o;++a)n[a]=isNaN(r[a]=+t(e[a],a,e))?0:+i(e[a],a,e)}}return"function"!=typeof t&&(t=Gb(null==t?0:+t)),a.initialize=function(t){e=t,o()},a.strength=function(t){return arguments.length?(i="function"==typeof t?t:Gb(+t),o(),a):i},a.y=function(e){return arguments.length?(t="function"==typeof e?e:Gb(+e),o(),a):t},a}var Nx=function(){return b((function t(e){y(this,t),this.id="d3-force",this.config={inputNodeAttrs:["x","y","vx","vy","fx","fy"],outputNodeAttrs:["x","y","vx","vy"],simulationAttrs:["alpha","alphaMin","alphaDecay","alphaTarget","velocityDecay","randomSource"]},this.forceMap={link:Yb,manyBody:bx,center:xx,collide:kx,radial:Mx,x:Sx,y:Ox},this.options={link:{id:function(t){return t.id}},manyBody:{},center:{x:0,y:0}},this.context={options:{},assign:!1,nodes:[],edges:[]},jh(this.options,e),this.options.forceSimulation&&(this.simulation=this.options.forceSimulation)}),[{key:"execute",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.genericLayout(!1,t,e));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"assign",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.genericLayout(!0,t,e);case 2:case"end":return n.stop()}}),n,this)})))}},{key:"stop",value:function(){this.simulation.stop()}},{key:"tick",value:function(t){return this.simulation.tick(t),this.getResult()}},{key:"restart",value:function(){this.simulation.restart()}},{key:"setFixedPosition",value:function(t,e){var n=this.context.nodes.find((function(e){return e.id===t}));n&&e.forEach((function(t,e){"number"!=typeof t&&null!==t||(n[["fx","fy","fz"][e]]=t)}))}},{key:"getOptions",value:function(t){var e,n,r=jh({},this.options,t);return r.collide&&void 0===(null===(e=r.collide)||void 0===e?void 0:e.radius)&&(r.collide=r.collide||{},r.collide.radius=null!==(n=r.nodeSize)&&void 0!==n?n:10),void 0===r.iterations&&(r.link&&void 0===r.link.iterations&&(r.iterations=r.link.iterations),r.collide&&void 0===r.collide.iterations&&(r.iterations=r.collide.iterations)),this.context.options=r,r}},{key:"genericLayout",value:function(t,e,n){var r;return pe(this,void 0,void 0,Tn().mark((function i(){var a,o,s,u,c,l=this;return Tn().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a=this.getOptions(n),o=e.getAllNodes().map((function(t){var e=t.id,n=t.data;return Object.assign(Object.assign({id:e},n),ep(n.data,l.config.inputNodeAttrs))})),s=e.getAllEdges().map((function(t){return Object.assign({},t)})),Object.assign(this.context,{assign:t,nodes:o,edges:s,graph:e}),u=new Promise((function(t){l.resolver=t})),(c=this.setSimulation(a)).nodes(o),null===(r=c.force("link"))||void 0===r||r.links(s),i.abrupt("return",u);case 9:case"end":return i.stop()}}),i,this)})))}},{key:"getResult",value:function(){var t=this,e=this.context,n=e.assign,r=e.nodes,i=e.edges,a=e.graph,o=r.map((function(e){return{id:e.id,data:Object.assign(Object.assign({},e.data),ep(e,t.config.outputNodeAttrs))}})),s=i.map((function(t){var e=t.id,n=t.source,r=t.target,i=t.data;return{id:e,source:"object"==typeof n?n.id:n,target:"object"==typeof r?r.id:r,data:i}}));return n&&o.forEach((function(t){return a.mergeNodeData(t.id,t.data)})),{nodes:o,edges:s}}},{key:"initSimulation",value:function(){return function(t){var e,n,r=1,i=.001,a=1-Math.pow(i,1/300),o=0,s=.6,u=new Map,c=hx(d),l=Zb("tick","end"),h=(n=1,function(){return(n=(1664525*n+1013904223)%px)/px});function d(){f(),l.call("tick",e),r<i&&(c.stop(),l.call("end",e))}function f(n){var i,c,l=t.length;void 0===n&&(n=1);for(var h=0;h<n;++h)for(r+=(o-r)*a,u.forEach((function(t){t(r)})),i=0;i<l;++i)null==(c=t[i]).fx?c.x+=c.vx*=s:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=s:(c.y=c.fy,c.vy=0);return e}function v(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=10*Math.sqrt(.5+n),a=n*mx;e.x=i*Math.cos(a),e.y=i*Math.sin(a)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,h),e}return null==t&&(t=[]),v(),e={tick:f,restart:function(){return c.restart(d),e},stop:function(){return c.stop(),e},nodes:function(n){return arguments.length?(t=n,v(),u.forEach(p),e):t},alpha:function(t){return arguments.length?(r=+t,e):r},alphaMin:function(t){return arguments.length?(i=+t,e):i},alphaDecay:function(t){return arguments.length?(a=+t,e):+a},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(s=1-t,e):1-s},randomSource:function(t){return arguments.length?(h=t,u.forEach(p),e):h},force:function(t,n){return arguments.length>1?(null==n?u.delete(t):u.set(t,p(n)),e):u.get(t)},find:function(e,n,r){var i,a,o,s,u,c=0,l=t.length;for(null==r?r=1/0:r*=r,c=0;c<l;++c)(o=(i=e-(s=t[c]).x)*i+(a=n-s.y)*a)<r&&(u=s,r=o);return u},on:function(t,n){return arguments.length>1?(l.on(t,n),e):l.on(t)}}}()}},{key:"setSimulation",value:function(t){var e=this,n=this.simulation||this.options.forceSimulation||this.initSimulation();return this.simulation||(this.simulation=n.on("tick",(function(){var n;return null===(n=t.onTick)||void 0===n?void 0:n.call(t,e.getResult())})).on("end",(function(){var t;return null===(t=e.resolver)||void 0===t?void 0:t.call(e,e.getResult())}))),Ax(n,this.config.simulationAttrs.map((function(e){return[e,t[e]]}))),Object.entries(this.forceMap).forEach((function(e){var r=h(e,2),i=r[0],a=r[1],o=i;if(t[i]){var s=n.force(o);s||(s=a(),n.force(o,s)),Ax(s,Object.entries(t[o]))}else n.force(o,null)})),n}}])}(),Ax=function(t,e){return e.reduce((function(e,n){var r=h(n,2),i=r[0],a=r[1];return e[i]&&void 0!==a?e[i].call(t,a):e}),t)},Tx=a(1681),Px=a.n(Tx),Cx=function(){return b((function t(e){y(this,t),this.id="dagre",this.options={},Object.assign(this.options,t.defaultOptions,e)}),[{key:"execute",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.genericDagreLayout(!1,t,Object.assign(Object.assign({},this.options),e)));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"assign",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.genericDagreLayout(!0,t,Object.assign(Object.assign({},this.options),e));case 2:case"end":return n.stop()}}),n,this)})))}},{key:"genericDagreLayout",value:function(t,e,n){return pe(this,void 0,void 0,Tn().mark((function r(){var i,a,o,s,u;return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.nodeSize,(a=new Tx.graphlib.Graph).setGraph(n),a.setDefaultEdgeLabel((function(){return{}})),o=e.getAllNodes(),s=e.getAllEdges(),[].concat(w(o),w(s)).some((function(t){return oe(t.id)}))&&console.error("Dagre layout only support string id, it will convert number to string."),e.getAllNodes().forEach((function(t){var e=t.id,n=Object.assign({},t.data);if(void 0!==i){var r=h(Rm(cn(i)?i(t):i),2),o=r[0],s=r[1];Object.assign(n,{width:o,height:s})}a.setNode(e.toString(),n)})),e.getAllEdges().forEach((function(t){var e=t.id,n=t.source,r=t.target;a.setEdge(n.toString(),r.toString(),{id:e})})),Px().layout(a),u={nodes:[],edges:[]},a.nodes().forEach((function(n){var r=a.node(n);u.nodes.push({id:n,data:r}),t&&e.mergeNodeData(n,r)})),a.edges().forEach((function(n){var r=a.edge(n),i=r.id,o=ve(r,["id"]),s=n.v,c=n.w;u.edges.push({id:i,source:s,target:c,data:o}),t&&e.mergeEdgeData(i,o)})),r.abrupt("return",u);case 14:case"end":return r.stop()}}),r)})))}}])}();Cx.defaultOptions={};var Rx=function(){function t(e){y(this,t),this.id=e.id||0,this.rx=e.rx,this.ry=e.ry,this.fx=0,this.fy=0,this.mass=e.mass,this.degree=e.degree,this.g=e.g||0}return b(t,[{key:"distanceTo",value:function(t){var e=this.rx-t.rx,n=this.ry-t.ry;return Math.hypot(e,n)}},{key:"setPos",value:function(t,e){this.rx=t,this.ry=e}},{key:"resetForce",value:function(){this.fx=0,this.fy=0}},{key:"addForce",value:function(t){var e=t.rx-this.rx,n=t.ry-this.ry,r=Math.hypot(e,n);r=r<1e-4?1e-4:r;var i=this.g*(this.degree+1)*(t.degree+1)/r;this.fx+=i*e/r,this.fy+=i*n/r}},{key:"in",value:function(t){return t.contains(this.rx,this.ry)}},{key:"add",value:function(e){var n=this.mass+e.mass;return new t({rx:(this.rx*this.mass+e.rx*e.mass)/n,ry:(this.ry*this.mass+e.ry*e.mass)/n,mass:n,degree:this.degree+e.degree})}}])}(),Lx=function(){function t(e){y(this,t),this.xmid=e.xmid,this.ymid=e.ymid,this.length=e.length,this.massCenter=e.massCenter||[0,0],this.mass=e.mass||1}return b(t,[{key:"getLength",value:function(){return this.length}},{key:"contains",value:function(t,e){var n=this.length/2;return t<=this.xmid+n&&t>=this.xmid-n&&e<=this.ymid+n&&e>=this.ymid-n}},{key:"NW",value:function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})}},{key:"NE",value:function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})}},{key:"SW",value:function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})}},{key:"SE",value:function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})}}])}(),Dx=function(){function t(e){y(this,t),this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=e&&(this.quad=e)}return b(t,[{key:"insert",value:function(e){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new t(this.quad.NW()),this.NE=new t(this.quad.NE()),this.SW=new t(this.quad.SW()),this.SE=new t(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e)):this.body=e}},{key:"_putBody",value:function(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))}},{key:"_isExternal",value:function(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE}},{key:"updateForce",value:function(t){null!=this.body&&t!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t)))}}])}(),_x={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},Ix=function(){return b((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y(this,t),this.options=e,this.id="forceAtlas2",this.options=Object.assign(Object.assign({},_x),e)}),[{key:"execute",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.genericForceAtlas2Layout(!1,t,e));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"assign",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.genericForceAtlas2Layout(!0,t,e);case 2:case"end":return n.stop()}}),n,this)})))}},{key:"genericForceAtlas2Layout",value:function(t,e,n){return pe(this,void 0,void 0,Tn().mark((function r(){var i,a,o,s,u,c,l,h,d,f,v,p,g,y,m,b,x,w,E,k,M,S;return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=e.getAllEdges(),a=e.getAllNodes(),o=this.formatOptions(n,a.length),s=o.width,u=o.height,c=o.prune,l=o.maxIteration,h=o.nodeSize,d=o.center,(null==a?void 0:a.length)&&1!==a.length){r.next=6;break}return r.abrupt("return",Gm(e,t,d));case 6:if(f=a.map((function(t){return jm(t,[s,u])})),v=i.filter((function(t){return t.source!==t.target})),p=new _g({nodes:f,edges:v}),g=this.getSizes(p,h),this.run(p,e,l,g,t,o),c){for(y=0;y<v.length;y+=1)m=v[y],b=m.source,x=m.target,w=p.getDegree(b),E=p.getDegree(b),w<=1?(k=p.getNode(x),p.mergeNodeData(b,{x:k.data.x,y:k.data.y})):E<=1&&(M=p.getNode(b),p.mergeNodeData(x,{x:M.data.x,y:M.data.y}));S=Object.assign(Object.assign({},o),{prune:!1,barnesHut:!1}),this.run(p,e,100,g,t,S)}return r.abrupt("return",{nodes:f,edges:i});case 13:case"end":return r.stop()}}),r,this)})))}},{key:"getSizes",value:function(t,e){for(var n=t.getAllNodes(),r={},i=0;i<n.length;i+=1){var a=n[i];r[a.id]=_m(e,void 0)(a)}return r}},{key:"formatOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n=Object.assign(Object.assign({},this.options),t),r=n.center,i=n.width,a=n.height,o=n.barnesHut,s=n.prune,u=n.maxIteration,c=n.kr,l=n.kg;return n.width=i||"undefined"==typeof window?i:window.innerWidth,n.height=a||"undefined"==typeof window?a:window.innerHeight,n.center=r||[n.width/2,n.height/2],void 0===o&&e>250&&(n.barnesHut=!0),void 0===s&&e>100&&(n.prune=!0),0!==u||s?0===u&&s&&(n.maxIteration=100,e<=200&&e>100?n.maxIteration=500:e>200&&(n.maxIteration=950)):(n.maxIteration=250,e<=200&&e>100?n.maxIteration=1e3:e>200&&(n.maxIteration=1200)),c||(n.kr=50,e>100&&e<=500?n.kr=20:e>500&&(n.kr=1)),l||(n.kg=20,e>100&&e<=500?n.kg=10:e>500&&(n.kg=1)),n}},{key:"run",value:function(t,e,n,r,i,a){for(var o=a.kr,s=a.barnesHut,u=a.onTick,c=t.getAllNodes(),l=0,h=n,d={},f={},v={},p=0;p<c.length;p+=1){var g=c[p],y=g.data,m=g.id;if(d[m]=[0,0],s){var b={id:p,rx:y.x,ry:y.y,mass:1,g:o,degree:t.getDegree(m)};v[m]=new Rx(b)}}for(;h>0;)l=this.oneStep(t,{iter:h,preventOverlapIters:50,krPrime:100,sg:l,forces:d,preForces:f,bodies:v,sizes:r},a),h--,null==u||u({nodes:c,edges:e.getAllEdges()});return t}},{key:"oneStep",value:function(t,e,n){for(var r=e.iter,i=e.preventOverlapIters,a=e.krPrime,o=e.sg,s=e.preForces,u=e.bodies,c=e.sizes,l=e.forces,h=n.preventOverlap,d=n.barnesHut,f=t.getAllNodes(),v=0;v<f.length;v+=1){var p=f[v].id;s[p]=w(l[p]),l[p]=[0,0]}return l=this.getAttrForces(t,r,i,c,l,n),l=d&&(h&&r>i||!h)?this.getOptRepGraForces(t,l,u,n):this.getRepGraForces(t,r,i,l,a,c,n),this.updatePos(t,l,s,o,n)}},{key:"getAttrForces",value:function(t,e,n,r,i,a){for(var o=a.preventOverlap,s=a.dissuadeHubs,u=a.mode,c=a.prune,l=t.getAllEdges(),h=0;h<l.length;h+=1){var d=l[h],f=d.source,v=d.target,p=t.getNode(f),g=t.getNode(v),y=t.getDegree(f),m=t.getDegree(v);if(!c||!(y<=1||m<=1)){var b=[g.data.x-p.data.x,g.data.y-p.data.y],x=Math.hypot(b[0],b[1]);x=x<1e-4?1e-4:x,b[0]=b[0]/x,b[1]=b[1]/x,o&&e<n&&(x=x-r[f]-r[v]);var w=x,E=w;"linlog"===u&&(E=w=Math.log(1+x)),s&&(w=x/y,E=x/m),o&&e<n&&x<=0?(w=0,E=0):o&&e<n&&x>0&&(w=x,E=x),i[f][0]+=w*b[0],i[v][0]-=E*b[0],i[f][1]+=w*b[1],i[v][1]-=E*b[1]}}return i}},{key:"getOptRepGraForces",value:function(t,e,n,r){for(var i=r.kg,a=r.center,o=r.prune,s=t.getAllNodes(),u=s.length,c=9e10,l=-9e10,h=9e10,d=-9e10,f=0;f<u;f+=1){var v=s[f],p=v.id,g=v.data;o&&t.getDegree(p)<=1||(n[p].setPos(g.x,g.y),g.x>=l&&(l=g.x),g.x<=c&&(c=g.x),g.y>=d&&(d=g.y),g.y<=h&&(h=g.y))}for(var y=Math.max(l-c,d-h),m=new Lx({xmid:(l+c)/2,ymid:(d+h)/2,length:y,massCenter:a,mass:u}),b=new Dx(m),x=0;x<u;x+=1){var w=s[x].id;o&&t.getDegree(w)<=1||n[w].in(m)&&b.insert(n[w])}for(var E=0;E<u;E+=1){var k=s[E],M=k.id,S=k.data,O=t.getDegree(M);if(!(o&&O<=1)){n[M].resetForce(),b.updateForce(n[M]),e[M][0]-=n[M].fx,e[M][1]-=n[M].fy;var N=[S.x-a[0],S.y-a[1]],A=Math.hypot(N[0],N[1]);A=A<1e-4?1e-4:A,N[0]=N[0]/A,N[1]=N[1]/A;var T=i*(O+1);e[M][0]-=T*N[0],e[M][1]-=T*N[1]}}return e}},{key:"getRepGraForces",value:function(t,e,n,r,i,a,o){for(var s=o.preventOverlap,u=o.kr,c=o.kg,l=o.center,h=o.prune,d=t.getAllNodes(),f=d.length,v=0;v<f;v+=1){for(var p=d[v],g=t.getDegree(p.id),y=v+1;y<f;y+=1){var m=d[y],b=t.getDegree(m.id);if(!h||!(g<=1||b<=1)){var x=[m.data.x-p.data.x,m.data.y-p.data.y],w=Math.hypot(x[0],x[1]);w=w<1e-4?1e-4:w,x[0]=x[0]/w,x[1]=x[1]/w,s&&e<n&&(w=w-a[p.id]-a[m.id]);var E=u*(g+1)*(b+1)/w;s&&e<n&&w<0?E=i*(g+1)*(b+1):s&&e<n&&0===w?E=0:s&&e<n&&w>0&&(E=u*(g+1)*(b+1)/w),r[p.id][0]-=E*x[0],r[m.id][0]+=E*x[0],r[p.id][1]-=E*x[1],r[m.id][1]+=E*x[1]}}var k=[p.data.x-l[0],p.data.y-l[1]],M=Math.hypot(k[0],k[1]);k[0]=k[0]/M,k[1]=k[1]/M;var S=c*(g+1);r[p.id][0]-=S*k[0],r[p.id][1]-=S*k[1]}return r}},{key:"updatePos",value:function(t,e,n,r,i){for(var a=i.ks,o=i.tao,s=i.prune,u=i.ksmax,c=t.getAllNodes(),l=c.length,h=[],d=[],f=0,v=0,p=r,g=0;g<l;g+=1){var y=c[g].id,m=t.getDegree(y);if(!(s&&m<=1)){var b=[e[y][0]-n[y][0],e[y][1]-n[y][1]],x=Math.hypot(b[0],b[1]),w=[e[y][0]+n[y][0],e[y][1]+n[y][1]],E=Math.hypot(w[0],w[1]);h[g]=x,d[g]=E/2,f+=(m+1)*h[g],v+=(m+1)*d[g]}}var k=p;p=o*v/f,0!==k&&(p=p>1.5*k?1.5*k:p);for(var M=0;M<l;M+=1){var S=c[M],O=S.id,N=S.data,A=t.getDegree(O);if(!(s&&A<=1||oe(N.fx)&&oe(N.fy))){var T=a*p/(1+p*Math.sqrt(h[M])),P=Math.hypot(e[O][0],e[O][1]),C=u/(P=P<1e-4?1e-4:P),R=(T=T>C?C:T)*e[O][0],L=T*e[O][1];t.mergeNodeData(O,{x:N.x+R,y:N.y+L})}}return p}}])}(),jx={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Fx=function(){return b((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y(this,t),this.options=e,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=Object.assign(Object.assign({},jx),e)}),[{key:"execute",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.genericFruchtermanLayout(!1,t,e));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"assign",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.genericFruchtermanLayout(!0,t,e);case 2:case"end":return n.stop()}}),n,this)})))}},{key:"stop",value:function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1}},{key:"tick",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.maxIteration||1;if(this.lastResult)return this.lastResult;for(var n=0;n<e;n++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var r={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&r.nodes.forEach((function(e){return t.lastGraph.mergeNodeData(e.id,{x:e.data.x,y:e.data.y,z:3===t.options.dimensions?e.data.z:void 0})})),r}},{key:"genericFruchtermanLayout",value:function(t,e,n){return pe(this,void 0,void 0,Tn().mark((function r(){var i,a,o,s,u,c,l,h,d,f,v,p,g,y,m,b,x,w=this;return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!this.running){r.next=2;break}return r.abrupt("return");case 2:if(i=this.formatOptions(n),a=i.dimensions,o=i.width,s=i.height,u=i.center,c=i.clustering,l=i.nodeClusterBy,h=i.maxIteration,d=i.onTick,f=e.getAllNodes(),v=e.getAllEdges(),null==f?void 0:f.length){r.next=10;break}return p={nodes:[],edges:v},this.lastResult=p,r.abrupt("return",p);case 10:if(1!==f.length){r.next=15;break}return t&&e.mergeNodeData(f[0].id,{x:u[0],y:u[1],z:3===a?u[2]:void 0}),g={nodes:[Object.assign(Object.assign({},f[0]),{data:Object.assign(Object.assign({},f[0].data),{x:u[0],y:u[1],z:3===a?u[2]:void 0})})],edges:v},this.lastResult=g,r.abrupt("return",g);case 15:if(y=f.map((function(t){return jm(t,[o,s])})),m=new _g({nodes:y,edges:v}),b={},c&&y.forEach((function(t){var e=t.data[l];b[e]||(b[e]={name:e,cx:0,cy:0,count:0})})),this.lastLayoutNodes=y,this.lastLayoutEdges=v,this.lastAssign=t,this.lastGraph=m,this.lastOptions=i,this.lastClusterMap=b,"undefined"!=typeof window){r.next=27;break}return r.abrupt("return");case 27:return x=0,r.abrupt("return",new Promise((function(n){w.timeInterval=window.setInterval((function(){w.running?(w.runOneStep(m,b,i),t&&y.forEach((function(t){var n=t.id,r=t.data;return e.mergeNodeData(n,{x:r.x,y:r.y,z:3===a?r.z:void 0})})),null==d||d({nodes:y,edges:v}),++x>=h&&(window.clearInterval(w.timeInterval),n({nodes:y,edges:v}))):n({nodes:y,edges:v})}),0),w.running=!0})));case 29:case"end":return r.stop()}}),r,this)})))}},{key:"formatOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign(Object.assign({},this.options),t),n=e.clustering,r=e.nodeClusterBy,i=e.center,a=e.width,o=e.height;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=o||"undefined"==typeof window?o:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=n&&!!r,e}},{key:"runOneStep",value:function(t,e,n){var r=n.dimensions,i=n.height,a=n.width,o=n.gravity,s=n.center,u=n.speed,c=n.clustering,l=n.nodeClusterBy,h=n.clusterGravity,d=i*a,f=Math.sqrt(d)/10,v=t.getAllNodes(),p=d/(v.length+1),g=Math.sqrt(p),y={};if(this.applyCalculate(t,y,g,p),c){for(var m in e)e[m].cx=0,e[m].cy=0,e[m].count=0;for(var b in v.forEach((function(t){var n=t.data,r=e[n[l]];oe(n.x)&&(r.cx+=n.x),oe(n.y)&&(r.cy+=n.y),r.count++})),e)e[b].cx/=e[b].count,e[b].cy/=e[b].count;var x=h||o;v.forEach((function(t,n){var r=t.id,i=t.data;if(oe(i.x)&&oe(i.y)){var a=e[i[l]],o=Math.sqrt((i.x-a.cx)*(i.x-a.cx)+(i.y-a.cy)*(i.y-a.cy)),s=g*x;y[r].x-=s*(i.x-a.cx)/o,y[r].y-=s*(i.y-a.cy)/o}}))}v.forEach((function(t,e){var n=t.id,i=t.data;if(oe(i.x)&&oe(i.y)){var a=.01*g*o;y[n].x-=a*(i.x-s[0]),y[n].y-=a*(i.y-s[1]),3===r&&(y[n].z-=a*(i.z-s[2]))}})),v.forEach((function(e,n){var i=e.id,a=e.data;if(oe(a.fx)&&oe(a.fy))return a.x=a.fx,a.y=a.fy,void(3===r&&(a.z=a.fz));if(oe(a.x)&&oe(a.y)){var o=Math.sqrt(y[i].x*y[i].x+y[i].y*y[i].y+(3===r?y[i].z*y[i].z:0));if(o>0){var s=Math.min(f*(u/800),o);t.mergeNodeData(i,{x:a.x+y[i].x/o*s,y:a.y+y[i].y/o*s,z:3===r?a.z+y[i].z/o*s:void 0})}}}))}},{key:"applyCalculate",value:function(t,e,n,r){this.calRepulsive(t,e,r),this.calAttractive(t,e,n)}},{key:"calRepulsive",value:function(t,e,n){var r=this,i=t.getAllNodes();i.forEach((function(t,a){var o=t.data,s=t.id;e[s]={x:0,y:0,z:0},i.forEach((function(t,i){var u=t.data,c=t.id;if(!(a<=i)&&oe(o.x)&&oe(u.x)&&oe(o.y)&&oe(u.y)){var l=o.x-u.x,h=o.y-u.y,d=3===r.options.dimensions?o.z-u.z:0,f=l*l+h*h+d*d;0===f&&(f=1,l=.01,h=.01,d=.01);var v=n/f,p=l*v,g=h*v,y=d*v;e[s].x+=p,e[s].y+=g,e[c].x-=p,e[c].y-=g,3===r.options.dimensions&&(e[s].z+=y,e[c].z-=y)}}))}))}},{key:"calAttractive",value:function(t,e,n){var r=this;t.getAllEdges().forEach((function(i){var a=i.source,o=i.target;if(a&&o&&a!==o){var s=t.getNode(a).data,u=t.getNode(o).data;if(oe(u.x)&&oe(s.x)&&oe(u.y)&&oe(s.y)){var c=u.x-s.x,l=u.y-s.y,h=3===r.options.dimensions?u.z-s.z:0,d=Math.sqrt(c*c+l*l+h*h)/n,f=c*d,v=l*d,p=h*d;e[a].x+=f,e[a].y+=v,e[o].x-=f,e[o].y-=v,3===r.options.dimensions&&(e[a].z+=p,e[o].z-=p)}}}))}}])}(),Bx={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},zx=function(){return b((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y(this,t),this.options=e,this.id="grid",this.options=Object.assign(Object.assign({},Bx),e)}),[{key:"execute",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.genericGridLayout(!1,t,e));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"assign",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.genericGridLayout(!0,t,e);case 2:case"end":return n.stop()}}),n,this)})))}},{key:"genericGridLayout",value:function(t,e,n){return pe(this,void 0,void 0,Tn().mark((function r(){var i,a,o,s,u,c,l,d,f,v,p,g,y,m,b,x,w,E,k,M,S,O,N,A,T,P,C,R,L,D,_,I,j,F,B,z,G,V,W;return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=Object.assign(Object.assign({},this.options),n),a=i.begin,o=void 0===a?[0,0]:a,s=i.condense,u=i.preventOverlapPadding,c=i.preventOverlap,l=i.rows,d=i.cols,f=i.nodeSpacing,v=i.nodeSize,p=i.width,g=i.height,y=i.position,m=i.sortBy,b=e.getAllNodes(),x=e.getAllEdges(),(w=null==b?void 0:b.length)&&1!==w){r.next=8;break}return r.abrupt("return",Gm(e,t,o));case 8:if(E=b.map((function(t){return jm(t)})),"id"===m||ce(m)&&void 0!==E[0].data[m]||(m="degree"),"degree"===m?E.sort((function(t,n){return e.getDegree(n.id,"both")-e.getDegree(t.id,"both")})):"id"===m?E.sort((function(t,e){return oe(e.id)&&oe(t.id)?e.id-t.id:"".concat(t.id).localeCompare("".concat(e.id))})):E.sort((function(t,e){return e.data[m]-t.data[m]})),k=p||"undefined"==typeof window?p:window.innerWidth,M=g||"undefined"==typeof window?g:window.innerHeight,S=w,O={rows:l,cols:d},null!=l&&null!=d?(O.rows=l,O.cols=d):null!=l&&null==d?(O.rows=l,O.cols=Math.ceil(S/O.rows)):null==l&&null!=d?(O.cols=d,O.rows=Math.ceil(S/O.cols)):(N=Math.sqrt(S*M/k),O.rows=Math.round(N),O.cols=Math.round(k/M*N)),O.rows=Math.max(O.rows,1),O.cols=Math.max(O.cols,1),O.cols*O.rows>S)A=Gx(O),T=Vx(O),(A-1)*T>=S?Gx(O,A-1):(T-1)*A>=S&&Vx(O,T-1);else for(;O.cols*O.rows<S;)P=Gx(O),((C=Vx(O))+1)*P>=S?Vx(O,C+1):Gx(O,P+1);for(R=s?0:k/O.cols,L=s?0:M/O.rows,(c||f)&&(D=Lm(10,f),_=Dm(30,v,!1),E.forEach((function(t){t.data.x&&t.data.y||(t.data.x=0,t.data.y=0);var n=e.getNode(t.id),r=h(Rm(_(n)||30),2),i=r[0],a=r[1],o=void 0!==D?D(t):u,s=i+o,c=a+o;R=Math.max(R,s),L=Math.max(L,c)}))),I={},j={row:0,col:0},F={},B=0;B<E.length;B++){if(z=E[B],G=void 0,y&&(G=y(e.getNode(z.id))),G&&(void 0!==G.row||void 0!==G.col)){if(void 0===(V={row:G.row,col:G.col}).col)for(V.col=0;Wx(I,V);)V.col++;else if(void 0===V.row)for(V.row=0;Wx(I,V);)V.row++;F[z.id]=V,Hx(I,V)}Ux(z,o,R,L,F,O,j,I)}return W={nodes:E,edges:x},t&&E.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r.abrupt("return",W);case 29:case"end":return r.stop()}}),r,this)})))}}])}(),Gx=function(t,e){var n,r=t.rows||5,i=t.cols||5;return null==e?n=Math.min(r,i):Math.min(r,i)===t.rows?t.rows=e:t.cols=e,n},Vx=function(t,e){var n,r=t.rows||5,i=t.cols||5;return null==e?n=Math.max(r,i):Math.max(r,i)===t.rows?t.rows=e:t.cols=e,n},Wx=function(t,e){return t["c-".concat(e.row,"-").concat(e.col)]||!1},Hx=function(t,e){return t["c-".concat(e.row,"-").concat(e.col)]=!0},Yx=function(t,e){var n=t.cols||5;e.col++,e.col>=n&&(e.col=0,e.row++)},Ux=function(t,e,n,r,i,a,o,s){var u,c,l=i[t.id];if(l)u=l.col*n+n/2+e[0],c=l.row*r+r/2+e[1];else{for(;Wx(s,o);)Yx(a,o);u=o.col*n+n/2+e[0],c=o.row*r+r/2+e[1],Hx(s,o),Yx(a,o)}t.data.x=u,t.data.y=c},qx=function(t,e,n){try{var r=Mb.mul(Mb.pow(e,2),-.5),i=r.mean("row"),a=r.mean("column"),o=r.mean();r.add(o).subRowVector(i).subColumnVector(a);var s=new Sb(r),u=Mb.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map((function(e){return Mb.mul([e],[u]).toJSON()[0].splice(0,t)}))}catch(t){for(var c=[],l=0;l<e.length;l++){var h=Math.random()*n,d=Math.random()*n;c.push([h,d])}return c}},Xx={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},Kx=function(t,e){for(var n=Object.assign(Object.assign({},Xx),e),r=n.positions,i=n.iterations,a=n.width,o=n.k,s=n.speed,u=void 0===s?100:s,c=n.strictRadial,l=n.focusIdx,h=n.radii,d=void 0===h?[]:h,f=n.nodeSizeFunc,v=t.getAllNodes(),p=[],g=a/10,y=0;y<i;y++)r.forEach((function(t,e){p[e]={x:0,y:0}})),$x(v,r,p,o,d,f),Zx(r,p,u,c,l,g,a,d);return r},$x=function(t,e,n,r,i,a){e.forEach((function(o,s){n[s]={x:0,y:0},e.forEach((function(e,u){if(s!==u&&i[s]===i[u]){var c=o.x-e.x,l=o.y-e.y,h=Math.sqrt(c*c+l*l);if(0===h){h=1;var d=s>u?1:-1;c=.01*d,l=.01*d}if(h<a(t[s])/2+a(t[u])/2){var f=r*r/h;n[s].x+=c/h*f,n[s].y+=l/h*f}}}))}))},Zx=function(t,e,n,r,i,a,o,s){var u=a||o/10;return r&&e.forEach((function(e,n){var r=t[n].x-t[i].x,a=t[n].y-t[i].y,o=Math.sqrt(r*r+a*a),s=a/o,u=-r/o,c=Math.sqrt(e.x*e.x+e.y*e.y),l=Math.acos((s*e.x+u*e.y)/c);l>Math.PI/2&&(l-=Math.PI/2,s*=-1,u*=-1);var h=Math.cos(l)*c;e.x=s*h,e.y=u*h})),t.forEach((function(a,o){if(o!==i){var c=Math.sqrt(e[o].x*e[o].x+e[o].y*e[o].y);if(c>0&&o!==i){var l=Math.min(u*(n/800),c);if(a.x+=e[o].x/c*l,a.y+=e[o].y/c*l,r){var h=a.x-t[i].x,d=a.y-t[i].y,f=Math.sqrt(h*h+d*d);h=h/f*s[o],d=d/f*s[o],a.x=t[i].x+h,a.y=t[i].y+d}}}})),t},Qx={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},Jx=function(){return b((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y(this,t),this.options=e,this.id="radial",this.options=Object.assign(Object.assign({},Qx),e)}),[{key:"execute",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.genericRadialLayout(!1,t,e));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"assign",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.genericRadialLayout(!0,t,e);case 2:case"end":return n.stop()}}),n,this)})))}},{key:"genericRadialLayout",value:function(t,e,n){return pe(this,void 0,void 0,Tn().mark((function r(){var i,a,o,s,u,c,l,d,f,v,p,g,y,m,b,x,E,k,M,S,O,N,A,T,P,C,R,L,D,_,I,j,F,B,z,G,V,W,H,Y,U,q,X,K;return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=Object.assign(Object.assign({},this.options),n),a=i.width,o=i.height,s=i.center,u=i.focusNode,c=i.unitRadius,l=i.nodeSize,d=i.nodeSpacing,f=i.strictRadial,v=i.preventOverlap,p=i.maxPreventOverlapIteration,g=i.sortBy,y=i.linkDistance,m=void 0===y?50:y,b=i.sortStrength,x=void 0===b?10:b,E=i.maxIteration,k=void 0===E?1e3:E,M=e.getAllNodes(),S=e.getAllEdges(),O=a||"undefined"==typeof window?a:window.innerWidth,N=o||"undefined"==typeof window?o:window.innerHeight,A=s||[O/2,N/2],(null==M?void 0:M.length)&&1!==M.length){r.next=9;break}return r.abrupt("return",Gm(e,t,A));case 9:if(T=M[0],!ce(u)){r.next=21;break}P=0;case 12:if(!(P<M.length)){r.next=19;break}if(M[P].id!==u){r.next=16;break}return T=M[P],r.abrupt("break",19);case 16:P++,r.next=12;break;case 19:r.next=22;break;case 21:T=u||M[0];case 22:return C=nw(M,T.id),R=Nb({nodes:M,edges:S},!1),L=Ob(R),D=iw(L,C),rw(L,C,D+1),_=L[C],I=O-A[0]>A[0]?A[0]:O-A[0],j=N-A[1]>A[1]?A[1]:N-A[1],0===I&&(I=O/2),0===j&&(j=N/2),F=Math.min(I,j),B=Math.max.apply(Math,w(_)),z=[],G=c||F/B,_.forEach((function(t,e){z[e]=t*G})),V=tw(M,L,m,z,G,g,x),W=ew(V),H=qx(m,V,m),Y=H.map((function(t){var e=h(t,2),n=e[0],r=e[1];return{x:(isNaN(n)?Math.random()*m:n)-H[C][0],y:(isNaN(r)?Math.random()*m:r)-H[C][1]}})),this.run(k,Y,W,V,z,C),v&&(U=_m(l,d),q={nodes:M,nodeSizeFunc:U,positions:Y,radii:z,height:N,width:O,strictRadial:Boolean(f),focusIdx:C,iterations:p||200,k:Y.length/4.5},Y=Kx(e,q)),X=[],Y.forEach((function(t,e){var n=jm(M[e]);n.data.x=t.x+A[0],n.data.y=t.y+A[1],X.push(n)})),t&&X.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),K={nodes:X,edges:S},r.abrupt("return",K);case 48:case"end":return r.stop()}}),r,this)})))}},{key:"run",value:function(t,e,n,r,i,a){for(var o=0;o<=t;o++){var s=o/t;this.oneIteration(s,e,i,r,n,a)}}},{key:"oneIteration",value:function(t,e,n,r,i,a){var o=1-t;e.forEach((function(s,u){var c=Pb(s,{x:0,y:0}),l=0===c?0:1/c;if(u!==a){var h=0,d=0,f=0;e.forEach((function(t,e){if(u!==e){var n=Pb(s,t),a=0===n?0:1/n,o=r[e][u];f+=i[u][e],h+=i[u][e]*(t.x+o*(s.x-t.x)*a),d+=i[u][e]*(t.y+o*(s.y-t.y)*a)}}));var v=0===n[u]?0:1/n[u];f*=o,f+=t*v*v,h*=o,h+=t*v*s.x*l,s.x=h/f,d*=o,d+=t*v*s.y*l,s.y=d/f}}))}}])}(),tw=function(t,e,n,r,i,a,o){if(!t)return[];var s=[];if(e){var u={};e.forEach((function(e,c){var l=[];e.forEach((function(e,s){var h,d;if(c===s)l.push(0);else if(r[c]===r[s])if("data"===a)l.push(e*(Math.abs(c-s)*o)/(r[c]/i));else if(a){var f,v;if(u[t[c].id])f=u[t[c].id];else{var p=("id"===a?t[c].id:null===(h=t[c].data)||void 0===h?void 0:h[a])||0;f=ce(p)?p.charCodeAt(0):p,u[t[c].id]=f}if(u[t[s].id])v=u[t[s].id];else{var g=("id"===a?t[s].id:null===(d=t[s].data)||void 0===d?void 0:d[a])||0;v=ce(g)?g.charCodeAt(0):g,u[t[s].id]=v}l.push(e*(Math.abs(f-v)*o)/(r[c]/i))}else l.push(e*n/(r[c]/i));else{var y=(n+i)/2;l.push(e*y)}})),s.push(l)}))}return s},ew=function(t){for(var e=t.length,n=t[0].length,r=[],i=0;i<e;i++){for(var a=[],o=0;o<n;o++)0!==t[i][o]?a.push(1/(t[i][o]*t[i][o])):a.push(0);r.push(a)}return r},nw=function(t,e){var n=-1;return t.forEach((function(t,r){t.id===e&&(n=r)})),Math.max(n,0)},rw=function(t,e,n){for(var r=t.length,i=0;i<r;i++)if(t[e][i]===1/0){t[e][i]=n,t[i][e]=n;for(var a=0;a<r;a++)t[i][a]!==1/0&&t[e][a]===1/0&&(t[e][a]=n+t[i][a],t[a][e]=n+t[i][a])}for(var o=0;o<r;o++)if(o!==e)for(var s=0;s<r;s++)if(t[o][s]===1/0){var u=Math.abs(t[e][o]-t[e][s]);u=0===u?1:u,t[o][s]=u}},iw=function(t,e){for(var n=0,r=0;r<t[e].length;r++)t[e][r]!==1/0&&(n=t[e][r]>n?t[e][r]:n);return n},aw={center:[0,0],width:300,height:300},ow=function(){return b((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y(this,t),this.options=e,this.id="random",this.options=Object.assign(Object.assign({},aw),e)}),[{key:"execute",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.genericRandomLayout(!1,t,e));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"assign",value:function(t,e){return pe(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.genericRandomLayout(!0,t,e);case 2:case"end":return n.stop()}}),n,this)})))}},{key:"genericRandomLayout",value:function(t,e,n){return pe(this,void 0,void 0,Tn().mark((function r(){var i,a,o,s,u,c,l,h,d,f;return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=Object.assign(Object.assign({},this.options),n),a=i.center,o=i.width,s=i.height,u=e.getAllNodes(),c=o||"undefined"==typeof window?o:window.innerWidth,l=s||"undefined"==typeof window?s:window.innerHeight,h=a||[c/2,l/2],d=[],u&&u.forEach((function(t){d.push({id:t.id,data:{x:.9*(Math.random()-.5)*c+h[0],y:.9*(Math.random()-.5)*l+h[1]}})})),t&&d.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),f={nodes:d,edges:e.getAllEdges()},r.abrupt("return",f);case 12:case"end":return r.stop()}}),r,this)})))}}])}(),sw=new Map;function uw(t,e,n){return void 0===n&&(n=128),function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var a=e?e.apply(this,r):r[0];sw.has(t)||sw.set(t,function(t){var e,n,r,i=t||1;function a(t,a){++e>i&&(r=n,o(1),++e),n[t]=a}function o(t){e=0,n=Object.create(null),t||(r=Object.create(null))}return o(),{clear:o,has:function(t){return void 0!==n[t]||void 0!==r[t]},get:function(t){var e=n[t];return void 0!==e?e:void 0!==(e=r[t])?(a(t,e),e):void 0},set:function(t,e){void 0!==n[t]?n[t]=e:a(t,e)}}}(n));var o=sw.get(t);if(o.has(a))return o.get(a);var s=t.apply(this,r);return o.set(a,s),s}}var cw=function(t){function e(){var t;return y(this,e),(t=S(this,e,arguments)).id="fishbone",t}return N(e,t),b(e,[{key:"getRoot",value:function(){var t=this.context.model.getRootsData();if(!(qd(t)||t.length>2))return t[0]}},{key:"formatSize",value:function(t){var e="function"==typeof t?t:function(){return t};return function(t){return jd(e(t))}}},{key:"doLayout",value:function(t,e){var n=e.hGap,r=e.getRibSep,i=e.vGap,a=e.nodeSize,o=e.height,s=this.context.model,u=this.formatSize(a),c=u(t)[0]+r(t),l=function(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return r+=n*((t.children||[]).length+1),null===(e=t.children)||void 0===e||e.forEach((function(t){var e;null===(e=s.getNodeLikeDatum(t).children)||void 0===e||e.forEach((function(t){var e=s.getNodeLikeDatum(t);r=l(e,r)}))})),r},h=function(t){if(1===t.depth)return c;var e=s.getParentData(t.id,"tree");if(dw(t)){var r=s.getParentData(e.id,"tree"),a=v(t)-v(r);return h(e)+a*n/i}var o=(e.children||[]).indexOf(t.id),f=s.getNodeData((e.children||[]).slice(o));return d(e)-f.reduce((function(t,e){return t+l(e)}),0)-u(e)[0]/2},d=uw((function(t){if(hw(t))return u(t)[0]/2;var e=s.getParentData(t.id,"tree");if(dw(t))return h(t)+l(t)+u(t)[0]/2;var r=v(t)-v(e),a=n/i;return h(t)+r*a}),(function(t){return t.id})),f=function(t){return v(s.getParentData(t,"tree"))},v=uw((function(t){if(hw(t))return o/2;if(dw(t)){var e=s.getParentData(t.id,"tree"),n=e.children.indexOf(t.id);if(0===n)return f(e.id)+i;var r=s.getNodeLikeDatum(e.children[n-1]);if(qd(r.children))return v(r)+i;var a=s.getDescendantsData(r.id);return Math.max.apply(Math,w(a.map((function(t){return dw(t)?f(t.id):v(t)}))))+i}if(qd(t.children))return f(t.id)+i;var u=s.getNodeLikeDatum(t.children.slice(-1)[0]);if(qd(u.children))return v(u)+i;var c=s.getDescendantsData(t.id).slice(-1)[0];return(dw(c)?f(c.id):v(c))+i}),(function(t){return t.id})),p=0,g={nodes:[],edges:[]},y=function(t){var e;null===(e=t.children)||void 0===e||e.forEach((function(t){return y(s.getNodeLikeDatum(t))}));var n=v(t),i=d(t);if(g.nodes.push({id:t.id,x:i,y:n}),!hw(t)){var a=s.getRelatedEdgesData(t.id,"in")[0],o=[h(t),dw(t)?n:f(t.id)];g.edges.push({id:yh(a),controlPoints:[o],relatedNodeId:t.id}),p=Math.max(p,i+r(t)),1===t.depth&&(c=p)}};return y(t),g}},{key:"placeAlterative",value:function(t,e){var n=(e.children||[]).filter((function(t,e){return e%2!=0}));if(0===n.length)return t;var r=this.context.model,i=t.nodes.find((function(t){return t.id===e.id})).y,a=function(t){var e=r.getAncestorsData(t,"tree");if(qd(e))return!1;var i=1===e.length?t:e[e.length-2].id;return n.includes(i)};t.nodes.forEach((function(t){a(t.id)&&(t.y=2*i-t.y)})),t.edges.forEach((function(t){a(t.relatedNodeId)&&(t.controlPoints=t.controlPoints.map((function(t){return[t[0],2*i-t[1]]})))}))}},{key:"rightToLeft",value:function(t,e){return t.nodes.forEach((function(t){return t.x=e.width-t.x})),t.edges.forEach((function(t){t.controlPoints=t.controlPoints.map((function(t){return[e.width-t[0],t[1]]}))})),t}},{key:"execute",value:function(t,n){return r=this,i=void 0,a=void 0,o=Tn().mark((function r(){var i,a,o,s,u,c,l,h,d;return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=Object.assign(Object.assign(Object.assign({},e.defaultOptions),this.options),n),a=i.direction,o=i.nodeSize,s=this.getRoot()){r.next=5;break}return r.abrupt("return",t);case 5:return u=this.formatSize(o),i.vGap||(i.vGap=Math.max.apply(Math,w((t.nodes||[]).map((function(t){return u(t)[1]}))))),i.hGap||(i.hGap=Math.max.apply(Math,w((t.nodes||[]).map((function(t){return u(t)[0]}))))),c=this.doLayout(s,i),this.placeAlterative(c,s),"RL"===a&&(c=this.rightToLeft(c,i)),l=this.context.model,h=[],d=[],c.nodes.forEach((function(t){var e=t.id,n=t.x,r=t.y,i=l.getNodeLikeDatum(e);h.push(lw(i,{x:n,y:r}))})),c.edges.forEach((function(t){var e=t.id,n=t.controlPoints,r=l.getEdgeDatum(e);d.push(lw(r,{controlPoints:n}))})),r.abrupt("return",{nodes:h,edges:d});case 17:case"end":return r.stop()}}),r,this)})),new(a||(a=Promise))((function(t,e){function n(t){try{u(o.next(t))}catch(t){e(t)}}function s(t){try{u(o.throw(t))}catch(t){e(t)}}function u(e){var r;e.done?t(e.value):(r=e.value,r instanceof a?r:new a((function(t){t(r)}))).then(n,s)}u((o=o.apply(r,i||[])).next())}));var r,i,a,o}}])}(Ig);cw.defaultOptions={direction:"RL",getRibSep:function(){return 60}};var lw=function(t,e){return Object.assign(Object.assign({},t),{style:Object.assign(Object.assign({},t.style||{}),e)})},hw=function(t){return 0===t.depth},dw=function(t){return(t.depth||(t.depth=0))%2==0},fw=function(t){function e(){var t;return y(this,e),(t=S(this,e,arguments)).id="snake",t}return N(e,t),b(e,[{key:"formatSize",value:function(t,e){var n="function"==typeof e?e:function(){return e};return t.reduce((function(t,e){var r=h(jd(n(e))||[0,0],2),i=r[0],a=r[1];return[Math.max(t[0],i),Math.max(t[1],a)]}),[0,0])}},{key:"validate",value:function(t){var e=t.nodes,n=void 0===e?[]:e,r=t.edges,i=void 0===r?[]:r,a={},o={},s={};n.forEach((function(t){a[t.id]=0,o[t.id]=0,s[t.id]=[]})),i.forEach((function(t){a[t.target]++,o[t.source]++,s[t.source].push(t.target)}));var u=new Set,c=function(t){u.has(t)||(u.add(t),s[t].forEach(c))};if(c(n[0].id),u.size!==n.length)return!1;var l=n.filter((function(t){return 0===a[t.id]})),h=n.filter((function(t){return 0===o[t.id]}));if(1!==l.length||1!==h.length)return!1;var d=n.filter((function(t){return 1===a[t.id]&&1===o[t.id]}));return d.length===n.length-2}},{key:"execute",value:function(t,n){return r=this,i=void 0,a=void 0,o=Tn().mark((function r(){var i,a,o,s,u,c,l,d,f,v,p,g,y,m,b,x,w,E,k,M,S,O,N;return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.validate(t)){r.next=2;break}return r.abrupt("return",t);case 2:return a=Object.assign({},e.defaultOptions,this.options,n),o=a.nodeSize,s=a.padding,u=a.sortBy,c=a.cols,l=a.colGap,d=a.rowGap,f=a.clockwise,v=a.width,p=a.height,g=Cl(s),y=h(g,4),m=y[0],b=y[1],x=y[2],w=y[3],E=this.formatSize(t.nodes||[],o),k=Math.ceil((t.nodes||[]).length/c),M=l||(v-w-b-c*E[0])/(c-1),((S=d||(p-m-x-k*E[1])/(k-1))===1/0||S<0)&&(S=0),(M===1/0||M<0)&&(M=0),O=u?null===(i=t.nodes)||void 0===i?void 0:i.sort(u):vw(t),N=(O||[]).map((function(t,e){var n=Math.floor(e/c),r=e%c,i=w+(f?n%2==0?r:c-1-r:n%2==0?c-1-r:r)*(E[0]+M)+E[0]/2,a=m+n*(E[1]+S)+E[1]/2;return{id:t.id,style:{x:i,y:a}}})),r.abrupt("return",{nodes:N});case 13:case"end":return r.stop()}}),r,this)})),new(a||(a=Promise))((function(t,e){function n(t){try{u(o.next(t))}catch(t){e(t)}}function s(t){try{u(o.throw(t))}catch(t){e(t)}}function u(e){var r;e.done?t(e.value):(r=e.value,r instanceof a?r:new a((function(t){t(r)}))).then(n,s)}u((o=o.apply(r,i||[])).next())}));var r,i,a,o}}])}(Ig);function vw(t){var e=t.nodes,n=void 0===e?[]:e,r=t.edges,i=void 0===r?[]:r,a={},o={};n.forEach((function(t){a[t.id]=0,o[t.id]=[]})),i.forEach((function(t){a[t.target]++,o[t.source].push(t.target)}));var s=[],u=[];n.forEach((function(t){0===a[t.id]&&s.push(t.id)}));for(var c=function(){var t=s.shift(),e=n.find((function(e){return e.id===t}));u.push(e),o[t].forEach((function(t){a[t]--,0===a[t]&&s.push(t)}))};s.length>0;)c();return u}fw.defaultOptions={padding:0,cols:5,clockwise:!0};const pw=function(t,e){return function(t,e,n){if(!He(t)&&!Dh(t))return t;var r=n;return Jv(t,(function(t,n){r=e(r,t,n)})),r}(t,(function(t,n,r){return e.includes(r)||(t[r]=n),t}),{})};var gw=function(t){function e(){return y(this,e),S(this,e,arguments)}return N(e,t),b(e)}(Ch);function yw(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=document.createElement("div");return r.setAttribute("class","g6-".concat(t)),Object.assign(r.style,{position:"absolute",display:"block"}),e&&Object.assign(r.style,{position:"unset",gridArea:"1 / 1 / 2 / 2",inset:"0px",height:"100%",width:"100%",overflow:"hidden",pointerEvents:"none"}),n&&Object.assign(r.style,n),r}function mw(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:document.body,a=document.getElementById(t);a&&a.remove();var o=document.createElement(e);return o.innerHTML=r,o.id=t,Object.assign(o.style,n),i.appendChild(o),o}var bw=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).$element=yw("background"),r.context.canvas.getContainer().prepend(r.$element),r.update(n),r}return N(e,t),b(e,[{key:"update",value:function(t){var n,r,i,a,o=this,s=Object.create(null,{update:{get:function(){return dn(e,"update",o,1)}}});return n=this,r=void 0,i=void 0,a=Tn().mark((function e(){return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.update.call(this,t),Object.assign(this.$element.style,pw(this.options,["key","type"]));case 2:case"end":return e.stop()}}),e,this)})),new(i||(i=Promise))((function(t,e){function o(t){try{u(a.next(t))}catch(t){e(t)}}function s(t){try{u(a.throw(t))}catch(t){e(t)}}function u(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(o,s)}u((a=a.apply(n,r||[])).next())}))}},{key:"destroy",value:function(){dn(e,"destroy",this,3)([]),this.$element.remove()}}])}(gw);function xw(t,e,n,r,i,a){var o,s=n-t,u=r-e,c=i-t,l=a-e,h=c*s+l*u;o=h<=0||(h=(c=s-c)*s+(l=u-l)*u)<=0?0:h*h/(s*s+u*u);var d=c*c+l*l-o;return d<0?0:d}function ww(t,e,n,r){return(t-n)*(t-n)+(e-r)*(e-r)}function Ew(t,e,n,r,i){return ww(t,e,n,r)<i*i}function kw(t){var e=Math.min(t.x1,t.x2),n=Math.max(t.x1,t.x2),r=Math.min(t.y1,t.y2),i=Math.max(t.y1,t.y2);return{x:e,y:r,x2:n,y2:i,width:n-e,height:i-r}}bw.defaultOptions={transition:"background 0.5s",backgroundSize:"cover",zIndex:"-1"};var Mw,Sw=function(){function t(e,n,r,i){y(this,t),this.x1=e,this.y1=n,this.x2=r,this.y2=i}return b(t,[{key:"equals",value:function(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}},{key:"draw",value:function(t){t.moveTo(this.x1,this.y1),t.lineTo(this.x2,this.y2)}},{key:"toString",value:function(){return"Line(from=(".concat(this.x1,",").concat(this.y1,"),to=(").concat(this.x2,",").concat(this.y2,"))")}},{key:"cuts",value:function(t,e){return!(this.y1===this.y2||e<this.y1&&e<=this.y2||e>this.y1&&e>=this.y2||t>this.x1&&t>=this.x2||!(t<this.x1&&t<=this.x2||t<=this.x1+(e-this.y1)*(this.x2-this.x1)/(this.y2-this.y1)))}},{key:"distSquare",value:function(t,e){return xw(this.x1,this.y1,this.x2,this.y2,t,e)}},{key:"ptClose",value:function(t,e,n){if(this.x1<this.x2){if(t<this.x1-n||t>this.x2+n)return!1}else if(t<this.x2-n||t>this.x1+n)return!1;if(this.y1<this.y2){if(e<this.y1-n||e>this.y2+n)return!1}else if(e<this.y2-n||e>this.y1+n)return!1;return!0}}],[{key:"from",value:function(e){return new t(e.x1,e.y1,e.x2,e.y2)}}])}();!function(t){t[t.POINT=1]="POINT",t[t.PARALLEL=2]="PARALLEL",t[t.COINCIDENT=3]="COINCIDENT",t[t.NONE=4]="NONE"}(Mw||(Mw={}));var Ow,Nw=b((function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;y(this,t),this.state=e,this.x=n,this.y=r}));function Aw(t,e){var n=(e.x2-e.x1)*(t.y1-e.y1)-(e.y2-e.y1)*(t.x1-e.x1),r=(t.x2-t.x1)*(t.y1-e.y1)-(t.y2-t.y1)*(t.x1-e.x1),i=(e.y2-e.y1)*(t.x2-t.x1)-(e.x2-e.x1)*(t.y2-t.y1);if(i){var a=n/i,o=r/i;return 0<=a&&a<=1&&0<=o&&o<=1?new Nw(Mw.POINT,t.x1+a*(t.x2-t.x1),t.y1+a*(t.y2-t.y1)):new Nw(Mw.NONE)}return new Nw(0===n||0===r?Mw.COINCIDENT:Mw.PARALLEL)}function Tw(t,e){var n=(e.x2-e.x1)*(t.y1-e.y1)-(e.y2-e.y1)*(t.x1-e.x1),r=(t.x2-t.x1)*(t.y1-e.y1)-(t.y2-t.y1)*(t.x1-e.x1),i=(e.y2-e.y1)*(t.x2-t.x1)-(e.x2-e.x1)*(t.y2-t.y1);if(i){var a=n/i,o=r/i;if(0<=a&&a<=1&&0<=o&&o<=1)return a}return Number.POSITIVE_INFINITY}function Pw(t,e,n){var r=new Set;return t.width<=0?(r.add(Ow.LEFT),r.add(Ow.RIGHT)):e<t.x?r.add(Ow.LEFT):e>t.x+t.width&&r.add(Ow.RIGHT),t.height<=0?(r.add(Ow.TOP),r.add(Ow.BOTTOM)):n<t.y?r.add(Ow.TOP):n>t.y+t.height&&r.add(Ow.BOTTOM),r}function Cw(t,e){var n=e.x1,r=e.y1,i=e.x2,a=e.y2,o=Array.from(Pw(t,i,a));if(0===o.length)return!0;for(var s=Pw(t,n,r);0!==s.size;){var u,c=Rn(o);try{for(c.s();!(u=c.n()).done;){var l=u.value;if(s.has(l))return!1}}catch(t){c.e(t)}finally{c.f()}if(s.has(Ow.RIGHT)||s.has(Ow.LEFT)){var h=t.x;s.has(Ow.RIGHT)&&(h+=t.width),r+=(h-n)*(a-r)/(i-n),n=h}else{var d=t.y;s.has(Ow.BOTTOM)&&(d+=t.height),n+=(d-r)*(i-n)/(a-r),r=d}s=Pw(t,n,r)}return!0}function Rw(t,e){var n=Number.POSITIVE_INFINITY,r=0;function i(t,i,a,o){var s=Tw(e,new Sw(t,i,a,o));(s=Math.abs(s-.5))>=0&&s<=1&&(r++,s<n&&(n=s))}return i(t.x,t.y,t.x2,t.y),i(t.x,t.y,t.x,t.y2),r>1?n:(i(t.x,t.y2,t.x2,t.y2),r>1?n:(i(t.x2,t.y,t.x2,t.y2),0===r?-1:n))}function Lw(t,e){var n=0,r=Aw(t,new Sw(e.x,e.y,e.x2,e.y));n+=r.state===Mw.POINT?1:0;var i=Aw(t,new Sw(e.x,e.y,e.x,e.y2));n+=i.state===Mw.POINT?1:0;var a=Aw(t,new Sw(e.x,e.y2,e.x2,e.y2));n+=a.state===Mw.POINT?1:0;var o=Aw(t,new Sw(e.x2,e.y,e.x2,e.y2));return{top:r,left:i,bottom:a,right:o,count:n+=o.state===Mw.POINT?1:0}}!function(t){t[t.LEFT=0]="LEFT",t[t.TOP=1]="TOP",t[t.RIGHT=2]="RIGHT",t[t.BOTTOM=3]="BOTTOM"}(Ow||(Ow={}));var Dw=function(){function t(e,n,r,i){y(this,t),this.x=e,this.y=n,this.width=r,this.height=i}return b(t,[{key:"x2",get:function(){return this.x+this.width}},{key:"y2",get:function(){return this.y+this.height}},{key:"cx",get:function(){return this.x+this.width/2}},{key:"cy",get:function(){return this.y+this.height/2}},{key:"radius",get:function(){return Math.max(this.width,this.height)/2}},{key:"equals",value:function(t){return this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height}},{key:"clone",value:function(){return new t(this.x,this.y,this.width,this.height)}},{key:"add",value:function(t){var e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),r=Math.max(this.x2,t.x+t.width),i=Math.max(this.y2,t.y+t.height);this.x=e,this.y=n,this.width=r-e,this.height=i-n}},{key:"addPoint",value:function(t){var e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),r=Math.max(this.x2,t.x),i=Math.max(this.y2,t.y);this.x=e,this.y=n,this.width=r-e,this.height=i-n}},{key:"toString",value:function(){return"Rectangle[x=".concat(this.x,", y=").concat(this.y,", w=").concat(this.width,", h=").concat(this.height,"]")}},{key:"draw",value:function(t){t.rect(this.x,this.y,this.width,this.height)}},{key:"containsPt",value:function(t,e){return t>=this.x&&t<=this.x2&&e>=this.y&&e<=this.y2}},{key:"area",get:function(){return this.width*this.height}},{key:"intersects",value:function(t){return!(this.area<=0||t.width<=0||t.height<=0)&&t.x+t.width>this.x&&t.y+t.height>this.y&&t.x<this.x2&&t.y<this.y2}},{key:"distSquare",value:function(t,e){if(this.containsPt(t,e))return 0;var n=Pw(this,t,e);return n.has(Ow.TOP)?n.has(Ow.LEFT)?ww(t,e,this.x,this.y):n.has(Ow.RIGHT)?ww(t,e,this.x2,this.y):(this.y-e)*(this.y-e):n.has(Ow.BOTTOM)?n.has(Ow.LEFT)?ww(t,e,this.x,this.y2):n.has(Ow.RIGHT)?ww(t,e,this.x2,this.y2):(e-this.y2)*(e-this.y2):n.has(Ow.LEFT)?(this.x-t)*(this.x-t):n.has(Ow.RIGHT)?(t-this.x2)*(t-this.x2):0}}],[{key:"from",value:function(e){return new t(e.x,e.y,e.width,e.height)}}])}(),_w=function(){function t(e,n,r){y(this,t),this.cx=e,this.cy=n,this.radius=r}return b(t,[{key:"x",get:function(){return this.cx-this.radius}},{key:"x2",get:function(){return this.cx+this.radius}},{key:"width",get:function(){return 2*this.radius}},{key:"y",get:function(){return this.cy-this.radius}},{key:"y2",get:function(){return this.cy+this.radius}},{key:"height",get:function(){return 2*this.radius}},{key:"containsPt",value:function(t,e){return ww(this.cx,this.cy,t,e)<this.radius*this.radius}},{key:"distSquare",value:function(t,e){var n=ww(this.cx,this.cy,t,e);if(n<this.radius*this.radius)return 0;var r=Math.sqrt(n)-this.radius;return r*r}},{key:"draw",value:function(t){t.ellipse(this.cx,this.cy,this.radius,this.radius,0,0,2*Math.PI)}}],[{key:"from",value:function(e){return new t(e.cx,e.cy,e.radius)}}])}(),Iw=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:10,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:10,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:new Float32Array(Math.max(0,o*s)).fill(0);y(this,t),this.pixelGroup=e,this.i=n,this.j=r,this.pixelX=i,this.pixelY=a,this.width=o,this.height=s,this.area=u}return b(t,[{key:"createSub",value:function(e,n){return new t(this.pixelGroup,e.x,e.y,n.x,n.y,e.width,e.height)}},{key:"copy",value:function(e,n){return new t(this.pixelGroup,this.scaleX(n.x),this.scaleY(n.y),n.x,n.y,e.width,e.height,e.area)}},{key:"boundX",value:function(t){return t<this.i?this.i:t>=this.width?this.width-1:t}},{key:"boundY",value:function(t){return t<this.j?this.j:t>=this.height?this.height-1:t}},{key:"scaleX",value:function(t){return this.boundX(Math.floor((t-this.pixelX)/this.pixelGroup))}},{key:"scaleY",value:function(t){return this.boundY(Math.floor((t-this.pixelY)/this.pixelGroup))}},{key:"scale",value:function(t){var e=this.scaleX(t.x),n=this.scaleY(t.y),r=this.boundX(Math.ceil((t.x+t.width-this.pixelX)/this.pixelGroup)),i=this.boundY(Math.ceil((t.y+t.height-this.pixelY)/this.pixelGroup));return new Dw(e,n,r-e,i-n)}},{key:"invertScaleX",value:function(t){return Math.round(t*this.pixelGroup+this.pixelX)}},{key:"invertScaleY",value:function(t){return Math.round(t*this.pixelGroup+this.pixelY)}},{key:"addPadding",value:function(t,e){var n=Math.ceil(e/this.pixelGroup),r=this.boundX(t.x-n),i=this.boundY(t.y-n),a=this.boundX(t.x2+n),o=this.boundY(t.y2+n);return new Dw(r,i,a-r,o-i)}},{key:"get",value:function(t,e){return t<0||e<0||t>=this.width||e>=this.height?Number.NaN:this.area[t+e*this.width]}},{key:"inc",value:function(t,e,n){t<0||e<0||t>=this.width||e>=this.height||(this.area[t+e*this.width]+=n)}},{key:"set",value:function(t,e,n){t<0||e<0||t>=this.width||e>=this.height||(this.area[t+e*this.width]=n)}},{key:"incArea",value:function(t,e){if(!(t.width<=0||t.height<=0||0===e)){var n=this.width,r=t.width,i=Math.max(0,t.i),a=Math.max(0,t.j),o=Math.min(t.i+t.width,n),s=Math.min(t.j+t.height,this.height);if(!(s<=0||o<=0||i>=n||s>=this.height))for(var u=a;u<s;u++)for(var c=(u-t.j)*r,l=u*n,h=i;h<o;h++){var d=t.area[h-t.i+c];0!==d&&(this.area[h+l]+=e*d)}}}},{key:"fill",value:function(t){this.area.fill(t)}},{key:"fillArea",value:function(t,e){for(var n=t.x+t.y*this.width,r=0;r<t.height;r++){var i=n+r*this.width;this.area.fill(e,i,i+t.width)}}},{key:"fillHorizontalLine",value:function(t,e,n,r){var i=t+e*this.width;this.area.fill(r,i,i+n)}},{key:"fillVerticalLine",value:function(t,e,n,r){for(var i=t+e*this.width,a=0;a<n;a++)this.area[i+a*this.width]=r}},{key:"clear",value:function(){this.area.fill(0)}},{key:"toString",value:function(){for(var t="",e=0;e<this.height;e++){for(var n=e*this.width,r=0;r<this.width;r++)t+=this.area[n+r].toFixed(1).padStart(6),t+=" ";t+="\n"}return t}},{key:"draw",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!(this.width<=0||this.height<=0)){t.save(),e&&t.translate(this.pixelX,this.pixelY);var n=this.area.reduce((function(t,e){return Math.min(t,e)}),Number.POSITIVE_INFINITY),r=this.area.reduce((function(t,e){return Math.max(t,e)}),Number.NEGATIVE_INFINITY),i=function(t){return(t-n)/(r-n)};t.scale(this.pixelGroup,this.pixelGroup);for(var a=0;a<this.width;a++)for(var o=0;o<this.height;o++){var s=this.area[a+o*this.width];t.fillStyle="rgba(0, 0, 0, ".concat(i(s),")"),t.fillRect(a,o,1,1)}t.restore()}}},{key:"drawThreshold",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!(this.width<=0||this.height<=0)){t.save(),n&&t.translate(this.pixelX,this.pixelY),t.scale(this.pixelGroup,this.pixelGroup);for(var r=0;r<this.width;r++)for(var i=0;i<this.height;i++){var a=this.area[r+i*this.width];t.fillStyle=a>e?"black":"white",t.fillRect(r,i,1,1)}t.restore()}}}],[{key:"fromPixelRegion",value:function(e,n){return new t(n,0,0,e.x,e.y,Math.ceil(e.width/n),Math.ceil(e.height/n))}}])}();function jw(t,e){var n=function(t){return{x:t.x-e,y:t.y-e,width:t.width+2*e,height:t.height+2*e}};return Array.isArray(t)?t.map(n):n(t)}function Fw(t,e,n){return Bw(Object.assign(kw(t),{distSquare:function(e,n){return xw(t.x1,t.y1,t.x2,t.y2,e,n)}}),e,n)}function Bw(t,e,n){var r=jw(t,n),i=e.scale(r),a=e.createSub(i,r);return function(t,e,n,r){for(var i=n*n,a=0;a<t.height;a++)for(var o=0;o<t.width;o++){var s=r(e.invertScaleX(t.i+o),e.invertScaleY(t.j+a));if(0!==s){if(s<i){var u=n-Math.sqrt(s);t.set(o,a,u*u)}}else t.set(o,a,i)}}(a,e,n,(function(e,n){return t.distSquare(e,n)})),a}function zw(t,e){return{x:t,y:e}}function Gw(t,e){return e.some((function(e){return e.containsPt(t.x,t.y)}))}function Vw(t,e){return e.some((function(e){return!!Ew(e.x1,e.y1,t.x,t.y,.001)||!!Ew(e.x2,e.y2,t.x,t.y,.001)}))}function Ww(t,e){var n,r=Number.POSITIVE_INFINITY,i=null,a=Rn(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(Cw(o,e)){var s=Rw(o,e);s>=0&&s<r&&(i=o,r=s)}}}catch(t){a.e(t)}finally{a.f()}return i}function Hw(t,e,n,r){var i=n.top,a=n.left,o=n.bottom,s=n.right;if(r){if(a.state===Mw.POINT){if(i.state===Mw.POINT)return zw(t.x-e,t.y-e);if(o.state===Mw.POINT)return zw(t.x-e,t.y2+e);var u=t.width*t.height;return t.width*(.5*(a.y-t.y+(s.y-t.y)))<.5*u?a.y>s.y?zw(t.x-e,t.y-e):zw(t.x2+e,t.y-e):a.y<s.y?zw(t.x-e,t.y2+e):zw(t.x2+e,t.y2+e)}if(s.state===Mw.POINT){if(i.state===Mw.POINT)return zw(t.x2+e,t.y-e);if(o.state===Mw.POINT)return zw(t.x2+e,t.y2+e)}var c=t.height*t.width;return t.height*(.5*(i.x-t.x+(s.x-t.x)))<.5*c?i.x>o.x?zw(t.x-e,t.y-e):zw(t.x-e,t.y2+e):i.x<o.x?zw(t.x2+e,t.y-e):zw(t.x2+e,t.y2+e)}if(a.state===Mw.POINT){if(i.state===Mw.POINT)return zw(t.x2+e,t.y2+e);if(o.state===Mw.POINT)return zw(t.x2+e,t.y-e);var l=t.height*t.width;return t.width*(.5*(a.y-t.y+(s.y-t.y)))<.5*l?a.y>s.y?zw(t.x2+e,t.y2+e):zw(t.x-e,t.y2+e):a.y<s.y?zw(t.x2+e,t.y-e):zw(t.x-e,t.y-e)}if(s.state===Mw.POINT){if(i.state===Mw.POINT)return zw(t.x-e,t.y2+e);if(o.state===Mw.POINT)return zw(t.x-e,t.y-e)}var h=t.height*t.width;return t.height*(.5*(i.x-t.x+(s.x-t.x)))<.5*h?i.x>o.x?zw(t.x2+e,t.y2+e):zw(t.x2+e,t.y-e):i.x<o.x?zw(t.x-e,t.y2+e):zw(t.x-e,t.y-e)}function Yw(t,e,n,r){if(!(t.closed?n<t.length:n<t.length-1))return!1;for(var i=t.get(e),a=t.get(n+1),o=e+1;o<=n;o++){var s=t.get(o);if(xw(i.x,i.y,a.x,a.y,s.x,s.y)>r)return!1}return!0}function Uw(t,e){switch(t){case-2:return(((3-e)*e-3)*e+1)/6;case-1:return((3*e-6)*e*e+4)/6;case 0:return(((-3*e+3)*e+3)*e+1)/6;case 1:return e*e*e/6;default:throw new Error("unknown error")}}var qw=function(){return b((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];y(this,t),this.points=e,this.closed=n}),[{key:"get",value:function(t){var e=t,n=this.points.length;return t<0?this.closed?this.get(t+n):this.points[0]:t>=n?this.closed?this.get(t-n):this.points[n-1]:this.points[e]}},{key:"length",get:function(){return this.points.length}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,e=this.points;if(0===e.length)return"";var n,r="function"==typeof t?t:function(t){if(!Number.isFinite(t))return function(t){return t};if(0===t)return Math.round;var e=Math.pow(10,t);return function(t){return Math.round(t*e)/e}}(t),i="M",a=Rn(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;i+="".concat(r(o.x),",").concat(r(o.y)," L")}}catch(t){a.e(t)}finally{a.f()}return i=i.slice(0,-1),this.closed&&(i+=" Z"),i}},{key:"draw",value:function(t){var e=this.points;if(0!==e.length){t.beginPath(),t.moveTo(e[0].x,e[0].y);var n,r=Rn(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;t.lineTo(i.x,i.y)}}catch(t){r.e(t)}finally{r.f()}this.closed&&t.closePath()}}},{key:"sample",value:function(t){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;return function(e){var n=t,r=e.length;if(n>1)for(r=Math.floor(e.length/n);r<3&&n>1;)n-=1,r=Math.floor(e.length/n);for(var i=[],a=0,o=0;o<r;o++,a+=n)i.push(e.get(a));return new qw(i)}}(t)(this)}},{key:"simplify",value:function(t){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(e){if(t<0||e.length<3)return e;for(var n=[],r=0,i=t*t;r<e.length;){for(var a=r+1;Yw(e,r,a,i);)a++;n.push(e.get(r)),r=a}return new qw(n)}}(t)(this)}},{key:"bSplines",value:function(t){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;function e(t,e,n){for(var r=0,i=0,a=-2;a<=1;a++){var o=t.get(e+a),s=Uw(a,n);r+=s*o.x,i+=s*o.y}return{x:r,y:i}}return function(n){if(n.length<3)return n;var r=[],i=n.closed,a=n.length+3-1+(i?0:2);r.push(e(n,2-(i?0:2),0));for(var o=2-(i?0:2);o<a;o++)for(var s=1;s<=t;s++)r.push(e(n,o,s/t));return new qw(r)}}(t)(this)}},{key:"apply",value:function(t){return t(this)}},{key:"containsElements",value:function(t){var e=this,n=function(t){if(0===t.length)return null;var e,n=t[0],r=new Dw(n.x,n.y,0,0),i=Rn(t);try{for(i.s();!(e=i.n()).done;){var a=e.value;r.addPoint(a)}}catch(t){i.e(t)}finally{i.f()}return r}(this.points);return!!n&&t.every((function(t){return n.containsPt(t.cx,t.cy)&&e.withinArea(t.cx,t.cy)}))}},{key:"withinArea",value:function(t,e){if(0===this.length)return!1;for(var n=0,r=this.points[0],i=new Sw(r.x,r.y,r.x,r.y),a=1;a<this.points.length;a++){var o=this.points[a];i.x1=i.x2,i.y1=i.y2,i.x2=o.x,i.y2=o.y,i.cuts(t,e)&&n++}return i.x1=i.x2,i.y1=i.y2,i.x2=r.x,i.y2=r.y,i.cuts(t,e)&&n++,n%2==1}}])}(),Xw=function(){return b((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;y(this,t),this.count=0,this.arr=[],this.set=new Set,this.arr.length=e}),[{key:"add",value:function(t){this.set.add("".concat(t.x,"x").concat(t.y)),this.arr[this.count++]=t}},{key:"contains",value:function(t){return this.set.has("".concat(t.x,"x").concat(t.y))}},{key:"isFirst",value:function(t){if(0===this.count)return!1;var e=this.arr[0];return null!=e&&e.x===t.x&&e.y===t.y}},{key:"path",value:function(){return new qw(this.arr.slice(0,this.count))}},{key:"clear",value:function(){this.set.clear(),this.count=0}},{key:"get",value:function(t){return this.arr[t]}},{key:"length",get:function(){return this.count}}])}();function Kw(t,e){var n=2*(Math.floor(t.width)+Math.floor(t.height)),r=new Xw(n);function i(n,r,i,a){var o=t.get(n,r);return Number.isNaN(o)?Number.NaN:o>e?i+a:i}function a(t,e){var n=0;return n=i(t,e,n,1),n=i(t+1,e,n,2),n=i(t,e+1,n,4),n=i(t+1,e+1,n,8),Number.isNaN(n)?-1:n}var o=1;function s(e,n){for(var i=e,s=n,u=t.invertScaleX(i),c=t.invertScaleY(s),l=0;l<t.width*t.height;l++){var h={x:u,y:c};if(r.contains(h)){if(r.isFirst(h))return!0}else r.add(h);var d=a(i,s);switch(d){case-1:return!0;case 0:case 3:case 2:case 7:o=2;break;case 12:case 14:case 4:o=3;break;case 6:o=0===o?3:2;break;case 1:case 13:case 5:o=0;break;case 9:o=2===o?0:1;break;case 10:case 8:case 11:o=1;break;default:return console.warn("Marching squares invalid state: "+d),!0}switch(o){case 0:s--,c-=t.pixelGroup;break;case 1:s++,c+=t.pixelGroup;break;case 3:i--,u-=t.pixelGroup;break;case 2:i++,u+=t.pixelGroup;break;default:return console.warn("Marching squares invalid state: "+d),!0}}return!0}for(var u=0;u<t.width;u++)for(var c=0;c<t.height;c++)if(!(t.get(u,c)<=e)){var l=a(u,c);if(!(l<0||15===l)&&s(u,c))return r.path()}return null}var $w,Zw={maxRoutingIterations:100,maxMarchingIterations:20,pixelGroup:4,edgeR0:10,edgeR1:20,nodeR0:15,nodeR1:50,morphBuffer:10,threshold:1,memberInfluenceFactor:1,edgeInfluenceFactor:1,nonMemberInfluenceFactor:-.8,virtualEdges:!0};function Qw(t){return null!=t&&"number"==typeof t.radius}function Jw(t,e){if(Qw(t)!==Qw(e))return!1;if(Qw(t)){var n=e;return t.cx===n.cx&&t.cy===n.cy&&t.radius===n.radius}var r=e;return t.x===r.x&&t.y===r.y&&t.width===r.width&&t.height===r.height}!function(t){t[t.MEMBERS=0]="MEMBERS",t[t.NON_MEMBERS=1]="NON_MEMBERS",t[t.EDGES=2]="EDGES"}($w||($w={}));var tE=function(){return b((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y(this,t),this.dirty=new Set,this.members=[],this.nonMembers=[],this.virtualEdges=[],this.edges=[],this.activeRegion=new Dw(0,0,0,0),this.potentialArea=new Iw(1,0,0,0,0,0,0),this.o=Object.assign({},Zw,e)}),[{key:"pushMember",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(0!==e.length){this.dirty.add($w.MEMBERS);for(var r=0,i=e;r<i.length;r++){var a=i[r];this.members.push({raw:a,obj:Qw(a)?_w.from(a):Dw.from(a),area:null})}}}},{key:"removeMember",value:function(t){var e=this.members.findIndex((function(e){return Jw(e.raw,t)}));return!(e<0||(this.members.splice(e,1),this.dirty.add($w.MEMBERS),0))}},{key:"removeNonMember",value:function(t){var e=this.nonMembers.findIndex((function(e){return Jw(e.raw,t)}));return!(e<0||(this.nonMembers.splice(e,1),this.dirty.add($w.NON_MEMBERS),0))}},{key:"removeEdge",value:function(t){var e=this.edges.findIndex((function(e){return e.obj.equals(t)}));return!(e<0||(this.edges.splice(e,1),this.dirty.add($w.NON_MEMBERS),0))}},{key:"pushNonMember",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(0!==e.length){this.dirty.add($w.NON_MEMBERS);for(var r=0,i=e;r<i.length;r++){var a=i[r];this.nonMembers.push({raw:a,obj:Qw(a)?_w.from(a):Dw.from(a),area:null})}}}},{key:"pushEdge",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(0!==e.length){this.dirty.add($w.EDGES);for(var r=0,i=e;r<i.length;r++){var a=i[r];this.edges.push({raw:a,obj:Sw.from(a),area:null})}}}},{key:"update",value:function(){var t=this,e=this.dirty.has($w.MEMBERS),n=this.dirty.has($w.NON_MEMBERS),r=this.dirty.has($w.EDGES);this.dirty.clear();var i=this.members.map((function(t){return t.obj}));if(this.o.virtualEdges&&(e||n)){var a=function(t,e,n,r){if(0===t.length)return[];var i=function(t){if(t.length<2)return t;var e=0,n=0;return t.forEach((function(t){e+=t.cx,n+=t.cy})),e/=t.length,n/=t.length,t.map((function(t){var r=e-t.cx,i=n-t.cy;return[t,r*r+i*i]})).sort((function(t,e){return t[1]-e[1]})).map((function(t){return t[0]}))}(t);return i.map((function(t,a){var o=i.slice(0,a);return function(t,e,n,r,i){var a=zw(e.cx,e.cy),o=function(t,e,n){var r=Number.POSITIVE_INFINITY;return e.reduce((function(e,i){var a=ww(t.x,t.y,i.cx,i.cy);if(a>r)return e;var o=new Sw(t.x,t.y,i.cx,i.cy),s=function(t,e){return t.reduce((function(t,n){return Cw(n,e)&&function(t,e){function n(t,n,r,i){var a=Tw(e,new Sw(t,n,r,i));return(a=Math.abs(a-.5))>=0&&a<=1?1:0}var r=n(t.x,t.y,t.x2,t.y);return(r+=n(t.x,t.y,t.x,t.y2))>1||(r+=n(t.x,t.y2,t.x2,t.y2))>1||(r+=n(t.x2,t.y,t.x2,t.y2))>0}(n,e)?t+1:t}),0)}(n,o);return a*(s+1)*(s+1)<r&&(e=i,r=a*(s+1)*(s+1)),e}),null)}(a,n,t);if(null==o)return[];var s=function(t,e,n,r){var i=[],a=[];a.push(t);for(var o=!0,s=0;s<n&&o;s++)for(o=!1;!o&&a.length>0;){var u=a.pop(),c=Ww(e,u),l=c?Lw(u,c):null;if(c&&l&&2===l.count){for(var h=r,d=Hw(c,h,l,!0),f=Vw(d,a)||Vw(d,i),v=Gw(d,e);!f&&v&&h>=1;)f=Vw(d=Hw(c,h/=1.5,l,!0),a)||Vw(d,i),v=Gw(d,e);if(!d||f||v||(a.push(new Sw(u.x1,u.y1,d.x,d.y)),a.push(new Sw(d.x,d.y,u.x2,u.y2)),o=!0),!o){var p=Vw(d=Hw(c,h=r,l,!1),a)||Vw(d,i);for(v=Gw(d,e);!p&&v&&h>=1;)p=Vw(d=Hw(c,h/=1.5,l,!1),a)||Vw(d,i),v=Gw(d,e);d&&!p&&(a.push(new Sw(u.x1,u.y1,d.x,d.y)),a.push(new Sw(d.x,d.y,u.x2,u.y2)),o=!0),o||i.push(u)}}else o||i.push(u)}for(;a.length>0;)i.push(a.pop());return i}(new Sw(a.x,a.y,o.cx,o.cy),t,r,i);return function(t,e){for(var n=[];t.length>0;){var r=t.pop();if(0===t.length){n.push(r);break}var i=t.pop(),a=new Sw(r.x1,r.y1,i.x2,i.y2);Ww(e,a)?(n.push(r),t.push(i)):t.push(a)}return n}(s,t)}(e,t,o,n,r)})).flat()}(i,this.nonMembers.map((function(t){return t.obj})),this.o.maxRoutingIterations,this.o.morphBuffer),o=new Map(this.virtualEdges.map((function(t){return[t.obj.toString(),t.area]})));this.virtualEdges=a.map((function(t){var e;return{raw:t,obj:t,area:null!==(e=o.get(t.toString()))&&void 0!==e?e:null}})),r=!0}var s=!1;if(e||r){var u=function(t,e){if(0===t.length)return new Dw(0,0,0,0);var n,r=Dw.from(t[0]),i=Rn(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;r.add(a)}}catch(t){i.e(t)}finally{i.f()}var o,s=Rn(e);try{for(s.s();!(o=s.n()).done;){var u=o.value;r.add(kw(u))}}catch(t){s.e(t)}finally{s.f()}return r}(i,this.virtualEdges.concat(this.edges).map((function(t){return t.obj}))),c=Math.max(this.o.edgeR1,this.o.nodeR1)+this.o.morphBuffer,l=Dw.from(jw(u,c));l.equals(this.activeRegion)||(s=!0,this.activeRegion=l)}if(s){var h=Math.ceil(this.activeRegion.width/this.o.pixelGroup),d=Math.ceil(this.activeRegion.height/this.o.pixelGroup);this.activeRegion.x!==this.potentialArea.pixelX||this.activeRegion.y!==this.potentialArea.pixelY?(this.potentialArea=Iw.fromPixelRegion(this.activeRegion,this.o.pixelGroup),this.members.forEach((function(t){return t.area=null})),this.nonMembers.forEach((function(t){return t.area=null})),this.edges.forEach((function(t){return t.area=null})),this.virtualEdges.forEach((function(t){return t.area=null}))):h===this.potentialArea.width&&d===this.potentialArea.height||(this.potentialArea=Iw.fromPixelRegion(this.activeRegion,this.o.pixelGroup))}var f=new Map,v=function(t){if(t.area){var e="".concat(t.obj.width,"x").concat(t.obj.height,"x").concat(t.obj instanceof Dw?"R":"C");f.set(e,t.area)}},p=function(e){if(!e.area){var n="".concat(e.obj.width,"x").concat(e.obj.height,"x").concat(e.obj instanceof Dw?"R":"C");if(f.has(n)){var r=f.get(n);e.area=t.potentialArea.copy(r,{x:e.obj.x-t.o.nodeR1,y:e.obj.y-t.o.nodeR1})}else{var i=e.obj instanceof Dw?function(t,e,n){var r=e.scale(t),i=e.addPadding(r,n),a=e.createSub(i,{x:t.x-n,y:t.y-n}),o=r.x-i.x,s=r.y-i.y,u=i.x2-r.x2,c=i.y2-r.y2,l=i.width-o-u,h=i.height-s-c,d=n*n;a.fillArea({x:o,y:s,width:l+1,height:h+1},d);for(var f=[0],v=Math.max(s,o,u,c),p=e.invertScaleX(r.x+r.width/2),g=1;g<v;g++){var y=e.invertScaleY(r.y-g),m=t.distSquare(p,y);if(!(m<d))break;var b=n-Math.sqrt(m);f.push(b*b)}for(var x=[],w=Math.max(o,u),E=Math.max(s,u),k=1;k<w;k++){for(var M=e.invertScaleX(r.x-k),S=[],O=1;O<E;O++){var N=e.invertScaleY(r.y-O),A=t.distSquare(M,N);if(A<d){var T=n-Math.sqrt(A);S.push(T*T)}else S.push(0)}x.push(S)}for(var P=1;P<Math.min(s,f.length);P++){var C=f[P];a.fillHorizontalLine(o,s-P,l+1,C)}for(var R=1;R<Math.min(c,f.length);R++){var L=f[R];a.fillHorizontalLine(o,s+h+R,l+1,L)}for(var D=1;D<Math.min(o,f.length);D++){var _=f[D];a.fillVerticalLine(o-D,s,h+1,_)}for(var I=1;I<Math.min(c,f.length);I++){var j=f[I];a.fillVerticalLine(o+l+I,s,h+1,j)}for(var F=1;F<o;F++){for(var B=x[F-1],z=o-F,G=1;G<s;G++)a.set(z,s-G,B[G-1]);for(var V=1;V<c;V++)a.set(z,s+h+V,B[V-1])}for(var W=1;W<u;W++){for(var H=x[W-1],Y=o+l+W,U=1;U<s;U++)a.set(Y,s-U,H[U-1]);for(var q=1;q<c;q++)a.set(Y,s+h+q,H[q-1])}return a}(e.obj,t.potentialArea,t.o.nodeR1):Bw(e.obj,t.potentialArea,t.o.nodeR1);e.area=i,f.set(n,i)}}};this.members.forEach(v),this.nonMembers.forEach(v),this.members.forEach(p),this.nonMembers.forEach((function(e){t.activeRegion.intersects(e.obj)?p(e):e.area=null})),this.edges.forEach((function(e){e.area||(e.area=Fw(e.obj,t.potentialArea,t.o.edgeR1))})),this.virtualEdges.forEach((function(e){e.area||(e.area=Fw(e.obj,t.potentialArea,t.o.edgeR1))}))}},{key:"drawMembers",value:function(t){var e,n=Rn(this.members);try{for(n.s();!(e=n.n()).done;)e.value.obj.draw(t)}catch(t){n.e(t)}finally{n.f()}}},{key:"drawNonMembers",value:function(t){var e,n=Rn(this.nonMembers);try{for(n.s();!(e=n.n()).done;)e.value.obj.draw(t)}catch(t){n.e(t)}finally{n.f()}}},{key:"drawEdges",value:function(t){var e,n=Rn(this.edges);try{for(n.s();!(e=n.n()).done;)e.value.obj.draw(t)}catch(t){n.e(t)}finally{n.f()}}},{key:"drawPotentialArea",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.potentialArea.draw(t,e)}},{key:"compute",value:function(){if(0===this.members.length)return new qw([]);this.dirty.size>0&&this.update();var t=this.o,e=this.potentialArea,n=this.members.map((function(t){return t.area})),r=this.virtualEdges.concat(this.edges).map((function(t){return t.area})),i=this.nonMembers.filter((function(t){return null!=t.area})).map((function(t){return t.area})),a=this.members.map((function(t){return t.obj}));return function(t,e,n,r,i){for(var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=Object.assign({},Zw,a),s=o.threshold,u=o.memberInfluenceFactor,c=o.edgeInfluenceFactor,l=o.nonMemberInfluenceFactor,h=(o.nodeR0-o.nodeR1)*(o.nodeR0-o.nodeR1),d=(o.edgeR0-o.edgeR1)*(o.edgeR0-o.edgeR1),f=0;f<o.maxMarchingIterations;f++){if(t.clear(),0!==u){var v,p=u/h,g=Rn(e);try{for(g.s();!(v=g.n()).done;){var y=v.value;t.incArea(y,p)}}catch(t){g.e(t)}finally{g.f()}}if(0!==c){var m,b=c/d,x=Rn(n);try{for(x.s();!(m=x.n()).done;){var w=m.value;t.incArea(w,b)}}catch(t){x.e(t)}finally{x.f()}}if(0!==l){var E,k=l/h,M=Rn(r);try{for(M.s();!(E=M.n()).done;){var S=E.value;t.incArea(S,k)}}catch(t){M.e(t)}finally{M.f()}}var O=Kw(t,s);if(O&&i(O))return O;if(s*=.95,f<=.5*o.maxMarchingIterations)u*=1.2,c*=1.2;else{if(!(0!==l&&r.length>0))break;l*=.8}}return new qw([])}(e,n,r,i,(function(t){return t.containsElements(a)}),t)}}])}(),eE=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,jh({},e.defaultOptions,n)])).members=new Map,r.avoidMembers=new Map,r.bubbleSetOptions={},r.drawBubbleSets=function(){var t=r.parseOptions(),e=t.style,n=t.bubbleSetOptions;Vc(r.bubbleSetOptions,n)||r.init(),r.bubbleSetOptions=Object.assign({},n);var i=Object.assign(Object.assign({},e),{d:r.getPath()});r.shape?r.shape.update(i):(r.shape=new nf({style:i}),r.context.canvas.appendChild(r.shape))},r.updateBubbleSetsPath=function(t){if(r.shape){var e=yh(t.data);[].concat(w(r.options.members),w(r.options.avoidMembers)).includes(e)&&r.shape.update(Object.assign(Object.assign({},r.parseOptions().style),{d:r.getPath(e)}))}},r.getPath=function(t){var e=r.context.graph,n=r.options.members,i=w(r.members.keys()),a=r.options.avoidMembers,o=w(r.avoidMembers.keys());if(!t&&Vc(n,i)&&Vc(a,o))return r.path;var s=Ah(i,n,(function(t){return t})),u=s.enter,c=void 0===u?[]:u,l=s.exit,d=void 0===l?[]:l,f=Ah(o,a,(function(t){return t})),v=f.enter,p=void 0===v?[]:v,g=f.exit,y=void 0===g?[]:g;t&&(d.push(t),c.push(t));var m=function(t,n,i){t.forEach((function(t){var a=i?r.members:r.avoidMembers,o=i?"pushMember":"pushNonMember",s=i?"removeMember":"removeNonMember";if(n){var u;"edge"===e.getElementType(t)?(u=h(rE(e,t),1)[0],r.bubbleSets.pushEdge(u)):(u=h(nE(e,t),1)[0],r.bubbleSets[o](u)),a.set(t,u)}else{var c=a.get(t);c&&("edge"===e.getElementType(t)?r.bubbleSets.removeEdge(c):r.bubbleSets[s](c),a.delete(t))}}))};m(d,!1,!0),m(c,!0,!0),m(y,!1,!1),m(p,!0,!1);var b=r.bubbleSets.compute().sample(8).simplify(0).bSplines().simplify(0);return r.path=ef(b.points.map(id)),r.path},r.bindEvents(),r.bubbleSets=new tE(r.options),r}return N(e,t),b(e,[{key:"bindEvents",value:function(){this.context.graph.on($c.AFTER_RENDER,this.drawBubbleSets),this.context.graph.on($c.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath)}},{key:"init",value:function(){this.bubbleSets=new tE(this.options),this.members=new Map,this.avoidMembers=new Map}},{key:"parseOptions",value:function(){var t=this.options,e=t.type,n=t.key,r=t.members,i=t.avoidMembers,a=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(t,["type","key","members","avoidMembers"]),o=Object.keys(a).reduce((function(t,e){return e in Zw?t.bubbleSetOptions[e]=a[e]:t.style[e]=a[e],t}),{style:{},bubbleSetOptions:{}});return Object.assign({type:e,key:n,members:r,avoidMembers:i},o)}},{key:"addMember",value:function(t){var e=this,n=Array.isArray(t)?t:[t];n.some((function(t){return e.options.avoidMembers.includes(t)}))&&(this.options.avoidMembers=this.options.avoidMembers.filter((function(t){return!n.includes(t)}))),this.options.members=w(new Set([].concat(w(this.options.members),w(n)))),this.drawBubbleSets()}},{key:"removeMember",value:function(t){var e=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter((function(t){return!e.includes(t)})),this.drawBubbleSets()}},{key:"updateMember",value:function(t){this.options.members=cn(t)?t(this.options.members):t,this.drawBubbleSets()}},{key:"getMember",value:function(){return this.options.members}},{key:"addAvoidMember",value:function(t){var e=this,n=Array.isArray(t)?t:[t];n.some((function(t){return e.options.members.includes(t)}))&&(this.options.members=this.options.members.filter((function(t){return!n.includes(t)}))),this.options.avoidMembers=w(new Set([].concat(w(this.options.avoidMembers),w(n)))),this.drawBubbleSets()}},{key:"removeAvoidMember",value:function(t){var e=Array.isArray(t)?t:[t];this.options.avoidMembers.some((function(t){return e.includes(t)}))&&(this.options.avoidMembers=this.options.avoidMembers.filter((function(t){return!e.includes(t)})),this.drawBubbleSets())}},{key:"updateAvoidMember",value:function(t){this.options.avoidMembers=Array.isArray(t)?t:[t],this.drawBubbleSets()}},{key:"getAvoidMember",value:function(){return this.options.avoidMembers}},{key:"destroy",value:function(){this.context.graph.off($c.AFTER_RENDER,this.drawBubbleSets),this.context.graph.off($c.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath),this.shape.destroy(),dn(e,"destroy",this,3)([])}}])}(gw);eE.defaultOptions=Object.assign({members:[],avoidMembers:[],fill:"lightblue",fillOpacity:.2,stroke:"blue",strokeOpacity:.2},Zw);var nE=function(t,e){return(Array.isArray(e)?e:[e]).map((function(e){var n=t.getElementRenderBounds(e);return new Dw(n.min[0],n.min[1],Ll(n),Dl(n))}))},rE=function(t,e){return(Array.isArray(e)?e:[e]).map((function(e){var n=t.getEdgeData(e),r=t.getElementPosition(n.source),i=t.getElementPosition(n.target);return Sw.from({x1:r[0],y1:r[1],x2:i[0],y2:i[1]})}))},iE=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,n])).setOptions=function(t){Object.entries({cameraType:"setType",near:"setNear",far:"setFar",fov:"setFov",aspect:"setAspect",projectionMode:"setProjectionMode",distance:"setDistance",minDistance:"setMinDistance",maxDistance:"setMaxDistance",roll:"setRoll",elevation:"setElevation",azimuth:"setAzimuth"}).forEach((function(e){var n=h(e,2),i=n[0],a=n[1],o=t[i];if(void 0!==o){var s=function(t,e){switch(t){case"projectionMode":return"perspective"===e?1:0;case"cameraType":return{orbiting:0,exploring:1,tracking:2}[e];case"aspect":return"number"==typeof e?e:r.getCanvasAspect();default:return e}}(i,o);r.context.canvas.getCamera()[a](s)}}))},r.bindEvents(),r}return N(e,t),b(e,[{key:"update",value:function(t){this.setOptions(t),dn(e,"update",this,3)([t])}},{key:"bindEvents",value:function(){var t=this;this.context.graph.once($c.BEFORE_DRAW,(function(){return t.setOptions(t.options)}))}},{key:"getCanvasAspect",value:function(){var t=h(this.context.viewport.getCanvasSize(),2);return t[0]/t[1]}}])}(gw);function aE(t){return'\n    <ul class="g6-contextmenu-ul">\n      '.concat(t.map((function(t){return'<li  class="g6-contextmenu-li" value="'.concat(t.value,'">').concat(t.name,"</li>")})).join(""),"\n    </ul>\n  ")}var oE=function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},sE=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).targetElement=null,r.onTriggerEvent=function(t){var e;null===(e=t.preventDefault)||void 0===e||e.call(t),r.show(t)},r.onMenuItemClick=function(t){var e=r.options,n=e.onClick,i=e.trigger;if(t.target instanceof HTMLElement&&t.target.className.includes("g6-contextmenu-li")){var a=t.target.getAttribute("value");null==n||n(a,t.target,r.targetElement),r.hide()}"click"!==i&&r.hide()},r.initElement(),r.update(n),r}return N(e,t),b(e,[{key:"initElement",value:function(){this.$element=yw("contextmenu",!1,{zIndex:"99"});var t=this.options.className;t&&this.$element.classList.add(t),this.context.canvas.getContainer().appendChild(this.$element),mw("g6-contextmenu-css","style",{},"\n  .g6-contextmenu {\n    font-size: 12px;\n    background-color: rgba(255, 255, 255, 0.96);\n    border-radius: 4px;\n    overflow: hidden;\n    box-shadow: rgba(0, 0, 0, 0.12) 0px 6px 12px 0px;\n    transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1) 0s, left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s;\n  }\n\n  .g6-contextmenu-ul {\n    max-width: 256px;\n    min-width: 96px;\n    list-style: none;\n    padding: 0;\n    margin: 0;\n  }\n\n  .g6-contextmenu-li {\n    padding: 8px 12px;\n    cursor: pointer;\n    user-select: none;\n  }\n\n  .g6-contextmenu-li:hover {\n    background-color: #f5f5f5;\n    cursor: pointer;\n  }\n",document.head)}},{key:"show",value:function(t){return oE(this,void 0,void 0,Tn().mark((function e(){var n,r,i,a,o;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.options,r=n.enable,i=n.offset,("function"!=typeof r||r(t))&&r){e.next=4;break}return this.hide(),e.abrupt("return");case 4:return e.next=6,this.getDOMContent(t);case 6:(a=e.sent)instanceof HTMLElement?(this.$element.innerHTML="",this.$element.appendChild(a)):this.$element.innerHTML=a,o=this.context.graph.getCanvas().getContainer().getBoundingClientRect(),this.$element.style.left="".concat(t.client.x-o.left+i[0],"px"),this.$element.style.top="".concat(t.client.y-o.top+i[1],"px"),this.$element.style.display="block",this.targetElement=t.target;case 13:case"end":return e.stop()}}),e,this)})))}},{key:"hide",value:function(){this.$element.style.display="none",this.targetElement=null}},{key:"update",value:function(t){this.unbindEvents(),dn(e,"update",this,3)([t]),this.bindEvents()}},{key:"destroy",value:function(){this.unbindEvents(),dn(e,"destroy",this,3)([]),this.$element.remove()}},{key:"getDOMContent",value:function(t){return oE(this,void 0,void 0,Tn().mark((function e(){var n,r,i;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.options,r=n.getContent,!(i=n.getItems)){e.next=7;break}return e.t0=aE,e.next=5,i(t);case 5:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 7:return e.next=9,r(t);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this)})))}},{key:"bindEvents",value:function(){var t=this.context.graph,e=this.options.trigger;t.on("canvas:".concat(e),this.onTriggerEvent),t.on("node:".concat(e),this.onTriggerEvent),t.on("edge:".concat(e),this.onTriggerEvent),t.on("combo:".concat(e),this.onTriggerEvent),document.addEventListener("click",this.onMenuItemClick)}},{key:"unbindEvents",value:function(){var t=this.context.graph,e=this.options.trigger;t.off("canvas:".concat(e),this.onTriggerEvent),t.off("node:".concat(e),this.onTriggerEvent),t.off("edge:".concat(e),this.onTriggerEvent),t.off("combo:".concat(e),this.onTriggerEvent),document.removeEventListener("click",this.onMenuItemClick)}}])}(gw);sE.defaultOptions={trigger:"contextmenu",offset:[4,4],loadingContent:'<div class="g6-contextmenu-loading">Loading...</div>',getContent:function(){return"It is a empty context menu."},enable:function(){return!0}};var uE=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).edgeBundles={},r.edgePoints={},r.onBundle=function(){var t=r.context,e=t.model,n=t.element,i=e.getEdgeData();r.divideEdges(r.options.divisions);for(var a=r.options,o=a.cycles,s=a.iterRate,u=a.divRate,c=r.options,l=c.lambda,h=c.divisions,d=c.iterations,f=0;f<o;f++){for(var v=function(){var t={};i.forEach((function(e){var n;if(e.source!==e.target){var i=yh(e);t[i]=r.getEdgeForces(e,h,l);for(var a=0;a<h+1;a++)(n=r.edgePoints)[i]||(n[i]=[]),r.edgePoints[i][a]=Bh(r.edgePoints[i][a],t[i][a])}}))},p=0;p<d;p++)v();l/=2,h*=u,d*=s,r.divideEdges(h)}i.forEach((function(t){var e=yh(t),i=n.getElement(e);null==i||i.update({d:Tp(r.edgePoints[e])})}))},r.bindEvents(),r}return N(e,t),b(e,[{key:"nodeMap",get:function(){var t=this.context.model.getNodeData();return Object.fromEntries(t.map((function(t){return[yh(t),Kh(ed(t))]})))}},{key:"divideEdges",value:function(t){var e=this;this.context.model.getEdgeData().forEach((function(n){var r,i=yh(n);(r=e.edgePoints)[i]||(r[i]=[]);var a=e.nodeMap[n.source],o=e.nodeMap[n.target];if(1===t)e.edgePoints[i].push(a),e.edgePoints[i].push(Vh(Bh(a,o),2)),e.edgePoints[i].push(o);else{for(var s=(0===e.edgePoints[i].length?Hh(a,o):pE(e.edgePoints[i]))/(t+1),u=s,c=[a],l=1;l<e.edgePoints[i].length;l++){for(var h=e.edgePoints[i][l-1],d=e.edgePoints[i][l],f=Hh(d,h);f>u;){var v=u/f,p=Bh(h,Gh(zh(d,h),v));c.push(p),f-=u,u=s}u-=f}c.push(o),e.edgePoints[i]=c}}))}},{key:"getVectorPosition",value:function(t){var e=this.nodeMap[t.source],n=this.nodeMap[t.target],r=h(zh(n,e),2);return{source:e,target:n,vx:r[0],vy:r[1],length:Hh(e,n)}}},{key:"measureEdgeCompatibility",value:function(t,e){var n=this.getVectorPosition(t),r=this.getVectorPosition(e);return cE(n,r)*lE(n,r)*hE(n,r)*vE(n,r)}},{key:"getEdgeBundles",value:function(){var t=this,e={},n=this.options.bundleThreshold,r=this.context.model.getEdgeData();return r.forEach((function(i,a){r.forEach((function(r,o){var s,u;o<=a||t.measureEdgeCompatibility(i,r)>=n&&(e[s=yh(i)]||(e[s]=[]),e[yh(i)].push(r),e[u=yh(r)]||(e[u]=[]),e[yh(r)].push(i))}))})),e}},{key:"getSpringForce",value:function(t,e){var n=t.pre,r=t.cur;return Gh(zh(Bh(n,t.next),Gh(r,2)),e)}},{key:"getElectrostaticForce",value:function(t,e){var n=this;qd(this.edgeBundles)&&(this.edgeBundles=this.getEdgeBundles());var r=this.edgeBundles[yh(e)],i=[0,0];return null==r||r.forEach((function(r){var a=n.edgePoints[yh(r)][t],o=n.edgePoints[yh(e)][t],s=zh(a,o),u=Hh(a,o);i=Bh(i,Gh(s,1/u))})),i}},{key:"getEdgeForces",value:function(t,e,n){for(var r=this.nodeMap[t.source],i=this.nodeMap[t.target],a=this.options.K/(Hh(r,i)*(e+1)),o=[[0,0]],s=yh(t),u=1;u<e;u++){var c=this.getSpringForce({pre:this.edgePoints[s][u-1],cur:this.edgePoints[s][u],next:this.edgePoints[s][u+1]||[0,0]},a),l=this.getElectrostaticForce(u,t);o.push(Gh(Bh(c,l),n))}return o.push([0,0]),o}},{key:"bindEvents",value:function(){this.context.graph.on($c.AFTER_RENDER,this.onBundle)}},{key:"unbindEvents",value:function(){this.context.graph.off($c.AFTER_RENDER,this.onBundle)}},{key:"destroy",value:function(){this.unbindEvents(),dn(e,"destroy",this,3)([])}}])}(gw);uE.defaultOptions={K:.1,lambda:.1,divisions:1,divRate:2,cycles:6,iterations:90,iterRate:2/3,bundleThreshold:.6};var cE=function(t,e){return Math.abs((n=[t.vx,t.vy],r=[e.vx,e.vy],n.reduce((function(t,e,n){return t+e*r[n]}),0)/(t.length*e.length)));var n,r},lE=function(t,e){var n=(t.length+e.length)/2;return 2/(n/Math.min(t.length,e.length)+Math.max(t.length,e.length)/n)},hE=function(t,e){var n=(t.length+e.length)/2;return n/(n+Hh(Vh(Bh(t.source,t.target),2),Vh(Bh(e.source,e.target),2)))},dE=function(t,e){if(e.source[0]===e.target[0])return[e.source[0],t[1]];if(e.source[1]===e.target[1])return[t[0],e.source[1]];var n=(e.source[1]-e.target[1])/(e.source[0]-e.target[0]),r=(n*n*e.source[0]+n*(t[1]-e.source[1])+t[0])/(n*n+1);return[r,n*(r-e.source[0])+e.source[1]]},fE=function(t,e){var n=dE(e.source,t),r=dE(e.target,t),i=Vh(Bh(n,r),2),a=Vh(Bh(t.source,t.target),2);return 0===Hh(n,r)?0:Math.max(0,1-2*Hh(a,i)/Hh(n,r))},vE=function(t,e){return Math.min(fE(t,e),fE(e,t))},pE=function(t){for(var e=0,n=1;n<t.length;n++)e+=Hh(t[n],t[n-1]);return e},gE={fill:"#fff",fillOpacity:1,lineWidth:1,stroke:"#000",strokeOpacity:.8,zIndex:-1/0},yE=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).shapes=new Map,r.r=r.options.r,r.onEdgeFilter=function(t){if("drag"!==r.options.trigger||!r.isLensOn){var e=id(t.canvas);r.renderLens(e),r.renderFocusElements()}},r.renderLens=function(t){var e=Object.assign({},gE,r.options.style);r.isLensOn||(r.lens=new ff({style:e}),r.canvas.appendChild(r.lens)),Object.assign(e,ad(t),{size:2*r.r}),r.lens.update(e)},r.getFilterData=function(){var t=r.options.filter,e=r.context.model.getData();if(!t)return e;var n=e.nodes,i=e.edges,a=e.combos;return{nodes:n.filter((function(e){return t(yh(e),"node")})),edges:i.filter((function(e){return t(yh(e),"edge")})),combos:a.filter((function(e){return t(yh(e),"combo")}))}},r.getFocusElements=function(t){var e=r.getFilterData(),n=e.nodes,i=e.edges,a=n.filter((function(e){return Hh(ed(e),t)<r.r})),o=a.map((function(t){return yh(t)}));return{nodes:a,edges:i.filter((function(t){var e=t.source,n=t.target,i=o.includes(e),a=o.includes(n);switch(r.options.nodeType){case"both":return i&&a;case"either":return i!==a;case"source":return i&&!a;case"target":return!i&&a;default:return!1}}))}},r.renderFocusElements=function(){var t=r.context,e=t.element,n=t.graph;if(r.isLensOn){var i=r.lens.getCenter(),a=r.getFocusElements(i),o=a.nodes,s=a.edges,u=new Set,c=function(t){var i=yh(t);u.add(i);var a=e.getElement(i);if(a){var o=r.shapes.get(i)||a.cloneNode();o.setPosition(a.getPosition()),o.id=a.id,r.shapes.has(i)?Object.entries(a.attributes).forEach((function(t){var e=h(t,2),n=e[0],r=e[1];o.style[n]!==r&&(o.style[n]=r)})):(r.canvas.appendChild(o),r.shapes.set(i,o));var s=n.getElementType(i),c=r.getElementStyle(s,t);o.update(c)}};o.forEach(c),s.forEach(c),r.shapes.forEach((function(t,e){u.has(e)||(t.destroy(),r.shapes.delete(e))}))}},r.scaleRByWheel=function(t){var e;r.options.preventDefault&&t.preventDefault();var n=t.clientX,i=t.clientY,a=t.deltaX,o=t.deltaY,s=r.context,u=s.graph,c=s.canvas,l=u.getCanvasByClient([n,i]),h=null===(e=r.lens)||void 0===e?void 0:e.getCenter();if(r.isLensOn&&!(Hh(l,h)>r.r)){var d=r.options,f=d.maxR,v=d.minR,p=a+o>0?1/.95:.95,g=Math.min.apply(Math,w(c.getSize()))/2;r.r=Math.max(v||0,Math.min(f||g,r.r*p)),r.renderLens(h),r.renderFocusElements()}},r.isLensDragging=!1,r.onDragStart=function(t){var e,n=id(t.canvas),i=null===(e=r.lens)||void 0===e?void 0:e.getCenter();!r.isLensOn||Hh(n,i)>r.r||(r.isLensDragging=!0)},r.onDrag=function(t){if(r.isLensDragging){var e=id(t.canvas);r.renderLens(e),r.renderFocusElements()}},r.onDragEnd=function(){r.isLensDragging=!1},r.bindEvents(),r}return N(e,t),b(e,[{key:"canvas",get:function(){return this.context.canvas.getLayer("transient")}},{key:"isLensOn",get:function(){return this.lens&&!this.lens.destroyed}},{key:"getElementStyle",value:function(t,e){var n="node"===t?this.options.nodeStyle:this.options.edgeStyle;return"function"==typeof n?n(e):n}},{key:"graphDom",get:function(){return this.context.graph.getCanvas().getContextService().getDomElement()}},{key:"bindEvents",value:function(){var t,e=this.context.graph,n=this.options,r=n.trigger,i=n.scaleRBy,a=e.getCanvas().getLayer();["click","drag"].includes(r)&&a.addEventListener(qc.CLICK,this.onEdgeFilter),"pointermove"===r?a.addEventListener(qc.POINTER_MOVE,this.onEdgeFilter):"drag"===r&&(a.addEventListener(qc.DRAG_START,this.onDragStart),a.addEventListener(qc.DRAG,this.onDrag),a.addEventListener(qc.DRAG_END,this.onDragEnd)),"wheel"===i&&(null===(t=this.graphDom)||void 0===t||t.addEventListener(qc.WHEEL,this.scaleRByWheel,{passive:!1}))}},{key:"unbindEvents",value:function(){var t,e=this.context.graph,n=this.options,r=n.trigger,i=n.scaleRBy,a=e.getCanvas().getLayer();["click","drag"].includes(r)&&a.removeEventListener(qc.CLICK,this.onEdgeFilter),"pointermove"===r?a.removeEventListener(qc.POINTER_MOVE,this.onEdgeFilter):"drag"===r&&(a.removeEventListener(qc.DRAG_START,this.onDragStart),a.removeEventListener(qc.DRAG,this.onDrag),a.removeEventListener(qc.DRAG_END,this.onDragEnd)),"wheel"===i&&(null===(t=this.graphDom)||void 0===t||t.removeEventListener(qc.WHEEL,this.scaleRByWheel))}},{key:"update",value:function(t){this.unbindEvents(),dn(e,"update",this,3)([t]),this.bindEvents()}},{key:"destroy",value:function(){var t=this;this.unbindEvents(),this.isLensOn&&this.lens.destroy(),this.shapes.forEach((function(e,n){e.destroy(),t.shapes.delete(n)})),dn(e,"destroy",this,3)([])}}])}(gw);yE.defaultOptions={trigger:"pointermove",r:60,nodeType:"both",filter:function(){return!0},style:{lineWidth:2},nodeStyle:{label:!1},edgeStyle:{label:!0},scaleRBy:"wheel",preventDefault:!0};var mE={fill:"#ccc",fillOpacity:.1,lineWidth:2,stroke:"#000",strokeOpacity:.8,labelFontSize:12},bE=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).r=r.options.r,r.d=r.options.d,r.onCreateFisheye=function(t){if("drag"!==r.options.trigger||!r.isLensOn){var e=id(t.canvas);r.onMagnify(e)}},r.onMagnify=function(t){t.some(isNaN)||(r.renderLens(t),r.renderFocusElements())},r.renderLens=function(t){var e=Object.assign({},mE,r.options.style);r.isLensOn||(r.lens=new ff({style:e}),r.canvas.appendChild(r.lens)),Object.assign(e,ad(t),{size:2*r.r,label:r.options.showDPercent,labelText:r.getDPercent()}),r.lens.update(e)},r.getDPercent=function(){var t=r.options,e=t.minD,n=t.maxD,i=Math.round((r.d-e)/(n-e)*100);return"".concat(i,"%")},r.prevMagnifiedStyleMap=new Map,r.prevOriginStyleMap=new Map,r.renderFocusElements=function(){if(r.isLensOn){var t=r.context.graph,e=r.lens.getCenter(),n=(r.d+1)*r.r,i=new Map,a=new Map;t.getNodeData().forEach((function(o){var s=ed(o),u=Hh(s,e);if(!(u>r.r)){var c=n*u/(r.d*u+r.r),l=h(s,2),d=l[0],f=l[1],v=h(e,2),p=v[0],g=v[1],y=[p+c*((d-p)/u),g+c*((f-g)/u)],m=yh(o),b=r.getNodeStyle(o),x=ep(t.getElementRenderStyle(m),Object.keys(b));i.set(m,Object.assign(Object.assign({},ad(y)),b)),a.set(m,Object.assign(Object.assign({},ad(s)),x))}})),r.updateStyle(i,a)}},r.getNodeStyle=function(t){var e=r.options.nodeStyle;return"function"==typeof e?e(t):e},r.updateStyle=function(t,e){var n=r.context,i=n.graph,a=n.element,o=Ah(Array.from(r.prevMagnifiedStyleMap.keys()),Array.from(t.keys()),(function(t){return t})),s=o.enter,u=o.exit,c=o.keep,l=new Set,h=function(t,e){var n=a.getElement(t);null==n||n.update(e),i.getRelatedEdgesData(t).forEach((function(t){l.add(yh(t))}))};[].concat(w(s),w(c)).forEach((function(e){h(e,t.get(e))})),u.forEach((function(t){h(t,r.prevOriginStyleMap.get(t)),r.prevOriginStyleMap.delete(t)})),l.forEach((function(t){var e=a.getElement(t);null==e||e.update({})})),r.prevMagnifiedStyleMap=t,e.forEach((function(t,e){r.prevOriginStyleMap.has(e)||r.prevOriginStyleMap.set(e,t)}))},r.isWheelValid=function(t){if(r.options.preventDefault&&t.preventDefault(),!r.isLensOn)return!1;var e=t.clientX,n=t.clientY;return!(Hh(r.context.graph.getCanvasByClient([e,n]),r.lens.getCenter())>r.r)},r.scaleR=function(t){var e=r.options,n=e.maxR,i=e.minR,a=t?1/.95:.95,o=Math.min.apply(Math,w(r.context.canvas.getSize()))/2;r.r=Math.max(i||0,Math.min(n||o,r.r*a))},r.scaleD=function(t){var e=r.options,n=e.maxD,i=e.minD,a=t?r.d+.1:r.d-.1;r.d=Math.max(i,Math.min(n,a))},r.scaleRByWheel=function(t){if(r.isWheelValid(t)){var e=t.deltaX,n=t.deltaY;r.scaleR(e+n>0);var i=r.lens.getCenter();r.onMagnify(i)}},r.scaleDByWheel=function(t){if(r.isWheelValid(t)){var e=t.deltaX,n=t.deltaY;r.scaleD(e+n>0);var i=r.lens.getCenter();r.onMagnify(i)}},r.isDragValid=function(t){return r.options.preventDefault&&t.preventDefault(),!(!r.isLensOn||Hh(id(t.canvas),r.lens.getCenter())>r.r)},r.isLensDragging=!1,r.onDragStart=function(t){r.isDragValid(t)&&(r.isLensDragging=!0)},r.onDrag=function(t){if(r.isLensDragging){var e=id(t.canvas);r.onMagnify(e)}},r.onDragEnd=function(){r.isLensDragging=!1},r.scaleRByDrag=function(t){if(r.isLensDragging){var e=t.dx,n=t.dy;r.scaleR(e-n>0);var i=r.lens.getCenter();r.onMagnify(i)}},r.scaleDByDrag=function(t){if(r.isLensDragging){var e=t.dx,n=t.dy;r.scaleD(e-n>0);var i=r.lens.getCenter();r.onMagnify(i)}},r.bindEvents(),r}return N(e,t),b(e,[{key:"canvas",get:function(){return this.context.canvas.getLayer("transient")}},{key:"isLensOn",get:function(){return this.lens&&!this.lens.destroyed}},{key:"graphDom",get:function(){return this.context.graph.getCanvas().getContextService().getDomElement()}},{key:"bindEvents",value:function(){var t,e=this.context.graph,n=this.options,r=n.trigger,i=n.scaleRBy,a=n.scaleDBy,o=e.getCanvas().getLayer();if(["click","drag"].includes(r)&&o.addEventListener(qc.CLICK,this.onCreateFisheye),"pointermove"===r&&o.addEventListener(qc.POINTER_MOVE,this.onCreateFisheye),"drag"===r||"drag"===i||"drag"===a){o.addEventListener(qc.DRAG_START,this.onDragStart),o.addEventListener(qc.DRAG_END,this.onDragEnd);var s="drag"===r?this.onDrag:"drag"===i?this.scaleRByDrag:this.scaleDByDrag;o.addEventListener(qc.DRAG,s)}if("wheel"===i||"wheel"===a){var u="wheel"===i?this.scaleRByWheel:this.scaleDByWheel;null===(t=this.graphDom)||void 0===t||t.addEventListener(qc.WHEEL,u,{passive:!1})}}},{key:"unbindEvents",value:function(){var t,e=this.context.graph,n=this.options,r=n.trigger,i=n.scaleRBy,a=n.scaleDBy,o=e.getCanvas().getLayer();if(["click","drag"].includes(r)&&o.removeEventListener(qc.CLICK,this.onCreateFisheye),"pointermove"===r&&o.removeEventListener(qc.POINTER_MOVE,this.onCreateFisheye),"drag"===r||"drag"===i||"drag"===a){o.removeEventListener(qc.DRAG_START,this.onDragStart),o.removeEventListener(qc.DRAG_END,this.onDragEnd);var s="drag"===r?this.onDrag:"drag"===i?this.scaleRByDrag:this.scaleDByDrag;o.removeEventListener(qc.DRAG,s)}if("wheel"===i||"wheel"===a){var u="wheel"===i?this.scaleRByWheel:this.scaleDByWheel;null===(t=this.graphDom)||void 0===t||t.removeEventListener(qc.WHEEL,u)}}},{key:"update",value:function(t){this.unbindEvents(),dn(e,"update",this,3)([t]),this.bindEvents()}},{key:"destroy",value:function(){var t;this.unbindEvents(),this.isLensOn&&(null===(t=this.lens)||void 0===t||t.destroy()),this.prevMagnifiedStyleMap.clear(),this.prevOriginStyleMap.clear(),dn(e,"destroy",this,3)([])}}])}(gw);bE.defaultOptions={trigger:"pointermove",r:120,d:1.5,maxD:5,minD:0,showDPercent:!0,style:{},nodeStyle:{label:!0},preventDefault:!0};var xE=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).$el=r.context.canvas.getContainer(),r.graphSize=[0,0],r.onFullscreenChange=function(){var t,e,n,i,a=!!document.fullscreenElement;r.options.autoFit&&r.setGraphSize(a),a?null===(e=(t=r.options).onEnter)||void 0===e||e.call(t):null===(i=(n=r.options).onExit)||void 0===i||i.call(n)},r.shortcut=new md(t.graph),r.bindEvents(),r.style=document.createElement("style"),document.head.appendChild(r.style),r.style.innerHTML="\n      :not(:root):fullscreen::backdrop {\n        background: transparent;\n      }\n    ",r}return N(e,t),b(e,[{key:"bindEvents",value:function(){var t=this;this.unbindEvents(),this.shortcut.unbindAll();var e=this.options.trigger,n=e.request,r=void 0===n?[]:n,i=e.exit,a=void 0===i?[]:i;this.shortcut.bind(r,this.request),this.shortcut.bind(a,this.exit),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach((function(e){document.addEventListener(e,t.onFullscreenChange,!1)}))}},{key:"unbindEvents",value:function(){var t=this;this.shortcut.unbindAll(),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach((function(e){document.removeEventListener(e,t.onFullscreenChange,!1)}))}},{key:"setGraphSize",value:function(){var t,e,n,r;if(arguments.length>0&&void 0!==arguments[0]&&!arguments[0]){var i=h(this.graphSize,2);n=i[0],r=i[1]}else n=(null===(t=globalThis.screen)||void 0===t?void 0:t.width)||0,r=(null===(e=globalThis.screen)||void 0===e?void 0:e.height)||0,this.graphSize=this.context.graph.getSize();this.context.graph.setSize(n,r),this.context.graph.render()}},{key:"request",value:function(){!document.fullscreenElement&&(document.fullscreenEnabled||Reflect.get(document,"webkitFullscreenEnabled")||Reflect.get(document,"mozFullscreenEnabled")||Reflect.get(document,"msFullscreenEnabled"))&&this.$el.requestFullscreen().catch((function(t){ll.warn("Error attempting to enable full-screen: ".concat(t.message," (").concat(t.name,")"))}))}},{key:"exit",value:function(){document.fullscreenElement&&document.exitFullscreen()}},{key:"update",value:function(t){this.unbindEvents(),dn(e,"update",this,3)([t]),this.bindEvents()}},{key:"destroy",value:function(){this.exit(),this.style.remove(),dn(e,"destroy",this,3)([])}}])}(gw);xE.defaultOptions={trigger:{},autoFit:!0};var wE=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).$element=yw("grid-line",!0),r.offset=[0,0],r.onTransform=function(t){if(r.options.follow){var e=t.data.translate;e&&r.updateOffset(e)}},r.context.canvas.getContainer().prepend(r.$element),r.updateStyle(),r.bindEvents(),r}return N(e,t),b(e,[{key:"update",value:function(t){dn(e,"update",this,3)([t]),this.updateStyle()}},{key:"bindEvents",value:function(){this.context.graph.on($c.AFTER_TRANSFORM,this.onTransform)}},{key:"updateStyle",value:function(){var t=this.options,e=t.size,n=t.stroke,r=t.lineWidth,i=t.border,a=t.borderLineWidth,o=t.borderStroke,s=t.borderStyle;Object.assign(this.$element.style,{border:i?"".concat(a,"px ").concat(s," ").concat(o):"none",backgroundImage:"linear-gradient(".concat(n," ").concat(r,"px, transparent ").concat(r,"px), linear-gradient(90deg, ").concat(n," ").concat(r,"px, transparent ").concat(r,"px)"),backgroundSize:"".concat(e,"px ").concat(e,"px"),backgroundRepeat:"repeat"})}},{key:"updateOffset",value:function(t){var e,n;this.offset=(e=Bh(this.offset,t),n=this.options.size,e.map((function(t){return t%n}))),this.$element.style.backgroundPosition="".concat(this.offset[0],"px ").concat(this.offset[1],"px")}},{key:"destroy",value:function(){this.context.graph.off($c.AFTER_TRANSFORM,this.onTransform),this.$element.remove(),dn(e,"destroy",this,3)([])}}])}(gw);function EE(t){var e={Added:new Map,Updated:new Map,Removed:new Map};return t.forEach((function(t){var n=t.type,r=t.value,i=yh(r);if("NodeAdded"===n||"EdgeAdded"===n||"ComboAdded"===n)e.Added.set(i,t);else if("NodeUpdated"===n||"EdgeUpdated"===n||"ComboUpdated"===n)if(e.Added.has(i))e.Added.set(i,{type:n.replace("Updated","Added"),value:r});else if(e.Updated.has(i)){var a=e.Updated.get(i).original;e.Updated.set(i,{type:n,value:r,original:a})}else e.Removed.has(i)||e.Updated.set(i,t);else"NodeRemoved"!==n&&"EdgeRemoved"!==n&&"ComboRemoved"!==n||(e.Added.has(i)?e.Added.delete(i):e.Updated.has(i)?(e.Updated.delete(i),e.Removed.set(i,t)):e.Removed.set(i,t))})),[].concat(w(Array.from(e.Added.values())),w(Array.from(e.Updated.values())),w(Array.from(e.Removed.values())))}function kE(t){var e=Sl(t,(function(t){return t.type})),n=e.NodeAdded,r=void 0===n?[]:n,i=e.NodeUpdated,a=void 0===i?[]:i,o=e.NodeRemoved,s=void 0===o?[]:o,u=e.EdgeAdded,c=void 0===u?[]:u,l=e.EdgeUpdated,h=void 0===l?[]:l,d=e.EdgeRemoved,f=void 0===d?[]:d,v=e.ComboAdded,p=void 0===v?[]:v,g=e.ComboUpdated,y=void 0===g?[]:g,m=e.ComboRemoved;return{add:{nodes:r,edges:c,combos:p},update:{nodes:a,edges:h,combos:y},remove:{nodes:s,edges:f,combos:void 0===m?[]:m}}}function ME(t,e){for(var n in t)ln(t[n])&&!Array.isArray(t[n])&&null!==t[n]?(e[n]||(e[n]={}),ME(t[n],e[n])):void 0===e[n]&&(e[n]=vl(n))}function SE(t){var e=arguments.length>2?arguments[2]:void 0,n={animation:arguments.length>1&&void 0!==arguments[1]&&arguments[1],current:{add:{},update:{},remove:{}},original:{add:{},update:{},remove:{}}},r=kE(EE(t)),i=r.add,a=r.update,o=r.remove;return["nodes","edges","combos"].forEach((function(t){a[t]&&a[t].forEach((function(r){var i,a,o=Object.assign({},r.value),s=Object.assign({},r.original);if(e){var u=e.graph.getElementType(yh(r.original)),c="edge"===u?"stroke":"fill",l=e.element.getElementComputedStyle(u,r.original);s=Object.assign(Object.assign({},r.original),{style:Object.assign(v({},c,l[c]),r.original.style)})}ME(o,s),(i=n.current.update)[t]||(i[t]=[]),n.current.update[t].push(o),(a=n.original.update)[t]||(a[t]=[]),n.original.update[t].push(s)})),i[t]&&i[t].forEach((function(e){var r,i,a=Object.assign({},e.value);(r=n.current.add)[t]||(r[t]=[]),n.current.add[t].push(a),(i=n.original.remove)[t]||(i[t]=[]),n.original.remove[t].push(a)})),o[t]&&o[t].forEach((function(e){var r,i,a=Object.assign({},e.value);(r=n.current.remove)[t]||(r[t]=[]),n.current.remove[t].push(a),(i=n.original.add)[t]||(i[t]=[]),n.original.add[t].push(a)}))})),n}wE.defaultOptions={border:!0,borderLineWidth:1,borderStroke:"#eee",borderStyle:"solid",lineWidth:1,size:20,stroke:"#eee"};var OE=function(t){function e(t,n){var r;y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).batchChanges=null,r.batchAnimation=!1,r.undoStack=[],r.redoStack=[],r.freezed=!1,r.executeCommand=function(t){var e,n,i,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];r.freezed=!0,null===(n=(e=r.options).executeCommand)||void 0===n||n.call(e,t);var o=a?t.original:t.current;r.context.graph.addData(o.add),r.context.graph.updateData(o.update),r.context.graph.removeData(bh(o.remove,!1)),null===(i=r.context.element)||void 0===i||i.draw({silence:!0,animation:t.animation}),r.freezed=!1},r.addCommand=function(t){var e;if(!r.freezed){if(t.type===$c.AFTER_DRAW){var n=t.data,i=n.dataChanges,a=void 0===i?[]:i,o=n.animation,s=void 0===o||o;if(null===(e=r.context.batch)||void 0===e?void 0:e.isBatching){if(!r.batchChanges)return;return r.batchChanges.push(a),void(r.batchAnimation&&(r.batchAnimation=s))}r.batchChanges=[a],r.batchAnimation=s}r.undoStackPush(SE(r.batchChanges.flat(),r.batchAnimation,r.context)),r.notify(Zc.ADD,r.undoStack[r.undoStack.length-1])}},r.initBatchCommand=function(t){var e=t.data.initiate;r.batchAnimation=!1,e?r.batchChanges=[]:r.undoStack.pop()||(r.batchChanges=null)},r.emitter=new Pg;var i=r.context.graph;return i.on($c.AFTER_DRAW,r.addCommand),i.on($c.BATCH_START,r.initBatchCommand),i.on($c.BATCH_END,r.addCommand),r}return N(e,t),b(e,[{key:"canUndo",value:function(){return this.undoStack.length>0}},{key:"canRedo",value:function(){return this.redoStack.length>0}},{key:"undo",value:function(){var t,e,n,r,i=this.undoStack.pop();if(i){if(this.executeCommand(i),!1===(null===(e=(t=this.options).beforeAddCommand)||void 0===e?void 0:e.call(t,i,!1)))return;this.redoStack.push(i),null===(r=(n=this.options).afterAddCommand)||void 0===r||r.call(n,i,!1),this.notify(Zc.UNDO,i)}return this}},{key:"redo",value:function(){var t=this.redoStack.pop();return t&&(this.executeCommand(t,!1),this.undoStackPush(t),this.notify(Zc.REDO,t)),this}},{key:"undoAndCancel",value:function(){var t=this.undoStack.pop();return t&&(this.executeCommand(t,!1),this.redoStack=[],this.notify(Zc.CANCEL,t)),this}},{key:"undoStackPush",value:function(t){var e,n,r,i,a=this.options.stackSize;0!==a&&this.undoStack.length>=a&&this.undoStack.shift(),!1!==(null===(n=(e=this.options).beforeAddCommand)||void 0===n?void 0:n.call(e,t,!0))&&(this.undoStack.push(t),null===(i=(r=this.options).afterAddCommand)||void 0===i||i.call(r,t,!0))}},{key:"clear",value:function(){this.undoStack=[],this.redoStack=[],this.batchChanges=null,this.batchAnimation=!1,this.notify(Zc.CLEAR,null)}},{key:"notify",value:function(t,e){this.emitter.emit(t,{cmd:e}),this.emitter.emit(Zc.CHANGE,{cmd:e})}},{key:"on",value:function(t,e){this.emitter.on(t,e)}},{key:"destroy",value:function(){var t=this.context.graph;t.off($c.AFTER_DRAW,this.addCommand),t.off($c.BATCH_START,this.initBatchCommand),t.off($c.BATCH_END,this.addCommand),this.emitter.off(),dn(e,"destroy",this,3)([]),this.undoStack=[],this.redoStack=[]}}])}(gw);OE.defaultOptions={stackSize:0};var NE=a(5037),AE=a.n(NE),TE=function(t,e,n){var r=[e,e,0,0,0],i="sharp"===n?Bh(t[0],Wh(Uh(zh(t[0],t[1])),e)):t[0],a="sharp"===n?Bh(t[1],Wh(Uh(zh(t[1],t[0])),e)):t[1],o=Wh(Uh(Xh(zh(i,a),!1)),e),s=Wh(o,-1),u=Bh(i,o),c=Bh(a,o),l=Bh(a,s),h=Bh(i,s);return"sharp"===n?[["M",u[0],u[1]],["L",c[0],c[1]],["L",l[0],l[1]],["L",h[0],h[1]],["Z"]]:[["M",u[0],u[1]],["L",c[0],c[1]],["A"].concat(r,[l[0],l[1]]),["L",h[0],h[1]],["A"].concat(r,[u[0],u[1]])]},PE=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).hullMemberIds=[],r.drawHull=function(){if(r.shape){var t=!Vc(r.optionsCache,r.options);r.shape.update(r.getHullStyle(t))}else r.shape=new nf({style:r.getHullStyle()}),r.context.canvas.appendChild(r.shape);r.optionsCache=Object.assign({},r.options)},r.updateHullPath=function(t){r.shape&&r.options.members.includes(yh(t.data))&&r.shape.update({d:r.getHullPath(!0)})},r.getHullPath=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=r.context.graph,n=r.getMember();if(0===n.length)return"";var i=n.map((function(t){return e.getNodeData(t)})),a=AE()(i.map(ed),r.options.concavity).slice(1).reverse(),o=a.flatMap((function(t){return i.filter((function(e){return Vc(ed(e),t)})).map(yh)}));return Vc(o,r.hullMemberIds)&&!t||(r.hullMemberIds=o,r.path=function(t,e,n){if(1===t.length)return function(t,e,n){if("sharp"===n)return[["M",t[0]-e,t[1]-e],["L",t[0]+e,t[1]-e],["L",t[0]+e,t[1]+e],["L",t[0]-e,t[1]+e],["Z"]];var r=[e,e,0,0,0];return[["M",t[0],t[1]-e],["A"].concat(r,[t[0],t[1]+e]),["A"].concat(r,[t[0],t[1]-e])]}(t[0],e,n);if(2===t.length)return TE(t,e,n);if(3===t.length){var r=h(vd(t),3),i=r[0],a=r[1],o=r[2];if(cd(i,a,o))return TE([i,o],e,n)}switch(n){case"smooth":return function(t,e){var n=vd(t).map((function(e,n){return{p:e,v:Uh(zh(t[(n+1)%t.length],e))}}));return n.forEach((function(r,i){var a=i>0?i-1:t.length-1,o=n[a].v,s=Uh(Bh(o,Wh(r.v,qh(o,r.v,!0)<Math.PI?1:-1)));r.p=Bh(r.p,Wh(s,e))})),ef(n.map((function(t){return t.p})))}(t,e);case"sharp":return function(t,e){var n=t.map((function(n,r){var i=t[0===r?t.length-1:r-1],a=$h(Wh(Uh(Xh(zh(i,n),!1)),e));return[Bh(i,a),Bh(n,a)]})),r=n.flat();return r.map((function(t,e){return e%2==0?null:Jh([r[(e-1)%r.length],r[e%r.length]],[r[(e+1)%r.length],r[(e+2)%r.length]],!0)})).filter(Boolean).map((function(t,e){return[0===e?"M":"L",t[0],t[1]]})).concat([["Z"]])}(t,e);default:return function(t,e){var n=vd(t).map((function(n,r){var i=(r-2+t.length)%t.length,a=(r-1+t.length)%t.length,o=(r+1)%t.length,s=t[i],u=t[a],c=t[o],l=zh(s,u),h=zh(u,n),d=zh(n,c),f=function(t,e){return qh(t,e,!0)<Math.PI},v=f(l,h),p=f(h,d),g=function(t){return Wh(Uh(Xh(t,!1)),e)},y=g(h);return[{p:Kh(Bh(u,v?g(l):y)),concave:v&&u},{p:Kh(Bh(n,p?g(d):y)),concave:p&&n}]})),r=[e,e,0,0,0],i=n.findIndex((function(t,e){return!(n[(e-1+n.length)%n.length][0].concave||n[(e-1+n.length)%n.length][1].concave||t[0].concave||t[0].concave||t[1].concave)})),a=n.slice(i).concat(n.slice(0,i)),o=[];return a.flatMap((function(t,e){var i=[],s=a[n.length-1];return 0===e&&i.push(["M"].concat(w(s[1].p))),t[0].concave?o.push(t[0].p,t[1].p):i.push(["A"].concat(r,w(t[0].p))),t[1].concave?o.unshift(t[1].p):i.push(["L"].concat(w(t[1].p))),3===o.length&&(i.pop(),i.push(["C"].concat(w(o.flat()))),o=[]),i}))}(t,e)}}(a,r.getPadding(),r.options.corner)),r.path},r.bindEvents(),r}return N(e,t),b(e,[{key:"bindEvents",value:function(){this.context.graph.on($c.AFTER_RENDER,this.drawHull),this.context.graph.on($c.AFTER_ELEMENT_UPDATE,this.updateHullPath)}},{key:"getHullStyle",value:function(t){var e=this.options,n=(e.members,e.padding,e.corner,function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(e,["members","padding","corner"]));return Object.assign(Object.assign({},n),{d:this.getHullPath(t)})}},{key:"getPadding",value:function(){var t=this.context.graph,e=this.hullMemberIds.reduce((function(e,n){var r=t.getElementRenderBounds(n).halfExtents,i=Math.max(r[0],r[1]);return Math.max(e,i)}),0);return e+this.options.padding}},{key:"addMember",value:function(t){var e=Array.isArray(t)?t:[t];this.options.members=w(new Set([].concat(w(this.options.members),w(e)))),this.shape.update({d:this.getHullPath()})}},{key:"removeMember",value:function(t){var e=this,n=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter((function(t){return!n.includes(t)})),n.some((function(t){return e.hullMemberIds.includes(t)}))&&this.shape.update({d:this.getHullPath()})}},{key:"updateMember",value:function(t){this.options.members=cn(t)?t(this.options.members):t,this.shape.update(this.getHullStyle(!0))}},{key:"getMember",value:function(){return this.options.members}},{key:"destroy",value:function(){this.context.graph.off($c.AFTER_DRAW,this.drawHull),this.shape.destroy(),this.hullMemberIds=[],dn(e,"destroy",this,3)([])}}])}(gw);function CE(t,e){e(t),t.children&&t.children.forEach((function(t){t&&CE(t,e)}))}function RE(t){DE(t,!0)}function LE(t){DE(t,!1)}function DE(t,e){var n=e?"visible":"hidden";CE(t,(function(t){t.attr("visibility",n)}))}PE.defaultOptions={members:[],padding:10,corner:"rounded",concavity:1/0,fill:"lightblue",fillOpacity:.2,labelOpacity:1,stroke:"blue",strokeOpacity:.2};var _E=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=5),Object.entries(e).forEach((function(i){var a=ye(i,2),o=a[0],s=a[1],u=t;Object.prototype.hasOwnProperty.call(e,o)&&(s?Dh(s)?(Dh(t[o])||(u[o]={}),n<r?_E(t[o],s,n+1,r):u[o]=e[o]):He(s)?(u[o]=[],u[o]=u[o].concat(s)):u[o]=s:u[o]=s)}))},IE=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r+=1)_E(t,e[r]);return t},jE=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=t.apply(this,me([],ye(e),!1))||this;return r.isMutationObserved=!0,r.addEventListener(bs.INSERTED,(function(){LE(r)})),r}return de(e,t),e}(vu);function FE(t){var e=t.appendChild(new jE({class:"offscreen"}));return LE(e),e}function BE(){DE(this,"hidden"!==this.attributes.visibility)}var zE=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this,IE({},{style:n},e))||this;return r.initialized=!1,r._defaultOptions=n,r}return de(e,t),Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=FE(this)),this._offscreen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defaultOptions",{get:function(){return this._defaultOptions},enumerable:!1,configurable:!0}),e.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this),this.initialized=!0},e.prototype.disconnectedCallback=function(){var t;null===(t=this._offscreen)||void 0===t||t.destroy()},e.prototype.attributeChangedCallback=function(t){"visibility"===t&&BE.call(this)},e.prototype.update=function(t,e){var n;return this.attr(IE({},this.attributes,t||{})),null===(n=this.render)||void 0===n?void 0:n.call(this,this.attributes,this,e)},e.prototype.clear=function(){this.removeChildren()},e.prototype.bindEvents=function(t,e){},e.prototype.getSubShapeStyle=function(t){return t.x,t.y,t.transform,t.transformOrigin,t.class,t.className,t.zIndex,ve(t,["x","y","transform","transformOrigin","class","className","zIndex"])},e}(du);function GE(t){return t.toString().charAt(0).toUpperCase()+t.toString().slice(1)}function VE(t,e,n){var r;void 0===n&&(n=!0);var i=e||(null===(r=t.match(/^([a-z][a-z0-9]+)/))||void 0===r?void 0:r[0])||"",a=t.replace(new RegExp("^(".concat(i,")")),"");return n?function(t){return t.toString().charAt(0).toLowerCase()+t.toString().slice(1)}(a):a}var WE=function(t,e){if(!(null==t?void 0:t.startsWith(e)))return!1;var n=t[e.length];return n>="A"&&n<="Z"};function HE(t,e,n){void 0===n&&(n=!1);var r={};return Object.entries(t).forEach((function(t){var i,a=ye(t,2),o=a[0],s=a[1];if("className"===o||"class"===o);else if(WE(o,"show")&&WE(VE(o,"show"),e)!==n)o===(i=e,"".concat("show").concat(GE(i)))?r[o]=s:r[o.replace(new RegExp(GE(e)),"")]=s;else if(!WE(o,"show")&&WE(o,e)!==n){var u=VE(o,e);"filter"===u&&"function"==typeof s||(r[u]=s)}})),r}function YE(t,e){return Object.entries(t).reduce((function(t,n){var r=ye(n,2),i=r[0],a=r[1];return i.startsWith("show")?t["show".concat(e).concat(i.slice(4))]=a:t["".concat(e).concat(GE(i))]=a,t}),{})}function UE(t,e){void 0===e&&(e=["x","y","class","className"]);var n=["transform","transformOrigin","anchor","visibility","pointerEvents","zIndex","cursor","clipPath","clipPathTargets","offsetPath","offsetPathTargets","offsetDistance","draggable","droppable"],r={},i={};return Object.entries(t).forEach((function(t){var a=ye(t,2),o=a[0],s=a[1];e.includes(o)||(-1!==n.indexOf(o)?i[o]=s:r[o]=s)})),[r,i]}var qE=function(t){function e(e){void 0===e&&(e={});var n=e.style,r=ve(e,["style"]);return t.call(this,fe({style:fe({text:"",fill:"black",fontFamily:"sans-serif",fontSize:16,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1,textAlign:"start",textBaseline:"middle"},n)},r))||this}return de(e,t),Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=FE(this)),this._offscreen},enumerable:!1,configurable:!0}),e.prototype.disconnectedCallback=function(){var t;null===(t=this._offscreen)||void 0===t||t.destroy()},e}(Au),XE=function(){function t(t,n,r,i,a,o,s){void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=null),void 0===a&&(a=[null,null,null,null,null]),void 0===o&&(o=[]),void 0===s&&(s=[]),e.add(this),this._elements=Array.from(t),this._data=n,this._parent=r,this._document=i,this._enter=a[0],this._update=a[1],this._exit=a[2],this._merge=a[3],this._split=a[4],this._transitions=o,this._facetElements=s}var e,n,r;return t.prototype.selectAll=function(t){var e="string"==typeof t?this._parent.querySelectorAll(t):t;return new n(e,null,this._elements[0],this._document)},t.prototype.selectFacetAll=function(t){var e="string"==typeof t?this._parent.querySelectorAll(t):t;return new n(this._elements,null,this._parent,this._document,void 0,void 0,e)},t.prototype.select=function(t){var e="string"==typeof t?this._parent.querySelectorAll(t)[0]||null:t;return new n([e],null,e,this._document)},t.prototype.append=function(t){var e=this,r="function"==typeof t?t:function(){return e.createElement(t)},i=[];if(null!==this._data){for(var a=0;a<this._data.length;a++){var o=this._data[a],s=ye(Array.isArray(o)?o:[o,null],2),u=s[0],c=s[1];(h=r(u,a)).__data__=u,null!==c&&(h.__fromElements__=c),this._parent.appendChild(h),i.push(h)}return new n(i,null,this._parent,this._document)}for(a=0;a<this._elements.length;a++){var l=this._elements[a],h=r(u=l.__data__,a);l.appendChild(h),i.push(h)}return new n(i,null,i[0],this._document)},t.prototype.maybeAppend=function(t,n){var i=be(this,e,"m",r).call(this,"#"===t[0]?t:"#".concat(t),n);return i.attr("id",t),i},t.prototype.maybeAppendByClassName=function(t,n){var i=t.toString(),a=be(this,e,"m",r).call(this,"."===i[0]?i:".".concat(i),n);return a.attr("className",i),a},t.prototype.maybeAppendByName=function(t,n){var i=be(this,e,"m",r).call(this,'[name="'.concat(t,'"]'),n);return i.attr("name",t),i},t.prototype.data=function(t,e,r){var i,a;void 0===e&&(e=function(t){return t}),void 0===r&&(r=function(){return null});for(var o,s,u,c=[],l=[],h=new Set(this._elements),d=[],f=new Set,v=new Map(this._elements.map((function(t,n){return[e(t.__data__,n),t]}))),p=new Map(this._facetElements.map((function(t,n){return[e(t.__data__,n),t]}))),g=(o=this._elements,s=function(t){return r(t.__data__)},u=new Map,o.forEach((function(t){var e=s(t);u.has(e)||u.set(e,[]),u.get(e).push(t)})),u),y=0;y<t.length;y++){var m=t[y],b=e(m,y),x=r(m,y);if(v.has(b))(M=v.get(b)).__data__=m,M.__facet__=!1,l.push(M),h.delete(M),v.delete(b);else if(p.has(b))(M=p.get(b)).__data__=m,M.__facet__=!0,l.push(M),p.delete(b);else if(g.has(b)){var w=g.get(b);d.push([m,w]);try{for(var E=(i=void 0,ge(w)),k=E.next();!k.done;k=E.next()){var M=k.value;h.delete(M)}}catch(t){i={error:t}}finally{try{k&&!k.done&&(a=E.return)&&a.call(E)}finally{if(i)throw i.error}}g.delete(b)}else v.has(x)?((M=v.get(x)).__toData__?M.__toData__.push(m):M.__toData__=[m],f.add(M),h.delete(M)):c.push(m)}var S=[new n([],c,this._parent,this._document),new n(l,null,this._parent,this._document),new n(h,null,this._parent,this._document),new n([],d,this._parent,this._document),new n(f,null,this._parent,this._document)];return new n(this._elements,null,this._parent,this._document,S)},t.prototype.merge=function(t){var e=me(me([],ye(this._elements),!1),ye(t._elements),!1),r=me(me([],ye(this._transitions),!1),ye(t._transitions),!1);return new n(e,null,this._parent,this._document,void 0,r)},t.prototype.createElement=function(t){if(this._document)return this._document.createElement(t,{});var e=n.registry[t];return e?new e:function(t){throw new Error(t)}("Unknown node type: ".concat(t))},t.prototype.join=function(t,e,n,r,i){void 0===t&&(t=function(t){return t}),void 0===e&&(e=function(t){return t}),void 0===n&&(n=function(t){return t.remove()}),void 0===r&&(r=function(t){return t}),void 0===i&&(i=function(t){return t.remove()});var a=t(this._enter),o=e(this._update),s=n(this._exit),u=r(this._merge),c=i(this._split);return o.merge(a).merge(s).merge(u).merge(c)},t.prototype.remove=function(){for(var t=function(t){var n=e._elements[t],r=e._transitions[t];r?r.then((function(){return n.remove()})):n.remove()},e=this,r=0;r<this._elements.length;r++)t(r);return new n([],null,this._parent,this._document,void 0,this._transitions)},t.prototype.each=function(t){for(var e=0;e<this._elements.length;e++){var n=this._elements[e],r=n.__data__;t.call(n,r,e)}return this},t.prototype.attr=function(t,e){var n="function"!=typeof e?function(){return e}:e;return this.each((function(r,i){void 0!==e&&(this[t]=n.call(this,r,i))}))},t.prototype.style=function(t,e,n){void 0===n&&(n=!0);var r="function"==typeof e&&n?e:function(){return e};return this.each((function(n,i){void 0!==e&&(this.style[t]=r.call(this,n,i))}))},t.prototype.styles=function(t,e){return void 0===t&&(t={}),void 0===e&&(e=!0),this.each((function(n,r){var i=this;Object.entries(t).forEach((function(t){var a=ye(t,2),o=a[0],s=a[1],u="function"==typeof s&&e?s:function(){return s};void 0!==s&&i.attr(o,u.call(i,n,r))}))}))},t.prototype.update=function(t,e){void 0===e&&(e=!0);var n="function"==typeof t&&e?t:function(){return t};return this.each((function(e,r){t&&this.update&&this.update(n.call(this,e,r))}))},t.prototype.maybeUpdate=function(t,e){void 0===e&&(e=!0);var n="function"==typeof t&&e?t:function(){return t};return this.each((function(e,r){t&&this.update&&this.update(n.call(this,e,r))}))},t.prototype.transition=function(t){var e=this._transitions;return this.each((function(n,r){e[r]=t.call(this,n,r)}))},t.prototype.on=function(t,e){return this.each((function(){this.addEventListener(t,e)})),this},t.prototype.call=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t.call.apply(t,me([this._parent,this],ye(e),!1)),this},t.prototype.node=function(){return this._elements[0]},t.prototype.nodes=function(){return this._elements},t.prototype.transitions=function(){return this._transitions.filter((function(t){return!!t}))},t.prototype.parent=function(){return this._parent},n=t,e=new WeakSet,r=function(t,e){var r=this._elements[0],i=r.querySelector(t);if(i)return new n([i],null,this._parent,this._document);var a="string"==typeof e?this.createElement(e):e();return r.appendChild(a),new n([a],null,this._parent,this._document)},t.registry={g:vu,rect:Ou,circle:lu,path:wu,text:qE,ellipse:fu,image:yu,line:bu,polygon:ku,polyline:Su,html:gu},t}();function KE(t){return new XE([t],null,t,t.ownerDocument)}var $E=function(){function t(t,e,n,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),this.x=0,this.y=0,this.width=0,this.height=0,this.x=t,this.y=e,this.width=n,this.height=r}return Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),t.fromRect=function(e){return new t(e.x,e.y,e.width,e.height)},t.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,right:this.right,bottom:this.bottom,left:this.left}},t.prototype.isPointIn=function(t,e){return t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom},t}(),ZE=function(t,e){var n=function(t){return"".concat(e,"-").concat(t)},r=Object.fromEntries(Object.entries(t).map((function(t){var e=ye(t,2),r=e[0],i=e[1],a=n(i);return[r,{name:a,class:".".concat(a),id:"#".concat(a),toString:function(){return a}}]})));return Object.assign(r,{prefix:n}),r};function QE(t){if(oe(t))return[t,t,t,t];if(He(t)){var e=t.length;if(1===e)return[t[0],t[0],t[0],t[0]];if(2===e)return[t[0],t[1],t[0],t[1]];if(3===e)return[t[0],t[1],t[2],t[1]];if(4===e)return t}return[0,0,0,0]}function JE(t,e,n,r,i){return void 0===r&&(r=!0),void 0===i&&(i=function(t){t.node().removeChildren()}),t?n(e):(r&&i(e),null)}var tk=ZE({text:"text"},"title");function ek(t){return/\S+-\S+/g.test(t)?t.split("-").map((function(t){return t[0]})):t.length>2?[t[0]]:t.split("")}function nk(t,e){var n=Object.entries(e).reduce((function(e,n){var r=ye(n,2),i=r[0],a=r[1];return t.node().attr(i)||(e[i]=a),e}),{});t.styles(n)}var rk=function(t){function e(e){return t.call(this,e,{text:"",width:0,height:0,fill:"#4a505a",fontWeight:"bold",fontSize:12,fontFamily:"sans-serif",inset:0,spacing:0,position:"top-left"})||this}return de(e,t),e.prototype.getAvailableSpace=function(){var t=this.attributes,e=t.width,n=t.height,r=t.position,i=t.spacing,a=t.inset,o=this.querySelector(tk.text.class);if(!o)return new $E(0,0,+e,+n);var s=o.getBBox(),u=s.width,c=s.height,l=ye(QE(i),4),h=l[0],d=l[1],f=l[2],v=l[3],p=ye([0,0,+e,+n],4),g=p[0],y=p[1],m=p[2],b=p[3],x=ek(r);if(x.includes("i"))return new $E(g,y,m,b);x.forEach((function(t,r){var i,a,o,s;"t"===t&&(i=ye(0===r?[c+f,+n-c-f]:[0,+n],2),y=i[0],b=i[1]),"r"===t&&(a=ye([+e-u-v],1),m=a[0]),"b"===t&&(o=ye([+n-c-h],1),b=o[0]),"l"===t&&(s=ye(0===r?[u+d,+e-u-d]:[0,+e],2),g=s[0],m=s[1])}));var w=ye(QE(a),4),E=w[0],k=w[1],M=w[2],S=w[3],O=ye([S+k,E+M],2),N=O[0],A=O[1];return new $E(g+S,y+E,m-N,b-A)},e.prototype.getBBox=function(){return this.title?this.title.getBBox():new $E(0,0,0,0)},e.prototype.render=function(t,e){var n=this,r=(t.width,t.height,t.position,t.spacing,ve(t,["width","height","position","spacing"])),i=ye(UE(r),1)[0],a=function(t){var e,n,r,i,a=t,o=a.width,s=a.height,u=a.position,c=ye([+o/2,+s/2],2),l=ye([+c[0],+c[1],"center","middle"],4),h=l[0],d=l[1],f=l[2],v=l[3],p=ek(u);return p.includes("l")&&(h=(e=ye([0,"start"],2))[0],f=e[1]),p.includes("r")&&(h=(n=ye([+o,"end"],2))[0],f=n[1]),p.includes("t")&&(d=(r=ye([0,"top"],2))[0],v=r[1]),p.includes("b")&&(d=(i=ye([+s,"bottom"],2))[0],v=i[1]),{x:h,y:d,textAlign:f,textBaseline:v}}(t),o=a.x,s=a.y,u=a.textAlign,c=a.textBaseline;JE(!!r.text,KE(e),(function(t){n.title=t.maybeAppendByClassName(tk.text,"text").styles(i).call(nk,{x:o,y:s,textAlign:u,textBaseline:c}).node()}))},e}(zE);const ik=function(){};function ak(t,e){return cn(t)?t.apply(void 0,me([],ye(e),!1)):t}function ok(t){if(!t)return{enter:!1,update:!1,exit:!1};var e=["enter","update","exit"],n=Object.fromEntries(Object.entries(t).filter((function(t){var n=ye(t,1)[0];return!e.includes(n)})));return Object.fromEntries(e.map((function(e){return function(t){return"boolean"!=typeof t&&"enter"in t&&"update"in t&&"exit"in t}(t)?!1===t[e]?[e,!1]:[e,fe(fe({},t[e]),n)]:[e,n]})))}function sk(t,e){t?t.finished.then(e):e()}function uk(t,e){"update"in t?t.update(e):t.attr(e)}function ck(t,e,n){return 0===e.length?null:n?t.animate(e,n):(uk(t,{style:e.slice(-1)[0]}),null)}function lk(t,e,n){var r={},i={};return Object.entries(e).forEach((function(e){var n=ye(e,2),a=n[0],o=n[1];if(!ue(o)){var s=t.style[a]||t.parsedStyle[a]||0;s!==o&&(r[a]=s,i[a]=o)}})),n?ck(t,[r,i],fe({fill:"both"},n)):(uk(t,i),null)}function hk(t,e,n){void 0===n&&(n=!1);var r=t.getBBox(),i=r.width,a=r.height,o=e/Math.max(i,a);return n&&(t.style.transform="scale(".concat(o,")")),o}var dk=function(t,e,n){return[["M",t-n,e],["A",n,n,0,1,0,t+n,e],["A",n,n,0,1,0,t-n,e],["Z"]]},fk=dk,vk=function(t,e,n){return[["M",t,e+n],["L",t,e-n]]},pk=function(t,e,n){return[["M",t-n,e],["L",t+n,e]]},gk=pk,yk=ZE({prevBtnGroup:"prev-btn-group",prevBtn:"prev-btn",nextBtnGroup:"next-btn-group",nextBtn:"next-btn",pageInfoGroup:"page-info-group",pageInfo:"page-info",playWindow:"play-window",contentGroup:"content-group",controller:"controller",clipPath:"clip-path"},"navigator"),mk=function(t){function e(e){var n,r,i,a=t.call(this,e,{x:0,y:0,animate:{easing:"linear",duration:200,fill:"both"},buttonCursor:"pointer",buttonFill:"black",buttonD:(n=0,r=0,i=6,[["M",n-i,r-i],["L",n+i,r],["L",n-i,r+i],["Z"]]),buttonSize:12,controllerPadding:5,controllerSpacing:5,formatter:function(t,e){return"".concat(t,"/").concat(e)},defaultPage:0,loop:!1,orientation:"horizontal",pageNumFill:"black",pageNumFontSize:12,pageNumTextAlign:"start",pageNumTextBaseline:"middle"})||this;return a.playState="idle",a.contentGroup=a.appendChild(new vu({class:yk.contentGroup.name})),a.playWindow=a.contentGroup.appendChild(new vu({class:yk.playWindow.name})),a.innerCurrPage=a.defaultPage,a}return de(e,t),Object.defineProperty(e.prototype,"defaultPage",{get:function(){var t=this.attributes.defaultPage;return le(t,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controllerShape",{get:function(){return this.totalPages>1?{width:55,height:0}:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageShape",{get:function(){var t=ye(function(t){var e;return(null===(e=t[0])||void 0===e?void 0:e.map((function(e,n){return t.map((function(t){return t[n]}))})))||[]}(this.pageViews.map((function(t){var e=t.getBBox();return[e.width,e.height]}))).map((function(t){return Math.max.apply(Math,me([],ye(t),!1))})),2),e=t[0],n=t[1],r=this.attributes,i=r.pageWidth,a=void 0===i?e:i,o=r.pageHeight;return{pageWidth:a,pageHeight:void 0===o?n:o}},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(e.prototype,"totalPages",{get:function(){return this.pageViews.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currPage",{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var e=t.prototype.getBBox.call(this),n=e.x,r=e.y,i=this.controllerShape,a=this.pageShape,o=a.pageWidth,s=a.pageHeight;return new $E(n,r,o+i.width,s)},e.prototype.goTo=function(t){var e=this,n=this.attributes.animate,r=this,i=r.currPage,a=r.playState,o=r.playWindow,s=r.pageViews;if("idle"!==a||t<0||s.length<=0||t>=s.length)return null;s[i].setLocalPosition(0,0),this.prepareFollowingPage(t);var u=ye(this.getFollowingPageDiff(t),2),c=u[0],l=u[1];this.playState="running";var h=ck(o,[{transform:"translate(0, 0)"},{transform:"translate(".concat(-c,", ").concat(-l,")")}],n);return sk(h,(function(){e.innerCurrPage=t,e.playState="idle",e.setVisiblePages([t]),e.updatePageInfo()})),h},e.prototype.prev=function(){var t=this.attributes.loop,e=this.pageViews.length,n=this.currPage;if(!t&&n<=0)return null;var r=t?(n-1+e)%e:le(n-1,0,e);return this.goTo(r)},e.prototype.next=function(){var t=this.attributes.loop,e=this.pageViews.length,n=this.currPage;if(!t&&n>=e-1)return null;var r=t?(n+1)%e:le(n+1,0,e);return this.goTo(r)},e.prototype.renderClipPath=function(t){var e=this.pageShape,n=e.pageWidth,r=e.pageHeight;n&&r?(this.clipPath=t.maybeAppendByClassName(yk.clipPath,"rect").styles({width:n,height:r}),this.contentGroup.attr("clipPath",this.clipPath.node())):this.contentGroup.style.clipPath=void 0},e.prototype.setVisiblePages=function(t){this.playWindow.children.forEach((function(e,n){t.includes(n)?RE(e):LE(e)}))},e.prototype.adjustControllerLayout=function(){var t=this,e=t.prevBtnGroup,n=t.nextBtnGroup,r=t.pageInfoGroup,i=this.attributes,a=i.orientation,o=i.controllerPadding,s=r.getBBox(),u=s.width,c=(s.height,ye("horizontal"===a?[-180,0]:[-90,90],2)),l=c[0],h=c[1];e.setLocalEulerAngles(l),n.setLocalEulerAngles(h);var d=e.getBBox(),f=d.width,v=d.height,p=n.getBBox(),g=p.width,y=p.height,m=Math.max(f,u,g),b="horizontal"===a?{offset:[[0,0],[f/2+o,0],[f+u+2*o,0]],textAlign:"start"}:{offset:[[m/2,-v-o],[m/2,0],[m/2,y+o]],textAlign:"center"},x=ye(b.offset,3),w=ye(x[0],2),E=w[0],k=w[1],M=ye(x[1],2),S=M[0],O=M[1],N=ye(x[2],2),A=N[0],T=N[1],P=b.textAlign,C=r.querySelector("text");C&&(C.style.textAlign=P),e.setLocalPosition(E,k),r.setLocalPosition(S,O),n.setLocalPosition(A,T)},e.prototype.updatePageInfo=function(){var t,e=this,n=e.currPage,r=e.pageViews,i=e.attributes.formatter;r.length<2||(null===(t=this.pageInfoGroup.querySelector(yk.pageInfo.class))||void 0===t||t.attr("text",i(n+1,r.length)),this.adjustControllerLayout())},e.prototype.getFollowingPageDiff=function(t){var e=this.currPage;if(e===t)return[0,0];var n=this.attributes.orientation,r=this.pageShape,i=r.pageWidth,a=r.pageHeight,o=t<e?-1:1;return"horizontal"===n?[o*i,0]:[0,o*a]},e.prototype.prepareFollowingPage=function(t){var e=this.currPage,n=this.pageViews;if(this.setVisiblePages([t,e]),t!==e){var r=ye(this.getFollowingPageDiff(t),2),i=r[0],a=r[1];n[t].setLocalPosition(i,a)}},e.prototype.renderController=function(t){var e=this,n=this.attributes.controllerSpacing,r=this.pageShape,i=r.pageWidth,a=r.pageHeight,o=this.pageViews.length>=2,s=t.maybeAppendByClassName(yk.controller,"g");if(DE(s.node(),o),o){var u=HE(this.attributes,"button"),c=HE(this.attributes,"pageNum"),l=ye(UE(u),2),h=l[0],d=l[1],f=h.size,v=ve(h,["size"]),p=!s.select(yk.prevBtnGroup.class).node(),g=s.maybeAppendByClassName(yk.prevBtnGroup,"g").styles(d);this.prevBtnGroup=g.node();var y=g.maybeAppendByClassName(yk.prevBtn,"path"),m=s.maybeAppendByClassName(yk.nextBtnGroup,"g").styles(d);this.nextBtnGroup=m.node(),[y,m.maybeAppendByClassName(yk.nextBtn,"path")].forEach((function(t){t.styles(fe(fe({},v),{transformOrigin:"center"})),hk(t.node(),f,!0)}));var b=s.maybeAppendByClassName(yk.pageInfoGroup,"g");this.pageInfoGroup=b.node(),b.maybeAppendByClassName(yk.pageInfo,"text").styles(c),this.updatePageInfo(),s.node().setLocalPosition(i+n,a/2),p&&(this.prevBtnGroup.addEventListener("click",(function(){e.prev()})),this.nextBtnGroup.addEventListener("click",(function(){e.next()})))}},e.prototype.render=function(t,e){var n=t.x,r=void 0===n?0:n,i=t.y,a=void 0===i?0:i;this.attr("transform","translate(".concat(r,", ").concat(a,")"));var o=KE(e);this.renderClipPath(o),this.renderController(o),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},e.prototype.bindEvents=function(){var t=this,e=Sg((function(){return t.render(t.attributes,t)}),50);this.playWindow.addEventListener(bs.INSERTED,e),this.playWindow.addEventListener(bs.REMOVED,e)},e}(zE);var bk,xk=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return de(e,t),e.prototype.render=function(t,n){var r=t.x,i=void 0===r?0:r,a=t.y,o=void 0===a?0:a,s=this.getSubShapeStyle(t),u=s.symbol,c=s.size,l=void 0===c?16:c,h=ve(s,["symbol","size"]),d=function(t){var e=function(t){var e="default";if(ln(t)&&t instanceof Image)e="image";else if(cn(t))e="symbol";else if(ce(t)){var n=new RegExp("data:(image|text)");e=t.match(n)?"base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(t)?"url":"symbol"}return e}(t);return["base64","url","image"].includes(e)?"image":t&&"symbol"===e?"path":null}(u);JE(!!d,KE(n),(function(t){t.maybeAppendByClassName("marker",d).attr("className","marker ".concat(d,"-marker")).call((function(t){if("image"===d){var n=2*l;t.styles({img:u,width:n,height:n,x:i-l,y:o-l})}else{n=l/2;var r=cn(u)?u:e.getSymbol(u);t.styles(fe({d:null==r?void 0:r(i,o,n)},h))}}))}))},e.MARKER_SYMBOL_MAP=new Map,e.registerSymbol=function(t,n){e.MARKER_SYMBOL_MAP.set(t,n)},e.getSymbol=function(t){return e.MARKER_SYMBOL_MAP.get(t)},e.getSymbols=function(){return Array.from(e.MARKER_SYMBOL_MAP.keys())},e}(zE);function wk(t,e,n){return void 0===t&&(t="horizontal"),"horizontal"===t?e:n}function Ek(t){var e=t.getLocalBounds(),n=ye([e.min,e.max],2),r=ye(n[0],2),i=r[0],a=r[1],o=ye(n[1],2),s=o[0],u=o[1];return{x:i,y:a,width:s-i,height:u-a,left:i,bottom:u,top:a,right:s}}function kk(t,e){var n=ye(t,2),r=n[0],i=n[1],a=ye(e,2),o=a[0],s=a[1];return r!==o&&i===s}function Mk(t){return"function"==typeof t?t():ce(t)||oe(t)?new qE({style:{text:String(t)}}):t}xk.registerSymbol("cross",(function(t,e,n){return[["M",t-n,e-n],["L",t+n,e+n],["M",t+n,e-n],["L",t-n,e+n]]})),xk.registerSymbol("hyphen",(function(t,e,n){return[["M",t-n,e],["L",t+n,e]]})),xk.registerSymbol("line",vk),xk.registerSymbol("plus",(function(t,e,n){return[["M",t-n,e],["L",t+n,e],["M",t,e-n],["L",t,e+n]]})),xk.registerSymbol("tick",(function(t,e,n){return[["M",t-n/2,e-n],["L",t+n/2,e-n],["M",t,e-n],["L",t,e+n],["M",t-n/2,e+n],["L",t+n/2,e+n]]})),xk.registerSymbol("circle",dk),xk.registerSymbol("point",fk),xk.registerSymbol("bowtie",(function(t,e,n){var r=n-1.5;return[["M",t-n,e-r],["L",t+n,e+r],["L",t+n,e-r],["L",t-n,e+r],["Z"]]})),xk.registerSymbol("hexagon",(function(t,e,n){var r=n/2*Math.sqrt(3);return[["M",t,e-n],["L",t+r,e-n/2],["L",t+r,e+n/2],["L",t,e+n],["L",t-r,e+n/2],["L",t-r,e-n/2],["Z"]]})),xk.registerSymbol("square",(function(t,e,n){return[["M",t-n,e-n],["L",t+n,e-n],["L",t+n,e+n],["L",t-n,e+n],["Z"]]})),xk.registerSymbol("diamond",(function(t,e,n){return[["M",t-n,e],["L",t,e-n],["L",t+n,e],["L",t,e+n],["Z"]]})),xk.registerSymbol("triangle",(function(t,e,n){var r=n*Math.sin(1/3*Math.PI);return[["M",t-n,e+r],["L",t,e-r],["L",t+n,e+r],["Z"]]})),xk.registerSymbol("triangle-down",(function(t,e,n){var r=n*Math.sin(1/3*Math.PI);return[["M",t-n,e-r],["L",t+n,e-r],["L",t,e+r],["Z"]]})),xk.registerSymbol("line",vk),xk.registerSymbol("dot",pk),xk.registerSymbol("dash",gk),xk.registerSymbol("smooth",(function(t,e,n){return[["M",t-n,e],["A",n/2,n/2,0,1,1,t,e],["A",n/2,n/2,0,1,0,t+n,e]]})),xk.registerSymbol("hv",(function(t,e,n){return[["M",t-n-1,e-2.5],["L",t,e-2.5],["L",t,e+2.5],["L",t+n+1,e+2.5]]})),xk.registerSymbol("vh",(function(t,e,n){return[["M",t-n-1,e+2.5],["L",t,e+2.5],["L",t,e-2.5],["L",t+n+1,e-2.5]]})),xk.registerSymbol("hvh",(function(t,e,n){return[["M",t-(n+1),e+2.5],["L",t-n/2,e+2.5],["L",t-n/2,e-2.5],["L",t+n/2,e-2.5],["L",t+n/2,e+2.5],["L",t+n+1,e+2.5]]})),xk.registerSymbol("vhv",(function(t,e){return[["M",t-5,e+2.5],["L",t-5,e],["L",t,e],["L",t,e-3],["L",t,e+3],["L",t+6.5,e+3]]})),xk.registerSymbol("hiddenHandle",(function(t,e,n){var r=1.4*n;return[["M",t-n,e-r],["L",t+n,e-r],["L",t+n,e+r],["L",t-n,e+r],["Z"]]})),xk.registerSymbol("verticalHandle",(function(t,e,n){var r=1.4*n,i=n/2,a=n/6,o=t+.4*r;return[["M",t,e],["L",o,e+i],["L",t+r,e+i],["L",t+r,e-i],["L",o,e-i],["Z"],["M",o,e+a],["L",t+r-2,e+a],["M",o,e-a],["L",t+r-2,e-a]]})),xk.registerSymbol("horizontalHandle",(function(t,e,n){var r=1.4*n,i=n/2,a=n/6,o=e+.4*r;return[["M",t,e],["L",t-i,o],["L",t-i,e+r],["L",t+i,e+r],["L",t+i,o],["Z"],["M",t-a,o],["L",t-a,e+r-2],["M",t+a,o],["L",t+a,e+r-2]]}));var Sk=uw((function(t,e){var n=e.fontSize,r=e.fontFamily,i=e.fontWeight,a=e.fontStyle,o=e.fontVariant;return bk||(bk=$s.offscreenCanvasCreator.getOrCreateContext(void 0)),bk.font=[a,o,i,"".concat(n,"px"),r].join(" "),bk.measureText(t).width}),(function(t,e){return[t,Object.values(e||Ok(t)).join()].join("")}),4096),Ok=function(t){var e=t.style.fontFamily||"sans-serif",n=t.style.fontWeight||"normal",r=t.style.fontStyle||"normal",i=t.style.fontVariant,a=t.style.fontSize;return{fontSize:a="object"==typeof a?a.value:a,fontFamily:e,fontWeight:n,fontStyle:r,fontVariant:i}};function Nk(t){return"text"===t.nodeName?t:"g"===t.nodeName&&1===t.children.length&&"text"===t.children[0].nodeName?t.children[0]:null}function Ak(t,e){var n=Nk(t);n&&n.attr(e)}function Tk(t,e,n){void 0===n&&(n="..."),Ak(t,{wordWrap:!0,wordWrapWidth:e,maxLines:1,textOverflow:n})}var Pk=ZE({layout:"flex",markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label",valueGroup:"value-group",value:"value",backgroundGroup:"background-group",background:"background"},"legend-category-item"),Ck=function(t){function e(e){return t.call(this,e,{span:[1,1],marker:function(){return new lu({style:{r:6}})},markerSize:10,labelFill:"#646464",valueFill:"#646464",labelFontSize:12,valueFontSize:12,labelTextBaseline:"middle",valueTextBaseline:"middle"})||this}return de(e,t),Object.defineProperty(e.prototype,"showValue",{get:function(){var t=this.attributes.valueText;return!!t&&("string"==typeof t||"number"==typeof t?""!==t:"function"==typeof t||""!==t.attr("text"))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actualSpace",{get:function(){var t=this.labelGroup,e=this.valueGroup,n=this.attributes.markerSize,r=t.node().getBBox(),i=r.width,a=r.height,o=e.node().getBBox(),s=o.width,u=o.height;return{markerWidth:n,labelWidth:i,valueWidth:s,height:Math.max(n,a,u)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"span",{get:function(){var t=this.attributes.span;if(!t)return[1,1];var e=ye(QE(t),2),n=e[0],r=e[1],i=this.showValue?r:0,a=n+i;return[n/a,i/a]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t,e=this.attributes,n=e.markerSize,r=e.width,i=this.actualSpace,a=i.markerWidth,o=i.height,s=this.actualSpace,u=s.labelWidth,c=s.valueWidth,l=ye(this.spacing,2),h=l[0],d=l[1];if(r){var f=r-n-h-d,v=ye(this.span,2);u=(t=ye([v[0]*f,v[1]*f],2))[0],c=t[1]}return{width:a+u+c+h+d,height:o,markerWidth:a,labelWidth:u,valueWidth:c}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spacing",{get:function(){var t=this.attributes.spacing;if(!t)return[0,0];var e=ye(QE(t),2),n=e[0],r=e[1];return this.showValue?[n,r]:[n,0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layout",{get:function(){var t=this.shape,e=t.markerWidth,n=t.labelWidth,r=t.valueWidth,i=t.width,a=t.height,o=ye(this.spacing,2),s=o[0];return{height:a,width:i,markerWidth:e,labelWidth:n,valueWidth:r,position:[e/2,e+s,e+n+s+o[1]]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleSize",{get:function(){var t,e,n=(t=this.markerGroup.node(),(e=t.querySelector(Pk.marker.class))?e.style:{}),r=this.attributes,i=r.markerSize,a=r.markerStrokeWidth,o=void 0===a?n.strokeWidth:a,s=r.markerLineWidth,u=void 0===s?n.lineWidth:s,c=r.markerStroke,l=void 0===c?n.stroke:c,h=+(o||u||(l?1:0))*Math.sqrt(2),d=this.markerGroup.node().getBBox(),f=d.width,v=d.height;return(1-h/Math.max(f,v))*i},enumerable:!1,configurable:!0}),e.prototype.renderMarker=function(t){var e=this,n=this.attributes.marker,r=HE(this.attributes,"marker");this.markerGroup=t.maybeAppendByClassName(Pk.markerGroup,"g").style("zIndex",0),JE(!!n,this.markerGroup,(function(){var t,i=e.markerGroup.node(),a=null===(t=i.childNodes)||void 0===t?void 0:t[0],o="string"==typeof n?new xk({style:{symbol:n},className:Pk.marker.name}):n();a?o.nodeName===a.nodeName?a instanceof xk?a.update(fe(fe({},r),{symbol:n})):(function(t,e){var n,r,i=e.attributes;try{for(var a=ge(Object.entries(i)),o=a.next();!o.done;o=a.next()){var s=ye(o.value,2),u=s[0],c=s[1];"id"!==u&&"className"!==u&&t.attr(u,c)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}(a,o),KE(a).styles(r)):(a.remove(),KE(o).attr("className",Pk.marker.name).styles(r),i.appendChild(o)):(o instanceof xk||KE(o).attr("className",Pk.marker.name).styles(r),i.appendChild(o)),e.markerGroup.node().scale(1/e.markerGroup.node().getScale()[0]);var s=hk(e.markerGroup.node(),e.scaleSize,!0);e.markerGroup.node().style._transform="scale(".concat(s,")")}))},e.prototype.renderLabel=function(t){var e=HE(this.attributes,"label"),n=e.text,r=ve(e,["text"]);this.labelGroup=t.maybeAppendByClassName(Pk.labelGroup,"g").style("zIndex",0),this.labelGroup.maybeAppendByClassName(Pk.label,(function(){return Mk(n)})).styles(r)},e.prototype.renderValue=function(t){var e=this,n=HE(this.attributes,"value"),r=n.text,i=ve(n,["text"]);this.valueGroup=t.maybeAppendByClassName(Pk.valueGroup,"g").style("zIndex",0),JE(this.showValue,this.valueGroup,(function(){e.valueGroup.maybeAppendByClassName(Pk.value,(function(){return Mk(r)})).styles(i)}))},e.prototype.renderBackground=function(t){var e=this.shape,n=e.width,r=e.height,i=HE(this.attributes,"background");this.background=t.maybeAppendByClassName(Pk.backgroundGroup,"g").style("zIndex",-1),this.background.maybeAppendByClassName(Pk.background,"rect").styles(fe({width:n,height:r},i))},e.prototype.adjustLayout=function(){var t=this.layout,e=t.labelWidth,n=t.valueWidth,r=t.height,i=ye(t.position,3),a=i[0],o=i[1],s=i[2],u=r/2;this.markerGroup.styles({transform:"translate(".concat(a,", ").concat(u,")").concat(this.markerGroup.node().style._transform)}),this.labelGroup.styles({transform:"translate(".concat(o,", ").concat(u,")")}),Tk(this.labelGroup.select(Pk.label.class).node(),Math.ceil(e)),this.showValue&&(this.valueGroup.styles({transform:"translate(".concat(s,", ").concat(u,")")}),Tk(this.valueGroup.select(Pk.value.class).node(),Math.ceil(n)))},e.prototype.render=function(t,e){var n=KE(e),r=t.x,i=void 0===r?0:r,a=t.y,o=void 0===a?0:a;n.styles({transform:"translate(".concat(i,", ").concat(o,")")}),this.renderMarker(n),this.renderLabel(n),this.renderValue(n),this.renderBackground(n),this.adjustLayout()},e}(zE),Rk=ZE({page:"item-page",navigator:"navigator",item:"item"},"items"),Lk=function(t,e,n){return void 0===n&&(n=!0),t?e(t):n},Dk=function(t){function e(e){var n=t.call(this,e,{data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:"flex",orientation:"horizontal",click:ik,mouseenter:ik,mouseleave:ik})||this;return n.navigatorShape=[0,0],n}return de(e,t),Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){var t=this.attributes,e=t.gridRow,n=t.gridCol,r=t.data;if(!e&&!n)throw new Error("gridRow and gridCol can not be set null at the same time");return e&&n?[e,n]:e?[e,r.length]:[r.length,n]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderData",{get:function(){var t=this.attributes,e=t.data,n=t.layout,r=HE(this.attributes,"item"),i=e.map((function(t,i){var a=t.id,o=void 0===a?i:a,s=t.label,u=t.value;return{id:"".concat(o),index:i,style:fe({layout:n,labelText:s,valueText:u},Object.fromEntries(Object.entries(r).map((function(n){var r=ye(n,2);return[r[0],ak(r[1],[t,i,e])]}))))}}));return i},enumerable:!1,configurable:!0}),e.prototype.getGridLayout=function(){var t=this,e=this.attributes,n=e.orientation,r=e.width,i=e.rowPadding,a=e.colPadding,o=ye(this.navigatorShape,1)[0],s=ye(this.grid,2),u=s[0],c=s[1],l=c*u,h=0;return this.pageViews.children.map((function(e,s){var d,f,v=Math.floor(s/l),p=s%l,g=t.ifHorizontal(c,u),y=[Math.floor(p/g),p%g];"vertical"===n&&y.reverse();var m=ye(y,2),b=m[0],x=m[1],w=(r-o-(c-1)*a)/c,E=e.getBBox().height,k=ye([0,0],2),M=k[0],S=k[1];return"horizontal"===n?(M=(d=ye([h,b*(E+i)],2))[0],S=d[1],h=x===c-1?0:h+w+a):(M=(f=ye([x*(w+a),h],2))[0],S=f[1],h=b===u-1?0:h+E+i),{page:v,index:s,row:b,col:x,pageIndex:p,width:w,height:E,x:M,y:S}}))},e.prototype.getFlexLayout=function(){var t=this.attributes,e=t.width,n=t.height,r=t.rowPadding,i=t.colPadding,a=ye(this.navigatorShape,1)[0],o=ye(this.grid,2),s=o[0],u=o[1],c=ye([e-a,n],2),l=c[0],h=c[1],d=ye([0,0,0,0,0,0,0,0],8),f=d[0],v=d[1],p=d[2],g=d[3],y=d[4],m=d[5],b=d[6],x=d[7];return this.pageViews.children.map((function(t,e){var n,a,o,c,d=t.getBBox(),w=d.width,E=d.height,k=0===b?0:i,M=b+k+w;return M<=l&&Lk(y,(function(t){return t<u}))?(n=ye([b+k,x,M],3),f=n[0],v=n[1],b=n[2],{width:w,height:E,x:f,y:v,page:p,index:e,pageIndex:g++,row:m,col:y++}):(a=ye([m+1,0,0,x+E+r],4),m=a[0],y=a[1],b=a[2],(x=a[3])+E<=h&&Lk(m,(function(t){return t<s}))?(o=ye([b,x,w],3),f=o[0],v=o[1],b=o[2],{width:w,height:E,x:f,y:v,page:p,index:e,pageIndex:g++,row:m,col:y++}):(c=ye([0,0,w,0,p+1,0,0,0],8),f=c[0],v=c[1],b=c[2],x=c[3],p=c[4],g=c[5],m=c[6],y=c[7],{width:w,height:E,x:f,y:v,page:p,index:e,pageIndex:g++,row:m,col:y++}))}))},Object.defineProperty(e.prototype,"itemsLayout",{get:function(){this.navigatorShape=[0,0];var t="grid"===this.attributes.layout?this.getGridLayout:this.getFlexLayout,e=t.call(this);return e.slice(-1)[0].page>0?(this.navigatorShape=[55,0],t.call(this)):e},enumerable:!1,configurable:!0}),e.prototype.ifHorizontal=function(t,e){return wk(this.attributes.orientation,t,e)},e.prototype.flattenPage=function(t){t.querySelectorAll(Rk.item.class).forEach((function(e){t.appendChild(e)})),t.querySelectorAll(Rk.page.class).forEach((function(e){t.removeChild(e).destroy()}))},e.prototype.renderItems=function(t){var e=this.attributes,n=e.click,r=e.mouseenter,i=e.mouseleave;this.flattenPage(t);var a=this.dispatchCustomEvent.bind(this);KE(t).selectAll(Rk.item.class).data(this.renderData,(function(t){return t.id})).join((function(t){return t.append((function(t){var e=t.style;return new Ck({style:e})})).attr("className",Rk.item.name).on("click",(function(){null==n||n(this),a("itemClick",{item:this})})).on("pointerenter",(function(){null==r||r(this),a("itemMouseenter",{item:this})})).on("pointerleave",(function(){null==i||i(this),a("itemMouseleave",{item:this})}))}),(function(t){return t.each((function(t){var e=t.style;this.update(e)}))}),(function(t){return t.remove()}))},e.prototype.relayoutNavigator=function(){var t,e=this.attributes,n=e.layout,r=e.width,i=(null===(t=this.pageViews.children[0])||void 0===t?void 0:t.getBBox().height)||0,a=ye(this.navigatorShape,2),o=a[0],s=a[1];this.navigator.update("grid"===n?{pageWidth:r-o,pageHeight:i-s}:{})},e.prototype.adjustLayout=function(){var t,e,n=this,r=Object.entries((t=this.itemsLayout,e="page",t.reduce((function(t,n){return(t[n[e]]=t[n[e]]||[]).push(n),t}),{}))).map((function(t){var e=ye(t,2);return{page:e[0],layouts:e[1]}})),i=me([],ye(this.navigator.getContainer().children),!1);r.forEach((function(t){var e=t.layouts,r=n.pageViews.appendChild(new vu({className:Rk.page.name}));e.forEach((function(t){var e=t.x,n=t.y,a=t.index,o=t.width,s=t.height,u=i[a];r.appendChild(u),Cd(u,"__layout__",t),u.update({x:e,y:n,width:o,height:s})}))})),this.relayoutNavigator()},e.prototype.renderNavigator=function(t){var e=this.attributes.orientation,n=HE(this.attributes,"nav"),r=IE({orientation:e},n),i=this;return t.selectAll(Rk.navigator.class).data(["nav"]).join((function(t){return t.append((function(){return new mk({style:r})})).attr("className",Rk.navigator.name).each((function(){i.navigator=this}))}),(function(t){return t.each((function(){this.update(r)}))}),(function(t){return t.remove()})),this.navigator},e.prototype.getBBox=function(){return this.navigator.getBBox()},e.prototype.render=function(t,e){var n=this.attributes.data;if(n&&0!==n.length){var r=this.renderNavigator(KE(e));this.renderItems(r.getContainer()),this.adjustLayout()}},e.prototype.dispatchCustomEvent=function(t,e){var n=new cs(t,{detail:e});this.dispatchEvent(n)},e}(zE),_k=ZE({markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label"},"handle"),Ik={showLabel:!0,formatter:function(t){return t.toString()},markerSize:25,markerStroke:"#c5c5c5",markerFill:"#fff",markerLineWidth:1,labelFontSize:12,labelFill:"#c5c5c5",labelText:"",orientation:"vertical",spacing:0},jk=(function(t){function e(e){return t.call(this,e,Ik)||this}de(e,t),e.prototype.render=function(t,e){var n=KE(e).maybeAppendByClassName(_k.markerGroup,"g");this.renderMarker(n);var r=KE(e).maybeAppendByClassName(_k.labelGroup,"g");this.renderLabel(r)},e.prototype.renderMarker=function(t){var e=this,n=this.attributes,r=n.orientation,i=n.markerSymbol,a=void 0===i?wk(r,"horizontalHandle","verticalHandle"):i;JE(!!a,t,(function(t){var n=HE(e.attributes,"marker"),r=fe({symbol:a},n);e.marker=t.maybeAppendByClassName(_k.marker,(function(){return new xk({style:r})})).update(r)}))},e.prototype.renderLabel=function(t){var e=this,n=this.attributes,r=n.showLabel,i=n.orientation,a=n.spacing,o=void 0===a?0:a,s=n.formatter;JE(r,t,(function(t){var n,r=HE(e.attributes,"label"),a=r.text,u=ve(r,["text"]),c=(null===(n=t.select(_k.marker.class))||void 0===n?void 0:n.node().getBBox())||{},l=c.width,h=void 0===l?0:l,d=c.height,f=ye(wk(i,[0,(void 0===d?0:d)+o,"center","top"],[h+o,0,"start","middle"]),4),v=f[0],p=f[1],g=f[2],y=f[3];t.maybeAppendByClassName(_k.label,"text").styles(fe(fe({},u),{x:v,y:p,text:s(a).toString(),textAlign:g,textBaseline:y}))}))}}(zE),{showTitle:!0,padding:0,orientation:"horizontal",backgroundFill:"transparent",titleText:"",titleSpacing:4,titlePosition:"top-left",titleFill:"#2C3542",titleFontWeight:"bold",titleFontFamily:"sans-serif",titleFontSize:12}),Fk=IE({},jk,{}),Bk=(IE({},jk,YE(Ik,"handle"),{color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],indicatorBackgroundFill:"#262626",indicatorLabelFill:"white",indicatorLabelFontSize:12,indicatorVisibility:"hidden",labelAlign:"value",labelDirection:"positive",labelSpacing:5,showHandle:!0,showIndicator:!0,showLabel:!0,slidable:!0,titleText:"",type:"continuous"}),ZE({title:"title",titleGroup:"title-group",items:"items",itemsGroup:"items-group",contentGroup:"content-group",ribbonGroup:"ribbon-group",ribbon:"ribbon",handlesGroup:"handles-group",handle:"handle",startHandle:"start-handle",endHandle:"end-handle",labelGroup:"label-group",label:"label",indicator:"indicator"},"legend")),zk=function(t){function e(e){return t.call(this,e,Fk)||this}return de(e,t),e.prototype.renderTitle=function(t,e,n){var r=this.attributes,i=r.showTitle,a=r.titleText,o=ye(UE(HE(this.attributes,"title")),2),s=o[0],u=o[1];this.titleGroup=t.maybeAppendByClassName(Bk.titleGroup,"g").styles(u);var c=fe(fe({width:e,height:n},s),{text:i?a:""});this.title=this.titleGroup.maybeAppendByClassName(Bk.title,(function(){return new rk({style:c})})).update(c)},e.prototype.renderItems=function(t,e){var n=e.x,r=e.y,i=e.width,a=e.height,o=ye(UE(HE(this.attributes,"title",!0)),2),s=o[0],u=o[1],c=fe(fe({},s),{width:i,height:a,x:0,y:0});this.itemsGroup=t.maybeAppendByClassName(Bk.itemsGroup,"g").styles(fe(fe({},u),{transform:"translate(".concat(n,", ").concat(r,")")}));var l=this;this.itemsGroup.selectAll(Bk.items.class).data(["items"]).join((function(t){return t.append((function(){return new Dk({style:c})})).attr("className",Bk.items.name).each((function(){l.items=KE(this)}))}),(function(t){return t.update(c)}),(function(t){return t.remove()}))},e.prototype.adjustLayout=function(){if(this.attributes.showTitle){var t=this.title.node().getAvailableSpace(),e=t.x,n=t.y;this.itemsGroup.node().style.transform="translate(".concat(e,", ").concat(n,")")}},Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes,e=t.showTitle,n=t.width,r=t.height;return e?this.title.node().getAvailableSpace():new $E(0,0,n,r)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var e,n,r=null===(e=this.title)||void 0===e?void 0:e.node(),i=null===(n=this.items)||void 0===n?void 0:n.node();return r&&i?function(t,e){var n=t.attributes,r=n.position,i=n.spacing,a=n.inset,o=n.text,s=t.getBBox(),u=e.getBBox(),c=ek(r),l=ye(QE(o?i:0),4),h=l[0],d=l[1],f=l[2],v=l[3],p=ye(QE(a),4),g=p[0],y=p[1],m=p[2],b=p[3],x=ye([v+d,h+f],2),w=x[0],E=x[1],k=ye([b+y,g+m],2),M=k[0],S=k[1];if("l"===c[0])return new $E(s.x,s.y,u.width+s.width+w+M,Math.max(u.height+S,s.height));if("t"===c[0])return new $E(s.x,s.y,Math.max(u.width+M,s.width),u.height+s.height+E+S);var O=ye([e.attributes.width||u.width,e.attributes.height||u.height],2),N=O[0],A=O[1];return new $E(u.x,u.y,N+s.width+w+M,A+s.height+E+S)}(r,i):t.prototype.getBBox.call(this)},e.prototype.render=function(t,e){var n=this.attributes,r=n.width,i=n.height,a=n.x,o=void 0===a?0:a,s=n.y,u=void 0===s?0:s,c=KE(e);e.style.transform="translate(".concat(o,", ").concat(u,")"),this.renderTitle(c,r,i),this.renderItems(c,this.availableSpace),this.adjustLayout()},e}(zE);function Gk(t){var e=t.width,n=t.height,r=t.renderer,i=function(t){var e,n=t.container,r=t.className,i=t.graphCanvas;if(n)return"string"==typeof n?document.getElementById(n):n;var a=yw(r,!1),o=t.width,s=t.height,u=t.containerStyle,c=function(t){var e=t.width,n=t.height,r=t.placement,i=h(t.graphCanvas.getSize(),2),a=i[0],o=i[1],s=h(td(r),2);return[s[0]*(a-e),s[1]*(o-n)]}(t),l=h(c,2),d=l[0],f=l[1];return Object.assign(a.style,Object.assign({position:"absolute",left:d+"px",top:f+"px",width:o+"px",height:s+"px"},u)),null===(e=i.getContainer())||void 0===e||e.appendChild(a),a}(t);return[i,new Vu({width:e,height:n,container:i,renderer:r||new Qv})]}var Vk=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).typePrefix="__data__",r.draw=!1,r.fieldMap={node:new Map,edge:new Map,combo:new Map},r.selectedItems=[],r.bindEvents=function(){r.context.graph.on($c.AFTER_DRAW,r.createElement)},r.changeState=function(t,e){var n=r.context.graph,i=r.typePrefix,a=Pd(t,[i,"id"]),o=Pd(t,[i,"style","labelText"]),s=h(a.split("__"),1)[0],u=r.fieldMap[s].get(o)||[];n.setElementState(Object.fromEntries(null==u?void 0:u.map((function(t){return[t,e]}))))},r.click=function(t){if("hover"!==r.options.trigger){var e=Pd(t,[r.typePrefix,"id"]);r.selectedItems.includes(e)?(r.selectedItems=r.selectedItems.filter((function(t){return t!==e})),r.changeState(t,[])):(r.selectedItems.push(e),r.changeState(t,"selected"))}},r.mouseleave=function(t){"click"!==r.options.trigger&&(r.selectedItems=[],r.changeState(t,[]))},r.mouseenter=function(t){if("click"!==r.options.trigger){var e=Pd(t,[r.typePrefix,"id"]);r.selectedItems.includes(e)?r.selectedItems=r.selectedItems.filter((function(t){return t!==e})):(r.selectedItems.push(e),r.changeState(t,"active"))}},r.setFieldMap=function(t,e,n){if(t){var i=r.fieldMap[n];if(i)if(i.has(t)){var a=i.get(t);a&&(a.push(e),i.set(t,a))}else i.set(t,[e])}},r.getEvents=function(){return{mouseenter:r.mouseenter,mouseleave:r.mouseleave,click:r.click}},r.getMarkerData=function(t,e){if(!t)return[];var n=r.context,i=n.model,a=n.element,o=i.getData(),s=o.nodes,u=o.edges,c=o.combos,l={},h=function(e){return cn(t)?t(e):t},d={node:"circle",edge:"line",combo:"rect"},f={circle:"circle",ellipse:"circle",image:"bowtie",rect:"square",star:"cross",triangle:"triangle",diamond:"diamond",cubic:"dot",line:"hyphen",polyline:"hyphen",quadratic:"hv","cubic-horizontal":"hyphen","cubic-vertical":"line"},v=function(t,e){t.forEach((function(t){var n=t.id,i=Pd(t,["data",h(t)]),o=(null==a?void 0:a.getElementType(e,t))||"circle",s=function(t,e){return null==a?void 0:a.getElementComputedStyle(t,e)}(e,t),u=("edge"===e?null==s?void 0:s.stroke:null==s?void 0:s.fill)||"#1783ff";n&&i&&i.replace(/\s+/g,"")&&(r.setFieldMap(i,n,e),l[i]||(l[i]={id:"".concat(e,"__").concat(n),label:i,marker:f[o]||d[e],elementType:e,lineWidth:1,stroke:u,fill:u}))}))};switch(e){case"node":v(s,"node");break;case"edge":v(u,"edge");break;case"combo":v(c,"combo");break;default:return[]}return Object.values(l)},r.createElement=function(){if(r.draw)r.updateElement();else{var t=r.options,e=t.width,n=t.height,i=t.nodeField,a=t.edgeField,o=t.comboField,s=(t.trigger,t.position,t.container,t.containerStyle,t.className,function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(t,["width","height","nodeField","edgeField","comboField","trigger","position","container","containerStyle","className"])),u=r.getMarkerData(i,"node"),c=r.getMarkerData(a,"edge"),l=r.getMarkerData(o,"combo"),h=[].concat(w(u),w(l),w(c)),d=Object.assign({width:e,height:n,data:h,itemMarkerLineWidth:function(t){return t.lineWidth},itemMarker:function(t){return t.marker},itemMarkerStroke:function(t){return t.stroke},itemMarkerFill:function(t){return t.fill},gridCol:u.length},s,r.getEvents()),f=new zk({className:"legend",style:d});r.category=f,r.upsertCanvas().appendChild(f),r.draw=!0}},r.bindEvents(),r}return N(e,t),b(e,[{key:"update",value:function(t){dn(e,"update",this,3)([t]),this.clear(),this.createElement()}},{key:"clear",value:function(){var t,e;null===(t=this.canvas)||void 0===t||t.destroy(),null===(e=this.container)||void 0===e||e.remove(),this.canvas=void 0,this.container=void 0,this.draw=!1}},{key:"updateElement",value:function(){var t=this;this.category&&this.category.update({itemMarkerOpacity:function(e){var n=e.id;return!t.selectedItems.length||t.selectedItems.includes(n)?1:.5},itemLabelOpacity:function(e){var n=e.id;return!t.selectedItems.length||t.selectedItems.includes(n)?1:.5}})}},{key:"upsertCanvas",value:function(){if(this.canvas)return this.canvas;var t=this.context.canvas,e=h(t.getSize(),2),n=e[0],r=e[1],i=this.options,a=i.width,o=void 0===a?n:a,s=i.height,u=void 0===s?r:s,c=i.position,l=i.container,d=i.containerStyle,f=i.className,v=h(Gk({width:o,height:u,graphCanvas:t,container:l,containerStyle:d,placement:c,className:"legend"}),2),p=v[0],g=v[1];return this.container=p,f&&p.classList.add(f),this.canvas=g,this.canvas}},{key:"destroy",value:function(){this.clear(),this.context.graph.off($c.AFTER_DRAW,this.createElement),dn(e,"destroy",this,3)([])}}])}(gw);Vk.defaultOptions={position:"bottom",trigger:"hover",orientation:"horizontal",layout:"flex",itemSpacing:4,rowPadding:10,colPadding:10,itemMarkerSize:16,itemLabelFontSize:16,width:240,height:160};var Wk=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).onDraw=function(t){var e;(null===(e=null==t?void 0:t.data)||void 0===e?void 0:e.render)||r.onRender()},r.shapes=new Map,r.landmarkMap=new Map,r.mask=null,r.isMaskDragging=!1,r.onMaskDragStart=function(t){r.mask&&(r.isMaskDragging=!0,r.mask.setPointerCapture(t.pointerId),r.mask.addEventListener("pointermove",r.onMaskDrag),r.mask.addEventListener("pointerup",r.onMaskDragEnd),r.mask.addEventListener("pointercancel",r.onMaskDragEnd))},r.onMaskDrag=function(t){if(r.mask&&r.isMaskDragging){var e=h(r.options.size,2),n=e[0],i=e[1],a=t.movementX,o=t.movementY,s=r.mask.style,u=s.left,c=s.top,l=s.width,d=s.height,f=h(r.maskBBox,4),v=f[2],p=f[3],g=parseInt(u)+a,y=parseInt(c)+o,m=parseInt(l),b=parseInt(d);g<0&&(g=0),y<0&&(y=0),g+m>n&&(g=Yk(n-m,0)),y+b>i&&(y=Yk(i-b,0)),m<v&&(a>0?(g=Yk(g-a,0),m=Hk(m+a,n)):a<0&&(m=Hk(m-a,n))),b<p&&(o>0?(y=Yk(y-o,0),b=Hk(b+o,i)):o<0&&(b=Hk(b-o,i))),Object.assign(r.mask.style,{left:g+"px",top:y+"px",width:m+"px",height:b+"px"});var x=parseInt(u)-g,w=parseInt(c)-y;if(0!==x||0!==w){var E=r.context.canvas.getCamera().getZoom()/r.canvas.getCamera().getZoom();r.context.graph.translateBy([x*E,w*E],!1)}}},r.onMaskDragEnd=function(t){r.mask&&(r.isMaskDragging=!1,r.mask.releasePointerCapture(t.pointerId),r.mask.removeEventListener("pointermove",r.onMaskDrag),r.mask.removeEventListener("pointerup",r.onMaskDragEnd),r.mask.removeEventListener("pointercancel",r.onMaskDragEnd))},r.onTransform=Ol((function(){r.isMaskDragging||(r.updateMask(),r.setCamera())}),32,{leading:!0}),r.setOnRender(),r.bindEvents(),r}return N(e,t),b(e,[{key:"update",value:function(t){this.unbindEvents(),dn(e,"update",this,3)([t]),"delay"in t&&this.setOnRender(),this.bindEvents()}},{key:"setOnRender",value:function(){var t=this;this.onRender=Sg((function(){t.renderMinimap(),t.renderMask()}),this.options.delay,!0)}},{key:"bindEvents",value:function(){var t=this.context.graph;t.on($c.AFTER_DRAW,this.onDraw),t.on($c.AFTER_RENDER,this.onRender),t.on($c.AFTER_TRANSFORM,this.onTransform)}},{key:"unbindEvents",value:function(){var t=this.context.graph;t.off($c.AFTER_DRAW,this.onDraw),t.off($c.AFTER_RENDER,this.onRender),t.off($c.AFTER_TRANSFORM,this.onTransform)}},{key:"renderMinimap",value:function(){var t=this.getElements(),e=this.initCanvas();this.setShapes(e,t)}},{key:"getElements",value:function(){var t=this.options.filter,e=this.context.model.getData();if(!t)return e;var n=e.nodes,r=e.edges,i=e.combos;return{nodes:n.filter((function(e){return t(yh(e),"node")})),edges:r.filter((function(e){return t(yh(e),"edge")})),combos:i.filter((function(e){return t(yh(e),"combo")}))}}},{key:"setShapes",value:function(t,e){var n=this,r=e.nodes,i=e.edges,a=e.combos,o=this.options.shape,s=this.context.element;if("key"===o){var u=new Set,c=function(e){var r=yh(e);u.add(r);var i=s.getElement(r);if(i){var a=i.getShape("key"),o=n.shapes.get(r)||a.cloneNode();o.setPosition(a.getPosition()),i.style.zIndex&&(o.style.zIndex=i.style.zIndex),o.id=i.id,n.shapes.has(r)?Object.entries(a.attributes).forEach((function(t){var e=h(t,2),n=e[0],r=e[1];o.style[n]!==r&&(o.style[n]=r)})):(t.appendChild(o),n.shapes.set(r,o))}};return i.forEach(c),a.forEach(c),r.forEach(c),void this.shapes.forEach((function(e,r){u.has(r)||(t.removeChild(e),n.shapes.delete(r))}))}var l=function(t,e){var n=s.getElement(t).getPosition();return e.setPosition(n),e};t.removeChildren(),i.forEach((function(e){return t.appendChild(o(yh(e),"edge"))})),a.forEach((function(e){t.appendChild(l(yh(e),o(yh(e),"combo")))})),r.forEach((function(e){t.appendChild(l(yh(e),o(yh(e),"node")))}))}},{key:"initCanvas",value:function(){var t=this.options,e=t.renderer,n=h(t.size,2),r=n[0],i=n[1];if(this.canvas){var a=this.canvas.getConfig(),o=a.width,s=a.height;r===o&&i===s||this.canvas.resize(r,i),e&&this.canvas.setRenderer(e)}else{var u=this.options,c=u.className,l=h(Gk({renderer:e,width:r,height:i,placement:u.position,className:"minimap",container:u.container,containerStyle:u.containerStyle,graphCanvas:this.context.canvas}),2),d=l[0],f=l[1];c&&d.classList.add(c),this.container=d,this.canvas=f}return this.setCamera(),this.canvas}},{key:"createLandmark",value:function(t,e,n){var r="".concat(t.join(","),"-").concat(e.join(","),"-").concat(n);if(this.landmarkMap.has(r))return this.landmarkMap.get(r);var i=this.canvas.getCamera().createLandmark(r,{position:t,focalPoint:e,zoom:n});return this.landmarkMap.set(r,i),i}},{key:"setCamera",value:function(){var t,e=this.context.canvas,n=null===(t=this.canvas)||void 0===t?void 0:t.getCamera();if(n){var r=this.options,i=h(r.size,2),a=i[0],o=i[1],s=h(Cl(r.padding),4),u=s[0],c=s[1],l=s[2],d=s[3],f=e.getBounds("elements"),v=f.min,p=f.max,g=f.center,y=(a-d-c)/(p[0]-v[0]),m=(o-u-l)/(p[1]-v[1]),b=Math.min(y,m),x=this.createLandmark(g,g,b);n.gotoLandmark(x,0)}}},{key:"maskBBox",get:function(){var t=this.context.canvas,e=t.getSize(),n=t.getCanvasByViewport([0,0]),r=t.getCanvasByViewport(e),i=this.canvas.canvas2Viewport(ad(n)),a=this.canvas.canvas2Viewport(ad(r)),o=a.x-i.x,s=a.y-i.y;return[i.x,i.y,o,s]}},{key:"calculateMaskBBox",value:function(){var t=h(this.options.size,2),e=t[0],n=t[1],r=h(this.maskBBox,4),i=r[0],a=r[1],o=r[2],s=r[3];return i<0&&(o=Hk(o+i,e),i=0),a<0&&(s=Hk(s+a,n),a=0),i+o>e&&(o=Yk(e-i,0)),a+s>n&&(s=Yk(n-a,0)),[Hk(i,e),Hk(a,n),Yk(o,0),Yk(s,0)]}},{key:"renderMask",value:function(){var t=this.options.maskStyle;this.mask||(this.mask=document.createElement("div"),this.mask.addEventListener("pointerdown",this.onMaskDragStart)),this.container.appendChild(this.mask),Object.assign(this.mask.style,Object.assign(Object.assign({},t),{cursor:"move",position:"absolute",pointerEvents:"auto"})),this.updateMask()}},{key:"updateMask",value:function(){if(this.mask){var t=h(this.calculateMaskBBox(),4),e=t[0],n=t[1],r=t[2],i=t[3];Object.assign(this.mask.style,{top:n+"px",left:e+"px",width:r+"px",height:i+"px"})}}},{key:"destroy",value:function(){var t;this.unbindEvents(),this.canvas.destroy(),null===(t=this.mask)||void 0===t||t.remove(),dn(e,"destroy",this,3)([])}}])}(gw);Wk.defaultOptions={size:[240,160],shape:"key",padding:10,position:"right-bottom",maskStyle:{border:"1px solid #ddd",background:"rgba(0, 0, 0, 0.1)"},containerStyle:{border:"1px solid #ddd",background:"#fff"},delay:128};var Hk=function(t,e){return Math.min(t,e)},Yk=function(t,e){return Math.max(t,e)},Uk=function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},qk={x1:0,y1:0,x2:0,y2:0,visibility:"hidden"},Xk=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).initSnapline=function(){var t=r.context.canvas.getLayer("transient");r.horizontalLine||(r.horizontalLine=t.appendChild(new bu({style:Object.assign(Object.assign({},qk),r.options.horizontalLineStyle)}))),r.verticalLine||(r.verticalLine=t.appendChild(new bu({style:Object.assign(Object.assign({},qk),r.options.verticalLineStyle)})))},r.isHorizontalSticking=!1,r.isVerticalSticking=!1,r.enableStick=!0,r.autoSnapToLine=function(t,e,n){return Uk(r,void 0,void 0,Tn().mark((function r(){var i,a,o,s,u,c,l,d,f,p,g,y,m,b;return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.verticalX,a=n.horizontalY,o=this.options.tolerance,s=h(e.min,2),u=s[0],c=s[1],l=h(e.max,2),d=l[0],f=l[1],p=h(e.center,2),g=p[0],y=p[1],m=0,b=0,null!==i&&(Kk(d,i)<o&&(m=i-d),Kk(u,i)<o&&(m=i-u),Kk(g,i)<o&&(m=i-g),0!==m&&(this.isVerticalSticking=!0)),null!==a&&(Kk(f,a)<o&&(b=a-f),Kk(c,a)<o&&(b=a-c),Kk(y,a)<o&&(b=a-y),0!==b&&(this.isHorizontalSticking=!0)),0===m&&0===b){r.next=10;break}return r.next=10,this.context.graph.translateElementBy(v({},t,[m,b]),!1);case 10:case"end":return r.stop()}}),r,this)})))},r.enableSnap=function(t){var e=t.target,n=.5;if(r.isHorizontalSticking||r.isVerticalSticking){var i=h(r.getDelta(t),2),a=i[0],o=i[1];if(r.isHorizontalSticking&&r.isVerticalSticking&&Math.abs(a)<=n&&Math.abs(o)<=n)return r.context.graph.translateElementBy(v({},e.id,[-a,-o]),!1),!1;if(r.isHorizontalSticking&&Math.abs(o)<=n)return r.context.graph.translateElementBy(v({},e.id,[0,-o]),!1),!1;if(r.isVerticalSticking&&Math.abs(a)<=n)return r.context.graph.translateElementBy(v({},e.id,[-a,0]),!1),!1;r.isHorizontalSticking=!1,r.isVerticalSticking=!1,r.enableStick=!1,setTimeout((function(){r.enableStick=!0}),200)}return r.enableStick},r.calcSnaplineMetadata=function(t,e){var n=r.options,i=n.tolerance,a=n.shape,o=h(e.min,2),s=o[0],u=o[1],c=h(e.max,2),l=c[0],d=c[1],f=h(e.center,2),v=f[0],p=f[1],g=null,y=null,m=null,b=null,x=null,w=null;return r.getNodes().some((function(e){if(Vc(t.id,e.id))return!1;var n=$k(e,a).getRenderBounds(),r=h(n.min,2),o=r[0],c=r[1],f=h(n.max,2),E=f[0],k=f[1],M=h(n.center,2),S=M[0],O=M[1];return null===g&&(Kk(S,v)<i?g=S:Kk(o,s)<i||Kk(o,l)<i?g=o:(Kk(E,l)<i||Kk(E,s)<i)&&(g=E),null!==g&&(y=Math.min(c,u),m=Math.max(k,d))),null===b&&(Kk(O,p)<i?b=O:Kk(c,u)<i||Kk(c,d)<i?b=c:(Kk(k,d)<i||Kk(k,u)<i)&&(b=k),null!==b&&(x=Math.min(o,s),w=Math.max(E,l))),null!==g&&null!==b})),{verticalX:g,verticalMinY:y,verticalMaxY:m,horizontalY:b,horizontalMinX:x,horizontalMaxX:w}},r.onDragStart=function(){r.initSnapline()},r.onDrag=function(t){return Uk(r,void 0,void 0,Tn().mark((function e(){var n,r,i;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target,!this.options.autoSnap){e.next=5;break}if(this.enableSnap(t)){e.next=5;break}return e.abrupt("return");case 5:if(r=$k(n,this.options.shape).getRenderBounds(),i=this.calcSnaplineMetadata(n,r),this.hideSnapline(),null===i.verticalX&&null===i.horizontalY||this.updateSnapline(i),!this.options.autoSnap){e.next=12;break}return e.next=12,this.autoSnapToLine(n.id,r,i);case 12:case"end":return e.stop()}}),e,this)})))},r.onDragEnd=function(){r.hideSnapline()},r.bindEvents(),r}return N(e,t),b(e,[{key:"getNodes",value:function(){var t,e=this,n=this.options.filter,r=((null===(t=this.context.element)||void 0===t?void 0:t.getNodes())||[]).filter((function(t){var n;return"hidden"!==Pd(t,["style","visibility"])&&(null===(n=e.context.viewport)||void 0===n?void 0:n.isInViewport(t.getRenderBounds()))}));return n?r.filter((function(t){return n(t)})):r}},{key:"hideSnapline",value:function(){this.horizontalLine.style.visibility="hidden",this.verticalLine.style.visibility="hidden"}},{key:"getLineWidth",value:function(t){return+(this.options["".concat(t,"LineStyle")].lineWidth||qk.lineWidth||1)/this.context.graph.getZoom()}},{key:"updateSnapline",value:function(t){var e=t.verticalX,n=t.verticalMinY,r=t.verticalMaxY,i=t.horizontalY,a=t.horizontalMinX,o=t.horizontalMaxX,s=h(this.context.canvas.getSize(),2),u=s[0],c=s[1],l=this.options.offset;null!==i?Object.assign(this.horizontalLine.style,{x1:l===1/0?0:a-l,y1:i,x2:l===1/0?u:o+l,y2:i,visibility:"visible",lineWidth:this.getLineWidth("horizontal")}):this.horizontalLine.style.visibility="hidden",null!==e?Object.assign(this.verticalLine.style,{x1:e,y1:l===1/0?0:n-l,x2:e,y2:l===1/0?c:r+l,visibility:"visible",lineWidth:this.getLineWidth("vertical")}):this.verticalLine.style.visibility="hidden"}},{key:"getDelta",value:function(t){var e=this.context.graph.getZoom();return Vh([t.dx,t.dy],e)}},{key:"bindEvents",value:function(){return Uk(this,void 0,void 0,Tn().mark((function t(){var e;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(e=this.context.graph).on(Qc.DRAG_START,this.onDragStart),e.on(Qc.DRAG,this.onDrag),e.on(Qc.DRAG_END,this.onDragEnd);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"unbindEvents",value:function(){var t=this.context.graph;t.off(Qc.DRAG_START,this.onDragStart),t.off(Qc.DRAG,this.onDrag),t.off(Qc.DRAG_END,this.onDragEnd)}},{key:"destroyElements",value:function(){var t,e;null===(t=this.horizontalLine)||void 0===t||t.destroy(),null===(e=this.verticalLine)||void 0===e||e.destroy()}},{key:"destroy",value:function(){this.destroyElements(),this.unbindEvents(),dn(e,"destroy",this,3)([])}}])}(gw);Xk.defaultOptions={tolerance:5,offset:20,autoSnap:!0,shape:"key",verticalLineStyle:{stroke:"#1783FF"},horizontalLineStyle:{stroke:"#1783FF"},filter:function(){return!0}};var Kk=function(t,e){return Math.abs(t-e)},$k=function(t,e){return"function"==typeof e?e(t):t.getShape(e)};function Zk(t,e){var n={YYYY:t.getFullYear(),MM:t.getMonth()+1,DD:t.getDate(),HH:t.getHours(),mm:t.getMinutes(),ss:t.getSeconds()},r=e;return Object.keys(n).forEach((function(t){var e=n[t];r=r.replace(t,"YYYY"===t?"".concat(e):"".concat(e).padStart(2,"0"))})),r}var Qk={data:[],animate:{enter:!1,update:{duration:100,easing:"ease-in-out-sine",fill:"both"},exit:{duration:100,fill:"both"}},showArrow:!0,showGrid:!0,showLabel:!0,showLine:!0,showTick:!0,showTitle:!0,showTrunc:!1,dataThreshold:100,lineLineWidth:1,lineStroke:"black",crossPadding:10,titleFill:"black",titleFontSize:12,titlePosition:"lb",titleSpacing:0,titleTextAlign:"center",titleTextBaseline:"middle",lineArrow:function(){return new wu({style:{d:[["M",10,10],["L",-10,0],["L",10,-10],["L",0,0],["L",10,10],["Z"]],fill:"black",transformOrigin:"center"}})},labelAlign:"parallel",labelDirection:"positive",labelFontSize:12,labelSpacing:0,gridConnect:"line",gridControlAngles:[],gridDirection:"positive",gridLength:0,gridType:"segment",lineArrowOffset:15,lineArrowSize:10,tickDirection:"positive",tickLength:5,tickLineWidth:1,tickStroke:"black",labelOverlap:[]},Jk=(jh({},Qk,{style:{type:"arc"}}),jh({},Qk,{style:{}}),ZE({mainGroup:"main-group",gridGroup:"grid-group",grid:"grid",lineGroup:"line-group",line:"line",tickGroup:"tick-group",tick:"tick",tickItem:"tick-item",labelGroup:"label-group",label:"label",labelItem:"label-item",titleGroup:"title-group",title:"title",lineFirst:"line-first",lineSecond:"line-second"},"axis"));function tM(t,e){return[t[0]*e,t[1]*e]}function eM(t,e){return[t[0]+e[0],t[1]+e[1]]}function nM(t,e){return[t[0]-e[0],t[1]-e[1]]}function rM(t,e){return[Math.min(t[0],e[0]),Math.min(t[1],e[1])]}function iM(t,e){return[Math.max(t[0],e[0]),Math.max(t[1],e[1])]}function aM(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function oM(t){if(0===t[0]&&0===t[1])return[0,0];var e=Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2));return[t[0]/e,t[1]/e]}function sM(t){return t*Math.PI/180}function uM(t){return Number((180*t/Math.PI).toPrecision(5))}function cM(t,e){return t.style.opacity||(t.style.opacity=1),lk(t,{opacity:0},e)}var lM=["$el","cx","cy","d","dx","dy","fill","fillOpacity","filter","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","img","increasedLineWidthForHitTesting","innerHTML","isBillboard","billboardRotation","isSizeAttenuation","isClosed","isOverflowing","leading","letterSpacing","lineDash","lineHeight","lineWidth","markerEnd","markerEndOffset","markerMid","markerStart","markerStartOffset","maxLines","metrics","miterLimit","offsetX","offsetY","opacity","path","points","r","radius","rx","ry","shadowColor","src","stroke","strokeOpacity","text","textAlign","textBaseline","textDecorationColor","textDecorationLine","textDecorationStyle","textOverflow","textPath","textPathSide","textPathStartOffset","transform","transformOrigin","visibility","width","wordWrap","wordWrapWidth","x","x1","x2","y","y1","y2","z1","z2","zIndex"];function hM(t){return lM.includes(t)}function dM(t){var e={};for(var n in t)hM(n)&&(e[n]=t[n]);return e}var fM=ZE({lineGroup:"line-group",line:"line",regionGroup:"region-group",region:"region"},"grid");function vM(t){return t.reduce((function(t,e,n){return t.push(me([0===n?"M":"L"],ye(e),!1)),t}),[])}function pM(t,e,n){return"surround"===e.type?function(t,e,n){var r=e.connect,i=void 0===r?"line":r,a=e.center;if("line"===i)return vM(t);if(!a)return[];var o=aM(t[0],a),s=n?0:1;return t.reduce((function(t,e,n){return 0===n?t.push(me(["M"],ye(e),!1)):t.push(me(["A",o,o,0,0,s],ye(e),!1)),t}),[])}(t,e,n):vM(t)}function gM(t,e,n){var r=n.type,i=n.connect,a=n.center,o=n.closed?[["Z"]]:[],s=ye([pM(t,n),pM(e.slice().reverse(),n,!0)],2),u=s[0],c=s[1],l=ye([t[0],e.slice(-1)[0]],2),h=l[0],d=l[1],f=function(t,e){return[u,t,c,e,o].flat()};if("line"===i||"surround"===r)return f([me(["L"],ye(d),!1)],[me(["L"],ye(h),!1)]);if(!a)throw new Error("Arc grid need to specified center");var v=ye([aM(d,a),aM(h,a)],2),p=v[0],g=v[1];return f([me(["A",p,p,0,0,1],ye(d),!1),me(["L"],ye(d),!1)],[me(["A",g,g,0,0,0],ye(h),!1),me(["L"],ye(h),!1)])}var yM=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return de(e,t),e.prototype.render=function(t,e){t.type,t.center,t.areaFill,t.closed;var n=ve(t,["type","center","areaFill","closed"]),r=function(t){var e=t.data,n=void 0===e?[]:e;return t.closed?n.map((function(t){var e=t.points,n=ye(e,1)[0];return fe(fe({},t),{points:me(me([],ye(e),!1),[n],!1)})})):n}(t),i=KE(e).maybeAppendByClassName(fM.lineGroup,"g"),a=KE(e).maybeAppendByClassName(fM.regionGroup,"g"),o=function(t,e,n,r){var i=n.animate,a=n.isBillboard,o=e.map((function(t,e){return{id:t.id||"grid-line-".concat(e),d:pM(t.points,n)}}));return t.selectAll(fM.line.class).data(o,(function(t){return t.id})).join((function(t){return t.append("path").each((function(t,e){var n=ak(dM(fe({d:t.d},r)),[t,e,o]);this.attr(fe({class:fM.line.name,stroke:"#D9D9D9",lineWidth:1,lineDash:[4,4],isBillboard:a},n))}))}),(function(t){return t.transition((function(t,e){return lk(this,ak(dM(fe({d:t.d},r)),[t,e,o]),i.update)}))}),(function(t){return t.transition((function(){var t=this,e=cM(this,i.exit);return sk(e,(function(){return t.remove()})),e}))})).transitions()}(i,r,t,n),s=function(t,e,n){var r=n.animate,i=n.connect,a=n.areaFill;if(e.length<2||!a||!i)return[];for(var o=Array.isArray(a)?a:[a,"transparent"],s=function(t){return o[t%o.length]},u=[],c=0;c<e.length-1;c++){var l=ye([e[c].points,e[c+1].points],2),h=gM(l[0],l[1],n);u.push({d:h,fill:s(c)})}return t.selectAll(fM.region.class).data(u,(function(t,e){return e})).join((function(t){return t.append("path").each((function(t,e){var n=ak(t,[t,e,u]);this.attr(n)})).attr("className",fM.region.name)}),(function(t){return t.transition((function(t,e){return lk(this,ak(t,[t,e,u]),r.update)}))}),(function(t){return t.transition((function(){var t=this,e=cM(this,r.exit);return sk(e,(function(){return t.remove()})),e}))})).transitions()}(a,r,t);return me(me([],ye(o),!1),ye(s),!1)},e}(zE);function mM(t,e){return"number"==typeof t&&"number"==typeof e?function(t,e){return function(n){return t*(1-n)+e*n}}(t,e):Array.isArray(t)&&Array.isArray(e)?function(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0;return function(i){var a=new Array(r),o=new Array(n),s=0;for(s=0;s<r;++s)a[s]=mM(t[s],e[s]);for(;s<n;++s)o[s]=e[s];for(s=0;s<r;++s)o[s]=a[s](i);return o}}(t,e):"object"==typeof t&&"object"==typeof e?function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var n={},r={};return Object.entries(e).forEach((function(e){var i=ye(e,2),a=i[0],o=i[1];a in t?n[a]=mM(t[a],o):r[a]=o})),function(t){return Object.entries(n).forEach((function(e){var n=ye(e,2),i=n[0],a=n[1];return r[i]=a(t)})),r}}(t,e):function(e){return t}}function bM(t,e){var n={},r=Array.isArray(e)?e:[e];for(var i in t)r.includes(i)||(n[i]=t[i]);return n}function xM(t,e){return Object.fromEntries(Object.entries(t).map((function(t){var n=ye(t,2);return[n[0],ak(n[1],e)]})))}function wM(t,e){return e&&cn(e)?t.filter(e):t}function EM(t,e){var n=e.startAngle;return(e.endAngle-n)*t+n}function kM(t,e){if("linear"===e.type){var n=ye(e.startPos,2),r=n[0],i=n[1],a=ye(e.endPos,2),o=ye([a[0]-r,a[1]-i],2);return oM([o[0],o[1]])}var s=sM(EM(t,e));return[-Math.sin(s),Math.cos(s)]}function MM(t,e,n){return function(t,e){return e?[t[1],-t[0]]:[-t[1],t[0]]}(kM(t,n),"positive"!==e)}function SM(t,e){return MM(t,e.labelDirection,e)}function OM(t,e){return"linear"===e.type?function(t,e){var n=ye(e.startPos,2),r=n[0],i=n[1],a=ye(e.endPos,2),o=ye([a[0]-r,a[1]-i],2);return[r+o[0]*t,i+o[1]*t]}(t,e):function(t,e){var n=e.radius,r=ye(e.center,2),i=r[0],a=r[1],o=sM(EM(t,e));return[i+n*Math.cos(o),a+n*Math.sin(o)]}(t,e)}function NM(t){return 0===kM(0,t)[1]}function AM(t){return 0===kM(0,t)[0]}function TM(t,e){return e-t==360}function PM(t,e,n,r,i){var a=e-t,o=ye([i,i],2),s=o[0],u=o[1],c=ye([sM(t),sM(e)],2),l=c[0],h=c[1],d=function(t){return[n+i*Math.cos(t),r+i*Math.sin(t)]},f=ye(d(l),2),v=f[0],p=f[1],g=ye(d(h),2),y=g[0],m=g[1];if(TM(t,e)){var b=ye(d((h+l)/2),2);return[["M",v,p],["A",s,u,0,1,0,b[0],b[1]],["A",s,u,0,1,0,y,m]]}var x=a>180?1:0,w=t>e?0:1;return"M".concat(v,",").concat(p,",A").concat(s,",").concat(u,",0,").concat(x,",").concat(w,",").concat(y,",").concat(m)}function CM(t,e,n,r){var i=e.startAngle,a=e.endAngle,o=e.center,s=e.radius;return t.selectAll(Jk.line.class).data([{d:PM.apply(void 0,me(me([i,a],ye(o),!1),[s],!1))}],(function(t,e){return e})).join((function(t){return t.append("path").attr("className",Jk.line.name).styles(e).styles({d:function(t){return t.d}})}),(function(t){return t.transition((function(){var t=this,e=function(t,e,n,r){if(!r)return t.attr("__keyframe_data__",n),null;var i=r.duration,a=void 0===i?0:i,o=mM(e,n),s=Math.ceil(+a/16),u=new Array(s).fill(0).map((function(t,e,n){return{__keyframe_data__:o(e/(n.length-1))}}));return t.animate(u,fe({fill:"both"},r))}(this,function(t){var e=t.attributes,n=e.startAngle,r=e.endAngle,i=e.center,a=e.radius;return me(me([n,r],ye(i),!1),[a],!1)}(this),me(me([i,a],ye(o),!1),[s],!1),r.update);if(e){var n=function(){var e=Pd(t.attributes,"__keyframe_data__");t.style.d=PM.apply(void 0,me([],ye(e),!1))};e.onframe=n,e.onfinish=n}return e})).styles(e)}),(function(t){return t.remove()})).styles(n).transitions()}function RM(t){var e=ye(t,2),n=ye(e[0],2),r=n[0],i=n[1],a=ye(e[1],2);return{x1:r,y1:i,x2:a[0],y2:a[1]}}function LM(t,e,n){var r,i=e.type,a=HE(e,"line");return r="linear"===i?function(t,e,n,r){var i=e.showTrunc,a=e.startPos,o=e.endPos,s=e.truncRange,u=e.lineExtension,c=ye([a,o],2),l=ye(c[0],2),h=l[0],d=l[1],f=ye(c[1],2),v=f[0],p=f[1],g=ye(u?function(t,e,n){void 0===n&&(n=[0,0]);var r=ye([t,e,n],3),i=ye(r[0],2),a=i[0],o=i[1],s=ye(r[1],2),u=s[0],c=s[1],l=ye(r[2],2),h=l[0],d=l[1],f=ye([u-a,c-o],2),v=f[0],p=f[1],g=Math.sqrt(Math.pow(v,2)+Math.pow(p,2)),y=ye([-h/g,d/g],2),m=y[0],b=y[1];return[m*v,m*p,b*v,b*p]}(a,o,u):new Array(4).fill(0),4),y=g[0],m=g[1],b=g[2],x=g[3],w=function(e){return t.selectAll(Jk.line.class).data(e,(function(t,e){return e})).join((function(t){return t.append("line").attr("className",(function(t){return"".concat(Jk.line.name," ").concat(t.className)})).styles(n).transition((function(t){return lk(this,RM(t.line),!1)}))}),(function(t){return t.styles(n).transition((function(t){return lk(this,RM(t.line),r.update)}))}),(function(t){return t.remove()})).transitions()};if(!i||!s)return w([{line:[[h+y,d+m],[v+b,p+x]],className:Jk.line.name}]);var E=ye(s,2),k=E[0],M=E[1],S=v-h,O=p-d,N=ye([h+S*k,d+O*k],2),A=N[0],T=N[1],P=ye([h+S*M,d+O*M],2),C=P[0],R=P[1],L=w([{line:[[h+y,d+m],[A,T]],className:Jk.lineFirst.name},{line:[[C,R],[v+b,p+x]],className:Jk.lineSecond.name}]);return function(t,e){e.truncRange,e.truncShape,e.lineExtension}(0,e),L}(t,e,bM(a,"arrow"),n):CM(t,e,bM(a,"arrow"),n),function(t,e,n,r){var i,a=n.showArrow,o=n.showTrunc,s=n.lineArrow,u=n.lineArrowOffset,c=n.lineArrowSize;if(i="arc"===e?t.select(Jk.line.class):o?t.select(Jk.lineSecond.class):t.select(Jk.line.class),!a||!s||"arc"===n.type&&TM(n.startAngle,n.endAngle)){var l=i.node();l&&(l.style.markerEnd=void 0)}else{var h=Mk(s);h.attr(r),hk(h,c,!0),i.style("markerEnd",h).style("markerEndOffset",-u)}}(t,i,e,a),r}function DM(t){var e=t.type,n=t.gridCenter;return"linear"===e?n:n||t.center}function _M(t,e,n,r){var i=HE(n,"grid"),a=i.type,o=i.areaFill,s=DM(n),u=wM(e,n.gridFilter),c="segment"===a?function(t,e){var n=e.gridLength;return t.map((function(t,r){var i=t.value,a=ye(OM(i,e),2),o=a[0],s=a[1],u=ye(tM(function(t,e){return MM(t,e.gridDirection,e)}(i,e),n),2);return{id:r,points:[[o,s],[o+u[0],s+u[1]]]}}))}(u,n):function(t,e){var n=e.gridControlAngles,r=DM(e);if(!r)throw new Error("grid center is not provide");if(t.length<2)throw new Error("Invalid grid data");if(!n||0===n.length)throw new Error("Invalid gridControlAngles");var i=ye(r,2),a=i[0],o=i[1];return t.map((function(t,r){var i=ye(OM(t.value,e),2),s=i[0],u=i[1],c=ye([s-a,u-o],2),l=c[0],h=c[1],d=[];return n.forEach((function(t){var e=sM(t),n=ye([Math.cos(e),Math.sin(e)],2),r=n[0],i=n[1],s=l*r-h*i+a,u=l*i+h*r+o;d.push([s,u])})),{points:d,id:r}}))}(u,n),l=fe(fe({},i),{center:s,areaFill:cn(o)?u.map((function(t,e){return ak(o,[t,e,u])})):o,animate:r,data:c});return t.selectAll(Jk.grid.class).data([1]).join((function(t){return t.append((function(){return new yM({style:l})})).attr("className",Jk.grid.name)}),(function(t){return t.transition((function(){return this.update(l)}))}),(function(t){return t.remove()})).transitions()}function IM(t,e,n,r,i){return void 0===r&&(r=!0),void 0===i&&(i=!1),!!(r&&t===e||i&&t===n)||t>e&&t<n}function jM(t,e){if(e)try{var n=e.replace(/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,(function(e,n,r){return"translate(".concat(function(t,e,n){var r=t.getBBox(),i=r.width,a=r.height,o=ye([e,n].map((function(t,e){var n;return t.includes("%")?parseFloat((null===(n=t.match(/[+-]?([0-9]*[.])?[0-9]+/))||void 0===n?void 0:n[0])||"0")/100*(0===e?i:a):t})),2);return[o[0],o[1]]}(t,n,r),")")}));t.attr("transform",n)}catch(t){}}var FM=function(t){return void 0!==t&&null!=t&&!Number.isNaN(t)},BM=function(){function t(t,e,n,r){this.set(t,e,n,r)}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),t.prototype.rotatedPoints=function(t,e,n){var r=this,i=r.x1,a=r.y1,o=r.x2,s=r.y2,u=Math.cos(t),c=Math.sin(t),l=e-e*u+n*c,h=n-e*c-n*u;return[[u*i-c*s+l,c*i+u*s+h],[u*o-c*s+l,c*o+u*s+h],[u*i-c*a+l,c*i+u*a+h],[u*o-c*a+l,c*o+u*a+h]]},t.prototype.set=function(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},t.prototype.defined=function(t){return this[t]!==Number.MAX_VALUE&&this[t]!==-Number.MAX_VALUE},t}();function zM(t,e){var n=t.getEulerAngles()||0;t.setEulerAngles(0);var r=t.getBounds(),i=ye(r.min,2),a=i[0],o=i[1],s=ye(r.max,2),u=s[0],c=s[1],l=t.getBBox(),h=l.width,d=l.height,f=0,v=0,p=a,g=o,y=Nk(t);if(y){d-=1.5;var m=y.style.textAlign,b=y.style.textBaseline;"center"===m?p=(a+u)/2:"right"!==m&&"end"!==m||(p=u),"middle"===b?g=(o+c)/2:"bottom"===b&&(g=c)}var x=ye(QE(e),4),w=x[0],E=void 0===w?0:w,k=x[1],M=void 0===k?0:k,S=x[2],O=void 0===S?E:S,N=x[3],A=new BM((f+=a)-(void 0===N?M:N),(v+=o)-E,f+h+M,v+d+O);return t.setEulerAngles(n),A.rotatedPoints(sM(n),p,g)}function GM(t,e){return e[0]<=Math.max(t[0][0],t[1][0])&&e[0]<=Math.min(t[0][0],t[1][0])&&e[1]<=Math.max(t[0][1],t[1][1])&&e[1]<=Math.min(t[0][1],t[1][1])}function VM(t,e,n){var r=(e[1]-t[1])*(n[0]-e[0])-(e[0]-t[0])*(n[1]-e[1]);return 0===r?0:r<0?2:1}function WM(t,e){return[[t[0],t[1],t[2],t[3]],[t[2],t[3],t[4],t[5]],[t[4],t[5],t[6],t[7]],[t[6],t[7],t[0],t[1]]].some((function(t){return function(t,e){var n=ye(t,4),r=n[0],i=n[1],a=n[2],o=n[3],s=ye(e,4),u=s[0],c=s[1],l=a-r,h=o-i,d=s[2]-u,f=s[3]-c,v=l*f-d*h;if(0===v)return!1;var p=v>0,g=r-u,y=i-c,m=l*y-h*g;if(m<0===p)return!1;var b=d*y-f*g;return b<0!==p&&m>v!==p&&b>v!==p}(e,t)}))}function HM(t,e,n){var r,i,a,o,s=e.crossPadding,u=new Set,c=null,l=function(t,e){var n=t.type,r=t.labelDirection,i=t.crossSize;if(!i)return!1;if("arc"===n){var a=t.center,o=t.radius,s=ye(a,2),u=s[0],c=s[1],l="negative"===r?0:i,h=-o-l,d=o+l,f=ye(QE(e),4),v=f[0],p=f[1],g=f[2],y=f[3];return new BM(u+h-y,c+h-v,u+d+p,c+d+g)}var m=ye(t.startPos,2),b=m[0],x=m[1],w=ye(t.endPos,2),E=w[0],k=w[1],M=ye(AM(t)?[-e,0,e,0]:[0,e,0,-e],4),S=M[0],O=M[1],N=M[2],A=M[3],T=tM(SM(0,t),i),P=new BM(b,x,E,k);return P.x1+=A,P.y1+=S,P.x2+=O+T[0],P.y2+=N+T[1],P}(e,s),h=function(t){return!l||(n=t,i=(e=l).x1,a=e.x2,o=e.y1,s=e.y2,r=[[i,o],[a,o],[a,s],[i,s]],zM(n,void 0).every((function(t){return function(t,e){var n=t.length;if(n<3)return!1;var r,i,a,o,s,u,c=[e,[9999,e[1]]],l=0,h=0;do{var d=[t[h],t[(h+1)%n]];if(a=VM((r=d)[0],r[1],(i=c)[0]),o=VM(r[0],r[1],i[1]),s=VM(i[0],i[1],r[0]),u=VM(i[0],i[1],r[1]),a!==o&&s!==u||0===a&&GM(r,i[0])||0===o&&GM(r,i[1])||0===s&&GM(i,r[0])||0===u&&GM(i,r[1])){if(0===VM(d[0],e,d[1]))return GM(d,e);l++}h=(h+1)%n}while(0!==h);return!!(1&l)}(r,t)})));var e,n,r,i,a,o,s};try{for(var d=ge(t),f=d.next();!f.done;f=d.next()){var v=f.value;h(v)?c&&(o=v,(a=c)&&a.firstChild&&function(t,e,n){var r,i,a=zM(t,n).flat(1),o=zM(e,n).flat(1),s=[[a[0],a[1],a[2],a[3]],[a[0],a[1],a[4],a[5]],[a[4],a[5],a[6],a[7]],[a[2],a[3],a[6],a[7]]];try{for(var u=ge(s),c=u.next();!c.done;c=u.next())if(WM(o,c.value))return!0}catch(t){r={error:t}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return!1}(a.firstChild,o.firstChild,QE(n)))?(u.add(c),u.add(v)):c=v:u.add(v)}}catch(t){r={error:t}}finally{try{f&&!f.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}return Array.from(u)}function YM(t,e){return void 0===e&&(e={}),ue(t)?0:"number"==typeof t?t:Math.floor(Sk(t,e))}var UM=function(t,e){var n=e.seq,r=void 0===n?2:n;return t.filter((function(t,e){return!(e%r&&(LE(t),1))}))},qM=new Map([["hide",function(t,e,n,r){var i=t.length,a=e.keepHeader,o=e.keepTail;if(!(i<=1||2===i&&a&&o)){var s,u,c,l=UM,h=function(t){return t.forEach(r.show),t},d=2,f=t.slice(),v=t.slice(),p=Math.min.apply(Math,me([1],ye(t.map((function(t){return t.getBBox().width}))),!1));if("linear"===n.type&&(NM(n)||AM(n))){var g=Ek(t[0]).left,y=Ek(t[i-1]).right,m=Math.abs(y-g)||1;d=Math.max(Math.floor(i*p/m),d)}for(a&&(s=f.splice(0,1)[0]),o&&(u=f.splice(-1,1)[0],f.reverse()),h(f);d<t.length&&HM((c=u?me(me([u],ye(v),!1),[s],!1):me([s],ye(v),!1),c.filter(FM)),n,null==e?void 0:e.margin).length;)(u&&!s&&d%2==0||u&&s)&&f.splice(0,1).forEach(r.hide),v=l(h(f),{seq:d}),d++}}],["rotate",function(t,e,n,r){var i,a,o=e.optionalAngles,s=void 0===o?[0,45,90]:o,u=e.margin,c=e.recoverWhenFailed,l=void 0===c||c,h=t.map((function(t){return t.getLocalEulerAngles()})),d=function(e){return t.forEach((function(t,n){var i=Array.isArray(e)?e[n]:e;r.rotate(t,+i)}))};try{for(var f=ge(s),v=f.next();!v.done;v=f.next())if(d(v.value),HM(t,n,u).length<1)return}catch(t){i={error:t}}finally{try{v&&!v.done&&(a=f.return)&&a.call(f)}finally{if(i)throw i.error}}l&&d(h)}],["ellipsis",function(t,e,n,r){if(!(t.length<=1)){var i=e.suffix,a=void 0===i?"...":i,o=e.minLength,s=e.maxLength,u=void 0===s?1/0:s,c=e.step,l=void 0===c?" ":c,h=e.margin,d=void 0===h?[0,0,0,0]:h,f=Ok(r.getTextShape(t[0])),v=YM(l,f),p=o?YM(o,f):v,g=YM(u,f);(ue(g)||g===1/0)&&(g=Math.max.apply(null,t.map((function(t){return t.getBBox().width}))));for(var y=t.slice(),m=ye(d,4),b=(m[0],m[1],m[2],m[3],function(e){if(y.forEach((function(t){r.ellipsis(r.getTextShape(t),e,a)})),(y=HM(t,n,d)).length<1)return{value:void 0}}),x=g;x>p+v;x-=v){var w=b(x);if("object"==typeof w)return w.value}}}],["wrap",function(t,e,n,r){var i=e.wordWrapWidth,a=void 0===i?50:i,o=e.maxLines,s=void 0===o?3:o,u=e.recoverWhenFailed,c=void 0===u||u,l=e.margin,h=void 0===l?[0,0,0,0]:l,d=t.map((function(t){return t.attr("maxLines")||1})),f=Math.min.apply(Math,me([],ye(d),!1)),v=function(t){var e=t.type,n=t.labelDirection;return"linear"===e&&NM(t)?"negative"===n?"bottom":"top":"middle"}(n),p=function(e){return t.forEach((function(t,n){var i=Array.isArray(e)?e[n]:e;r.wrap(t,a,i,v)}))};if(!(f>s)){for(var g=f;g<=s;g++)if(p(g),HM(t,n,h).length<1)return;c&&p(d)}}]]);function XM(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.reduce((function(t,e){return t*("positive"===e?-1:1)}),1)}function KM(t){for(var e=t;e<0;)e+=360;return Math.round(e%360)}function $M(t,e){var n=ye(t,2),r=n[0],i=n[1],a=ye(e,2),o=a[0],s=a[1],u=ye([r*o+i*s,r*s-i*o],2),c=u[0],l=u[1];return Math.atan2(l,c)}function ZM(t,e,n){var r=n.type,i=n.labelAlign,a=SM(t,n),o=KM(e),s=KM(uM($M([1,0],a))),u="center",c="middle";return"linear"===r?[90,270].includes(s)&&0===o?(u="center",c=1===a[1]?"top":"bottom"):s%180||![90,270].includes(o)?0===s?(IM(o,0,90,!1,!0)||IM(o,0,90)||IM(o,270,360))&&(u="start"):90===s?IM(o,0,90,!1,!0)?u="start":(IM(o,90,180)||IM(o,270,360))&&(u="end"):270===s?IM(o,0,90,!1,!0)?u="end":(IM(o,90,180)||IM(o,270,360))&&(u="start"):180===s&&(90===o?u="start":(IM(o,0,90)||IM(o,270,360))&&(u="end")):u="center":"parallel"===i?c=IM(s,0,180,!0)?"top":"bottom":"horizontal"===i?IM(s,90,270,!1)?u="end":(IM(s,270,360,!1)||IM(s,0,90))&&(u="start"):"perpendicular"===i&&(u=IM(s,90,270)?"end":"start"),{textAlign:u,textBaseline:c}}function QM(t,e,n){var r=n.showTick,i=n.tickLength,a=n.tickDirection,o=n.labelDirection,s=n.labelSpacing,u=e.indexOf(t),c=ak(s,[t,u,e]),l=ye([SM(t.value,n),XM(o,a)],2),h=ye(eM(tM(l[0],c+(1===l[1]?ak(r?i:0,[t,u,e]):0)),OM(t.value,n)),2);return{x:h[0],y:h[1]}}function JM(t,e){"text"===t.nodeName&&t.attr(e)}function tS(t){!function(t,e,n){var r=e.labelOverlap,i=void 0===r?[]:r;i.length&&i.forEach((function(r){var i=r.type,a=qM.get(i);(function(t,e,n){return!(e.labelOverlap.length<1)&&("hide"===n?!function(t){for(var e=t;e;){if("offscreen"===e.className)return!0;e=e.parent}return!1}(t[0]):"rotate"===n?!t.some((function(t){var e;return!!(null===(e=t.attr("transform"))||void 0===e?void 0:e.includes("rotate"))})):"ellipsis"!==n&&"wrap"!==n||t.filter((function(t){return t.querySelector("text")})).length>1)})(t,e,i)&&(null==a||a(t,r,e,n))}))}(this.node().childNodes,t,{hide:LE,show:RE,rotate:function(e,n){!function(t,e,n){e.setLocalEulerAngles(t);var r=ZM(e.__data__.value,t,n),i=e.querySelector(Jk.labelItem.class);i&&JM(i,r)}(+n,e,t)},ellipsis:function(t,e,n){t&&Tk(t,e||1/0,n)},wrap:function(t,e,n){t&&function(t,e,n,r){void 0===n&&(n=2),void 0===r&&(r="top"),Ak(t,{wordWrap:!0,wordWrapWidth:e,maxLines:n,textBaseline:r})}(t,e,n)},getTextShape:function(t){return t.querySelector("text")}})}function eS(t,e,n,r,i){var a=n.indexOf(e),o=KE(t).append(function(t,e,n,r){var i=r.labelFormatter;return cn(i)?function(){return Mk(ak(i,[t,e,n,SM(t.value,r)]))}:function(){return Mk(t.label||"")}}(e,a,n,i)).attr("className",Jk.labelItem.name).node(),s=ye(UE(xM(r,[e,a,n])),2),u=s[0],c=s[1],l=c.transform,h=ve(c,["transform"]);jM(o,l);var d=function(t,e,n){var r,i=n.labelAlign;if(null===(r=e.style.transform)||void 0===r?void 0:r.includes("rotate"))return e.getLocalEulerAngles();var a=SM(t.value,n),o=kM(t.value,n);return"horizontal"===i?0:function(t){var e=(t+360)%180;return IM(e,-90,90)||(e+=180),e}(uM("perpendicular"===i?$M([1,0],a):$M([o[0]<0?-1:1,0],o)))}(e,o,i);return o.getLocalEulerAngles()||o.setLocalEulerAngles(d),JM(o,fe(fe({},ZM(e.value,d,i)),u)),t.attr(h),o}function nS(t,e){return MM(t,e.tickDirection,e)}function rS(t,e,n,r,i,a){var o=function(t,e,n,r,i){var a=i.tickFormatter,o=nS(e.value,i),s="line";return cn(a)&&(s=function(){return ak(a,[e,n,r,o])}),t.append(s).attr("className",Jk.tickItem.name)}(KE(this),t,e,n,r);!function(t,e,n,r,i,a,o){var s=nS(t.value,a),u=function(t,e,n,r,i){var a=ye(function(t,e){var n=ye(t,2);return[[0,0],[n[0]*e,n[1]*e]]}(r,ak(i.tickLength,[t,e,n])),2),o=ye(a[0],2),s=o[0],u=o[1],c=ye(a[1],2);return{x1:s,x2:c[0],y1:u,y2:c[1]}}(t,e,n,s,a),c=u.x1,l=u.x2,h=u.y1,d=u.y2,f=ye(UE(xM(o,[t,e,n,s])),2),v=f[0],p=f[1];"line"===r.node().nodeName&&r.styles(fe({x1:c,x2:l,y1:h,y2:d},v)),i.attr(p),r.styles(v)}(t,e,n,o,this,r,i);var s=ye(OM(t.value,r),2),u=s[0],c=s[1];return lk(this,{transform:"translate(".concat(u,", ").concat(c,")")},a)}function iS(t,e,n,r,i){var a=ye(UE(HE(r,"title")),2),o=a[0],s=a[1],u=s.transform,c=s.transformOrigin,l=ve(s,["transform","transformOrigin"]);e.styles(l);var h=u||function(t,e,n){var r=2*t.getGeometryBounds().halfExtents[1];if("vertical"===e){if("left"===n)return"rotate(-90) translate(0, ".concat(r/2,")");if("right"===n)return"rotate(-90) translate(0, -".concat(r/2,")")}return""}(t.node(),o.direction,o.position);t.styles(fe(fe({},o),{transformOrigin:c})),jM(t.node(),h);var d=function(t,e,n){var r=n.titlePosition,i=void 0===r?"lb":r,a=n.titleSpacing,o=ek(i),s=t.node().getLocalBounds(),u=ye(s.min,2),c=u[0],l=u[1],h=ye(s.halfExtents,2),d=h[0],f=h[1],v=ye(e.node().getLocalBounds().halfExtents,2),p=v[0],g=v[1],y=ye([c+d,l+f],2),m=y[0],b=y[1],x=ye(QE(a),4),w=x[0],E=x[1],k=x[2],M=x[3];if(["start","end"].includes(i)&&"linear"===n.type){var S=n.startPos,O=n.endPos,N=ye("start"===i?[S,O]:[O,S],2),A=N[0],T=N[1],P=ye(tM(oM([-T[0]+A[0],-T[1]+A[1]]),w),2),C=P[0],R=P[1];return{x:A[0]+C,y:A[1]+R}}return o.includes("t")&&(b-=f+g+w),o.includes("r")&&(m+=d+p+E),o.includes("l")&&(m-=d+p+M),o.includes("b")&&(b+=f+g+k),{x:m,y:b}}(KE(n._offscreen||n.querySelector(Jk.mainGroup.class)),e,r),f=d.x,v=d.y;return lk(e.node(),{transform:"translate(".concat(f,", ").concat(v,")")},i)}function aS(t,e,n,r){var i=t.showLine,a=t.showTick,o=t.showLabel,s=JE(i,e.maybeAppendByClassName(Jk.lineGroup,"g"),(function(e){return LM(e,t,r)}))||[],u=JE(a,e.maybeAppendByClassName(Jk.tickGroup,"g"),(function(e){return function(t,e,n,r){var i=wM(e,n.tickFilter),a=HE(n,"tick");return t.selectAll(Jk.tick.class).data(i,(function(t){return t.id||t.label})).join((function(t){return t.append("g").attr("className",Jk.tick.name).transition((function(t,e){return rS.call(this,t,e,i,n,a,!1)}))}),(function(t){return t.transition((function(t,e){return this.removeChildren(),rS.call(this,t,e,i,n,a,r.update)}))}),(function(t){return t.transition((function(){var t=this,e=cM(this.childNodes[0],r.exit);return sk(e,(function(){return t.remove()})),e}))})).transitions()}(e,n,t,r)}))||[],c=JE(o,e.maybeAppendByClassName(Jk.labelGroup,"g"),(function(e){return function(t,e,n,r){var i=wM(e,n.labelFilter),a=HE(n,"label");return t.selectAll(Jk.label.class).data(i,(function(t,e){return e})).join((function(r){return r.append("g").attr("className",Jk.label.name).transition((function(t){eS(this,t,e,a,n);var r=QM(t,e,n),i=r.x,o=r.y;return this.style.transform="translate(".concat(i,", ").concat(o,")"),null})).call((function(){tS.call(t,n)}))}),(function(i){return i.transition((function(t){var i=function(t,e,n,r){if(void 0===r&&(r="destroy"),function(t,e){return"text"===t.nodeName&&"text"===e.nodeName&&t.attributes.text===e.attributes.text}(t,e))return t.remove(),[null];var i=function(){"destroy"===r?t.destroy():"hide"===r&&LE(t),e.isVisible()&&RE(e)};if(!n)return i(),[null];var a=n.duration,o=void 0===a?0:a,s=n.delay,u=void 0===s?0:s,c=Math.ceil(+o/2),l=+o/4,h=ye(t.getGeometryBounds().center,2),d=h[0],f=h[1],v=ye(e.getGeometryBounds().center,2),p=ye([(d+v[0])/2-d,(f+v[1])/2-f],2),g=p[0],y=p[1],m=t.style.opacity,b=void 0===m?1:m,x=e.style.opacity,w=void 0===x?1:x,E=t.style.transform||"",k=e.style.transform||"",M=t.animate([{opacity:b,transform:"translate(0, 0) ".concat(E)},{opacity:0,transform:"translate(".concat(g,", ").concat(y,") ").concat(E)}],fe(fe({fill:"both"},n),{duration:u+c+l})),S=e.animate([{opacity:0,transform:"translate(".concat(-g,", ").concat(-y,") ").concat(k),offset:.01},{opacity:w,transform:"translate(0, 0) ".concat(k)}],fe(fe({fill:"both"},n),{duration:c+l,delay:u+c-l}));return sk(S,i),[M,S]}(this.querySelector(Jk.labelItem.class),eS(this,t,e,a,n),r.update),o=QM(t,e,n),s=o.x,u=o.y,c=lk(this,{transform:"translate(".concat(s,", ").concat(u,")")},r.update);return me(me([],ye(i),!1),[c],!1)})).call((function(e){var r,i;i=function(){tS.call(t,n)},0===(r=Pd(e,"_transitions").flat().filter(FM)).length?i():Promise.all(r.map((function(t){return null==t?void 0:t.finished}))).then(i)}))}),(function(t){return t.transition((function(){var t=this,e=cM(this.childNodes[0],r.exit);return sk(e,(function(){return KE(t).remove()})),e}))})).transitions()}(e,n,t,r)}))||[];return me(me(me([],ye(s),!1),ye(u),!1),ye(c),!1).filter((function(t){return!!t}))}var oS=function(t){function e(e){return t.call(this,e,Qk)||this}return de(e,t),e.prototype.render=function(t,e,n){var r=this,i=t.titleText,a=t.data,o=t.animate,s=t.showTitle,u=t.showGrid,c=t.dataThreshold,l=t.truncRange,h=function(t,e){if(t.length<=e)return t;for(var n=Math.floor(t.length/e),r=[],i=0;i<t.length;i+=n)r.push(t[i]);return r}(a,c).filter((function(t){var e=t.value;return!(l&&e>l[0]&&e<l[1])})),d=ok(void 0===n?o:n),f=JE(u,KE(e).maybeAppendByClassName(Jk.gridGroup,"g"),(function(e){return _M(e,h,t,d)}))||[],v=KE(e).maybeAppendByClassName(Jk.mainGroup,"g");i&&(!this.initialized&&d.enter||this.initialized&&d.update)&&aS(t,KE(this.offscreenGroup),h,ok(!1));var p=aS(t,KE(v.node()),h,d),g=JE(s,KE(e).maybeAppendByClassName(Jk.titleGroup,"g"),(function(e){return function(t,e,n,r){var i=n.titleText;return t.selectAll(Jk.title.class).data([{title:i}].filter((function(t){return!!t.title})),(function(t,e){return t.title})).join((function(a){return a.append((function(){return Mk(i)})).attr("className",Jk.title.name).transition((function(){return iS(KE(this),t,e,n,r.enter)}))}),(function(i){return i.transition((function(){return iS(KE(this),t,e,n,r.update)}))}),(function(t){return t.remove()})).transitions()}(e,r,t,d)}))||[];return me(me(me([],ye(f),!1),ye(p),!1),ye(g),!1).flat().filter((function(t){return!!t}))},e}(zE);function sS(t){var e=t.canvas,n=t.touches,r=t.offsetX,i=t.offsetY;if(e)return[e.x,e.y];if(n){var a=n[0];return[a.clientX,a.clientY]}return r&&i?[r,i]:[0,0]}function uS(t,e){return+t.toPrecision(e)}const cS=function(t){return t};var lS=function(){return b((function t(e){y(this,t),this.options=jh({},this.getDefaultOptions()),this.update(e)}),[{key:"getOptions",value:function(){return this.options}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=jh({},this.options,t),this.rescale(t)}},{key:"rescale",value:function(t){}}])}();function hS(t,e){return e-t?function(n){return(n-t)/(e-t)}:function(t){return.5}}function dS(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return n.reduce((function(t,e){return function(n){return t(e(n))}}),t)}var fS=a(7485),vS=a.n(fS);function pS(t,e,n){var r=n;return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function gS(t){var e=vS().get(t);if(!e)return null;var n=e.model,r=e.value;return"rgb"===n?r:"hsl"===n?function(t){var e=t[0]/360,n=t[1]/100,r=t[2]/100,i=t[3];if(0===n)return[255*r,255*r,255*r,i];var a=r<.5?r*(1+n):r+n-r*n,o=2*r-a;return[255*pS(o,a,e+1/3),255*pS(o,a,e),255*pS(o,a,e-1/3),i]}(r):null}var yS=function(t,e){return function(n){return t*(1-n)+e*n}},mS=function(t,e){return"number"==typeof t&&"number"==typeof e?yS(t,e):"string"==typeof t&&"string"==typeof e?function(t,e){var n=gS(t),r=gS(e);return null===n||null===r?n?function(){return t}:function(){return e}:function(t){for(var e=new Array(4),i=0;i<4;i+=1){var a=n[i],o=r[i];e[i]=a*(1-t)+o*t}var s=e[0],u=e[1],c=e[2],l=e[3];return"rgba(".concat(Math.round(s),", ").concat(Math.round(u),", ").concat(Math.round(c),", ").concat(l,")")}}(t,e):function(){return t}},bS=function(t,e){var n=yS(t,e);return function(t){return Math.round(n(t))}};function xS(t){return!(an(t)||(e=t,null===e)||Number.isNaN(t));var e}var wS=Math.sqrt(50),ES=Math.sqrt(10),kS=Math.sqrt(2);function MS(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=wS?10:a>=ES?5:a>=kS?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=wS?10:a>=ES?5:a>=kS?2:1)}var SS=function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,i=[t,e],a=0,o=i.length-1,s=i[a],u=i[o];if(u<s){var c=[u,s];s=c[0],u=c[1];var l=[o,a];a=l[0],o=l[1]}return(n=MS(s,u,r))>0?n=MS(s=Math.floor(s/n)*n,u=Math.ceil(u/n)*n,r):n<0&&(n=MS(s=Math.ceil(s*n)/n,u=Math.floor(u*n)/n,r)),n>0?(i[a]=Math.floor(s/n)*n,i[o]=Math.ceil(u/n)*n):n<0&&(i[a]=Math.ceil(s*n)/n,i[o]=Math.floor(u*n)/n),i},OS=function(t,e,n){var r,i,a=h(t,2),o=a[0],s=a[1],u=h(e,2),c=u[0],l=u[1];return o<s?(r=hS(o,s),i=n(c,l)):(r=hS(s,o),i=n(l,c)),dS(i,r)},NS=function(t,e,n){for(var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=t[0]>t[r],s=o?w(t).reverse():t,u=o?w(e).reverse():e,c=0;c<r;c+=1)i[c]=hS(s[c],s[c+1]),a[c]=n(u[c],u[c+1]);return function(e){var n=function(t,e,n,r){for(var i=1,a=r||t.length,o=function(t){return t};i<a;){var s=Math.floor((i+a)/2);o(t[s])>e?a=s:i=s+1}return i}(t,e,0,r)-1,o=i[n];return dS(a[n],o)(e)}},AS=function(t,e,n,r){return(Math.min(t.length,e.length)>2?NS:OS)(t,e,r?bS:n)},TS=function(t){function e(){return y(this,e),S(this,e,arguments)}return N(e,t),b(e,[{key:"getDefaultOptions",value:function(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:yS,tickCount:5}}},{key:"map",value:function(t){return xS(t)?this.output(t):this.options.unknown}},{key:"invert",value:function(t){return xS(t)?this.input(t):this.options.unknown}},{key:"nice",value:function(){if(this.options.nice){var t=Jd(this.getTickMethodOptions()),e=t[0],n=t[1],r=t[2],i=t.slice(3);this.options.domain=this.chooseNice().apply(void 0,[e,n,r].concat(w(i)))}}},{key:"getTicks",value:function(){var t=this.options.tickMethod,e=Jd(this.getTickMethodOptions()),n=e[0],r=e[1],i=e[2],a=e.slice(3);return t.apply(void 0,[n,r,i].concat(w(a)))}},{key:"getTickMethodOptions",value:function(){var t=this.options,e=t.domain,n=t.tickCount;return[e[0],e[e.length-1],n]}},{key:"chooseNice",value:function(){return SS}},{key:"rescale",value:function(){this.nice();var t=h(this.chooseTransforms(),2),e=t[0],n=t[1];this.composeOutput(e,this.chooseClamp(e)),this.composeInput(e,n,this.chooseClamp(n))}},{key:"chooseClamp",value:function(t){var e,n,r,i,a=this.options,o=a.clamp,s=a.range,u=this.options.domain.map(t),c=Math.min(u.length,s.length);return o?(e=u[0],n=u[c-1],r=n<e?n:e,i=e>n?e:n,function(t){return Math.min(Math.max(r,t),i)}):cS}},{key:"composeOutput",value:function(t,e){var n=this.options,r=n.domain,i=n.range,a=n.round,o=n.interpolate,s=AS(r.map(t),i,o,a);this.output=dS(s,e,t)}},{key:"composeInput",value:function(t,e,n){var r=this.options,i=r.domain,a=r.range,o=AS(a,i.map(t),yS);this.input=dS(e,n,o)}}])}(lS),PS=function(t,e,n){var r,i,a=t,o=e;if(a===o&&n>0)return[a];var s=MS(a,o,n);if(0===s||!Number.isFinite(s))return[];if(s>0){a=Math.ceil(a/s),o=Math.floor(o/s),i=new Array(r=Math.ceil(o-a+1));for(var u=0;u<r;u+=1)i[u]=(a+u)*s}else{s=-s,a=Math.ceil(a*s),o=Math.floor(o*s),i=new Array(r=Math.ceil(o-a+1));for(var c=0;c<r;c+=1)i[c]=(a+c)/s}return i},CS=function(t){function e(){return y(this,e),S(this,e,arguments)}return N(e,t),b(e,[{key:"getDefaultOptions",value:function(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:mS,tickMethod:PS,tickCount:5}}},{key:"chooseTransforms",value:function(){return[cS,cS]}},{key:"clone",value:function(){return new e(this.options)}}])}(TS);function RS(t,e,n){if(k())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var i=new(t.bind.apply(t,r));return n&&O(i,n.prototype),i}function LS(t){var e="function"==typeof Map?new Map:void 0;return LS=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return RS(t,arguments,E(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),O(n,t)},LS(t)}function DS(t,e){var n=t.map,r=(0,t.initKey)(e);return n.has(r)?n.get(r):e}function _S(t,e){var n=t.map,r=(0,t.initKey)(e);return n.has(r)?n.get(r):(n.set(r,e),e)}function IS(t,e){var n=t.map,r=(0,t.initKey)(e);return n.has(r)&&(e=n.get(r),n.delete(r)),e}function jS(t){return"object"==typeof t?t.valueOf():t}var FS=function(t){function e(t){var n;if(y(this,e),(n=S(this,e)).map=new Map,n.initKey=jS,null!==t){var r,i=Rn(t);try{for(i.s();!(r=i.n()).done;){var a=h(r.value,2),o=a[0],s=a[1];n.set(o,s)}}catch(t){i.e(t)}finally{i.f()}}return n}return N(e,t),b(e,[{key:"get",value:function(t){return dn(e,"get",this,3)([DS({map:this.map,initKey:this.initKey},t)])}},{key:"has",value:function(t){return dn(e,"has",this,3)([DS({map:this.map,initKey:this.initKey},t)])}},{key:"set",value:function(t,n){return dn(e,"set",this,3)([_S({map:this.map,initKey:this.initKey},t),n])}},{key:"delete",value:function(t){return dn(e,"delete",this,3)([IS({map:this.map,initKey:this.initKey},t)])}}])}(LS(Map)),BS=Symbol("defaultUnknown");function zS(t,e,n){for(var r=0;r<e.length;r+=1)t.has(e[r])||t.set(n(e[r]),r)}function GS(t){var e=t.value,n=t.from,r=t.to,i=t.mapper,a=t.notFoundReturn,o=i.get(e);if(void 0===o){if(a!==BS)return a;o=n.push(e)-1,i.set(e,o)}return r[o%r.length]}function VS(t){return t instanceof Date?function(t){return"".concat(t)}:"object"==typeof t?function(t){return JSON.stringify(t)}:function(t){return t}}function WS(t){return Math.round(1e12*t)/1e12}var HS=function(t){function e(t){return y(this,e),S(this,e,[t])}return N(e,t),b(e,[{key:"getDefaultOptions",value:function(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:BS,flex:[]}}},{key:"clone",value:function(){return new e(this.options)}},{key:"getStep",value:function(t){return void 0===this.valueStep?1:"number"==typeof this.valueStep?this.valueStep:void 0===t?Array.from(this.valueStep.values())[0]:this.valueStep.get(t)}},{key:"getBandWidth",value:function(t){return void 0===this.valueBandWidth?1:"number"==typeof this.valueBandWidth?this.valueBandWidth:void 0===t?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(t)}},{key:"getRange",value:function(){return this.adjustedRange}},{key:"getPaddingInner",value:function(){var t=this.options,e=t.padding,n=t.paddingInner;return e>0?e:n}},{key:"getPaddingOuter",value:function(){var t=this.options,e=t.padding,n=t.paddingOuter;return e>0?e:n}},{key:"rescale",value:function(){dn(e,"rescale",this,3)([]);var t=this.options,n=t.align,r=t.domain,i=function(t){var e,n=t.domain.length;if(0===n)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(null===(e=t.flex)||void 0===e?void 0:e.length)return function(t){for(var e=t.domain,n=t.range,r=t.paddingOuter,i=t.paddingInner,a=t.flex,o=t.round,s=t.align,u=e.length,c=function(t,e){var n=e-t.length;return n>0?[].concat(w(t),w(new Array(n).fill(1))):n<0?t.slice(0,e):t}(a,u),l=h(n,2),d=l[0],f=l[1]-d,v=f/(2/u*r+1-1/u*i),p=v*i/u,g=v-u*p,y=function(t){var e=Math.min.apply(Math,w(t));return t.map((function(t){return t/e}))}(c),m=y.reduce((function(t,e){return t+e})),b=g/m,x=new FS(e.map((function(t,e){var n=y[e]*b;return[t,o?Math.floor(n):n]}))),E=new FS(e.map((function(t,e){var n=y[e]*b+p;return[t,o?Math.floor(n):n]}))),k=Array.from(E.values()).reduce((function(t,e){return t+e})),M=d+(f-(k-k/u*i))*s,S=o?Math.round(M):M,O=new Array(u),N=0;N<u;N+=1){O[N]=WS(S);var A=e[N];S+=E.get(A)}return{valueBandWidth:x,valueStep:E,adjustedRange:O}}(t);var r,i,a=t.range,o=t.paddingOuter,s=t.paddingInner,u=t.round,c=t.align,l=a[0],d=a[1]-l,f=2*o,v=n-s;r=d/Math.max(1,f+v),u&&(r=Math.floor(r)),l+=(d-r*(n-s))*c,i=r*(1-s),u&&(l=Math.round(l),i=Math.round(i));var p=new Array(n).fill(0).map((function(t,e){return l+e*r}));return{valueStep:r,valueBandWidth:i,adjustedRange:p}}({align:n,range:t.range,round:t.round,flex:t.flex,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:r}),a=i.adjustedRange,o=i.valueBandWidth,s=i.valueStep;this.valueStep=s,this.valueBandWidth=o,this.adjustedRange=a}}])}(function(t){function e(t){return y(this,e),S(this,e,[t])}return N(e,t),b(e,[{key:"getDefaultOptions",value:function(){return{domain:[],range:[],unknown:BS}}},{key:"map",value:function(t){return 0===this.domainIndexMap.size&&zS(this.domainIndexMap,this.getDomain(),this.domainKey),GS({value:this.domainKey(t),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}},{key:"invert",value:function(t){return 0===this.rangeIndexMap.size&&zS(this.rangeIndexMap,this.getRange(),this.rangeKey),GS({value:this.rangeKey(t),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}},{key:"rescale",value:function(t){var e=h(this.options.domain,1)[0],n=h(this.options.range,1)[0];if(this.domainKey=VS(e),this.rangeKey=VS(n),!this.rangeIndexMap)return this.rangeIndexMap=new Map,void(this.domainIndexMap=new Map);t&&!t.range||this.rangeIndexMap.clear(),(!t||t.domain||t.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}},{key:"clone",value:function(){return new e(this.options)}},{key:"getRange",value:function(){return this.options.range}},{key:"getDomain",value:function(){if(this.sortedDomain)return this.sortedDomain;var t=this.options,e=t.domain,n=t.compare;return this.sortedDomain=n?w(e).sort(n):e,this.sortedDomain}}])}(lS)),YS=function(t){function e(e){var n=this,r=e.style,i=ve(e,["style"]);return(n=t.call(this,jh({},{type:"column"},fe({style:r},i)))||this).columnsGroup=new vu({name:"columns"}),n.appendChild(n.columnsGroup),n.render(),n}return de(e,t),e.prototype.render=function(){var t=this.attributes,e=t.columns,n=t.x,r=t.y;this.columnsGroup.style.transform="translate(".concat(n,", ").concat(r,")"),KE(this.columnsGroup).selectAll(".column").data(e.flat()).join((function(t){return t.append("rect").attr("className","column").each((function(t){this.attr(t)}))}),(function(t){return t.each((function(t){this.attr(t)}))}),(function(t){return t.remove()}))},e.prototype.update=function(t){this.attr(IE({},this.attributes,t)),this.render()},e.prototype.clear=function(){this.removeChildren()},e}(cu),US=function(t){function e(e){var n=this,r=e.style,i=ve(e,["style"]);return(n=t.call(this,jh({},{type:"lines"},fe({style:r},i)))||this).linesGroup=n.appendChild(new vu),n.areasGroup=n.appendChild(new vu),n.render(),n}return de(e,t),e.prototype.render=function(){var t=this.attributes,e=t.lines,n=t.areas,r=t.x,i=t.y;this.style.transform="translate(".concat(r,", ").concat(i,")"),e&&this.renderLines(e),n&&this.renderAreas(n)},e.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},e.prototype.update=function(t){this.attr(IE({},this.attributes,t)),this.render()},e.prototype.renderLines=function(t){KE(this.linesGroup).selectAll(".line").data(t).join((function(t){return t.append("path").attr("className","line").each((function(t){this.attr(t)}))}),(function(t){return t.each((function(t){this.attr(t)}))}),(function(t){return t.remove()}))},e.prototype.renderAreas=function(t){KE(this.linesGroup).selectAll(".area").data(t).join((function(t){return t.append("path").attr("className","area").each((function(t){this.attr(t)}))}),(function(t){return t.each((function(t){this.style(t)}))}),(function(t){return t.remove()}))},e}(cu);function qS(t,e){void 0===e&&(e=!1);var n=e?t.length-1:0,r=t.map((function(t,e){return me([e===n?"M":"L"],ye(t),!1)}));return e?r.reverse():r}function XS(t,e){if(void 0===e&&(e=!1),t.length<=2)return qS(t);for(var n=[],r=t.length,i=0;i<r;i+=1){var a=e?t[r-i-1]:t[i];Vc(a,n.slice(-2))||n.push.apply(n,me([],ye(a),!1))}var o=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=[[0,0],[1,1]]);for(var r=!!e,i=[],a=0,o=t.length;a<o;a+=2)i.push([t[a],t[a+1]]);var s,u,c,l=function(t,e,n,r){var i,a,o,s,u,c,l=[],h=!!r,d=[1/0,1/0],f=[-1/0,-1/0];if(h){d=(i=ye(r,2))[0],f=i[1];for(var v=0,p=t.length;v<p;v+=1)d=rM(d,y=t[v]),f=iM(f,y)}v=0;for(var g=t.length;v<g;v+=1){var y=t[v];if(0!==v||n)if(v!==g-1||n){a=t[[v?v-1:g-1,v-1][n?0:1]];var m=[0,0];m=tM(m=nM(o=t[n?(v+1)%g:v+1],a),.4);var b=aM(y,a),x=aM(y,o),w=b+x;0!==w&&(b/=w,x/=w);var E=tM(m,-b),k=tM(m,x);u=eM(y,E),s=rM(s=eM(y,k),iM(o,y)),s=iM(s,rM(o,y)),u=rM(u=eM(y,E=tM(E=nM(s,y),-b/x)),iM(a,y)),s=eM(y,k=tM(k=nM(y,u=iM(u,rM(a,y))),x/b)),h&&(u=rM(u=iM(u,d),f),s=rM(s=iM(s,d),f)),l.push(c),l.push(u),c=s}else u=y,l.push(c),l.push(u);else c=y}return n&&l.push(l.shift()),l}(i,0,r,n),h=i.length,d=[];for(a=0;a<h-1;a+=1)s=l[2*a],u=l[2*a+1],c=i[a+1],d.push(["C",s[0],s[1],u[0],u[1],c[0],c[1]]);return r&&(s=l[h],u=l[h+1],c=ye(i,1)[0],d.push(["C",s[0],s[1],u[0],u[1],c[0],c[1]])),d}(n,!1);return e?o.unshift(me(["M"],ye(t[r-1]),!1)):o.unshift(me(["M"],ye(t[0]),!1)),o}function KS(t,e,n){var r=Al(t);return r.push(["L",e,n],["L",0,n],["Z"]),r}const $S=function(t,e){if(He(t)){for(var n,r=1/0,i=0;i<t.length;i++){var a=t[i],o=cn(e)?e(a):a[e];o<r&&(n=a,r=o)}return n}},ZS=function(t,e){if(He(t)){for(var n,r=-1/0,i=0;i<t.length;i++){var a=t[i],o=cn(e)?e(a):a[e];o>r&&(n=a,r=o)}return n}};function QS(t){return 0===t.length?[0,0]:[Ye($S(t,(function(t){return Ye(t)||0}))),Ue(ZS(t,(function(t){return Ue(t)||0})))]}function JS(t){for(var e=Al(t),n=e[0].length,r=ye([Array(n).fill(0),Array(n).fill(0)],2),i=r[0],a=r[1],o=0;o<e.length;o+=1)for(var s=e[o],u=0;u<n;u+=1)s[u]>=0?(s[u]+=i[u],i[u]=s[u]):(s[u]+=a[u],a[u]=s[u]);return e}var tO=function(t){function e(e){return t.call(this,e,{type:"line",x:0,y:0,width:200,height:20,isStack:!1,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:"#fff",scale:1,spacing:0})||this}return de(e,t),Object.defineProperty(e.prototype,"rawData",{get:function(){var t=this.attributes.data;if(!t||0===(null==t?void 0:t.length))return[[]];var e=Al(t);return oe(e[0])?[e]:e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.isStack?JS(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseline",{get:function(){var t=this.scales.y,e=ye(t.getOptions().domain||[0,0],2),n=e[0],r=e[1];return r<0?t.map(r):t.map(n<0?0:n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"containerShape",{get:function(){var t=this.attributes;return{width:t.width,height:t.height}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linesStyle",{get:function(){var t=this,e=this.attributes,n=e.type,r=e.isStack,i=e.smooth;if("line"!==n)throw new Error("linesStyle can only be used in line type");var a=HE(this.attributes,"area"),o=HE(this.attributes,"line"),s=this.containerShape.width,u=this.data;if(0===u[0].length)return{lines:[],areas:[]};var c=this.scales,l=function(t,e){var n,r=e.x,i=e.y,a=ye(i.getOptions().range||[0,0],2),o=a[0],s=a[1];return s>o&&(n=ye([o,s],2),s=n[0],o=n[1]),t.map((function(t){return t.map((function(t,e){return[r.map(e),le(i.map(t),s,o)]}))}))}(u,{type:"line",x:c.x,y:c.y}),h=[];if(a){var d=this.baseline;h=r?i?function(t,e,n){for(var r=[],i=t.length-1;i>=0;i-=1){var a=t[i],o=XS(a),s=void 0;if(0===i)s=KS(o,e,n);else{var u=XS(t[i-1],!0),c=a[0];u[0][0]="L",s=me(me(me([],ye(o),!1),ye(u),!1),[me(["M"],ye(c),!1),["Z"]],!1)}r.push(s)}return r}(l,s,d):function(t,e,n){for(var r=[],i=t.length-1;i>=0;i-=1){var a=qS(t[i]),o=void 0;if(0===i)o=KS(a,e,n);else{var s=qS(t[i-1],!0);s[0][0]="L",o=me(me(me([],ye(a),!1),ye(s),!1),[["Z"]],!1)}r.push(o)}return r}(l,s,d):function(t,e,n,r){return t.map((function(t){return KS(e?XS(t):qS(t),n,r)}))}(l,i,s,d)}return{lines:l.map((function(e,n){return fe({stroke:t.getColor(n),d:i?XS(e):qS(e)},o)})),areas:h.map((function(e,n){return fe({d:e,fill:t.getColor(n)},a)}))}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnsStyle",{get:function(){var t=this,e=HE(this.attributes,"column"),n=this.attributes,r=n.isStack,i=n.type,a=n.scale;if("column"!==i)throw new Error("columnsStyle can only be used in column type");var o=this.containerShape.height,s=this.rawData;if(!s)return{columns:[]};r&&(s=JS(s));var u=this.createScales(s),c=u.x,l=u.y,h=ye(QS(s),2),d=h[0],f=h[1],v=new CS({domain:[0,f-(d>0?0:d)],range:[0,o*a]}),p=c.getBandWidth(),g=this.rawData;return{columns:s.map((function(n,i){return n.map((function(n,a){var o=p/s.length;return fe(fe({fill:t.getColor(i)},e),r?{x:c.map(a),y:l.map(n),width:p,height:v.map(g[i][a])}:{x:c.map(a)+o*i,y:n>=0?l.map(n):l.map(0),width:o,height:v.map(Math.abs(n))})}))}))}},enumerable:!1,configurable:!0}),e.prototype.render=function(t,e){var n,r;(n=e,r=".container",n.querySelector(r)?KE(n).select(r):KE(n).append("rect")).attr("className","container").node();var i=t.type,a=t.x,o=t.y,s="spark".concat(i),u=fe({x:a,y:o},"line"===i?this.linesStyle:this.columnsStyle);KE(e).selectAll(".spark").data([i]).join((function(t){return t.append((function(t){return"line"===t?new US({className:s,style:u}):new YS({className:s,style:u})})).attr("className","spark ".concat(s))}),(function(t){return t.update(u)}),(function(t){return t.remove()}))},e.prototype.getColor=function(t){var e=this.attributes.color;return He(e)?e[t%e.length]:cn(e)?e.call(null,t):e},e.prototype.createScales=function(t){var e,n,r=this.attributes,i=r.type,a=r.scale,o=r.range,s=void 0===o?[]:o,u=r.spacing,c=this.containerShape,l=c.width,h=c.height,d=ye(QS(t),2),f=d[0],v=d[1],p=new CS({domain:[null!==(e=s[0])&&void 0!==e?e:f,null!==(n=s[1])&&void 0!==n?n:v],range:[h,h*(1-a)]});return"line"===i?{type:i,x:new CS({domain:[0,t[0].length-1],range:[0,l]}),y:p}:{type:i,x:new HS({domain:t[0].map((function(t,e){return e})),range:[0,l],paddingInner:u,paddingOuter:u/2,align:.5}),y:p}},e.tag="sparkline",e}(zE),eO={fill:"#fff",lineWidth:1,radius:2,size:10,stroke:"#bfbfbf",strokeOpacity:1,zIndex:0},nO={fill:"#000",fillOpacity:.45,fontSize:12,textAlign:"center",textBaseline:"middle",zIndex:1},rO={x:0,y:0,orientation:"horizontal",showLabel:!0,type:"start"},iO=ZE({foreground:"foreground",handle:"handle",selection:"selection",sparkline:"sparkline",sparklineGroup:"sparkline-group",track:"track",brushArea:"brush-area"},"slider"),aO=ZE({labelGroup:"label-group",label:"label",iconGroup:"icon-group",icon:"icon",iconRect:"icon-rect",iconLine:"icon-line"},"handle"),oO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return de(e,t),e.prototype.render=function(t,e){var n=t.x,r=t.y,i=t.size,a=void 0===i?10:i,o=t.radius,s=void 0===o?a/4:o,u=t.orientation,c=ve(t,["x","y","size","radius","orientation"]),l=a,h=2.4*l,d=KE(e).maybeAppendByClassName(aO.iconRect,"rect").styles(fe(fe({},c),{width:l,height:h,radius:s,x:n-l/2,y:r-h/2,transformOrigin:"center"})),f=n+1/3*l-l/2,v=n+2/3*l-l/2,p=r+1/4*h-h/2,g=r+3/4*h-h/2;d.maybeAppendByClassName("".concat(aO.iconLine,"-1"),"line").styles(fe({x1:f,x2:f,y1:p,y2:g},c)),d.maybeAppendByClassName("".concat(aO.iconLine,"-2"),"line").styles(fe({x1:v,x2:v,y1:p,y2:g},c)),"vertical"===u&&(d.node().style.transform="rotate(90)")},e}(zE),sO=function(t){function e(e){return t.call(this,e,rO)||this}return de(e,t),e.prototype.renderLabel=function(t){var e=this,n=this.attributes,r=n.x,i=n.y,a=n.showLabel,o=HE(this.attributes,"label"),s=o.x,u=void 0===s?0:s,c=o.y,l=void 0===c?0:c,h=o.transform,d=o.transformOrigin,f=ye(UE(ve(o,["x","y","transform","transformOrigin"]),[]),2),v=f[0],p=f[1],g=KE(t).maybeAppendByClassName(aO.labelGroup,"g").styles(p),y=fe(fe({},nO),v),m=y.text,b=ve(y,["text"]);JE(!!a,g,(function(t){e.label=t.maybeAppendByClassName(aO.label,"text").styles(fe(fe({},b),{x:r+u,y:i+l,transform:h,transformOrigin:d,text:"".concat(m)})),e.label.on("mousedown",(function(t){t.stopPropagation()})),e.label.on("touchstart",(function(t){t.stopPropagation()}))}))},e.prototype.renderIcon=function(t){var e=this.attributes,n=e.x,r=e.y,i=e.orientation,a=e.type,o=fe(fe({x:n,y:r,orientation:i},eO),HE(this.attributes,"icon")),s=this.attributes.iconShape,u=void 0===s?function(){return new oO({style:o})}:s;KE(t).maybeAppendByClassName(aO.iconGroup,"g").selectAll(aO.icon.class).data([u]).join((function(t){return t.append("string"==typeof u?u:function(){return u(a)}).attr("className",aO.icon.name)}),(function(t){return t.update(o)}),(function(t){return t.remove()}))},e.prototype.render=function(t,e){this.renderIcon(e),this.renderLabel(e)},e}(zE),uO=function(t){function e(e){var n=t.call(this,e,fe(fe(fe({x:0,y:0,animate:{duration:100,fill:"both"},brushable:!0,formatter:function(t){return t.toString()},handleSpacing:2,orientation:"horizontal",padding:0,autoFitLabel:!0,scrollable:!0,selectionFill:"#5B8FF9",selectionFillOpacity:.45,selectionZIndex:2,showHandle:!0,showLabel:!0,slidable:!0,trackFill:"#416180",trackLength:200,trackOpacity:.05,trackSize:20,trackZIndex:-1,values:[0,1],type:"range",selectionType:"select",handleIconOffset:0},YE(rO,"handle")),YE(eO,"handleIcon")),YE(nO,"handleLabel")))||this;return n.range=[0,1],n.onDragStart=function(t){return function(e){e.stopPropagation(),n.target=t,n.prevPos=n.getOrientVal(sS(e));var r=n.availableSpace,i=r.x,a=r.y,o=n.getBBox(),s=o.x,u=o.y;n.selectionStartPos=n.getRatio(n.prevPos-n.getOrientVal([i,a])-n.getOrientVal([+s,+u])),n.selectionWidth=0,document.addEventListener("pointermove",n.onDragging),document.addEventListener("pointerup",n.onDragEnd)}},n.onDragging=function(t){var e=n.attributes,r=e.slidable,i=e.brushable,a=e.type;t.stopPropagation();var o=n.getOrientVal(sS(t)),s=o-n.prevPos;if(s){var u=n.getRatio(s);switch(n.target){case"start":r&&n.setValuesOffset(u);break;case"end":r&&n.setValuesOffset(0,u);break;case"selection":r&&n.setValuesOffset(u,u);break;case"track":if(!i)return;n.selectionWidth+=u,"range"===a?n.innerSetValues([n.selectionStartPos,n.selectionStartPos+n.selectionWidth].sort(),!0):n.innerSetValues([0,n.selectionStartPos+n.selectionWidth],!0)}n.prevPos=o}},n.onDragEnd=function(){document.removeEventListener("pointermove",n.onDragging),document.removeEventListener("pointermove",n.onDragging),document.removeEventListener("pointerup",n.onDragEnd),n.target="",n.updateHandlesPosition(!1)},n.onValueChange=function(t){var e=n.attributes,r=e.onChange,i=e.type,a="range"===i?t:t[1],o="range"===i?n.getValues():n.getValues()[1],s=new cs("valuechange",{detail:{oldValue:a,value:o}});n.dispatchEvent(s),null==r||r(o)},n.selectionStartPos=0,n.selectionWidth=0,n.prevPos=0,n.target="",n}return de(e,t),Object.defineProperty(e.prototype,"values",{get:function(){return this.attributes.values},set:function(t){this.attributes.values=this.clampValues(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sparklineStyle",{get:function(){if("horizontal"!==this.attributes.orientation)return null;var t=HE(this.attributes,"sparkline");return fe(fe({zIndex:0},this.availableSpace),t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t=this.attributes,e=t.trackLength,n=t.trackSize,r=ye(this.getOrientVal([[e,n],[n,e]]),2);return{width:r[0],height:r[1]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes,e=(t.x,t.y,ye(QE(t.padding),4)),n=e[0],r=e[1],i=e[2],a=e[3],o=this.shape;return{x:a,y:n,width:o.width-(a+r),height:o.height-(n+i)}},enumerable:!1,configurable:!0}),e.prototype.getValues=function(){return this.values},e.prototype.setValues=function(t,e){void 0===t&&(t=[0,0]),void 0===e&&(e=!1),this.attributes.values=t;var n=!1!==e&&this.attributes.animate;this.updateSelectionArea(n),this.updateHandlesPosition(n)},e.prototype.updateSelectionArea=function(t){var e=this.calcSelectionArea();this.foregroundGroup.selectAll(iO.selection.class).each((function(n,r){lk(this,e[r],t)}))},e.prototype.updateHandlesPosition=function(t){this.attributes.showHandle&&(this.startHandle&&lk(this.startHandle,this.getHandleStyle("start"),t),this.endHandle&&lk(this.endHandle,this.getHandleStyle("end"),t))},e.prototype.innerSetValues=function(t,e){void 0===t&&(t=[0,0]),void 0===e&&(e=!1);var n=this.values,r=this.clampValues(t);this.attributes.values=r,this.setValues(r),e&&this.onValueChange(n)},e.prototype.renderTrack=function(t){var e=this.attributes,n=e.x,r=e.y,i=HE(this.attributes,"track");this.trackShape=KE(t).maybeAppendByClassName(iO.track,"rect").styles(fe(fe({x:n,y:r},this.shape),i))},e.prototype.renderBrushArea=function(t){var e=this.attributes,n=e.x,r=e.y,i=e.brushable;this.brushArea=KE(t).maybeAppendByClassName(iO.brushArea,"rect").styles(fe({x:n,y:r,fill:"transparent",cursor:i?"crosshair":"default"},this.shape))},e.prototype.renderSparkline=function(t){var e=this,n=this.attributes,r=n.x,i=n.y;JE("horizontal"===n.orientation,KE(t).maybeAppendByClassName(iO.sparklineGroup,"g"),(function(t){var n=fe(fe({},e.sparklineStyle),{x:r,y:i});t.maybeAppendByClassName(iO.sparkline,(function(){return new tO({style:n})})).update(n)}))},e.prototype.renderHandles=function(){var t,e=this,n=this.attributes,r=n.showHandle,i=n.type,a=r?"range"===i?["start","end"]:["end"]:[],o=this;null===(t=this.foregroundGroup)||void 0===t||t.selectAll(iO.handle.class).data(a.map((function(t){return{type:t}})),(function(t){return t.type})).join((function(t){return t.append((function(t){var n=t.type;return new sO({style:e.getHandleStyle(n)})})).each((function(t){var e=t.type;this.attr("class","".concat(iO.handle.name," ").concat(e,"-handle"));var n="".concat(e,"Handle");o[n]=this,this.addEventListener("pointerdown",o.onDragStart(e))}))}),(function(t){return t.each((function(t){var e=t.type;this.update(o.getHandleStyle(e))}))}),(function(t){return t.each((function(t){var e=t.type,n="".concat(e,"Handle");o[n]=void 0})).remove()}))},e.prototype.renderSelection=function(t){var e=this.attributes,n=e.x,r=e.y,i=e.type,a=e.selectionType;this.foregroundGroup=KE(t).maybeAppendByClassName(iO.foreground,"g");var o=HE(this.attributes,"selection"),s=function(t){return t.style("visibility",(function(t){return t.show?"visible":"hidden"})).style("cursor",(function(t){return"select"===a?"grab":"invert"===a?"crosshair":"default"})).styles(fe(fe({},o),{transform:"translate(".concat(n,", ").concat(r,")")}))},u=this;this.foregroundGroup.selectAll(iO.selection.class).data("value"===i?[]:this.calcSelectionArea().map((function(t,e){return{style:fe({},t),index:e,show:"select"===a?1===e:1!==e}})),(function(t){return t.index})).join((function(t){return t.append("rect").attr("className",iO.selection.name).call(s).each((function(t,e){var n=this;1===e?(u.selectionShape=KE(this),this.on("pointerdown",(function(t){n.attr("cursor","grabbing"),u.onDragStart("selection")(t)})),u.dispatchCustomEvent(this,"pointerenter","selectionMouseenter"),u.dispatchCustomEvent(this,"pointerleave","selectionMouseleave"),u.dispatchCustomEvent(this,"click","selectionClick"),this.addEventListener("pointerdown",(function(){n.attr("cursor","grabbing")})),this.addEventListener("pointerup",(function(){n.attr("cursor","pointer")})),this.addEventListener("pointerover",(function(){n.attr("cursor","pointer")}))):this.on("pointerdown",u.onDragStart("track"))}))}),(function(t){return t.call(s)}),(function(t){return t.remove()})),this.updateSelectionArea(!1),this.renderHandles()},e.prototype.render=function(t,e){this.renderTrack(e),this.renderSparkline(e),this.renderBrushArea(e),this.renderSelection(e)},e.prototype.clampValues=function(t,e){var n;void 0===e&&(e=4);var r=ye(this.range,2),i=r[0],a=r[1],o=ye(this.getValues().map((function(t){return uS(t,e)})),2),s=o[0],u=o[1],c=ye(((Array.isArray(t)?t:[s,null!=t?t:u])||[s,u]).map((function(t){return uS(t,e)})),2),l=c[0],h=c[1];if("value"===this.attributes.type)return[0,le(h,i,a)];l>h&&(l=(n=ye([h,l],2))[0],h=n[1]);var d=h-l;return d>a-i?[i,a]:l<i?s===i&&u===h?[i,h]:[i,d+i]:h>a?u===a&&s===l?[l,a]:[a-d,a]:[l,h]},e.prototype.calcSelectionArea=function(t){var e=ye(this.clampValues(t),2),n=e[0],r=e[1],i=this.availableSpace,a=i.x,o=i.y,s=i.width,u=i.height;return this.getOrientVal([[{y:o,height:u,x:a,width:n*s},{y:o,height:u,x:n*s+a,width:(r-n)*s},{y:o,height:u,x:r*s,width:(1-r)*s}],[{x:a,width:s,y:o,height:n*u},{x:a,width:s,y:n*u+o,height:(r-n)*u},{x:a,width:s,y:r*u,height:(1-r)*u}]])},e.prototype.calcHandlePosition=function(t){var e=this.attributes.handleIconOffset,n=this.availableSpace,r=n.x,i=n.y,a=n.width,o=n.height,s=ye(this.clampValues(),2),u=s[0],c=s[1],l="start"===t?-e:e,h=("start"===t?u:c)*this.getOrientVal([a,o])+l;return{x:r+this.getOrientVal([h,a/2]),y:i+this.getOrientVal([o/2,h])}},e.prototype.inferTextStyle=function(t){return"horizontal"===this.attributes.orientation?{}:"start"===t?{transformOrigin:"left center",transform:"rotate(90)",textAlign:"start"}:"end"===t?{transformOrigin:"right center",transform:"rotate(90)",textAlign:"end"}:{}},e.prototype.calcHandleText=function(t){var e,n=this.attributes,r=n.type,i=n.orientation,a=n.formatter,o=n.autoFitLabel,s=HE(this.attributes,"handle"),u=HE(s,"label"),c=s.spacing,l=this.getHandleSize(),h=this.clampValues(),d=a("start"===t?h[0]:h[1]),f=new qE({style:fe(fe(fe({},u),this.inferTextStyle(t)),{text:d})}),v=f.getBBox(),p=v.width,g=v.height;if(f.destroy(),!o){if("value"===r)return{text:d,x:0,y:-g-c};var y=c+l+("horizontal"===i?p/2:0);return(e={text:d})["horizontal"===i?"x":"y"]="start"===t?-y:y,e}var m=0,b=0,x=this.availableSpace,w=x.width,E=x.height,k=this.calcSelectionArea()[1],M=k.x,S=k.y,O=k.width,N=k.height,A=c+l;if("horizontal"===i){var T=A+p/2;m="start"===t?M-A-p>0?-T:T:w-M-O-A>p?T:-T}else{var P=g+A;b="start"===t?S-l>g?-P:A:E-(S+N)-l>g?P:-A}return{x:m,y:b,text:d}},e.prototype.getHandleLabelStyle=function(t){var e=HE(this.attributes,"handleLabel");return fe(fe(fe({},e),this.calcHandleText(t)),this.inferTextStyle(t))},e.prototype.getHandleIconStyle=function(){var t=this.attributes.handleIconShape,e=HE(this.attributes,"handleIcon"),n=this.getOrientVal(["ew-resize","ns-resize"]),r=this.getHandleSize();return fe({cursor:n,shape:t,size:r},e)},e.prototype.getHandleStyle=function(t){var e=this.attributes,n=e.x,r=e.y,i=e.showLabel,a=e.showLabelOnInteraction,o=e.orientation,s=this.calcHandlePosition(t),u=s.x,c=s.y,l=this.calcHandleText(t),h=i;return!i&&a&&(h=!!this.target),fe(fe(fe({},YE(this.getHandleIconStyle(),"icon")),YE(fe(fe({},this.getHandleLabelStyle(t)),l),"label")),{transform:"translate(".concat(u+n,", ").concat(c+r,")"),orientation:o,showLabel:h,type:t,zIndex:3})},e.prototype.getHandleSize=function(){var t=this.attributes,e=t.handleIconSize,n=t.width,r=t.height;return e||Math.floor((this.getOrientVal([+r,+n])+4)/2.4)},e.prototype.getOrientVal=function(t){var e=ye(t,2),n=e[0],r=e[1];return"horizontal"===this.attributes.orientation?n:r},e.prototype.setValuesOffset=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=!1);var r=this.attributes.type,i=ye(this.getValues(),2),a=[i[0]+("range"===r?t:0),i[1]+e].sort();n?this.setValues(a):this.innerSetValues(a,!0)},e.prototype.getRatio=function(t){var e=this.availableSpace,n=e.width,r=e.height;return t/this.getOrientVal([n,r])},e.prototype.dispatchCustomEvent=function(t,e,n){var r=this;t.on(e,(function(t){t.stopPropagation(),r.dispatchEvent(new cs(n,{detail:t}))}))},e.prototype.bindEvents=function(){this.addEventListener("wheel",this.onScroll);var t=this.brushArea;this.dispatchCustomEvent(t,"click","trackClick"),this.dispatchCustomEvent(t,"pointerenter","trackMouseenter"),this.dispatchCustomEvent(t,"pointerleave","trackMouseleave"),t.on("pointerdown",this.onDragStart("track"))},e.prototype.onScroll=function(t){if(this.attributes.scrollable){var e=t.deltaX,n=t.deltaY||e,r=this.getRatio(n);this.setValuesOffset(r,r,!0)}},e.tag="slider",e}(zE),cO={backgroundFill:"#262626",backgroundLineCap:"round",backgroundLineWidth:1,backgroundStroke:"#333",backgroundZIndex:-1,formatter:function(t){return t.toString()},labelFill:"#fff",labelFontSize:12,labelTextBaseline:"middle",padding:[2,4],position:"right",radius:0,zIndex:999},lO=ZE({background:"background",labelGroup:"label-group",label:"label"},"indicator"),hO=function(t){function e(e){var n=t.call(this,e,cO)||this;return n.point=[0,0],n.group=n.appendChild(new vu({})),n.isMutationObserved=!0,n}return de(e,t),e.prototype.renderBackground=function(){if(this.label){var t=this.attributes,e=t.position,n=ye(QE(t.padding),4),r=n[0],i=n[1],a=n[2],o=n[3],s=this.label.node().getLocalBounds(),u=s.min,c=s.max,l=new $E(u[0]-o,u[1]-r,c[0]+i-u[0]+o,c[1]+a-u[1]+r),h=this.getPath(e,l),d=HE(this.attributes,"background");this.background=KE(this.group).maybeAppendByClassName(lO.background,"path").styles(fe(fe({},d),{d:h})),this.group.appendChild(this.label.node())}},e.prototype.renderLabel=function(){var t=this.attributes,e=t.formatter,n=t.labelText,r=ye(UE(HE(this.attributes,"label")),2),i=r[0],a=r[1],o=(i.text,ve(i,["text"]));this.label=KE(this.group).maybeAppendByClassName(lO.labelGroup,"g").styles(a),n&&this.label.maybeAppendByClassName(lO.label,(function(){return Mk(e(n))})).style("text",e(n).toString()).selectAll("text").styles(o)},e.prototype.adjustLayout=function(){var t=ye(this.point,2),e=t[0],n=t[1],r=this.attributes,i=r.x,a=r.y;this.group.attr("transform","translate(".concat(i-e,", ").concat(a-n,")"))},e.prototype.getPath=function(t,e){var n=this.attributes.radius,r=e.x,i=e.y,a=e.width,o=e.height,s=[["M",r+n,i],["L",r+a-n,i],["A",n,n,0,0,1,r+a,i+n],["L",r+a,i+o-n],["A",n,n,0,0,1,r+a-n,i+o],["L",r+n,i+o],["A",n,n,0,0,1,r,i+o-n],["L",r,i+n],["A",n,n,0,0,1,r+n,i],["Z"]],u={top:4,right:6,bottom:0,left:2}[t],c=this.createCorner([s[u].slice(-2),s[u+1].slice(-2)]);return s.splice.apply(s,me([u+1,1],ye(c),!1)),s[0][0]="M",s},e.prototype.createCorner=function(t,e){void 0===e&&(e=10);var n=kk.apply(void 0,me([],ye(t),!1)),r=ye(t,2),i=ye(r[0],2),a=i[0],o=i[1],s=ye(r[1],2),u=s[0],c=s[1],l=ye(n?[u-a,[a,u]]:[c-o,[o,c]],2),h=l[0],d=ye(l[1],2),f=d[0],v=d[1],p=h/2,g=e*(h/Math.abs(h)),y=g/2,m=g*Math.sqrt(3)/2*.8,b=ye([f,f+p-y,f+p,f+p+y,v],5),x=b[0],w=b[1],E=b[2],k=b[3],M=b[4];return n?(this.point=[E,o-m],[["L",x,o],["L",w,o],["L",E,o-m],["L",k,o],["L",M,o]]):(this.point=[a+m,E],[["L",a,x],["L",a,w],["L",a+m,E],["L",a,k],["L",a,M]])},e.prototype.applyVisibility=function(){"hidden"===this.attributes.visibility?LE(this):RE(this)},e.prototype.bindEvents=function(){this.label.on(bs.BOUNDS_CHANGED,this.renderBackground)},e.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout(),this.applyVisibility()},e}(zE),dO=function(t){function e(n){var r=t.call(this,IE({},e.defaultOptions,n))||this;return r.hoverColor="#f5f5f5",r.selectedColor="#e6f7ff",r.background=r.appendChild(new Ou({})),r.label=r.background.appendChild(new vu({})),r}return de(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return QE(this.style.padding)},enumerable:!1,configurable:!0}),e.prototype.renderLabel=function(){var t=this.style,e=t.label,n=t.value,r=HE(this.attributes,"label");KE(this.label).maybeAppend(".label",(function(){return Mk(e)})).attr("className","label").styles(r),this.label.attr("__data__",n)},e.prototype.renderBackground=function(){var t=this.label.getBBox(),e=ye(this.padding,4),n=e[0],r=e[1],i=e[2],a=e[3],o=t.width,s=t.height,u=o+a+r,c=s+n+i,l=HE(this.attributes,"background"),h=this.style,d=h.width,f=void 0===d?0:d,v=h.height,p=void 0===v?0:v,g=h.selected;this.background.attr(fe(fe({},l),{width:Math.max(u,f),height:Math.max(c,p),fill:g?this.selectedColor:"#fff"})),this.label.attr({transform:"translate(".concat(a,", ").concat((c-s)/2,")")})},e.prototype.render=function(){this.renderLabel(),this.renderBackground()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("pointerenter",(function(){t.style.selected||t.background.attr("fill",t.hoverColor)})),this.addEventListener("pointerleave",(function(){t.style.selected||t.background.attr("fill",t.style.backgroundFill)}));var e=this;this.addEventListener("click",(function(){var n=t.style,r=n.label,i=n.value,a=n.onClick;null==a||a(i,{label:r,value:i},e)}))},e.defaultOptions={style:{value:"",label:"",cursor:"pointer"}},e}(zE),fO=function(t){function e(n){var r,i,a=t.call(this,IE({},e.defaultOptions,n))||this;a.currentValue=null===(r=e.defaultOptions.style)||void 0===r?void 0:r.defaultValue,a.isPointerInSelect=!1,a.select=a.appendChild(new Ou({className:"select",style:{cursor:"pointer",width:0,height:0}})),a.dropdown=a.appendChild(new Ou({className:"dropdown"}));var o=a.style.defaultValue;return o&&(null===(i=a.style.options)||void 0===i?void 0:i.some((function(t){return t.value===o})))&&(a.currentValue=o),a}return de(e,t),e.prototype.setValue=function(t){this.currentValue=t,this.render()},e.prototype.getValue=function(){return this.currentValue},Object.defineProperty(e.prototype,"dropdownPadding",{get:function(){return QE(this.style.dropdownPadding)},enumerable:!1,configurable:!0}),e.prototype.renderSelect=function(){var t,e=this,n=this.style,r=n.x,i=n.y,a=n.width,o=n.height,s=n.bordered,u=n.showDropdownIcon,c=HE(this.attributes,"select"),l=HE(this.attributes,"placeholder");this.select.attr(fe(fe({x:r,y:i,width:a,height:o},c),{fill:"#fff",strokeWidth:s?1:0}));var h=this.dropdownPadding;u&&KE(this.select).maybeAppend(".dropdown-icon","path").style("d","M-5,-3.5 L0,3.5 L5,-3.5").style("transform","translate(".concat(r+a-10-h[1]-h[3],", ").concat(i+o/2,")")).style("lineWidth",1).style("stroke",this.select.style.stroke);var d=null===(t=this.style.options)||void 0===t?void 0:t.find((function(t){return t.value===e.currentValue})),f=fe({x:r+h[3]},l);KE(this.select).selectAll(".placeholder").data(d?[]:[1]).join((function(t){return t.append("text").attr("className","placeholder").styles(f).style("y",(function(){var t=this.getBBox();return i+(o-t.height)/2}))}),(function(t){return t.styles(f)}),(function(t){return t.remove()}));var v=HE(this.attributes,"optionLabel"),p=fe({x:r+h[3]},v);KE(this.select).selectAll(".value").data(d?[d]:[]).join((function(t){return t.append((function(t){return Mk(t.label)})).attr("className","value").styles(p).style("y",(function(){var t=this.getBBox();return i+(o-t.height)/2}))}),(function(t){return t.styles(p)}),(function(t){return t.remove()}))},e.prototype.renderDropdown=function(){var t,e,n=this,r=this.style,i=r.x,a=r.y,o=r.width,s=r.height,u=r.options,c=r.onSelect,l=r.open,h=HE(this.attributes,"dropdown"),d=HE(this.attributes,"option"),f=this.dropdownPadding;KE(this.dropdown).maybeAppend(".dropdown-container","g").attr("className","dropdown-container").selectAll(".dropdown-item").data(u,(function(t){return t.value})).join((function(t){return t.append((function(t){return new dO({className:"dropdown-item",style:fe(fe(fe({},t),d),{width:o-f[1]-f[3],selected:t.value===n.currentValue,onClick:function(t,e,r){n.setValue(t),null==c||c(t,e,r),n.dispatchEvent(new cs("change",{detail:{value:t,option:e,item:r}})),LE(n.dropdown)}})})})).each((function(t,e){var n,r=(null===(n=this.parentNode)||void 0===n?void 0:n.children).reduce((function(t,n,r){return r<e&&(t+=n.getBBox().height),t}),0);this.attr("transform","translate(".concat(f[3],", ").concat(f[0]+r,")"))}))}),(function(t){return t.update((function(t){return{selected:t.value===n.currentValue}}))}),(function(t){return t.remove()}));var v=null===(e=null===(t=this.dropdown.getElementsByClassName("dropdown-container"))||void 0===t?void 0:t[0])||void 0===e?void 0:e.getBBox(),p=h.spacing;this.dropdown.attr(fe({transform:"translate(".concat(i,", ").concat(a+s+p,")"),width:v.width+f[1]+f[3],height:v.height+f[0]+f[2]},h)),!l&&LE(this.dropdown)},e.prototype.render=function(){this.renderSelect(),this.renderDropdown()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("click",(function(t){t.stopPropagation()})),this.select.addEventListener("click",(function(){"visible"===t.dropdown.style.visibility?LE(t.dropdown):RE(t.dropdown)})),this.addEventListener("pointerenter",(function(){t.isPointerInSelect=!0})),this.addEventListener("pointerleave",(function(){t.isPointerInSelect=!1})),null===document||void 0===document||document.addEventListener("click",(function(){t.isPointerInSelect||LE(t.dropdown)}))},e.defaultOptions={style:{x:0,y:0,width:140,height:32,options:[],bordered:!0,defaultValue:"",selectRadius:8,selectStroke:"#d9d9d9",showDropdownIcon:!0,placeholderText:"请选择",placeholderFontSize:12,placeholderTextBaseline:"top",placeholderFill:"#c2c2c2",dropdownFill:"#fff",dropdownStroke:"#d9d9d9",dropdownRadius:8,dropdownShadowBlur:4,dropdownShadowColor:"rgba(0, 0, 0, 0.08)",dropdownPadding:8,dropdownSpacing:10,optionPadding:[8,12],optionFontSize:12,optionTextBaseline:"top",optionBackgroundFill:"#fff",optionBackgroundRadius:4,optionLabelFontSize:12,optionLabelTextBaseline:"top"}},e}(zE),vO=function(t){function e(n){var r=t.call(this,IE({},{style:{backgroundOpacity:e.backgroundOpacities.default}},e.defaultOptions,n))||this;return r.showBackground=!0,r.background=r.appendChild(new Ou({})),r.icon=r.appendChild(new vu({})),r}return de(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"BaseIcon"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return Math.log10(this.attributes.size)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return QE(this.attributes.size/5)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iconSize",{get:function(){var t=this.attributes.size,e=ye(this.padding,4),n=e[0],r=e[1],i=e[2],a=e[3];return Math.max(t-Math.max(a+r,n+i),2*this.lineWidth+1)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.attributes,e=t.x,n=t.y,r=t.size,i=r/2,a=HE(this.attributes,"background");this.background.attr(fe({x:e-i,y:n-i,width:r,height:r},a))},e.prototype.showIndicator=function(){if(this.label){var t=this.attributes.size,e=this.background.getBBox(),n=e.x,r=e.y;this.indicator.update({x:n+t/2,y:r-5,labelText:this.label,visibility:"visible"})}},e.prototype.hideIndicator=function(){this.indicator.update({visibility:"hidden"})},e.prototype.connectedCallback=function(){var e;t.prototype.connectedCallback.call(this);var n=this.attributes.size,r=this.background.getBBox(),i=r.x,a=r.y,o=null===(e=this.ownerDocument)||void 0===e?void 0:e.defaultView;o&&(this.indicator=o.appendChild(new hO({style:{x:i+n/2,y:a-n/2,visibility:"hidden",position:"top",radius:3,zIndex:100}})))},e.prototype.disconnectedCallback=function(){this.indicator.destroy()},e.prototype.render=function(){this.renderIcon(),this.showBackground&&this.renderBackground()},e.prototype.bindEvents=function(){var t=this,n=this.attributes.onClick;if(this.addEventListener("click",(function(){null==n||n(t)})),this.showBackground){var r=function(){return t.background.attr({opacity:e.backgroundOpacities.default})};this.addEventListener("pointerenter",(function(){t.background.attr({opacity:e.backgroundOpacities.hover}),t.showIndicator()})),this.addEventListener("pointerleave",(function(){r(),t.hideIndicator()})),this.addEventListener("pointerdown",(function(){t.background.attr({opacity:e.backgroundOpacities.active})})),this.addEventListener("pointerup",(function(){r()}))}},e.tag="IconBase",e.defaultOptions={style:{x:0,y:0,size:10,color:"#565758",backgroundRadius:4,backgroundFill:"#e2e2e2"}},e.backgroundOpacities={default:0,hover:.8,active:1},e}(zE),pO=function(t,e){return void 0===e&&(e="#565758"),new wu({style:{fill:e,d:"M ".concat(t,",").concat(t," L -").concat(t,",0 L ").concat(t,",-").concat(t," Z"),transformOrigin:"center"}})},gO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return de(e,t),e.prototype.arcPath=function(t,e,n){var r=ye([n,n],2),i=r[0],a=r[1],o=function(r){return[t+n*Math.cos(r),e+n*Math.sin(r)]},s=ye(o(-5/4*Math.PI),2),u=s[0],c=s[1],l=ye(o(1/4*Math.PI),2),h=l[0],d=l[1];return"M".concat(u,",").concat(c,",A").concat(i,",").concat(a,",0,1,1,").concat(h,",").concat(d)},Object.defineProperty(e.prototype,"label",{get:function(){return"重置"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,a=this.lineWidth,o=a+.5;KE(this.icon).maybeAppend(".reset","path").styles({stroke:r,lineWidth:a,d:this.arcPath(e,n,i/2-a),markerStart:pO(o,r)})},e}(vO),yO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return de(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"快退"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,a=i/2,o=i/2/Math.pow(3,.5),s=[[e,n],[e,n-o],[e-a,n],[e,n+o],[e,n],[e+a,n-o],[e+a,n+o],[e,n]];KE(this.icon).maybeAppend(".backward","polygon").styles({points:s,fill:r})},e}(vO),mO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return de(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"快进"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,a=i/2,o=i/2/Math.pow(3,.5),s=[[e,n],[e,n-o],[e+a,n],[e,n+o],[e,n],[e-a,n-o],[e-a,n+o],[e,n]];KE(this.icon).maybeAppend(".forward","polygon").styles({points:s,fill:r})},e}(vO),bO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return de(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"播放"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,a=i/3*Math.pow(3,.5)*.8,o=[[e+a,n],[e-a/2,n-i/2*.8],[e-a/2,n+i/2*.8],[e+a,n]];KE(this.icon).maybeAppend(".play","polygon").styles({points:o,fill:r})},e}(vO),xO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return de(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"暂停"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,a=i/3,o=[[e-a,n-i/2],[e-a,n+i/2],[e-a/2,n+i/2],[e-a/2,n-i/2],[e-a,n-i/2],[e+a/2,n-i/2],[e+a/2,n+i/2],[e+a,n+i/2],[e+a,n-i/2]];KE(this.icon).maybeAppend(".pause","polygon").styles({points:o,fill:r})},e}(vO),wO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return de(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"范围时间"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,a=this.lineWidth,o=a;KE(this.icon).maybeAppend(".left-line","line").styles({x1:e-i/2,y1:n-i/2,x2:e-i/2,y2:n+i/2,stroke:r,lineWidth:a}),KE(this.icon).maybeAppend(".right-line","line").styles({x1:e+i/2,y1:n-i/2,x2:e+i/2,y2:n+i/2,stroke:r,lineWidth:a}),KE(this.icon).maybeAppend(".left-arrow","line").styles({x1:e,y1:n,x2:e-i/2+2*o,y2:n,stroke:r,lineWidth:a,markerEnd:pO(2*a,r)}),KE(this.icon).maybeAppend(".right-arrow","line").styles({x1:e,y1:n,x2:e+i/2-2*o,y2:n,stroke:r,lineWidth:a,markerEnd:pO(2*a,r)})},e}(vO),EO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return de(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"单一时间"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,a=this.lineWidth;KE(this.icon).maybeAppend(".line","line").styles({x1:e,y1:n-i/2,x2:e,y2:n+i/2,stroke:r,lineWidth:a});var o=a;KE(this.icon).maybeAppend(".left-arrow","line").styles({x1:e-i/2-2*o,y1:n,x2:e-2*o,y2:n,stroke:r,lineWidth:a,markerEnd:pO(2*a,r)}),KE(this.icon).maybeAppend(".right-arrow","line").styles({x1:e+i/2+2*o,y1:n,x2:e+2*o,y2:n,stroke:r,lineWidth:a,markerEnd:pO(2*a,r)})},e}(vO),kO=function(t){return[[-t/2,-t/2],[-t/2,t/2],[t/2,t/2]]},MO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return de(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"折线图"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,a=this.lineWidth,o=(i-2*a-a)/4,s=(i-2*a-a)/2,u=ye([e-i/2+a,n+i/2-2*a],2),c=u[0],l=u[1];KE(this.icon).maybeAppend(".coordinate","polyline").styles({points:kO(i).map((function(t){var r=ye(t,2),i=r[0],a=r[1];return[i+e,a+n]})),stroke:r,lineWidth:a}),KE(this.icon).maybeAppend(".line","polyline").styles({points:[[c,l],[c+o,l-s],[c+2*o,l],[c+4*o,l-2*s]],stroke:r,lineWidth:a})},e}(vO),SO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return de(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"条形图"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return[1,4,2,4,3]},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.data,e=this.attributes,n=e.x,r=e.y,i=e.color,a=this.iconSize,o=this.lineWidth,s=o,u=(a-s)/t.length,c=(a-2*s)/4,l=ye([n-a/2+2*s,r+a/2-s],2),h=l[0],d=l[1];KE(this.icon).maybeAppend(".coordinate","polyline").styles({points:kO(a).map((function(t){var e=ye(t,2),i=e[0],a=e[1];return[i+n,a+r]})),stroke:i,lineWidth:o}),KE(this.icon).maybeAppend(".bars","g").selectAll(".column").data(this.data.map((function(t,e){return{value:t,index:e}}))).join((function(t){return t.append("line").attr("className","column").style("x1",(function(t){var e=t.index;return h+u*e})).style("y1",d).style("x2",(function(t){var e=t.index;return h+u*e})).style("y2",(function(t){var e=t.value;return d-c*e})).styles({y1:d,stroke:i,lineWidth:o})}))},e}(vO),OO=function(t){function e(e){var n=t.call(this,IE({},{style:{color:"#d8d9d9"}},e))||this;return n.showBackground=!1,n}return de(e,t),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,a=this.lineWidth;KE(this.icon).maybeAppend(".split","line").styles({x1:e,y1:n-i/2,x2:e,y2:n+i/2,stroke:r,lineWidth:a})},e}(vO),NO=function(t){function e(){var e=t.apply(this,me([],ye(arguments),!1))||this;return e.showBackground=!1,e}return de(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return QE(0)},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.iconSize,e=this.attributes,n=e.x,r=e.y,i=e.speed,a=void 0===i?1:i,o=pw(this.attributes,["x","y","transform","transformOrigin","width","height","size","color","speed"]),s=le(t,20,1/0),u=fe(fe({},o),{x:n-s/2,y:r-10,width:s,height:20,defaultValue:a,bordered:!1,showDropdownIcon:!1,selectRadius:2,dropdownPadding:this.padding,dropdownRadius:2,dropdownSpacing:t/5,placeholderFontSize:t/2,optionPadding:0,optionLabelFontSize:t/2,optionBackgroundRadius:1,options:[{label:"1x",value:1},{label:"1.5x",value:1.5},{label:"2x",value:2}]});KE(this.icon).maybeAppend(".speed",(function(){return new fO({style:u})})).attr("className","speed").each((function(){this.update(u)}))},e.tag="SpeedSelect",e}(vO),AO=function(t){function e(e){var n=t.call(this,e)||this;return n.icon=n.appendChild(new vu({})),n.currentType=n.attributes.type,n}return de(e,t),e.prototype.getType=function(){return this.currentType},e.prototype.render=function(){var t=this,e=this.attributes,n=(e.onChange,ve(e,["onChange"]));KE(this.icon).selectAll(".icon").data([this.currentType]).join((function(e){return e.append((function(e){var n,r=null===(n=t.toggles.find((function(t){return ye(t,1)[0]===e})))||void 0===n?void 0:n[1];if(!r)throw new Error("Invalid type: ".concat(e));return new r({})})).attr("className","icon").styles(n,!1).update({})}),(function(t){return t.styles({restStyles:n}).update({})}),(function(t){return t.remove()}))},e.prototype.bindEvents=function(){var t=this,e=this.attributes.onChange;this.addEventListener("click",(function(n){n.preventDefault(),n.stopPropagation();var r=(t.toggles.findIndex((function(e){return ye(e,1)[0]===t.currentType}))+1)%t.toggles.length,i=t.toggles[r][0];null==e||e(t.currentType),t.currentType=i,t.render()}))},e.tag="ToggleIcon",e}(zE),TO=function(t){function e(e){var n=t.call(this,IE({},{style:{type:"play"}},e))||this;return n.toggles=[["play",bO],["pause",xO]],n}return de(e,t),e}(AO),PO=function(t){function e(e){var n=t.call(this,IE({},{style:{type:"range"}},e))||this;return n.toggles=[["range",wO],["value",EO]],n}return de(e,t),e}(AO),CO=function(t){function e(e){var n=t.call(this,IE({},{style:{type:"column"}},e))||this;return n.toggles=[["line",MO],["column",SO]],n}return de(e,t),e}(AO),RO={reset:gO,speed:NO,backward:yO,playPause:TO,forward:mO,selectionType:PO,chartType:CO,split:OO},LO=function(t){function e(n){var r=t.call(this,IE({},e.defaultOptions,n))||this;return r.background=r.appendChild(new Ou({})),r.functions=r.appendChild(new vu({})),r}return de(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return QE(this.attributes.padding)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.style,e=t.x,n=t.y,r=t.width,i=t.height,a=HE(this.attributes,"background");this.background.attr(fe({x:e,y:n,width:r,height:i},a))},e.prototype.renderFunctions=function(){var t,e=this,n=this.attributes,r=n.functions,i=n.iconSize,a=n.iconSpacing,o=n.x,s=n.y,u=n.width,c=n.height,l=n.align,h=ye(this.padding,4),d=h[1],f=h[3],v=r.reduce((function(t,e){return t.length&&e.length?t.concat.apply(t,me(["split"],ye(e),!1)):t.concat.apply(t,me([],ye(e),!1))}),[]),p=v.length*(i+a)-a,g={left:f+i/2,center:(u-p)/2+i/2,right:u-p-f-d+i/2}[l]||0;null===(t=this.speedSelect)||void 0===t||t.destroy(),this.functions.removeChildren(),v.forEach((function(t,n){var r,u=RO[t],l={x:o+n*(i+a)+g,y:s+c/2,size:i};if(u===NO?(l.speed=e.attributes.speed,l.onSelect=function(n){return e.handleFunctionChange(t,{value:n})}):[TO,PO,CO].includes(u)?(l.onChange=function(n){return e.handleFunctionChange(t,{value:n})},u===TO&&(l.type="play"===e.attributes.state?"pause":"play"),u===PO&&(l.type="range"===e.attributes.selectionType?"value":"range"),u===CO&&(l.type="line"===e.attributes.chartType?"column":"line")):l.onClick=function(){return e.handleFunctionChange(t,{value:t})},u===NO){var h=null===(r=e.ownerDocument)||void 0===r?void 0:r.defaultView;h&&(e.speedSelect=new u({style:fe(fe({},l),{zIndex:100})}),h.appendChild(e.speedSelect))}else e.functions.appendChild(new u({style:l}))}))},e.prototype.disconnectedCallback=function(){var e;t.prototype.disconnectedCallback.call(this),null===(e=this.speedSelect)||void 0===e||e.destroy()},e.prototype.render=function(){this.renderBackground(),this.renderFunctions()},e.prototype.handleFunctionChange=function(t,e){var n=this.attributes.onChange;null==n||n(t,e)},e.defaultOptions={style:{x:0,y:0,width:300,height:40,padding:0,align:"center",iconSize:25,iconSpacing:0,speed:1,state:"pause",chartType:"line",selectionType:"range",backgroundFill:"#fbfdff",backgroundStroke:"#ebedf0",functions:[["reset","speed"],["backward","playPause","forward"],["selectionType","chartType"]]}},e}(zE),DO=function(t){function e(n){var r=t.call(this,IE({},e.defaultOptions,n))||this;return r.bindEvents(),r}return de(e,t),e.prototype.bindEvents=function(){var t=this;this.addEventListener("mouseenter",(function(){t.attr("lineWidth",Math.ceil(+(t.style.r||0)/2))})),this.addEventListener("mouseleave",(function(){t.attr("lineWidth",0)}))},e.defaultOptions={style:{r:5,fill:"#3f7cf7",lineWidth:0,stroke:"#3f7cf7",strokeOpacity:.5,cursor:"pointer"}},e}(lu),_O=function(t){function e(n){return t.call(this,IE({},e.defaultOptions,n))||this}return de(e,t),e.prototype.renderBackground=function(){var t=this.attributes,e=t.x,n=t.y,r=t.width,i=t.height,a=HE(this.attributes,"background");KE(this).maybeAppend("background","rect").attr("className","background").styles(fe({x:e-r/2,y:n-i/2,width:r,height:i},a))},e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.iconSize,i=HE(this.attributes,"icon"),a=r/2;KE(this).maybeAppend("icon-left-line","line").attr("className","icon-left-line").styles(fe({x1:e-1,y1:n-a,x2:e-1,y2:n+a},i)),KE(this).maybeAppend("icon-right-line","line").attr("className","icon-right-line").styles(fe({x1:e+1,y1:n-a,x2:e+1,y2:n+a},i))},e.prototype.renderBorder=function(){var t=this.attributes,e=t.x,n=t.y,r=t.width,i=t.height,a=t.type,o=HE(this.attributes,"border"),s="start"===a?+r/2:-r/2;KE(this).maybeAppend("border","line").attr("className","border").styles(fe({x1:s+e,y1:n-i/2,x2:s+e,y2:n+i/2},o))},e.prototype.render=function(){this.renderBackground(),this.renderIcon(),this.renderBorder()},e.defaultOptions={style:{x:0,y:0,width:10,height:50,iconSize:10,type:"start",backgroundFill:"#fff",backgroundFillOpacity:.5,iconStroke:"#9a9a9a",iconLineWidth:1,borderStroke:"#e8e8e8",borderLineWidth:1}},e}(zE);function IO(t){var e=String(Math.floor(t/3600)).padStart(2,"0"),n=String(Math.floor(t%3600/60)).padStart(2,"0"),r=String(Math.floor(t%60)).padStart(2,"0");return t<3600?"".concat(n,":").concat(r):"".concat(e,":").concat(n,":").concat(r)}var jO=function(t){function e(n){var r=t.call(this,IE({},e.defaultOptions,n))||this;r.axis=r.appendChild(new oS({style:{type:"linear",startPos:[0,0],endPos:[0,0],data:[],showArrow:!1,animate:!1}})),r.timeline=r.appendChild(new uO({style:{onChange:function(t){r.handleSliderChange(t)}}})),r.controller=r.appendChild(new LO({})),r.states={},r.handleSliderChange=function(t){var e,n=(e=r.states.values,Array.isArray(e)?me([],ye(e),!1):e);r.setBySliderValues(t),r.dispatchOnChange(n)};var i=r.attributes,a=i.selectionType,o=i.chartType,s=i.speed,u=i.state,c=i.playMode,l=i.values;return r.states={chartType:o,playMode:c,selectionType:a,speed:s,state:u},r.setByTimebarValues(l),r}return de(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.data.sort((function(t,e){return t.time<e.time?-1:t.time>e.time?1:0}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){var t=this.attributes,e=t.x,n=t.y,r=t.width,i=t.height,a=t.type,o=t.controllerHeight,s=le(+i-o,0,+i),u=new $E(e,n+ +i-o,+r,o),c=0,l="time"===a?10:s;return{axisBBox:"chart"===a?new $E(e,n+s-(c=35),+r,c):new $E,controllerBBox:u,timelineBBox:new $E(e,n+("time"===a?s:s-l),+r,l-c)}},enumerable:!1,configurable:!0}),e.prototype.setBySliderValues=function(t){var e,n,r=this.data,i=ye(Array.isArray(t)?t:[0,t],2),a=i[0],o=i[1],s=r.length,u=r[Math.floor(a*s)],c=r[Math.ceil(o*s)-(Array.isArray(t)?0:1)];this.states.values=[null!==(e=null==u?void 0:u.time)&&void 0!==e?e:r[0].time,null!==(n=null==c?void 0:c.time)&&void 0!==n?n:1/0]},e.prototype.setByTimebarValues=function(t){var e,n,r,i=this.data,a=ye(Array.isArray(t)?t:[void 0,t],2),o=a[0],s=a[1],u=i.find((function(t){return t.time===o})),c=i.find((function(t){return t.time===s}));this.states.values=[null!==(e=null==u?void 0:u.time)&&void 0!==e?e:null===(n=i[0])||void 0===n?void 0:n.time,null!==(r=null==c?void 0:c.time)&&void 0!==r?r:1/0]},e.prototype.setByIndex=function(t){var e,n,r,i,a=this.data,o=ye(t,2),s=o[0],u=o[1];this.states.values=[null!==(n=null===(e=a[s])||void 0===e?void 0:e.time)&&void 0!==n?n:a[0].time,null!==(i=null===(r=this.data[u])||void 0===r?void 0:r.time)&&void 0!==i?i:1/0]},Object.defineProperty(e.prototype,"sliderValues",{get:function(){var t,e=this.states,n=e.values,r=e.selectionType,i=ye(Array.isArray(n)?n:[void 0,n],2),a=i[0],o=i[1],s=this.data,u=s.length,c="value"===r;return[(t=s.findIndex((function(t){return t.time===a})),c?0:t>-1?t/u:0),function(){if(o===1/0)return 1;var t=s.findIndex((function(t){return t.time===o}));return t>-1?t/u:c?.5:1}()]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){var t=this.states,e=t.values,n=t.selectionType,r=ye(Array.isArray(e)?e:[this.data[0].time,e],2),i=r[0],a=r[1];return"value"===n?a:[i,a]},enumerable:!1,configurable:!0}),e.prototype.getDatumByRatio=function(t){var e=this.data,n=e.length;return e[Math.floor(t*(n-1))]},Object.defineProperty(e.prototype,"chartHandleIconShape",{get:function(){var t=this.states.selectionType,e=this.space.timelineBBox.height;return"range"===t?function(t){return new _O({style:{type:t,height:e,iconSize:e/6}})}:function(){return new bu({style:{x1:0,y1:-e/2,x2:0,y2:e/2,lineWidth:2,stroke:"#c8c8c8"}})}},enumerable:!1,configurable:!0}),e.prototype.getChartStyle=function(t){var e=this,n=t.x,r=t.y,i=t.width,a=t.height,o=this.states,s=o.selectionType,u=o.chartType,c=this.data,l=this.attributes,h=l.type,d=l.labelFormatter,f=HE(this.attributes,"chart"),v=(f.type,ve(f,["type"])),p="range"===s;if("time"===h)return fe({handleIconShape:function(){return new DO({})},selectionFill:"#2e7ff8",selectionFillOpacity:1,showLabelOnInteraction:!0,handleLabelDy:p?-15:0,autoFitLabel:p,handleSpacing:p?-15:0,trackFill:"#edeeef",trackLength:i,trackOpacity:.5,trackRadius:a/2,trackSize:a/2,type:s,values:this.sliderValues,formatter:function(t){if(d)return d(t);var n=e.getDatumByRatio(t).time;return"number"==typeof n?IO(n):Zk(n,"YYYY-MM-DD HH:mm:ss")},transform:"translate(".concat(n,", ").concat(r,")"),zIndex:1},v);var g="range"===s?5:0,y=c.map((function(t){return t.value}));return fe({handleIconOffset:g,handleIconShape:this.chartHandleIconShape,selectionFill:"#fff",selectionFillOpacity:.5,selectionType:"invert",sparklineSpacing:.1,sparklineColumnLineWidth:0,sparklineColor:"#d4e5fd",sparklineAreaOpacity:1,sparklineAreaLineWidth:0,sparklineData:y,sparklineType:u,sparklineScale:.8,trackLength:i,trackSize:a,type:s,values:this.sliderValues,transform:"translate(".concat(n,", ").concat(r,")"),zIndex:1},v)},e.prototype.renderChart=function(t){void 0===t&&(t=this.space.timelineBBox),this.timeline.update(this.getChartStyle(t))},e.prototype.updateSelection=function(){this.timeline.setValues(this.sliderValues,!0),this.handleSliderChange(this.sliderValues)},e.prototype.getAxisStyle=function(t){var e=this.data,n=this.attributes,r=n.interval,i=n.labelFormatter,a=HE(this.attributes,"axis"),o=t.x,s=t.y,u=t.width,c=me(me([],ye(e),!1),[{time:0}],!1).map((function(t,e,n){var r=t.time;return{label:"".concat(r),value:e/(n.length-1),time:r}})),l=fe({startPos:[o,s],endPos:[o+u,s],data:c,labelFilter:function(t,e){return e<c.length-1},labelFormatter:function(t){var e=t.time;return i?i(e):function(t,e){return"number"==typeof t?IO(t):function(t,e){var n=new Date(t);switch(e){case"half-hour":case"hour":case"four-hour":return[0,6,12,18].includes(n.getHours())&&0===n.getMinutes()?Zk(n,"HH:mm\nYYYY-MM-DD"):Zk(n,"HH:mm");case"half-day":return n.getHours()<12?"AM\n".concat(Zk(n,"YYYY-MM-DD")):"PM";case"day":return[1,10,20].includes(n.getDate())?Zk(n,"DD\nYYYY-MM"):Zk(n,"DD");case"week":return n.getDate()<=7?Zk(n,"DD\nYYYY-MM"):Zk(n,"DD");case"month":return[0,6].includes(n.getMonth())?Zk(n,"MM月\nYYYY"):Zk(n,"MM月");case"season":return[0].includes(n.getMonth())?Zk(n,"MM月\nYYYY"):Zk(n,"MM月");case"year":return Zk(n,"YYYY");default:return Zk(n,"YYYY-MM-DD HH:mm")}}(t,e)}(e,r)}},a);return l},e.prototype.renderAxis=function(t){void 0===t&&(t=this.space.axisBBox),"chart"===this.attributes.type&&this.axis.update(this.getAxisStyle(t))},e.prototype.renderController=function(t){void 0===t&&(t=this.space.controllerBBox);var e=this.attributes.type,n=this.states,r=n.state,i=n.speed,a=n.selectionType,o=n.chartType,s=HE(this.attributes,"controller"),u=this,c=fe(fe(fe({},t),{iconSize:20,speed:i,state:r,selectionType:a,chartType:o,onChange:function(t,e){var n=e.value;switch(t){case"reset":u.internalReset();break;case"speed":u.handleSpeedChange(n);break;case"backward":u.internalBackward();break;case"playPause":"play"===n?u.internalPlay():u.internalPause();break;case"forward":u.internalForward();break;case"selectionType":u.handleSelectionTypeChange(n);break;case"chartType":u.handleChartTypeChange(n)}}}),s);"time"===e&&(c.functions=[["reset","speed"],["backward","playPause","forward"],["selectionType"]]),this.controller.update(c)},e.prototype.dispatchOnChange=function(t){var e=this.data,n=this.attributes.onChange,r=this.states,i=r.values,a=r.selectionType,o=ye(i,2),s=o[0],u=o[1],c=u===1/0?e.at(-1).time:u;t&&function(t,e){if(Array.isArray(t)){if(!Array.isArray(e))return!1;if(t[0]===e[0]){if(t[1]===e[1])return!0;if(t[1]===1/0||e[1]===1/0)return!0}return!1}return!Array.isArray(e)&&t===e}(t,"range"===a?[s,c]:c)||null==n||n("range"===a?[s,c]:c)},e.prototype.internalReset=function(t){var e,n,r=this.states.selectionType;this.internalPause(),this.setBySliderValues("range"===r?[0,1]:[0,0]),this.renderController(),this.updateSelection(),t||(null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onReset)||void 0===n||n.call(e),this.dispatchOnChange())},e.prototype.reset=function(){this.internalReset()},e.prototype.moveSelection=function(t,e){var n=this.data,r=n.length,i=this.states,a=i.values,o=i.selectionType,s=i.playMode,u=ye(a,2),c=u[0],l=u[1],h=n.findIndex((function(t){return t.time===c})),d=n.findIndex((function(t){return t.time===l}));-1===d&&(d=r);var f,v="backward"===t?-1:1;"range"===o?"acc"===s?(f=[h,d+v],-1===v&&h===d&&(f=[h,r])):f=[h+v,d+v]:f=[h,d+v];var p=function(t){var e=ye(t.sort((function(t,e){return t-e})),2),n=e[0],i=e[1],a=function(t){return le(t,0,r)};return i>r?"value"===o?[0,0]:"acc"===s?[a(n),a(n)]:[0,a(i-n)]:n<0?"acc"===s?[0,a(i)]:[a(n+r-i),r]:[a(n),a(i)]}(f);return this.setByIndex(p),this.updateSelection(),p},e.prototype.internalBackward=function(t){var e,n,r=this.moveSelection("backward",t);return t||(null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onBackward)||void 0===n||n.call(e),this.dispatchOnChange()),r},e.prototype.backward=function(){this.internalBackward()},e.prototype.internalPlay=function(t){var e,n,r=this,i=this.data,a=this.attributes.loop,o=this.states.speed,s=void 0===o?1:o;this.playInterval=window.setInterval((function(){r.internalForward()[1]!==i.length||a||(r.internalPause(),r.renderController())}),1e3/s),this.states.state="play",!t&&(null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onPlay)||void 0===n||n.call(e))},e.prototype.play=function(){this.internalPlay()},e.prototype.internalPause=function(t){var e,n;clearInterval(this.playInterval),this.states.state="pause",!t&&(null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onPause)||void 0===n||n.call(e))},e.prototype.pause=function(){this.internalPause()},e.prototype.internalForward=function(t){var e,n,r=this.moveSelection("forward",t);return t||(null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onForward)||void 0===n||n.call(e),this.dispatchOnChange()),r},e.prototype.forward=function(){this.internalForward()},e.prototype.handleSpeedChange=function(t){var e,n;this.states.speed=t,"play"===this.states.state&&(this.internalPause(!0),this.internalPlay(!0)),null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onSpeedChange)||void 0===n||n.call(e,t)},e.prototype.handleSelectionTypeChange=function(t){var e,n;this.states.selectionType=t,this.renderChart(),null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onSelectionTypeChange)||void 0===n||n.call(e,t)},e.prototype.handleChartTypeChange=function(t){var e,n;this.states.chartType=t,this.renderChart(),null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onChartTypeChange)||void 0===n||n.call(e,t)},e.prototype.render=function(){var t=this.space,e=t.axisBBox,n=t.controllerBBox,r=t.timelineBBox;this.renderController(n),this.renderAxis(e),this.renderChart(r),"play"===this.states.state&&this.internalPlay()},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.internalPause(!0)},e.defaultOptions={style:{x:0,y:0,axisLabelFill:"#6e6e6e",axisLabelTextAlign:"left",axisLabelTextBaseline:"top",axisLabelTransform:"translate(5, -12)",axisLineLineWidth:1,axisLineStroke:"#cacdd1",axisTickLength:15,axisTickLineWidth:1,axisTickStroke:"#cacdd1",chartShowLabel:!1,chartType:"line",controllerAlign:"center",controllerHeight:40,data:[],interval:"day",loop:!1,playMode:"acc",selectionType:"range",type:"time"}},e}(zE),FO=["timestamp","time","date","datetime"],BO=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).backup(),r.upsertTimebar(),r}return N(e,t),b(e,[{key:"padding",get:function(){return Cl(this.options.padding)}},{key:"play",value:function(){var t;null===(t=this.timebar)||void 0===t||t.play()}},{key:"pause",value:function(){var t;null===(t=this.timebar)||void 0===t||t.pause()}},{key:"forward",value:function(){var t;null===(t=this.timebar)||void 0===t||t.forward()}},{key:"backward",value:function(){var t;null===(t=this.timebar)||void 0===t||t.backward()}},{key:"reset",value:function(){var t;null===(t=this.timebar)||void 0===t||t.reset()}},{key:"update",value:function(t){dn(e,"update",this,3)([t]),this.backup(),this.upsertTimebar()}},{key:"backup",value:function(){this.originalData=zO(this.context.graph.getData())}},{key:"upsertTimebar",value:function(){var t=this,e=this.context.canvas,n=this.options,r=n.onChange,i=n.timebarType,a=n.data,o=(n.x,n.y,n.width),s=n.height,u=(n.mode,function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(n,["onChange","timebarType","data","x","y","width","height","mode"])),c=e.getSize(),l=h(this.padding,1)[0];this.upsertCanvas().ready.then((function(){var e,n=Object.assign(Object.assign({x:c[0]/2-o/2,y:l,onChange:function(e){var n=(He(e)?e:[e,e]).map((function(t){return function(t){return t instanceof Date}(t)?t.getTime():t}));"modify"===t.options.mode?t.filterElements(n):t.hiddenElements(n),null==r||r(n)}},u),{data:a.map((function(t){return oe(t)?{time:t,value:0}:t})),width:o,height:s,type:i});t.timebar?t.timebar.update(n):(t.timebar=new jO({style:n}),null===(e=t.canvas)||void 0===e||e.appendChild(t.timebar))}))}},{key:"upsertCanvas",value:function(){if(this.canvas)return this.canvas;var t=this.options,e=t.className,n=t.height,r=t.position,i=this.context.canvas,a=h(i.getSize(),1)[0],o=h(this.padding,3),s=h(Gk({width:a,height:n+o[0]+o[2],graphCanvas:i,className:"timebar",placement:r}),2),u=s[0],c=s[1];return this.container=u,e&&u.classList.add(e),this.canvas=c,this.canvas}},{key:"filterElements",value:function(t){return e=this,n=void 0,r=void 0,i=Tn().mark((function e(){var n,r,i,a,o,s,u,c,l,h=this;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.originalData){e.next=2;break}return e.abrupt("return");case 2:return r=this.options,i=r.elementTypes,a=r.getTime,o=this.context,s=o.graph,u=o.element,c=zO(this.originalData),i.forEach((function(e){var n="".concat(e,"s");c[n]=(h.originalData[n]||[]).filter((function(e){var n=a(e);return!!GO(n,t)}))})),l=[].concat(w(c.nodes),w(c.combos)).map((function(t){return yh(t)})),c.edges=c.edges.filter((function(t){var e=t.source,n=t.target;return l.includes(e)&&l.includes(n)})),s.setData(c),e.next=11,null===(n=u.draw({animation:!1,silence:!0}))||void 0===n?void 0:n.finished;case 11:case"end":return e.stop()}}),e,this)})),new(r||(r=Promise))((function(t,a){function o(t){try{u(i.next(t))}catch(t){a(t)}}function s(t){try{u(i.throw(t))}catch(t){a(t)}}function u(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(o,s)}u((i=i.apply(e,n||[])).next())}));var e,n,r,i}},{key:"hiddenElements",value:function(t){var e=this,n=this.context.graph,r=this.options,i=r.elementTypes,a=r.getTime,o=[],s=[];i.forEach((function(n){var r,i="".concat(n,"s");((null===(r=e.originalData)||void 0===r?void 0:r[i])||[]).forEach((function(e){var n=yh(e),r=a(e);GO(r,t)?s.push(n):o.push(n)}))})),n.hideElement(o,!1),n.showElement(s,!1)}},{key:"destroy",value:function(){var t,n,r,i=this.context.graph;this.originalData&&i.setData(Object.assign({},this.originalData)),null===(t=this.timebar)||void 0===t||t.destroy(),null===(n=this.canvas)||void 0===n||n.destroy(),null===(r=this.container)||void 0===r||r.remove(),this.originalData=void 0,this.container=void 0,this.timebar=void 0,this.canvas=void 0,dn(e,"destroy",this,3)([])}}])}(gw);BO.defaultOptions={position:"bottom",enable:!0,timebarType:"time",className:"g6-timebar",width:450,height:60,zIndex:3,elementTypes:["node"],padding:10,mode:"modify",getTime:function(t){return VO(t,FO,void 0)},loop:!1};var zO=function(t){var e=t.nodes,n=void 0===e?[]:e,r=t.edges,i=void 0===r?[]:r,a=t.combos,o=void 0===a?[]:a;return{nodes:w(n),edges:w(i),combos:w(o)}},GO=function(t,e){if(oe(e))return t===e;var n=h(e,2),r=n[0],i=n[1];return t>=r&&t<=i},VO=function(t,e,n){for(var r,i=0;i<e.length;i++){var a=e[i],o=null===(r=t.data)||void 0===r?void 0:r[a];if(o)return o}return n};function WO(t){var e={top:"unset",right:"unset",bottom:"unset",left:"unset"};return t.split("-").forEach((function(t){e[t]="8px"})),e.flexDirection=t.startsWith("top")||t.startsWith("bottom")?"row":"column",e}var HO=function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},YO=function(t){function e(t,n){var r;y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).$element=yw("toolbar",!1),r.onToolbarItemClick=function(t){var e=r.options.onClick;if(t.target instanceof Element&&t.target.className.includes("g6-toolbar-item")){var n=t.target.getAttribute("value");null==e||e(n,t.target)}};var i=r.context.canvas.getContainer();return r.$element.style.display="flex",i.appendChild(r.$element),mw("g6-toolbar-css","style",{},"\n  .g6-toolbar {\n    position: absolute;\n    z-index: 100;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: center;\n    border-radius: 4px;\n    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);\n    opacity: 0.65;\n  }\n  .g6-toolbar .g6-toolbar-item {\n    display: inline-block;\n    width: 16px;\n    height: 16px;\n    padding: 4px;\n    cursor: pointer;\n    box-sizing: content-box;\n  }\n\n  .g6-toolbar .g6-toolbar-item:hover {\n    background-color: #f0f0f0;\n  }\n\n  .g6-toolbar .g6-toolbar-item svg {\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n  }\n",document.head),mw("g6-toolbar-svgicon","div",{display:"none"},'\n  <svg>\n    <symbol id="zoom-in" viewBox="64 64 896 896">\n      <path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>\n    </symbol>\n    <symbol id="zoom-out" viewBox="64 64 896 896">\n      <path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>\n    </symbol>\n    <symbol id="edit" viewBox="64 64 896 896">\n      <path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"></path>\n    </symbol>\n    <symbol id="delete" viewBox="64 64 896 896">\n      <path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"></path>\n    </symbol>\n    <symbol id="redo" viewBox="64 64 896 896">\n      <path d="M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"></path>\n    </symbol>\n    <symbol id="undo" viewBox="64 64 896 896">\n      <path d="M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 00-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 00-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z"></path>\n    </symbol>\n    <symbol id="export" viewBox="64 64 896 896">\n      <path d="M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"></path>\n    </symbol>\n    <symbol id="auto-fit" viewBox="64 64 896 896">\n      <path d="M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"></path>\n      <path d="M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"></path>\n    </symbol>\n    <symbol id="reset" viewBox="64 64 896 896">\n      <path d="M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"></path>\n    </symbol>\n    <symbol id="exit-fullscreen" viewBox="0 0 1024 1024">\n      <path d="M418.13333333 361.43786666c0 0.2048-0.13653333 0.4096-0.13653334 0.68266667C417.99679999 362.32533333 418.13333333 362.53013333 418.13333333 362.73493333 418.13333333 371.54133333 414.44693333 379.392 408.78079999 385.39946666 408.43946666 385.7408 408.30293333 386.21866666 408.02986666 386.49173333c-1.09226667 1.09226667-2.59413333 1.77493333-3.82293333 2.73066667C398.40426666 393.65973333 391.64586666 396.8 383.93173333 396.8 383.72693333 396.8 383.59039999 396.73173333 383.38559999 396.73173333S382.97599999 396.8 382.77119999 396.8L112.29866666 396.8C92.50133333 396.8 76.79999999 381.50826666 76.79999999 362.66666666 76.66346666 343.89333333 92.63786666 328.53333333 112.16213333 328.53333333l189.44 0L87.44959999 114.51733333C73.59146666 100.59093333 73.25013333 78.5408 86.63039999 65.29706666c13.17546667-13.44853333 35.36213333-12.97066667 49.152 0.88746667l214.08426667 214.08426667L349.86666666 90.89706666C349.79839999 71.23626666 365.22666666 55.46666666 383.99999999 55.46666666 402.77333333 55.33013333 418.13333333 71.30453333 418.13333333 90.8288L418.13333333 361.43786666zM928.90453333 328.53333333l-189.44 0 214.15253333-214.08426667c13.85813333-13.9264 14.19946667-35.90826667 0.88746667-49.22026666-13.17546667-13.44853333-35.36213333-12.97066667-49.152 0.88746666l-214.08426667 214.08426667L691.26826666 90.89706666C691.26826666 71.23626666 675.83999999 55.46666666 657.06666666 55.46666666 638.29333333 55.33013333 622.93333333 71.30453333 622.93333333 90.8288l0 270.60906666c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 362.32533333 622.93333333 362.53013333 622.93333333 362.73493333 622.93333333 371.54133333 626.61973333 379.392 632.28586666 385.39946666c0.34133333 0.34133333 0.47786667 0.8192 0.8192 1.09226667 1.09226667 1.09226667 2.59413333 1.77493333 3.8912 2.73066667C642.66239999 393.65973333 649.42079999 396.8 657.13493333 396.8c0.2048 0 0.34133333-0.06826667 0.54613333-0.06826667S658.09066666 396.8 658.29546666 396.8l270.5408 0C948.56533333 396.8 964.26666666 381.50826666 964.26666666 362.66666666 964.40319999 343.89333333 948.42879999 328.53333333 928.90453333 328.53333333zM418.13333333 635.73333333c0-8.8064-3.6864-16.5888-9.35253334-22.66453333C408.43946666 612.72746666 408.30293333 612.2496 408.02986666 611.90826666 406.86933333 610.88426666 405.43573333 610.2016 404.20693333 609.24586666 398.47253333 604.80853333 391.64586666 601.6 383.93173333 601.6 383.72693333 601.6 383.59039999 601.73653333 383.38559999 601.73653333S382.97599999 601.6 382.77119999 601.6L112.29866666 601.6C92.50133333 601.6 76.79999999 616.96 76.79999999 635.73333333 76.66346666 654.50666666 92.63786666 669.86666666 112.16213333 669.86666666l189.44 0-214.15253334 214.15253334c-13.85813333 13.85813333-14.19946667 35.84-0.88746666 49.22026666 13.17546667 13.44853333 35.36213333 12.9024 49.152-0.95573333l214.08426666-214.08426667 0 189.37173334c0 19.59253333 15.42826667 35.49866667 34.2016 35.36213333C402.77333333 943.2064 418.13333333 927.232 418.13333333 907.5712L418.13333333 637.09866666c0-0.27306667-0.13653333-0.47786667-0.13653334-0.68266666C417.99679999 636.14293333 418.13333333 635.93813333 418.13333333 635.73333333zM739.46453333 669.86666666l189.44 0c19.456 0 35.49866667-15.36 35.36213333-34.13333333C964.26666666 616.96 948.56533333 601.6 928.76799999 601.6L658.29546666 601.6C658.09066666 601.6 657.88586666 601.73653333 657.68106666 601.73653333S657.33973333 601.6 657.13493333 601.6C649.42079999 601.6 642.59413333 604.80853333 636.85973333 609.24586666 635.63093333 610.2016 634.19733333 610.88426666 633.03679999 611.90826666 632.76373333 612.2496 632.62719999 612.72746666 632.28586666 613.0688 626.61973333 619.14453333 622.93333333 626.92693333 622.93333333 635.73333333c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 636.6208 622.93333333 636.8256 622.93333333 637.09866666l0 270.5408C622.93333333 927.232 638.29333333 943.2064 657.06666666 942.93333333c18.77333333 0.13653333 34.2016-15.70133333 34.2016-35.36213333l0-189.37173334 214.08426667 214.08426667c13.78986667 13.85813333 35.90826667 14.40426667 49.152 0.95573333 13.312-13.312 12.97066667-35.36213333-0.88746667-49.22026666L739.46453333 669.86666666z"  ></path></symbol>\n    <symbol id="request-fullscreen" viewBox="0 0 1024 1024">\n      <path d="M69.818182 87.598545v273.128728a34.909091 34.909091 0 0 0 69.818182 0V163.653818l221.928727 222.021818a33.512727 33.512727 0 0 0 47.383273-47.383272L186.926545 116.363636h197.073455a34.909091 34.909091 0 0 0 0-69.818181H110.871273C85.364364 46.545455 69.818182 59.671273 69.818182 87.598545zM938.542545 46.545455H665.413818a34.909091 34.909091 0 0 0 0 69.818181h197.073455L640.465455 338.292364a33.512727 33.512727 0 0 0 47.383272 47.383272l221.928728-222.021818v197.073455a34.909091 34.909091 0 0 0 69.818181 0V87.598545c0-27.927273-15.453091-41.053091-40.96-41.05309z m-827.671272 907.636363h273.128727a34.909091 34.909091 0 0 0 0-69.818182H186.926545l222.021819-221.928727a33.512727 33.512727 0 0 0-47.383273-47.383273L139.636364 837.073455V640a34.909091 34.909091 0 0 0-69.818182 0v273.128727c0 27.927273 15.546182 41.053091 41.053091 41.053091z m868.724363-41.053091V640a34.909091 34.909091 0 0 0-69.818181 0v197.073455L687.941818 615.051636a33.512727 33.512727 0 0 0-47.383273 47.383273L862.487273 884.363636H665.413818a34.909091 34.909091 0 0 0 0 69.818182h273.128727c25.6 0 41.053091-13.125818 41.053091-41.053091z"  ></path></symbol>\n  </svg>\n'),r.$element.addEventListener("click",r.onToolbarItemClick),r.update(n),r}return N(e,t),b(e,[{key:"update",value:function(t){var n=this,r=Object.create(null,{update:{get:function(){return dn(e,"update",n,1)}}});return HO(this,void 0,void 0,Tn().mark((function e(){var n,i,a,o;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.update.call(this,t),n=this.options,i=n.className,a=n.position,o=n.style,this.$element.className="g6-toolbar ".concat(i||""),Object.assign(this.$element.style,o,WO(a)),e.next=6,this.getDOMContent();case 6:this.$element.innerHTML=e.sent;case 7:case"end":return e.stop()}}),e,this)})))}},{key:"destroy",value:function(){this.$element.removeEventListener("click",this.onToolbarItemClick),this.$element.remove(),dn(e,"destroy",this,3)([])}},{key:"getDOMContent",value:function(){return HO(this,void 0,void 0,Tn().mark((function t(){var e;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.options.getItems();case 2:return e=t.sent,t.abrupt("return",e.map((function(t){return'\n          <div class="g6-toolbar-item" value="'.concat(t.value,'">\n            <svg aria-hidden="true" focusable="false">\n              <use xlink:href="#').concat(t.id,'"></use>\n            </svg>\n          </div>')})).join(""));case 4:case"end":return t.stop()}}),t,this)})))}}])}(gw);function UO(t){var e=document.createElement("div");e.innerHTML=t;var n=e.childNodes[0];return n&&e.contains(n)&&e.removeChild(n),n}YO.defaultOptions={position:"top-left"};var qO=function(t,e){null!=e?t.replaceChildren?Array.isArray(e)?t.replaceChildren.apply(t,me([],ye(e),!1)):t.replaceChildren(e):(t.innerHTML="",Array.isArray(e)?e.forEach((function(e){return t.appendChild(e)})):t.appendChild(e)):t.innerHTML=""};function XO(t){return void 0===t&&(t=""),{CONTAINER:"".concat(t,"tooltip"),TITLE:"".concat(t,"tooltip-title"),LIST:"".concat(t,"tooltip-list"),LIST_ITEM:"".concat(t,"tooltip-list-item"),NAME:"".concat(t,"tooltip-list-item-name"),MARKER:"".concat(t,"tooltip-list-item-marker"),NAME_LABEL:"".concat(t,"tooltip-list-item-name-label"),VALUE:"".concat(t,"tooltip-list-item-value"),CROSSHAIR_X:"".concat(t,"tooltip-crosshair-x"),CROSSHAIR_Y:"".concat(t,"tooltip-crosshair-y")}}var KO={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"};function $O(t){var e;void 0===t&&(t="");var n=XO(t);return(e={})[".".concat(n.CONTAINER)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.96)","box-shadow":"0 6px 12px 0 rgba(0, 0, 0, 0.12)","border-radius":"4px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"12px","min-width":"120px","max-width":"360px","font-family":"Roboto-Regular"},e[".".concat(n.TITLE)]={color:"rgba(0, 0, 0, 0.45)"},e[".".concat(n.LIST)]={margin:"0px","list-style-type":"none",padding:"0px"},e[".".concat(n.LIST_ITEM)]={"list-style-type":"none",display:"flex","line-height":"2em","align-items":"center","justify-content":"space-between","white-space":"nowrap"},e[".".concat(n.MARKER)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"4px"},e[".".concat(n.NAME)]={display:"flex","align-items":"center","max-width":"216px"},e[".".concat(n.NAME_LABEL)]=fe({flex:1},KO),e[".".concat(n.VALUE)]=fe({display:"inline-block",float:"right",flex:1,"text-align":"right","min-width":"28px","margin-left":"30px",color:"rgba(0, 0, 0, 0.85)"},KO),e[".".concat(n.CROSSHAIR_X)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e[".".concat(n.CROSSHAIR_Y)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e}var ZO=function(t){function e(e){var n,r,i=this,a=null===(r=null===(n=e.style)||void 0===n?void 0:n.template)||void 0===r?void 0:r.prefixCls,o=XO(a);return(i=t.call(this,e,{data:[],x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],enterable:!1,container:{x:0,y:0},bounding:null,template:{prefixCls:"",container:'<div class="'.concat(o.CONTAINER,'"></div>'),title:'<div class="'.concat(o.TITLE,'"></div>'),item:'<li class="'.concat(o.LIST_ITEM,'" data-index={index}>\n        <span class="').concat(o.NAME,'">\n          <span class="').concat(o.MARKER,'" style="background:{color}"></span>\n          <span class="').concat(o.NAME_LABEL,'" title="{name}">{name}</span>\n        </span>\n        <span class="').concat(o.VALUE,'" title="{value}">{value}</span>\n      </li>')},style:$O(a)})||this).timestamp=-1,i.prevCustomContentKey=i.attributes.contentKey,i.initShape(),i.render(i.attributes,i),i}return de(e,t),Object.defineProperty(e.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.element},Object.defineProperty(e.prototype,"elementSize",{get:function(){return{width:this.element.offsetWidth,height:this.element.offsetHeight}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HTMLTooltipItemsElements",{get:function(){var t=this.attributes,e=t.data,n=t.template;return e.map((function(t,e){var r,i,a=t.name,o=void 0===a?"":a,s=t.color,u=void 0===s?"black":s,c=t.index,l=ve(t,["name","color","index"]),h=fe({name:o,color:u,index:null!=c?c:e},l);return UO((r=n.item,i=h,r&&i?r.replace(/\\?\{([^{}]+)\}/g,(function(t,e){return"\\"===t.charAt(0)?t.slice(1):void 0===i[e]?"":i[e]})):r))}))},enumerable:!1,configurable:!0}),e.prototype.render=function(t,e){this.renderHTMLTooltipElement(),this.updatePosition()},e.prototype.destroy=function(){var e;null===(e=this.element)||void 0===e||e.remove(),t.prototype.destroy.call(this)},e.prototype.show=function(t,e){var n=this;if(void 0!==t&&void 0!==e){var r=function(){n.attributes.x=null!=t?t:n.attributes.x,n.attributes.y=null!=e?e:n.attributes.y,n.updatePosition()};"hidden"===this.element.style.visibility?this.closeTransition(r):r()}this.element.style.visibility="visible"},e.prototype.hide=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.attributes.enterable&&this.isCursorEntered(t,e)||(this.element.style.visibility="hidden")},e.prototype.initShape=function(){var t=this.attributes.template;this.element=UO(t.container),this.id&&this.element.setAttribute("id",this.id)},e.prototype.renderCustomContent=function(){if(void 0===this.prevCustomContentKey||this.prevCustomContentKey!==this.attributes.contentKey){this.prevCustomContentKey=this.attributes.contentKey;var t=this.attributes.content;t&&("string"==typeof t?this.element.innerHTML=t:qO(this.element,t))}},e.prototype.renderHTMLTooltipElement=function(){var t,e,n=this.attributes,r=n.template,i=n.title,a=n.enterable,o=n.style,s=n.content,u=XO(r.prefixCls),c=this.element;if(this.element.style.pointerEvents=a?"auto":"none",s)this.renderCustomContent();else{i?(c.innerHTML=r.title,c.getElementsByClassName(u.TITLE)[0].innerHTML=i):null===(e=null===(t=c.getElementsByClassName(u.TITLE))||void 0===t?void 0:t[0])||void 0===e||e.remove();var l=this.HTMLTooltipItemsElements,h=document.createElement("ul");h.className=u.LIST,qO(h,l);var d=this.element.querySelector(".".concat(u.LIST));d?d.replaceWith(h):c.appendChild(h)}!function(t,e){Object.entries(e).forEach((function(e){var n=ye(e,2),r=n[0],i=n[1];me([t],ye(t.querySelectorAll(r)),!1).filter((function(t){return t.matches(r)})).forEach((function(t){t&&(t.style.cssText+=Object.entries(i).reduce((function(t,e){return"".concat(t).concat(e.join(":"),";")}),""))}))}))}(c,o)},e.prototype.getRelativeOffsetFromCursor=function(t){var e=this.attributes,n=e.position,r=e.offset,i=(t||n).split("-"),a={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},o=this.elementSize,s=o.width,u=o.height,c=[-s/2,-u/2];return i.forEach((function(t){var e=ye(c,2),n=e[0],i=e[1],o=ye(a[t],2),l=o[0],h=o[1];c=[n+(s/2+r[0])*l,i+(u/2+r[1])*h]})),c},e.prototype.setOffsetPosition=function(t){var e=ye(t,2),n=e[0],r=e[1],i=this.attributes,a=i.x,o=void 0===a?0:a,s=i.y,u=void 0===s?0:s,c=i.container,l=c.x,h=c.y;this.element.style.left="".concat(+o+l+n,"px"),this.element.style.top="".concat(+u+h+r,"px")},e.prototype.updatePosition=function(){var t=this.attributes.showDelay,e=void 0===t?60:t,n=Date.now();this.timestamp>0&&n-this.timestamp<e||(this.timestamp=n,this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor())))},e.prototype.autoPosition=function(t){var e=ye(t,2),n=e[0],r=e[1],i=this.attributes,a=i.x,o=i.y,s=i.bounding,u=i.position;if(!s)return[n,r];var c=this.element,l=c.offsetWidth,h=c.offsetHeight,d=ye([+a+n,+o+r],2),f=d[0],v=d[1],p={left:"right",right:"left",top:"bottom",bottom:"top"},g=s.x,y=s.y,m={left:f<g,right:f+l>g+s.width,top:v<y,bottom:v+h>y+s.height},b=[];u.split("-").forEach((function(t){m[t]?b.push(p[t]):b.push(t)}));var x=b.join("-");return this.getRelativeOffsetFromCursor(x)},e.prototype.isCursorEntered=function(t,e){if(this.element){var n=this.element.getBoundingClientRect(),r=n.x,i=n.y,a=n.width,o=n.height;return new $E(r,i,a,o).isPointIn(t,e)}return!1},e.prototype.closeTransition=function(t){var e=this,n=this.element.style.transition;this.element.style.transition="none",t(),setTimeout((function(){e.element.style.transition=n}),10)},e.tag="tooltip",e}(zE),QO=function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},JO=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).currentTarget=null,r.tooltipElement=null,r.container=null,r.isEnable=function(t,e){var n=r.options.enable;return"function"==typeof n?n(t,e):n},r.onClick=function(t){var e=t.target.id;r.currentTarget===e?r.hide(t):r.show(t)},r.onPointerMove=function(t){var e=t.target;r.currentTarget&&e.id!==r.currentTarget&&r.show(t)},r.onPointerLeave=function(t){r.hide(t)},r.onCanvasMove=function(t){r.hide(t)},r.onPointerEnter=function(t){r.show(t)},r.showById=function(t){return QO(r,void 0,void 0,Tn().mark((function e(){var n;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={target:{id:t}},e.next=3,this.show(n);case 3:case"end":return e.stop()}}),e,this)})))},r.getElementData=function(t,e){var n=r.context.model;switch(e){case"node":return n.getNodeData([t]);case"edge":return n.getEdgeData([t]);case"combo":return n.getComboData([t]);default:return[]}},r.show=function(t){return QO(r,void 0,void 0,Tn().mark((function e(){var n,r,i,a,o,s,u,c,l,h,d,f,v,p,g;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.client,a=t.target.id,!bg(t.target)){e.next=3;break}return e.abrupt("return");case 3:if(o=this.context.graph.getElementType(a),s=this.options,u=s.getContent,c=s.title,l=this.getElementData(a,o),this.tooltipElement&&this.isEnable(t,l)){e.next=8;break}return e.abrupt("return");case 8:if(h={},!u){e.next=17;break}return e.next=12,u(t,l);case 12:if(h.content=e.sent,h.content){e.next=15;break}return e.abrupt("return");case 15:e.next=20;break;case 17:d=this.context.graph.getElementRenderStyle(a),f="node"===o?d.fill:d.stroke,h={title:c||o,data:l.map((function(t){return{name:"ID",value:t.id||"".concat(t.source," -> ").concat(t.target),color:f}}))};case 20:this.currentTarget=a,i?(v=i.x,p=i.y):(g=Pd(l,"0.style",{x:0,y:0}),v=g.x,p=g.y),null===(r=(n=this.options).onOpenChange)||void 0===r||r.call(n,!0),this.tooltipElement.update(Object.assign(Object.assign(Object.assign({},this.tooltipStyleProps),{x:v,y:p,style:{".tooltip":{visibility:"visible"}}}),h));case 24:case"end":return e.stop()}}),e,this)})))},r.hide=function(t){var e,n,i,a,o;if(!t)return null===(n=(e=r.options).onOpenChange)||void 0===n||n.call(e,!1),null===(i=r.tooltipElement)||void 0===i||i.hide(),void(r.currentTarget=null);if(r.tooltipElement&&r.currentTarget){var s=t.client,u=s.x,c=s.y;null===(o=(a=r.options).onOpenChange)||void 0===o||o.call(a,!1),r.tooltipElement.hide(u,c),r.currentTarget=null}},r.initTooltip=function(){var t,e=new ZO({className:"tooltip",style:r.tooltipStyleProps});return null===(t=r.container)||void 0===t||t.appendChild(e.HTMLTooltipElement),e},r.render(),r.bindEvents(),r}return N(e,t),b(e,[{key:"getEvents",value:function(){return"click"===this.options.trigger?{"node:click":this.onClick,"edge:click":this.onClick,"combo:click":this.onClick,"canvas:click":this.onPointerLeave,contextmenu:this.onPointerLeave,drag:this.onPointerLeave}:{"node:pointerenter":this.onPointerEnter,"node:pointermove":this.onPointerMove,"canvas:pointermove":this.onCanvasMove,"edge:pointerenter":this.onPointerEnter,"edge:pointermove":this.onPointerMove,"combo:pointerenter":this.onPointerEnter,"combo:pointermove":this.onPointerMove,contextmenu:this.onPointerLeave,"node:drag":this.onPointerLeave}}},{key:"update",value:function(t){var n;this.unbindEvents(),dn(e,"update",this,3)([t]),this.tooltipElement&&(null===(n=this.container)||void 0===n||n.removeChild(this.tooltipElement.HTMLTooltipElement)),this.tooltipElement=this.initTooltip(),this.bindEvents()}},{key:"render",value:function(){var t=this.context.canvas.getContainer();t&&(this.container=t,this.tooltipElement=this.initTooltip())}},{key:"unbindEvents",value:function(){var t=this.context.graph,e=this.getEvents();Object.keys(e).forEach((function(n){t.off(n,e[n])}))}},{key:"bindEvents",value:function(){var t=this.context.graph,e=this.getEvents();Object.keys(e).forEach((function(n){t.on(n,e[n])}))}},{key:"tooltipStyleProps",get:function(){var t=this.context.canvas,e=t.getBounds().center,n=t.getContainer().getBoundingClientRect(),r=n.top,i=n.left,a=this.options,o=a.style,s=a.position,u=a.enterable,c=a.container,l=void 0===c?{x:-i,y:-r}:c,d=a.title,f=a.offset,v=h(e,2),p=v[0],g=v[1],y=h(t.getSize(),2);return{x:p,y:g,container:l,title:d,bounding:{x:0,y:0,width:y[0],height:y[1]},position:s,enterable:u,offset:f,style:o}}},{key:"destroy",value:function(){var t;this.unbindEvents(),this.tooltipElement&&(null===(t=this.container)||void 0===t||t.removeChild(this.tooltipElement.HTMLTooltipElement)),dn(e,"destroy",this,3)([])}}])}(gw);JO.defaultOptions={trigger:"hover",position:"top-right",enterable:!1,enable:!0,offset:[10,10],style:{".tooltip":{visibility:"hidden"}}};var tN,eN=function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))};function nN(t,e){return tN||(tN=document.createElement("canvas")),tN.width=t,tN.height=e,tN.getContext("2d").clearRect(0,0,t,e),tN}function rN(t,e,n,r){return eN(this,void 0,void 0,Tn().mark((function i(){var a,o,s,u,c,l,h,d,f,v,p;return Tn().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a=nN(t,e),o=a.getContext("2d"),s=r.rotate,u=r.opacity,c=r.textFill,l=r.textFontSize,h=r.textFontFamily,d=r.textFontVariant,f=r.textFontWeight,v=r.textAlign,p=r.textBaseline,o.textAlign=v,o.textBaseline=p,o.translate(t/2,e/2),o.font="".concat(l,"px ").concat(h," ").concat(d," ").concat(f),s&&o.rotate(s),u&&(o.globalAlpha=u),c&&(o.fillStyle=c,o.fillText("".concat(n),0,0)),i.abrupt("return",a.toDataURL());case 11:case"end":return i.stop()}}),i)})))}function iN(t,e,n,r){return eN(this,void 0,void 0,Tn().mark((function i(){var a,o,s,u,c;return Tn().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a=nN(t,e),o=a.getContext("2d"),s=r.rotate,u=r.opacity,s&&o.rotate(s),u&&(o.globalAlpha=u),(c=new Image).crossOrigin="anonymous",c.src=n,i.abrupt("return",new Promise((function(n){c.onload=function(){var r=t>c.width?(t-c.width)/2:0,i=e>c.height?(e-c.height)/2:0;o.drawImage(c,0,0,c.width,c.height,r,i,t-2*r,e-2*i),n(a.toDataURL())}})));case 9:case"end":return i.stop()}}),i)})))}var aN=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},oN=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).$element=yw("watermark"),r.context.canvas.getContainer().appendChild(r.$element),r.update(n),r}return N(e,t),b(e,[{key:"update",value:function(t){var n,r,i,a,o=this,s=Object.create(null,{update:{get:function(){return dn(e,"update",o,1)}}});return n=this,r=void 0,i=void 0,a=Tn().mark((function e(){var n,r,i,a,o,u,c,l=this;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.update.call(this,t),n=this.options,r=n.width,i=n.height,a=n.text,o=n.imageURL,u=aN(n,["width","height","text","imageURL"]),Object.keys(u).forEach((function(e){e.startsWith("background")&&(l.$element.style[e]=t[e])})),!o){e.next=9;break}return e.next=6,iN(r,i,o,u);case 6:e.t0=e.sent,e.next=12;break;case 9:return e.next=11,rN(r,i,a,u);case 11:e.t0=e.sent;case 12:c=e.t0,this.$element.style.backgroundImage="url(".concat(c,")");case 14:case"end":return e.stop()}}),e,this)})),new(i||(i=Promise))((function(t,e){function o(t){try{u(a.next(t))}catch(t){e(t)}}function s(t){try{u(a.throw(t))}catch(t){e(t)}}function u(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(o,s)}u((a=a.apply(n,r||[])).next())}))}},{key:"destroy",value:function(){dn(e,"destroy",this,3)([]),this.$element.remove()}}])}(gw);oN.defaultOptions={width:200,height:100,opacity:.2,rotate:Math.PI/12,text:"",textFill:"#000",textFontSize:16,textAlign:"center",textBaseline:"middle",backgroundRepeat:"repeat"};var sN=["#7E92B5","#F4664A","#FFBE3A"],uN={type:"group",color:["#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]},cN={type:"group",color:["#99ADD1","#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]};function lN(t){var e=t.bgColor,n=t.textColor,r=t.nodeColor,i=t.nodeColorDisabled,a=t.nodeStroke,o=t.nodeHaloStrokeOpacityActive,s=void 0===o?.15:o,u=t.nodeHaloStrokeOpacitySelected,c=void 0===u?.25:u,l=t.nodeOpacityDisabled,h=void 0===l?.06:l,d=t.nodeIconOpacityInactive,f=void 0===d?.85:d,v=t.nodeOpacityInactive,p=void 0===v?.25:v,g=t.nodeBadgePalette,y=void 0===g?sN:g,m=t.nodePaletteOptions,b=void 0===m?uN:m,x=t.edgeColor,w=t.edgeColorDisabled,E=t.edgePaletteOptions,k=void 0===E?cN:E,M=t.comboColor,S=t.comboColorDisabled,O=t.comboStroke,N=t.comboStrokeDisabled;return{background:e,node:{palette:b,style:{donutOpacity:1,badgeBackgroundOpacity:1,badgeFill:"#fff",badgeFontSize:8,badgePadding:[0,4],badgePalette:y,fill:r,fillOpacity:1,halo:!1,iconFill:"#fff",iconOpacity:1,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelFill:n,labelFillOpacity:.85,labelLineHeight:16,labelPadding:[0,2],labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelOffsetY:2,lineWidth:0,portFill:r,portLineWidth:1,portStroke:a,portStrokeOpacity:.65,size:32,stroke:a,strokeOpacity:1,zIndex:2},state:{selected:{halo:!0,haloLineWidth:24,haloStrokeOpacity:c,labelFontSize:12,labelFontWeight:"bold",lineWidth:4,stroke:a},active:{halo:!0,haloLineWidth:12,haloStrokeOpacity:s},highlight:{labelFontWeight:"bold",lineWidth:4,stroke:a,strokeOpacity:.85},inactive:{badgeBackgroundOpacity:p,donutOpacity:p,fillOpacity:p,iconOpacity:f,labelFill:n,labelFillOpacity:p,strokeOpacity:p},disabled:{badgeBackgroundOpacity:.25,donutOpacity:h,fill:i,fillOpacity:h,iconFill:i,iconOpacity:.25,labelFill:n,labelFillOpacity:.25,strokeOpacity:h}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"node-expand",collapse:"node-collapse",update:[{fields:["x","y","fill","stroke"]}],translate:[{fields:["x","y"]}]}},edge:{palette:k,style:{badgeBackgroundFill:x,badgeFill:"#fff",badgeFontSize:8,badgeOffsetX:10,fillOpacity:1,halo:!1,haloLineWidth:12,haloStrokeOpacity:1,increasedLineWidthForHitTesting:2,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[4,4,4,4],labelFill:n,labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelPlacement:"center",labelTextBaseline:"middle",lineWidth:1,stroke:x,strokeOpacity:1,zIndex:1},state:{selected:{halo:!0,haloStrokeOpacity:.25,labelFontSize:14,labelFontWeight:"bold",lineWidth:3},active:{halo:!0,haloStrokeOpacity:.15},highlight:{labelFontWeight:"bold",lineWidth:3},inactive:{stroke:t.edgeColorInactive,fillOpacity:.08,labelOpacity:.25,strokeOpacity:.08,badgeBackgroundOpacity:.25},disabled:{stroke:w,fillOpacity:.45,strokeOpacity:.45,labelOpacity:.25,badgeBackgroundOpacity:.45}},animation:{enter:"fade",exit:"fade",expand:"path-in",collapse:"path-out",show:"fade",hide:"fade",update:[{fields:["sourceNode","targetNode"]},{fields:["stroke"],shape:"key"}],translate:[{fields:["sourceNode","targetNode"]}]}},combo:{style:{collapsedMarkerFill:e,collapsedMarkerFontSize:12,collapsedMarkerFillOpacity:1,collapsedSize:32,collapsedFillOpacity:1,fill:M,halo:!1,haloLineWidth:12,haloStroke:O,haloStrokeOpacity:.25,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[2,4,2,4],labelFill:n,labelFontSize:12,labelFontWeight:400,labelOpacity:1,lineDash:0,lineWidth:1,fillOpacity:.04,strokeOpacity:1,padding:10,stroke:O},state:{selected:{halo:!0,labelFontSize:14,labelFontWeight:700,lineWidth:4},active:{halo:!0},highlight:{labelFontWeight:700,lineWidth:4},inactive:{fillOpacity:.65,labelOpacity:.25,strokeOpacity:.65},disabled:{fill:S,fillOpacity:.25,labelOpacity:.25,stroke:N,strokeOpacity:.25}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"combo-expand",collapse:"combo-collapse",update:[{fields:["x","y"]},{fields:["fill","stroke","lineWidth"],shape:"key"}],translate:[{fields:["x","y"]}]}}}}var hN=lN({bgColor:"#000000",comboColor:"#fdfdfd",comboColorDisabled:"#d0e4ff",comboStroke:"#99add1",comboStrokeDisabled:"#969696",edgeColor:"#637088",edgeColorDisabled:"#637088",edgeColorInactive:"#D0E4FF",edgePaletteOptions:{type:"group",color:["#637088","#0F55A6","#008383","#9C5D38","#8B53A6","#4E40A6","#8F6608","#3E801D","#A65383","#175E75","#0F8248"]},nodeColor:"#1783ff",nodeColorDisabled:"#D0E4FF",nodeHaloStrokeOpacityActive:.25,nodeHaloStrokeOpacitySelected:.45,nodeIconOpacityInactive:.45,nodeOpacityDisabled:.25,nodeOpacityInactive:.45,nodeStroke:"#d0e4ff",textColor:"#ffffff"}),dN=lN({bgColor:"#ffffff",comboColor:"#99ADD1",comboColorDisabled:"#f0f0f0",comboStroke:"#99add1",comboStrokeDisabled:"#d9d9d9",edgeColor:"#99add1",edgeColorDisabled:"#d9d9d9",edgeColorInactive:"#1B324F",nodeColor:"#1783ff",nodeColorDisabled:"#1B324F",nodeHaloStrokeOpacityActive:.15,nodeHaloStrokeOpacitySelected:.25,nodeIconOpacityInactive:.85,nodeOpacityDisabled:.06,nodeOpacityInactive:.25,nodeStroke:"#000000",textColor:"#000000"}),fN=function(t){function e(){return y(this,e),S(this,e,arguments)}return N(e,t),b(e,[{key:"beforeDraw",value:function(t,e){return t}},{key:"afterLayout",value:function(t,e){}}])}(Ch),vN=function(t){function e(){return y(this,e),S(this,e,arguments)}return N(e,t),b(e,[{key:"beforeDraw",value:function(t){var e=this.context.model,n=t.add.combos,r=function(t){var n=[];return t.forEach((function(t,r){var i=e.getAncestorsData(r,"combo").map((function(t){return yh(t)})).reverse();n.push([r,t,i.length])})),new Map(n.sort((function(t,e){var n=h(t,3)[2];return h(e,3)[2]-n})).map((function(t){var e=h(t,2);return[e[0],e[1]]})))};return t.add.combos=r(n),t.update.combos=r(t.update.combos),t}}])}(fN);function pN(t,e,n,r,i){var a=yh(r),o="".concat(n,"s"),s=i?r:t.add[o].get(a)||t.update[o].get(a)||t.remove[o].get(a)||r;Object.entries(t).forEach((function(t){var n=h(t,2),r=n[0],i=n[1];e===r?i[o].set(a,s):i[o].delete(a)}))}function gN(t,e){return Object.keys(t).every((function(n){return t[n]===e[n]}))}var yN=function(t){function e(){return y(this,e),S(this,e,arguments)}return N(e,t),b(e,[{key:"beforeDraw",value:function(t,e){var n=this;if("visibility"===e.stage)return t;if(!this.context.model.model.hasTreeStructure(nl))return t;for(var r=this.context.model,i=t.add,a=t.update,o=[].concat(w(t.update.combos.entries()),w(t.add.combos.entries()));o.length;){var s=h(o.pop(),2),u=s[0];if(Td(s[1])){var c=r.getDescendantsData(u),l=Cp(c.map(yh),(function(t){return r.getRelatedEdgesData(t)})),d=l.internal,f=l.external;c.forEach((function(e){var n=yh(e),i=o.findIndex((function(t){return h(t,1)[0]===n}));-1!==i&&o.splice(i,1);var a=r.getElementType(n);pN(t,"remove",a,e)})),d.forEach((function(e){return pN(t,"remove","edge",e)})),f.forEach((function(t){var e,r=yh(t);(null===(e=n.context.element)||void 0===e?void 0:e.getElement(r))?a.edges.set(r,t):i.edges.set(r,t)}))}else{var v=r.getChildrenData(u),p=Cp(v.map(yh),(function(t){return r.getRelatedEdgesData(t)})),g=p.edges;[].concat(w(v),w(g)).forEach((function(e){var i,a=yh(e),s=r.getElementType(a),u=null===(i=n.context.element)||void 0===i?void 0:i.getElement(a);pN(t,u?"update":"add",s,e),"combo"===s&&o.push([a,e])}))}}return t}}])}(fN),mN=function(t,e,n,r){var i="".concat(n,"s"),a=yh(r);t.add[i].has(a)||t.update[i].has(a)||t[e][i].set(yh(r),r)},bN=function(t){function e(){return y(this,e),S(this,e,arguments)}return N(e,t),b(e,[{key:"getElement",value:function(t){return this.context.element.getElement(t)}},{key:"handleExpand",value:function(t,e){var n=this;if(mN(e,"add","node",t),!Td(t)){var r=yh(t);mN(e,"add","node",t),this.context.model.getRelatedEdgesData(r,"out").forEach((function(t){pN(e,"add","edge",t)})),this.context.model.getChildrenData(r).forEach((function(t){n.handleExpand(t,e)}))}}},{key:"beforeDraw",value:function(t){var e=this,n=this.context,r=n.graph,i=n.model;if(!i.model.hasTreeStructure(rl))return t;var a=t.add,o=a.nodes,s=a.edges,u=t.update.nodes,c=new Map,l=new Map;o.forEach((function(t,e){Td(t)&&c.set(e,t)})),s.forEach((function(t){if("node"===r.getElementType(t.source)){var e=r.getNodeData(t.source);Td(e)&&c.set(t.source,e)}})),u.forEach((function(t,n){var r=e.getElement(n);if(r){var i=r.attributes.collapsed;Td(t)?i||c.set(n,t):i&&l.set(n,t)}}));var h=new Set;return c.forEach((function(e,n){i.getDescendantsData(n).forEach((function(e){var n=yh(e);h.has(n)||(pN(t,"remove","node",e),i.getRelatedEdgesData(n).forEach((function(e){pN(t,"remove","edge",e)})),h.add(n))}))})),l.forEach((function(n,r){i.getAncestorsData(r,rl).some(Td)?pN(t,"remove","node",n):e.handleExpand(n,t)})),t}}])}(fN),xN=new WeakMap;function wN(t,e,n){xN.has(t)||xN.set(t,{});var r=xN.get(t);if(!r[e])return r[e]=n,!0;var i=r[e];return!EN(i,n)&&(r[e]=n,!0)}var EN=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if("object"!=typeof t||"object"!=typeof e)return t===e;var r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(var a=0,o=r;a<o.length;a++){var s=o[a],u=t[s],c=e[s];if(n>1&&"object"==typeof u&&"object"==typeof c){if(!EN(u,c,n-1))return!1}else if(u!==c)return!1}return!0};function kN(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=il[t][e];!r&&i?i!==n&&ll.warn("The extension ".concat(e," of ").concat(t," has been registered before.")):Object.assign(il[t],v({},e,n))}var MN=function(){function t(e){Sf(this,t),this.dragndropPluginOptions=e}return Mf(t,[{key:"apply",value:function(e){var n=this,r=e.renderingService,i=e.renderingContext.root.ownerDocument,a=i.defaultView,o=function(t){var e=t.target,r=e===i,o=r&&n.dragndropPluginOptions.isDocumentDraggable?i:e.closest&&e.closest("[draggable=true]");if(o){var s=!1,u=t.timeStamp,c=[t.clientX,t.clientY],l=null,h=[t.clientX,t.clientY],d=function(){var t=Yf(Wf().mark((function t(a){var d,f,v,p,g,y;return Wf().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s){t.next=8;break}if(d=a.timeStamp-u,f=se([a.clientX,a.clientY],c),!(d<=n.dragndropPluginOptions.dragstartTimeThreshold||f<=n.dragndropPluginOptions.dragstartDistanceThreshold)){t.next=5;break}return t.abrupt("return");case 5:a.type="dragstart",o.dispatchEvent(a),s=!0;case 8:if(a.type="drag",a.dx=a.clientX-h[0],a.dy=a.clientY-h[1],o.dispatchEvent(a),h=[a.clientX,a.clientY],r){t.next=21;break}return v="pointer"===n.dragndropPluginOptions.overlap?[a.canvasX,a.canvasY]:e.getBounds().center,t.next=17,i.elementsFromPoint(v[0],v[1]);case 17:p=t.sent,g=p[p.indexOf(e)+1],y=(null==g?void 0:g.closest("[droppable=true]"))||(n.dragndropPluginOptions.isDocumentDroppable?i:null),l!==y&&(l&&(a.type="dragleave",a.target=l,l.dispatchEvent(a)),y&&(a.type="dragenter",a.target=y,y.dispatchEvent(a)),(l=y)&&(a.type="dragover",a.target=l,l.dispatchEvent(a)));case 21:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();a.addEventListener("pointermove",d);var f=function(t){if(s){t.detail={preventClick:!0};var e=t.clone();l&&(e.type="drop",e.target=l,l.dispatchEvent(e)),e.type="dragend",o.dispatchEvent(e),s=!1}a.removeEventListener("pointermove",d)};e.addEventListener("pointerup",f,{once:!0}),e.addEventListener("pointerupoutside",f,{once:!0})}};r.hooks.init.tap(t.tag,(function(){a.addEventListener("pointerdown",o)})),r.hooks.destroy.tap(t.tag,(function(){a.removeEventListener("pointerdown",o)}))}}])}();MN.tag="Dragndrop";var SN=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Sf(this,e),(t=Af(this,e)).name="dragndrop",t.options=n,t}return Pf(e,t),Mf(e,[{key:"init",value:function(){this.addRenderingPlugin(new MN(qf({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}},{key:"setOptions",value:function(t){Object.assign(this.plugins[0].dragndropPluginOptions,t)}}])}(Fn),ON=function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},NN=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},AN=["main"],TN=["background","main","label","transient"],PN=function(){return b((function t(e){y(this,t),this.config={enableMultiLayer:!0},Object.assign(this.config,e);var n=this.config,r=n.renderer,i=n.background,a=(n.cursor,n.enableMultiLayer),o=NN(n,["renderer","background","cursor","enableMultiLayer"]),s=a?TN:AN,u=CN(r,s),c=Object.fromEntries(s.map((function(t){return[t,new Vu(Object.assign(Object.assign({},o),{supportsMutipleCanvasesInOneContainer:a,renderer:u[t],background:a?"background"===t?i:void 0:i}))]})));RN(c),this.extends={config:this.config,renderer:r,renderers:u,layers:c}}),[{key:"getConfig",value:function(){return this.config}},{key:"getLayer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";return this.extends.layers[t]||this.getLayers().main}},{key:"getLayers",value:function(){return this.extends.layers}},{key:"getRenderer",value:function(t){return this.extends.renderers[t]}},{key:"getCamera",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";return this.getLayer(t).getCamera()}},{key:"getRoot",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";return this.getLayer(t).getRoot()}},{key:"getContextService",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";return this.getLayer(t).getContextService()}},{key:"setCursor",value:function(t){this.config.cursor=t,this.getLayer().setCursor(t)}},{key:"document",get:function(){return this.getLayer().document}},{key:"context",get:function(){return this.getLayer().context}},{key:"ready",get:function(){return Promise.all(Object.entries(this.getLayers()).map((function(t){return h(t,2)[1].ready})))}},{key:"resize",value:function(t,e){Object.assign(this.extends.config,{width:t,height:e}),Object.values(this.getLayers()).forEach((function(n){var r=n.getCamera(),i=r.getPosition(),a=r.getFocalPoint();n.resize(t,e),r.setPosition(i),r.setFocalPoint(a)}))}},{key:"getBounds",value:function(t){return Bl(Object.values(this.getLayers()).map((function(e){var n=t?e.getRoot().childNodes.find((function(e){return e.classList.includes(t)})):e.getRoot();return n})).filter((function(t){return(null==t?void 0:t.childNodes.length)>0})).map((function(t){return t.getBounds()})))}},{key:"getContainer",value:function(){var t=this.extends.config.container;return"string"==typeof t?document.getElementById(t):t}},{key:"getSize",value:function(){return[this.extends.config.width||0,this.extends.config.height||0]}},{key:"appendChild",value:function(t,e){var n,r=(null===(n=t.style)||void 0===n?void 0:n.$layer)||"main";return this.getLayer(r).appendChild(t,e)}},{key:"setRenderer",value:function(t){var e=this;if(t!==this.extends.renderer){var n=CN(t,this.config.enableMultiLayer?TN:AN);this.extends.renderers=n,Object.entries(n).forEach((function(t){var n=h(t,2),r=n[0],i=n[1];return e.getLayer(r).setRenderer(i)})),RN(this.getLayers())}}},{key:"getCanvasByViewport",value:function(t){return id(this.getLayer().viewport2Canvas(ad(t)))}},{key:"getViewportByCanvas",value:function(t){return id(this.getLayer().canvas2Viewport(ad(t)))}},{key:"getViewportByClient",value:function(t){return id(this.getLayer().client2Viewport(ad(t)))}},{key:"getClientByViewport",value:function(t){return id(this.getLayer().viewport2Client(ad(t)))}},{key:"getClientByCanvas",value:function(t){return this.getClientByViewport(this.getViewportByCanvas(t))}},{key:"getCanvasByClient",value:function(t){var e=this.getLayer(),n=e.client2Viewport(ad(t));return id(e.viewport2Canvas(n))}},{key:"toDataURL",value:function(){return ON(this,arguments,void 0,(function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Tn().mark((function n(){var r,i,a,o,s,u,c,l,d,f,v,p,g,y,m,b,x,w,E,k,M,S,O,N,A,T,P,C,R,L,D,_;return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=globalThis.devicePixelRatio||1,i=e.mode,a=void 0===i?"viewport":i,o=NN(e,["mode"]),s=0,u=0,c=0,l=0,"viewport"===a?(d=t.getSize(),f=h(d,2),c=f[0],l=f[1]):"overall"===a&&(v=t.getBounds(),p=_l(v),g=h(v.min,2),s=g[0],u=g[1],y=h(p,2),c=y[0],l=y[1]),m=UO('<div id="virtual-image"></div>'),b=new Vu({width:c,height:l,renderer:new Qv,devicePixelRatio:r,container:m,background:t.extends.config.background}),n.next=8,b.ready;case 8:return b.appendChild(t.getLayer("background").getRoot().cloneNode(!0)),b.appendChild(t.getRoot().cloneNode(!0)),x=t.getLayer("label").getRoot().cloneNode(!0),w=b.viewport2Canvas({x:0,y:0}),E=t.getCanvasByViewport([0,0]),x.translate([E[0]-w.x,E[1]-w.y]),x.scale(1/t.getCamera().getZoom()),b.appendChild(x),b.appendChild(t.getLayer("transient").getRoot().cloneNode(!0)),k=t.getCamera(),M=b.getCamera(),"viewport"===a?(M.setZoom(k.getZoom()),M.setPosition(k.getPosition()),M.setFocalPoint(k.getFocalPoint())):"overall"===a&&(S=M.getPosition(),O=h(S,3),N=O[0],A=O[1],T=O[2],P=M.getFocalPoint(),C=h(P,3),R=C[0],L=C[1],D=C[2],M.setPosition([N+s,A+u,T]),M.setFocalPoint([R+s,L+u,D])),_=b.getContextService(),n.abrupt("return",new Promise((function(e){b.addEventListener(Iu.RERENDER,(function(){return ON(t,void 0,void 0,Tn().mark((function t(){var n;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t){return setTimeout(t,300)}));case 2:return t.next=4,_.toDataURL(o);case 4:n=t.sent,e(n);case 6:case"end":return t.stop()}}),t)})))}))})));case 22:case"end":return n.stop()}}),n)}))()}))}},{key:"destroy",value:function(){Object.values(this.getLayers()).forEach((function(t){t.getCamera().cancelLandmarkAnimation(),t.destroy()}))}}])}();function CN(t,e){return Object.fromEntries(e.map((function(e){var n=(null==t?void 0:t(e))||new Qv;return n instanceof Qv&&n.setConfig({enableDirtyRectangleRendering:!1}),"main"===e?n.registerPlugin(new SN({isDocumentDraggable:!0,isDocumentDroppable:!0,dragstartDistanceThreshold:10,dragstartTimeThreshold:100})):n.unregisterPlugin(n.getPlugin("dom-interaction")),[e,n]})))}function RN(t){Object.entries(t).forEach((function(t){var e=h(t,2),n=e[0],r=e[1].getContextService().getDomElement();(null==r?void 0:r.style)&&(r.style.gridArea="1 / 1 / 2 / 2",r.style.outline="none",r.tabIndex=1,"main"!==n&&(r.style.pointerEvents="none")),(null==r?void 0:r.parentElement)&&(r.parentElement.style.display="grid")}))}var LN=function(t){return t?parseInt(t):0};function DN(t){if(!t)return[0,0];var e=640,n=480,r=function(t){var e=getComputedStyle(t),n=t.clientWidth||LN(e.width),r=t.clientHeight||LN(e.height);return[n-(LN(e.paddingLeft)+LN(e.paddingRight)),r-(LN(e.paddingTop)+LN(e.paddingBottom))]}(t),i=h(r,2);return e=i[0]||e,n=i[1]||n,[Math.max(oe(e)?e:1,1),Math.max(oe(n)?n:1,1)]}var _N=b((function t(e){y(this,t),this.type=e})),IN=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t])).data=n,r}return N(e,t),b(e)}(_N),jN=function(t){function e(t,n,r,i){var a;return y(this,e),(a=S(this,e,[t])).animationType=n,a.animation=r,a.data=i,a}return N(e,t),b(e)}(_N),FN=function(t){function e(t,n,r){var i;return y(this,e),(i=S(this,e,[t])).elementType=n,i.data=r,i}return N(e,t),b(e)}(_N),BN=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t])).data=n,r}return N(e,t),b(e)}(_N);function zN(t,e){t.emit(e.type,e)}function GN(t){var e;return(null===(e=null==t?void 0:t.style)||void 0===e?void 0:e.zIndex)||0}var VN="cachedStyle",WN=function(t){return"__".concat(t,"__")};function HN(t,e){return Pd(t,[VN,WN(e)])}var YN=function(){return b((function t(e){y(this,t),this.tasks=[],this.animations=new Set,this.context=e}),[{key:"getTasks",value:function(){var t=w(this.tasks);return this.tasks=[],t}},{key:"add",value:function(t,e){this.tasks.push([t,e])}},{key:"animate",value:function(t,e,n){var r,i,a,o=this;null===(r=null==e?void 0:e.before)||void 0===r||r.call(e);var s=this.getTasks().map((function(e){var r,i,a,s=h(e,2),u=s[0],c=s[1],l=u.element,d=u.elementType,f=u.stage,v=function(t,e,n,r){var i,a,o=t.animation;if(!1===o||!1===r)return[];var s=null===(i=null==t?void 0:t[e])||void 0===i?void 0:i.animation;if(!1===s)return[];var u=null==s?void 0:s[n];if(!1===u)return[];var c=null===(a=hl(t)[e])||void 0===a?void 0:a.animation,l=function(){return function(t){return"string"==typeof t?al(el.ANIMATION,t)||(ll.warn("The animation of ".concat(t," is not registered.")),[]):t}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((function(t){return Object.assign(Object.assign(Object.assign(Object.assign({},tl),ln(o)&&o),t),ln(r)&&r)}))};if(u)return l(u);if(!c)return[];var h=c[n];return!1===h?[]:l(h)}(o.context.options,d,f,t);null===(r=null==c?void 0:c.before)||void 0===r||r.call(c);var p=v.length?yl(l,o.inferStyle(u,n),v):null;return p?(null===(i=null==c?void 0:c.beforeAnimate)||void 0===i||i.call(c,p),p.finished.then((function(){var t,e;null===(t=null==c?void 0:c.afterAnimate)||void 0===t||t.call(c,p),null===(e=null==c?void 0:c.after)||void 0===e||e.call(c),o.animations.delete(p)}))):null===(a=null==c?void 0:c.after)||void 0===a||a.call(c),p})).filter(Boolean);s.forEach((function(t){return o.animations.add(t)}));var u=dl(s);return u?(null===(i=null==e?void 0:e.beforeAnimate)||void 0===i||i.call(e,u),u.finished.then((function(){var t,n;null===(t=null==e?void 0:e.afterAnimate)||void 0===t||t.call(e,u),null===(n=null==e?void 0:e.after)||void 0===n||n.call(e),o.release()}))):null===(a=null==e?void 0:e.after)||void 0===a||a.call(e),u}},{key:"inferStyle",value:function(t,e){var n,r,i=t.element,a=t.elementType,o=t.stage,s=t.originalStyle,u=t.updatedStyle,c=void 0===u?{}:u;t.modifiedStyle||(t.modifiedStyle=Object.assign(Object.assign({},s),c));var l=t.modifiedStyle,d={},f={};if("enter"===o)Object.assign(d,{opacity:0});else if("exit"===o)Object.assign(f,{opacity:0});else if("show"===o)Object.assign(d,{opacity:0}),Object.assign(f,{opacity:null!==(n=HN(i,"opacity"))&&void 0!==n?n:vl("opacity")});else if("hide"===o)Object.assign(d,{opacity:null!==(r=HN(i,"opacity"))&&void 0!==r?r:vl("opacity")}),Object.assign(f,{opacity:0});else if("collapse"===o){var v=(e||{}).collapse,p=v.target,g=v.descendants,y=v.position;if("node"===a){if(g.includes(i.id)){var m=h(y,3),b=m[0],x=m[1],w=m[2];Object.assign(f,{x:b,y:x,z:w})}}else if("combo"===a){if(i.id===p||g.includes(i.id)){var E=h(y,2),k=E[0],M=E[1];Object.assign(f,{x:k,y:M,childrenNode:s.childrenNode})}}else"edge"===a&&Object.assign(f,{sourceNode:l.sourceNode,targetNode:l.targetNode})}else if("expand"===o){var S=(e||{}).expand,O=S.target,N=S.descendants,A=S.position;if("node"===a){if(i.id===O||N.includes(i.id)){var T=h(A,3),P=T[0],C=T[1],R=T[2];Object.assign(d,{x:P,y:C,z:R})}}else if("combo"===a){if(i.id===O||N.includes(i.id)){var L=h(A,3),D=L[0],_=L[1],I=L[2];Object.assign(d,{x:D,y:_,z:I,childrenNode:l.childrenNode})}}else"edge"===a&&Object.assign(d,{sourceNode:l.sourceNode,targetNode:l.targetNode})}return[Object.keys(d).length>0?Object.assign({},s,d):s,Object.keys(f).length>0?Object.assign({},l,f):l]}},{key:"stop",value:function(){this.animations.forEach((function(t){return t.cancel()}))}},{key:"clear",value:function(){this.tasks=[]}},{key:"release",value:function(){var t,e,n=this.context.canvas,r=null===(e=null===(t=n.document)||void 0===t?void 0:t.timeline)||void 0===e?void 0:e.animationsWithPromises;r&&(n.document.timeline.animationsWithPromises=r.filter((function(t){return"finished"!==t.playState})))}},{key:"destroy",value:function(){this.stop(),this.animations.clear(),this.tasks=[]}}])}(),UN=function(){return b((function t(e){y(this,t),this.batchCount=0,this.context=e}),[{key:"emit",value:function(t){this.context.graph.emit(t.type,t)}},{key:"startBatch",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.batchCount++,1===this.batchCount&&this.emit(new IN($c.BATCH_START,{initiate:t}))}},{key:"endBatch",value:function(){this.batchCount--,0===this.batchCount&&this.emit(new IN($c.BATCH_END))}},{key:"isBatching",get:function(){return this.batchCount>0}},{key:"destroy",value:function(){this.context=null}}])}(),qN=function(t){function e(t){var n;return y(this,e),(n=S(this,e,[t])).currentTarget=null,n.currentTargetType=null,n.category="behavior",n.forwardCanvasEvents=function(t){var e=t.target,r=function(t){if(!t)return null;if(t instanceof Pu)return{type:"canvas",element:t};for(var e=t;e;){if(ag(e))return{type:"node",element:e};if(og(e))return{type:"edge",element:e};if(sg(e))return{type:"combo",element:e};e=e.parentElement}return null}(e);if(r){var i=n.context,a=i.graph,o=i.canvas,s=r.type,u=r.element;if(!("destroyed"in u)||!bg(u)&&!u.destroyed){var c=t.type,l=t.detail,h=t.button,d=Object.assign(Object.assign({},t),{target:u,targetType:s,originalTarget:e});c===qc.POINTER_MOVE&&(n.currentTarget!==u&&(n.currentTarget&&a.emit("".concat(n.currentTargetType,":").concat(qc.POINTER_LEAVE),Object.assign(Object.assign({},d),{type:qc.POINTER_LEAVE,target:n.currentTarget,targetType:n.currentTargetType})),u&&(Object.assign(d,{type:qc.POINTER_ENTER}),a.emit("".concat(s,":").concat(qc.POINTER_ENTER),d))),n.currentTarget=u,n.currentTargetType=s),c===qc.CLICK&&2===h||(a.emit("".concat(s,":").concat(c),d),a.emit(c,d)),c===qc.CLICK&&2===l&&(Object.assign(d,{type:qc.DBLCLICK}),a.emit("".concat(s,":").concat(qc.DBLCLICK),d),a.emit(qc.DBLCLICK,d)),c===qc.POINTER_DOWN&&2===h&&(Object.assign(d,{type:qc.CONTEXT_MENU,preventDefault:function(){var t;null===(t=o.getContainer())||void 0===t||t.addEventListener(qc.CONTEXT_MENU,(function(t){return t.preventDefault()}),{once:!0})}}),a.emit("".concat(s,":").concat(qc.CONTEXT_MENU),d),a.emit(qc.CONTEXT_MENU,d))}}},n.forwardContainerEvents=function(t){n.context.graph.emit(t.type,t)},n.forwardEvents(),n.setBehaviors(n.context.options.behaviors||[]),n}return N(e,t),b(e,[{key:"setBehaviors",value:function(t){this.setExtensions(t)}},{key:"forwardEvents",value:function(){var t=this,e=this.context.canvas.getContainer();e&&[Xc.KEY_DOWN,Xc.KEY_UP].forEach((function(n){e.addEventListener(n,t.forwardContainerEvents)}));var n=this.context.canvas.document;n&&[qc.CLICK,qc.DBLCLICK,qc.POINTER_OVER,qc.POINTER_LEAVE,qc.POINTER_ENTER,qc.POINTER_MOVE,qc.POINTER_OUT,qc.POINTER_DOWN,qc.POINTER_UP,qc.CONTEXT_MENU,qc.DRAG_START,qc.DRAG,qc.DRAG_END,qc.DRAG_ENTER,qc.DRAG_OVER,qc.DRAG_LEAVE,qc.DROP,qc.WHEEL].forEach((function(e){n.addEventListener(e,t.forwardCanvasEvents)}))}},{key:"destroy",value:function(){var t=this,n=this.context.canvas.getContainer();n&&[Xc.KEY_DOWN,Xc.KEY_UP].forEach((function(e){n.removeEventListener(e,t.forwardContainerEvents)})),this.context.canvas.document.removeAllEventListeners(),dn(e,"destroy",this,3)([])}}])}(Ph),XN=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function KN(t,e){var n=t.data,r=t.style,i=XN(t,["data","style"]),a=e.data,o=e.style,s=XN(e,["data","style"]),u=Object.assign(Object.assign({},i),s);return(n||a)&&Object.assign(u,{data:Object.assign(Object.assign({},n),a)}),(r||o)&&Object.assign(u,{style:Object.assign(Object.assign({},r),o)}),u}function $N(t){var e=t.data,n=t.style,r=XN(t,["data","style"]);return e&&(r.data=Object.assign({},e)),n&&(r.style=Object.assign({},n)),r}function ZN(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.states,r=void 0===n?[]:n,i=t.data,a=void 0===i?{}:i,o=t.style,s=void 0===o?{}:o,u=t.children,c=void 0===u?[]:u,l=XN(t,["states","data","style","children"]),h=e.states,d=void 0===h?[]:h,f=e.data,v=void 0===f?{}:f,p=e.style,g=void 0===p?{}:p,y=e.children,m=void 0===y?[]:y,b=function(t,e){return t.length===e.length&&t.every((function(t,n){return t===e[n]}))},x=function(t,e){var n=Object.keys(t),r=Object.keys(e);return n.length===r.length&&n.every((function(n){return t[n]===e[n]}))};return!!(x(l,XN(e,["states","data","style","children"]))&&b(c,m)&&b(r,d)&&x(a,v)&&x(s,g))}function QN(t){var e=t.id,n=void 0===e?yh(t):e,r=t.style,i=t.data,a=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(t,["id","style","data"]),o=Object.assign(Object.assign({},t),{style:Object.assign({},r),data:Object.assign({},i)});return function(t){return"source"in t&&"target"in t}(t)?Object.assign({id:n,data:o},a):{id:n,data:o}}function JN(t){return t.data}function tA(t){if(!t.hasTreeStructure(rl)){t.attachTreeStructure(rl);var e,n=Rn(t.getAllEdges());try{for(n.s();!(e=n.n()).done;){var r=e.value,i=r.source,a=r.target;t.setParent(a,i,rl)}}catch(t){n.e(t)}finally{n.f()}}}var eA=function(){return b((function t(){y(this,t),this.latestRemovedComboIds=new Set,this.comboIds=new Set,this.changes=[],this.batchCount=0,this.isTraceless=!1,this.enableUpdateNodeLikeHierarchy=!0,this.model=new _g}),[{key:"pushChange",value:function(t){if(!this.isTraceless){var e=t.type;if(e===Wc.NodeUpdated||e===Wc.EdgeUpdated||e===Wc.ComboUpdated){var n=t.value,r=t.original;this.changes.push({value:$N(n),original:$N(r),type:e})}else this.changes.push({value:$N(t.value),type:e})}}},{key:"getChanges",value:function(){return this.changes}},{key:"clearChanges",value:function(){this.changes=[]}},{key:"batch",value:function(t){this.batchCount++,this.model.batch(t),this.batchCount--}},{key:"isBatching",value:function(){return this.batchCount>0}},{key:"silence",value:function(t){this.isTraceless=!0,t(),this.isTraceless=!1}},{key:"isCombo",value:function(t){return this.comboIds.has(t)||this.latestRemovedComboIds.has(t)}},{key:"getData",value:function(){return{nodes:this.getNodeData(),edges:this.getEdgeData(),combos:this.getComboData()}}},{key:"getNodeData",value:function(t){var e=this;return this.model.getAllNodes().reduce((function(n,r){var i=JN(r);return e.isCombo(yh(i))||(void 0===t||t.includes(yh(i)))&&n.push(i),n}),[])}},{key:"getEdgeDatum",value:function(t){return JN(this.model.getEdge(t))}},{key:"getEdgeData",value:function(t){return this.model.getAllEdges().reduce((function(e,n){var r=JN(n);return(void 0===t||t.includes(yh(r)))&&e.push(r),e}),[])}},{key:"getComboData",value:function(t){var e=this;return this.model.getAllNodes().reduce((function(n,r){var i=JN(r);return e.isCombo(yh(i))?((void 0===t||t.includes(yh(i)))&&n.push(i),n):n}),[])}},{key:"getRootsData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rl;return this.model.getRoots(t).map(JN)}},{key:"getAncestorsData",value:function(t,e){var n=this.model;return n.hasNode(t)&&n.hasTreeStructure(e)?n.getAncestors(t,e).map(JN):[]}},{key:"getDescendantsData",value:function(t){var e=this,n=this.getElementDataById(t),r=[];return kd(n,(function(t){t!==n&&r.push(t)}),(function(t){return e.getChildrenData(yh(t))}),"TB"),r}},{key:"getParentData",value:function(t,e){var n=this.model;if(e){if(n.hasNode(t)&&n.hasTreeStructure(e)){var r=n.getParent(t,e);return r?JN(r):void 0}}else ll.warn("The hierarchy structure key is not specified")}},{key:"getChildrenData",value:function(t){var e="node"===this.getElementType(t)?rl:nl,n=this.model;return n.hasNode(t)&&n.hasTreeStructure(e)?n.getChildren(t,e).map(JN):[]}},{key:"getElementsDataByType",value:function(t){return"node"===t?this.getNodeData():"edge"===t?this.getEdgeData():"combo"===t?this.getComboData():[]}},{key:"getElementDataById",value:function(t){return"edge"===this.getElementType(t)?this.getEdgeDatum(t):this.getNodeLikeDatum(t)}},{key:"getNodeLikeDatum",value:function(t){return JN(this.model.getNode(t))}},{key:"getNodeLikeData",value:function(t){return this.model.getAllNodes().reduce((function(e,n){var r=JN(n);return t?t.includes(yh(r))&&e.push(r):e.push(r),e}),[])}},{key:"getElementDataByState",value:function(t,e){return this.getElementsDataByType(t).filter((function(t){var n;return null===(n=t.states)||void 0===n?void 0:n.includes(e)}))}},{key:"getElementState",value:function(t){var e;return(null===(e=this.getElementDataById(t))||void 0===e?void 0:e.states)||[]}},{key:"hasNode",value:function(t){return this.model.hasNode(t)&&!this.isCombo(t)}},{key:"hasEdge",value:function(t){return this.model.hasEdge(t)}},{key:"hasCombo",value:function(t){return this.model.hasNode(t)&&this.isCombo(t)}},{key:"getRelatedEdgesData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"both";return this.model.getRelatedEdges(t,e).map(JN)}},{key:"getNeighborNodesData",value:function(t){return this.model.getNeighbors(t).map(JN)}},{key:"setData",value:function(t){var e=this,n=t.nodes,r=void 0===n?[]:n,i=t.edges,a=void 0===i?[]:i,o=t.combos,s=void 0===o?[]:o,u=this.getData(),c=u.nodes,l=u.edges,h=u.combos,d=Ah(c,r,(function(t){return yh(t)}),ZN),f=Ah(l,a,(function(t){return yh(t)}),ZN),v=Ah(h,s,(function(t){return yh(t)}),ZN);this.batch((function(){var t={nodes:d.enter,edges:f.enter,combos:v.enter};e.addData(t),e.computeZIndex(t,"add",!0);var n={nodes:d.update,edges:f.update,combos:v.update};e.updateData(n),e.computeZIndex(n,"update",!0);var r={nodes:d.exit.map(yh),edges:f.exit.map(yh),combos:v.exit.map(yh)};e.removeData(r)}))}},{key:"addData",value:function(t){var e=this,n=t.nodes,r=t.edges,i=t.combos;this.batch((function(){e.addComboData(i),e.addNodeData(n),e.addEdgeData(r)})),this.computeZIndex(t,"add")}},{key:"addNodeData",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length&&(this.model.addNodes(e.map((function(e){return t.pushChange({value:e,type:Wc.NodeAdded}),QN(e)}))),this.updateNodeLikeHierarchy(e),this.computeZIndex({nodes:e},"add"))}},{key:"addEdgeData",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length&&(this.model.addEdges(e.map((function(e){return t.pushChange({value:e,type:Wc.EdgeAdded}),QN(e)}))),this.computeZIndex({edges:e},"add"))}},{key:"addComboData",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e.length){var n=this.model;n.hasTreeStructure(nl)||n.attachTreeStructure(nl),n.addNodes(e.map((function(e){return t.comboIds.add(yh(e)),t.pushChange({value:e,type:Wc.ComboAdded}),QN(e)}))),this.updateNodeLikeHierarchy(e),this.computeZIndex({combos:e},"add")}}},{key:"addChildrenData",value:function(t,e){var n=this.getNodeLikeDatum(t),r=e.map(yh);this.addNodeData(e),this.updateNodeData([{id:t,children:[].concat(w(n.children||[]),w(r))}]),this.addEdgeData(r.map((function(e){return{source:t,target:e}})))}},{key:"computeZIndex",value:function(t,e){var n=this;!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])&&this.isBatching()||this.batch((function(){var r=t.nodes,i=void 0===r?[]:r,a=t.edges,o=void 0===a?[]:a,s=t.combos;(void 0===s?[]:s).forEach((function(t){var r,i,a,o=yh(t);if(!("add"===e&&oe(null===(r=t.style)||void 0===r?void 0:r.zIndex)||"update"===e&&!("combo"in t))){var s=n.getParentData(o,nl),u=s?(null!==(a=null===(i=s.style)||void 0===i?void 0:i.zIndex)&&void 0!==a?a:0)+1:0;n.preventUpdateNodeLikeHierarchy((function(){n.updateComboData([{id:o,style:{zIndex:u}}])}))}})),i.forEach((function(t){var r,i,a,o=yh(t);if(("add"!==e||!oe(null===(r=t.style)||void 0===r?void 0:r.zIndex))&&("update"!==e||"combo"in t||"children"in t)){var s=0,u=n.getParentData(o,nl);if(u)s=((null===(i=u.style)||void 0===i?void 0:i.zIndex)||0)+1;else{var c=n.getParentData(o,rl);c&&(s=(null===(a=null==c?void 0:c.style)||void 0===a?void 0:a.zIndex)||0)}n.preventUpdateNodeLikeHierarchy((function(){n.updateNodeData([{id:o,style:{zIndex:s}}])}))}})),o.forEach((function(t){var e,r,i,a,o;if(!oe(null===(e=t.style)||void 0===e?void 0:e.zIndex)){var s=t.id,u=t.source,c=t.target;if(s){var l=n.getEdgeDatum(s);u=l.source,c=l.target}else s=yh(t);if(u&&c){var h=(null===(i=null===(r=n.getNodeLikeDatum(u))||void 0===r?void 0:r.style)||void 0===i?void 0:i.zIndex)||0,d=(null===(o=null===(a=n.getNodeLikeDatum(c))||void 0===a?void 0:a.style)||void 0===o?void 0:o.zIndex)||0;n.updateEdgeData([{id:yh(t),style:{zIndex:Math.max(h,d)-1}}])}}}))}))}},{key:"getFrontZIndex",value:function(t){var e,n=this.getElementType(t),r=this.getElementDataById(t),i=this.getData();if(Object.assign(i,v({},"".concat(n,"s"),i["".concat(n,"s")].filter((function(e){return yh(e)!==t})))),"combo"===n&&!Td(r)){var a=new Set(this.getAncestorsData(t,nl).map(yh));i.nodes=i.nodes.filter((function(t){return!a.has(yh(t))})),i.combos=i.combos.filter((function(t){return!a.has(yh(t))})),i.edges=i.edges.filter((function(t){var e=t.source,n=t.target;return!a.has(e)&&!a.has(n)}))}return Math.max.apply(Math,[(null===(e=r.style)||void 0===e?void 0:e.zIndex)||0,0].concat(w(Object.values(i).flat().map((function(t){var e;return((null===(e=null==t?void 0:t.style)||void 0===e?void 0:e.zIndex)||0)+1})))))}},{key:"updateNodeLikeHierarchy",value:function(t){var e=this;if(this.enableUpdateNodeLikeHierarchy){var n=this.model;t.forEach((function(t){var r=yh(t),i=mh(t);void 0!==i&&(n.hasTreeStructure(nl)||n.attachTreeStructure(nl),null===i&&e.refreshComboData(r),e.setParent(r,mh(t),nl));var a=t.children||[];if(a.length){n.hasTreeStructure(rl)||n.attachTreeStructure(rl);var o=a.filter((function(t){return n.hasNode(t)}));o.forEach((function(t){return e.setParent(t,r,rl)})),o.length!==a.length&&e.updateNodeData([{id:r,children:o}])}}))}}},{key:"preventUpdateNodeLikeHierarchy",value:function(t){this.enableUpdateNodeLikeHierarchy=!1,t(),this.enableUpdateNodeLikeHierarchy=!0}},{key:"updateData",value:function(t){var e=this,n=t.nodes,r=t.edges,i=t.combos;this.batch((function(){e.updateNodeData(n),e.updateComboData(i),e.updateEdgeData(r)})),this.computeZIndex(t,"update")}},{key:"updateNodeData",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e.length){var n=this.model;this.batch((function(){var r=[];e.forEach((function(e){var i=yh(e),a=JN(n.getNode(i));if(!ZN(a,e)){var o=KN(a,e);t.pushChange({value:o,original:a,type:Wc.NodeUpdated}),n.mergeNodeData(i,o),r.push(o)}})),t.updateNodeLikeHierarchy(r)})),this.computeZIndex({nodes:e},"update")}}},{key:"refreshData",value:function(){var t=this,e=this.getData(),n=e.nodes,r=e.edges,i=e.combos;n.forEach((function(e){t.pushChange({value:e,original:e,type:Wc.NodeUpdated})})),r.forEach((function(e){t.pushChange({value:e,original:e,type:Wc.EdgeUpdated})})),i.forEach((function(e){t.pushChange({value:e,original:e,type:Wc.ComboUpdated})}))}},{key:"syncNodeLikeDatum",value:function(t){var e=this.model,n=yh(t);if(e.hasNode(n)){var r=KN(JN(e.getNode(n)),t);e.mergeNodeData(n,r)}}},{key:"syncEdgeDatum",value:function(t){var e=this.model,n=yh(t);if(e.hasEdge(n)){var r=KN(JN(e.getEdge(n)),t);e.mergeEdgeData(n,r)}}},{key:"updateEdgeData",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e.length){var n=this.model;this.batch((function(){e.forEach((function(e){var r=yh(e),i=JN(n.getEdge(r));if(!ZN(i,e)){e.source&&i.source!==e.source&&n.updateEdgeSource(r,e.source),e.target&&i.target!==e.target&&n.updateEdgeTarget(r,e.target);var a=KN(i,e);t.pushChange({value:a,original:i,type:Wc.EdgeUpdated}),n.mergeEdgeData(r,a)}}))})),this.computeZIndex({edges:e},"update")}}},{key:"updateComboData",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e.length){var n=this.model;n.batch((function(){var r=[];e.forEach((function(e){var i=yh(e),a=JN(n.getNode(i));if(!ZN(a,e)){var o=KN(a,e);t.pushChange({value:o,original:a,type:Wc.ComboUpdated}),n.mergeNodeData(i,o),r.push(o)}})),t.updateNodeLikeHierarchy(r)})),this.computeZIndex({combos:e},"update")}}},{key:"setParent",value:function(t,e,n){var r=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t!==e){var a=mh(this.getNodeLikeDatum(t));if(a!==e&&n===nl){var o={id:t,combo:e};this.isCombo(t),this.syncNodeLikeDatum(o)}this.model.setParent(t,e,n),i&&n===nl&&function(t,e){void 0===e&&(e=new Map);var n=[];if(Array.isArray(t))for(var r=0,i=t.length;r<i;r++){var a=t[r];e.has(a)||(n.push(a),e.set(a,!0))}return n}([a,e]).forEach((function(t){void 0!==t&&r.refreshComboData(t)}))}}},{key:"refreshComboData",value:function(t){var e=this,n=this.getComboData([t])[0],r=this.getAncestorsData(t,nl);n&&this.pushChange({value:n,original:n,type:Wc.ComboUpdated}),r.forEach((function(t){e.pushChange({value:t,original:t,type:Wc.ComboUpdated})}))}},{key:"getElementPosition",value:function(t){return ed(this.getElementDataById(t))}},{key:"translateNodeLikeBy",value:function(t,e){this.isCombo(t)?this.translateComboBy(t,e):this.translateNodeBy(t,e)}},{key:"translateNodeLikeTo",value:function(t,e){this.isCombo(t)?this.translateComboTo(t,e):this.translateNodeTo(t,e)}},{key:"translateNodeBy",value:function(t,e){var n=Bh(this.getElementPosition(t),[].concat(w(e),[0]).slice(0,3));this.translateNodeTo(t,n)}},{key:"translateNodeTo",value:function(t,e){var n=this,r=h(e,3),i=r[0],a=void 0===i?0:i,o=r[1],s=void 0===o?0:o,u=r[2],c=void 0===u?0:u;this.preventUpdateNodeLikeHierarchy((function(){n.updateNodeData([{id:t,style:{x:a,y:s,z:c}}])}))}},{key:"translateComboBy",value:function(t,e){var n=this,r=h(e,3),i=r[0],a=void 0===i?0:i,o=r[1],s=void 0===o?0:o,u=r[2],c=void 0===u?0:u;if(![a,s,c].some(isNaN)&&![a,s,c].every((function(t){return 0===t}))){var l=this.getComboData([t])[0];if(l){var d=new Set;kd(l,(function(t){var e=yh(t);if(!d.has(e)){d.add(e);var r=h(ed(t),3),i=r[0],o=r[1],u=r[2],l=KN(t,{style:{x:i+a,y:o+s,z:u+c}});n.pushChange({value:l,original:t,type:n.isCombo(e)?Wc.ComboUpdated:Wc.NodeUpdated}),n.model.mergeNodeData(e,l)}}),(function(t){return n.getChildrenData(yh(t))}),"BT")}}}},{key:"translateComboTo",value:function(t,e){var n,r=this;if(!e.some(isNaN)){var i=h(e,3),a=i[0],o=void 0===a?0:a,s=i[1],u=void 0===s?0:s,c=i[2],l=void 0===c?0:c,d=null===(n=this.getComboData([t]))||void 0===n?void 0:n[0];if(d){var f=h(ed(d),3),v=f[0],p=f[1],g=f[2],y=o-v,m=u-p,b=l-g;kd(d,(function(t){var e=yh(t),n=h(ed(t),3),i=n[0],a=n[1],o=n[2],s=KN(t,{style:{x:i+y,y:a+m,z:o+b}});r.pushChange({value:s,original:t,type:r.isCombo(e)?Wc.ComboUpdated:Wc.NodeUpdated}),r.model.mergeNodeData(e,s)}),(function(t){return r.getChildrenData(yh(t))}),"BT")}}}},{key:"removeData",value:function(t){var e=this,n=t.nodes,r=t.edges,i=t.combos;this.batch((function(){e.removeEdgeData(r),e.removeNodeData(n),e.removeComboData(i),e.latestRemovedComboIds=new Set(i)}))}},{key:"removeNodeData",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length&&this.batch((function(){e.forEach((function(e){t.removeEdgeData(t.getRelatedEdgesData(e).map(yh)),t.pushChange({value:t.getNodeData([e])[0],type:Wc.NodeRemoved}),t.removeNodeLikeHierarchy(e)})),t.model.removeNodes(e)}))}},{key:"removeEdgeData",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length&&(e.forEach((function(e){return t.pushChange({value:t.getEdgeData([e])[0],type:Wc.EdgeRemoved})})),this.model.removeEdges(e))}},{key:"removeComboData",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length&&this.batch((function(){e.forEach((function(e){t.pushChange({value:t.getComboData([e])[0],type:Wc.ComboRemoved}),t.removeNodeLikeHierarchy(e),t.comboIds.delete(e)})),t.model.removeNodes(e)}))}},{key:"removeNodeLikeHierarchy",value:function(t){var e=this;if(this.model.hasTreeStructure(nl)){var n=mh(this.getNodeLikeDatum(t));this.setParent(t,void 0,nl,!1),this.model.getChildren(t,nl).forEach((function(t){var r=JN(t),i=yh(r);e.setParent(yh(r),n,nl,!1);var a=KN(r,{id:yh(r),combo:n});e.pushChange({value:a,original:r,type:e.isCombo(i)?Wc.ComboUpdated:Wc.NodeUpdated}),e.model.mergeNodeData(yh(r),a)})),ue(n)||this.refreshComboData(n)}}},{key:"getElementType",value:function(t){if(this.model.hasNode(t))return this.isCombo(t)?"combo":"node";if(this.model.hasEdge(t))return"edge";throw new Error(cl("Unknown element type of id: ".concat(t)))}},{key:"destroy",value:function(){var t=this.model,e=t.getAllNodes(),n=t.getAllEdges();t.removeEdges(n.map((function(t){return t.id}))),t.removeNodes(e.map((function(t){return t.id}))),this.context={}}}])}(),nA=function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},rA=function(){return b((function t(e){y(this,t),this.elementMap={},this.shapeTypeMap={},this.paletteStyle={},this.defaultStyle={},this.stateStyle={},this.visibilityCache=new WeakMap,this.context=e}),[{key:"init",value:function(){this.initContainer()}},{key:"initContainer",value:function(){if(!this.container||this.container.destroyed){var t=this.context.canvas;this.container=t.appendChild(new vu({className:"elements"}))}}},{key:"emit",value:function(t,e){e.silence||zN(this.context.graph,t)}},{key:"forEachElementData",value:function(t){var e=this;Ed.forEach((function(n){var r=e.context.model.getElementsDataByType(n);t(n,r)}))}},{key:"getElementType",value:function(t,e){var n,r=this.context,i=r.options,a=r.graph,o=(null===(n=i[t])||void 0===n?void 0:n.type)||e.type;return o?"string"==typeof o?o:o.call(a,e):"edge"===t?"line":"circle"}},{key:"getTheme",value:function(t){return hl(this.context.options)[t]||{}}},{key:"getThemeStyle",value:function(t){return this.getTheme(t).style||{}}},{key:"getThemeStateStyle",value:function(t,e){var n=this.getTheme(t).state,r=void 0===n?{}:n;return Object.assign.apply(Object,[{}].concat(w(e.map((function(t){return r[t]||{}})))))}},{key:"computePaletteStyle",value:function(){var t=this,e=this.context.options;this.paletteStyle={},this.forEachElementData((function(n,r){var i,a,o=Object.assign({},zd(null===(i=t.getTheme(n))||void 0===i?void 0:i.palette),zd(null===(a=e[n])||void 0===a?void 0:a.palette));(null==o?void 0:o.field)&&Object.assign(t.paletteStyle,function(t,e){if(!e)return{};var n=e.type,r=e.color,i=e.field,a=e.invert,o=function(t){var e="string"==typeof r?al("palette",r):r;if("function"==typeof e){var n={};return t.forEach((function(t){var r=h(t,2),i=r[0],o=r[1];n[i]=e(a?1-o:o)})),n}if(Array.isArray(e)){var i=a?w(e).reverse():e,o={};return t.forEach((function(t){var n=h(t,2),r=n[0],a=n[1];o[r]=i[a%e.length]})),o}return{}},s=function(t,e){var n;return"string"==typeof t?null===(n=e.data)||void 0===n?void 0:n[t]:null==t?void 0:t(e)};if("group"===n){var u=Sl(t,(function(t){if(!i)return"default";var e=s(i,t);return e?String(e):"default"})),c=o(Object.keys(u).map((function(t,e){return[t,e]}))),l={};return Object.entries(u).forEach((function(t){var e=h(t,2),n=e[0];e[1].forEach((function(t){l[yh(t)]=c[n]}))})),l}if("value"===n){var d=t.reduce((function(t,e){var n=h(t,2),r=n[0],a=n[1],o=s(i,e);if("number"!=typeof o)throw new Error(cl("Palette field ".concat(i," is not a number")));return[Math.min(r,o),Math.max(a,o)]}),[1/0,-1/0]),f=h(d,2),v=f[0],p=f[1]-v;return o(t.map((function(t){return[t.id,(s(i,t)-v)/p]})))}}(r,o))}))}},{key:"getPaletteStyle",value:function(t,e){var n=this.paletteStyle[e];return n?"edge"===t?{stroke:n}:{fill:n}:{}}},{key:"computeElementDefaultStyle",value:function(t,e){var n,r=(null===(n=this.context.options[t])||void 0===n?void 0:n.style)||{};"transform"in r&&Array.isArray(r.transform)&&(r.transform=w(r.transform)),this.defaultStyle[yh(e.datum)]=Fd(r,e)}},{key:"computeElementsDefaultStyle",value:function(t){var e=this,n=this.context.graph;this.forEachElementData((function(r,i){for(var a=i.length,o=0;o<a;o++){var s=i[o];(void 0===t||t.includes(yh(s)))&&e.computeElementDefaultStyle(r,{datum:s,graph:n})}}))}},{key:"getDefaultStyle",value:function(t){return this.defaultStyle[t]||{}}},{key:"getElementState",value:function(t){try{return this.context.model.getElementState(t)}catch(t){return[]}}},{key:"getElementStateStyle",value:function(t,e,n){var r,i;return Fd((null===(i=null===(r=this.context.options[t])||void 0===r?void 0:r.state)||void 0===i?void 0:i[e])||{},n)}},{key:"computeElementStatesStyle",value:function(t,e,n){var r=this;this.stateStyle[yh(n.datum)]=Object.assign.apply(Object,[{}].concat(w(e.map((function(e){return r.getElementStateStyle(t,e,n)})))))}},{key:"computeElementsStatesStyle",value:function(t){var e=this,n=this.context.graph;this.forEachElementData((function(r,i){for(var a=i.length,o=0;o<a;o++){var s=i[o];if(void 0===t||t.includes(yh(s))){var u=e.getElementState(yh(s));e.computeElementStatesStyle(r,u,{datum:s,graph:n})}}}))}},{key:"getStateStyle",value:function(t){return this.stateStyle[t]||{}}},{key:"computeStyle",value:function(t,e){t&&["translate","zIndex"].includes(t)||(this.computePaletteStyle(),this.computeElementsDefaultStyle(e),this.computeElementsStatesStyle(e))}},{key:"getElement",value:function(t){return this.elementMap[t]}},{key:"getNodes",value:function(){var t=this;return this.context.model.getNodeData().map((function(e){var n=e.id;return t.elementMap[n]}))}},{key:"getEdges",value:function(){var t=this;return this.context.model.getEdgeData().map((function(e){return t.elementMap[yh(e)]}))}},{key:"getCombos",value:function(){var t=this;return this.context.model.getComboData().map((function(e){var n=e.id;return t.elementMap[n]}))}},{key:"getElementComputedStyle",value:function(t,e){var n=this,r=yh(e),i=this.getThemeStyle(t),a=this.getPaletteStyle(t,r),o=e.style||{},s=this.getDefaultStyle(r),u=this.getThemeStateStyle(t,this.getElementState(r)),c=this.getStateStyle(r),l=Object.assign({},i,a,o,s,u,c);if("combo"===t){var h=this.context.model.getChildrenData(r),d=l.collapsed?[]:h.map(yh).filter((function(t){return n.getElement(t)}));Object.assign(l,{childrenNode:d,childrenData:h})}return l}},{key:"getDrawData",value:function(t){this.init();var e=this.computeChangesAndDrawData(t);if(!e)return null;var n=t.type,r=void 0===n?"draw":n,i=t.stage,a=void 0===i?r:i;return this.markDestroyElement(e.drawData),this.computeStyle(a),{type:r,stage:a,data:e}}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{animation:!0},e=this.getDrawData(t);if(e){var n=e.data.drawData,r=n.add,i=n.update,a=n.remove;return this.destroyElements(a,t),this.createElements(r,t),this.updateElements(i,t),this.setAnimationTask(t,e)}}},{key:"preLayoutDraw",value:function(){return nA(this,arguments,void 0,(function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{animation:!0};return Tn().mark((function n(){var r,i,a,o,s,u,c;return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=t.getDrawData(e)){n.next=3;break}return n.abrupt("return");case 3:return o=a.data.drawData,n.next=6,null===(i=null===(r=t.context.layout)||void 0===r?void 0:r.preLayout)||void 0===i?void 0:i.call(r,o);case 6:return s=o.add,u=o.update,c=o.remove,t.destroyElements(c,e),t.createElements(s,e),t.updateElements(u,e),n.abrupt("return",t.setAnimationTask(e,a));case 11:case"end":return n.stop()}}),n)}))()}))}},{key:"setAnimationTask",value:function(t,e){var n=this,r=t.animation,i=t.silence,a=e.data,o=a.dataChanges,s=a.drawData,u=e.stage,c=e.type;return this.context.animation.animate(r,i?{}:{before:function(){return n.emit(new IN($c.BEFORE_DRAW,{dataChanges:o,animation:r,stage:u,render:"render"===c}),t)},beforeAnimate:function(e){return n.emit(new jN($c.BEFORE_ANIMATE,Hc.DRAW,e,s),t)},afterAnimate:function(e){return n.emit(new jN($c.AFTER_ANIMATE,Hc.DRAW,e,s),t)},after:function(){return n.emit(new IN($c.AFTER_DRAW,{dataChanges:o,animation:r,stage:u,render:"render"===c,firstRender:!1===n.context.graph.rendered}),t)}})}},{key:"computeChangesAndDrawData",value:function(t){var e=this.context.model,n=e.getChanges(),r=EE(n);if(0===r.length)return null;var i=Sl(r,(function(t){return t.type})),a=i.NodeAdded,o=void 0===a?[]:a,s=i.NodeUpdated,u=void 0===s?[]:s,c=i.NodeRemoved,l=void 0===c?[]:c,h=i.EdgeAdded,d=void 0===h?[]:h,f=i.EdgeUpdated,v=void 0===f?[]:f,p=i.EdgeRemoved,g=void 0===p?[]:p,y=i.ComboAdded,m=void 0===y?[]:y,b=i.ComboUpdated,x=void 0===b?[]:b,w=i.ComboRemoved,E=void 0===w?[]:w,k=function(t){return new Map(t.map((function(t){var e=t.value;return[yh(e),e]})))},M={add:{nodes:k(o),edges:k(d),combos:k(m)},update:{nodes:k(u),edges:k(v),combos:k(x)},remove:{nodes:k(l),edges:k(g),combos:k(E)}},S=this.transformData(M,t);return e.clearChanges(),{dataChanges:n,drawData:S}}},{key:"transformData",value:function(t,e){var n=this.context.transform.getTransformInstance();return Object.values(n).reduce((function(t,n){return n.beforeDraw(t,e)}),t)}},{key:"createElement",value:function(t,e,n){var r,i=this,a=yh(e);if(!this.getElement(a)){var o=this.getElementType(t,e),s=this.getElementComputedStyle(t,e),u=al(t,o);if(!u)return ll.warn("The element ".concat(o," of ").concat(t," is not registered."));this.emit(new FN($c.BEFORE_ELEMENT_CREATE,t,e),n);var c=this.container.appendChild(new u({id:a,context:this.context,style:s}));this.shapeTypeMap[a]=o,this.elementMap[a]=c;var l=n.stage,h=void 0===l?"enter":l;null===(r=this.context.animation)||void 0===r||r.add({element:c,elementType:t,stage:h,originalStyle:Object.assign({},c.attributes),updatedStyle:s},{after:function(){var r;i.emit(new FN($c.AFTER_ELEMENT_CREATE,t,e),n),null===(r=c.onCreate)||void 0===r||r.call(c)}})}}},{key:"createElements",value:function(t,e){var n=this,r=t.nodes,i=t.edges;[["node",r],["combo",t.combos],["edge",i]].forEach((function(t){var r=h(t,2),i=r[0];r[1].forEach((function(t){return n.createElement(i,t,e)}))}))}},{key:"getUpdateStageStyle",value:function(t,e,n){var r=n.stage;if("translate"===(void 0===r?"update":r)){if("node"===t||"combo"===t){var i=e.style,a=void 0===i?{}:i,o=a.x,s=void 0===o?0:o,u=a.y,c=void 0===u?0:u,l=a.z;return{x:s,y:c,z:void 0===l?0:l}}return{}}return this.getElementComputedStyle(t,e)}},{key:"updateElement",value:function(t,e,n){var r,i=this,a=yh(e),o=n.stage,s=void 0===o?"update":o,u=this.getElement(a);if(!u)return function(){return null};this.emit(new FN($c.BEFORE_ELEMENT_UPDATE,t,e),n);var c=this.getElementType(t,e),l=this.getUpdateStageStyle(t,e,n);this.shapeTypeMap[a]!==c&&(u.destroy(),delete this.shapeTypeMap[a],delete this.elementMap[a],this.createElement(t,e,{animation:!1,silence:!0}));var h="visibility"!==s?s:"hidden"===l.visibility?"hide":"show";"hide"===h&&delete l.visibility,null===(r=this.context.animation)||void 0===r||r.add({element:u,elementType:t,stage:h,originalStyle:Object.assign({},u.attributes),updatedStyle:l},{before:function(){var t=i.elementMap[a];"collapse"!==s&&mg(t,l),"visibility"===s&&(function(t){return WN("opacity")in(Pd(t,VN)||{})}(t)||function(t,e){var n=Array.isArray(e)?e:[e];Pd(t,VN)||Cd(t,VN,{}),n.forEach((function(e){Cd(Pd(t,VN),WN(e),t.attributes[e])}))}(t,"opacity"),i.visibilityCache.set(t,"show"===h?"visible":"hidden"),"show"===h&&Th(t,"visible"))},after:function(){var r,o=i.elementMap[a];"collapse"===s&&mg(o,l),"hide"===h&&Th(o,i.visibilityCache.get(o)),i.emit(new FN($c.AFTER_ELEMENT_UPDATE,t,e),n),null===(r=o.onUpdate)||void 0===r||r.call(o)}})}},{key:"updateElements",value:function(t,e){var n=this,r=t.nodes,i=t.edges;[["node",r],["combo",t.combos],["edge",i]].forEach((function(t){var r=h(t,2),i=r[0];r[1].forEach((function(t){return n.updateElement(i,t,e)}))}))}},{key:"markDestroyElement",value:function(t){var e=this;Object.values(t.remove).forEach((function(t){t.forEach((function(t){var n=yh(t),r=e.getElement(n);r&&function(t){Cd(t,"__to_be_destroyed__",!0)}(r)}))}))}},{key:"destroyElement",value:function(t,e,n){var r,i=this,a=n.stage,o=void 0===a?"exit":a,s=yh(e),u=this.elementMap[s];if(!u)return function(){return null};this.emit(new FN($c.BEFORE_ELEMENT_DESTROY,t,e),n),null===(r=this.context.animation)||void 0===r||r.add({element:u,elementType:t,stage:o,originalStyle:Object.assign({},u.attributes),updatedStyle:{}},{after:function(){var r;i.clearElement(s),u.destroy(),null===(r=u.onDestroy)||void 0===r||r.call(u),i.emit(new FN($c.AFTER_ELEMENT_DESTROY,t,e),n)}})}},{key:"destroyElements",value:function(t,e){var n=this,r=t.nodes,i=t.edges;[["combo",t.combos],["edge",i],["node",r]].forEach((function(t){var r=h(t,2),i=r[0];r[1].forEach((function(t){return n.destroyElement(i,t,e)}))}))}},{key:"clearElement",value:function(t){delete this.paletteStyle[t],delete this.defaultStyle[t],delete this.stateStyle[t],delete this.elementMap[t],delete this.shapeTypeMap[t]}},{key:"alignLayoutResultToElement",value:function(t,e){var n,r,i=null===(n=t.nodes)||void 0===n?void 0:n.find((function(t){return yh(t)===e}));if(i){var a=zh(ed(this.context.model.getNodeLikeDatum(e)),ed(i));null===(r=t.nodes)||void 0===r||r.forEach((function(t){var e,n,r;(null===(e=t.style)||void 0===e?void 0:e.x)&&(t.style.x+=a[0]),(null===(n=t.style)||void 0===n?void 0:n.y)&&(t.style.y+=a[1]),(null===(r=t.style)||void 0===r?void 0:r.z)&&(t.style.z+=a[2]||0)}))}}},{key:"collapseNode",value:function(t,e){return nA(this,void 0,void 0,Tn().mark((function n(){var r,i,a,o,s,u,c,l,d,f,v,p,g,y,m=this;return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=e.animation,a=e.align,o=this.context,s=o.model,u=o.layout,c=this.computeChangesAndDrawData({stage:"collapse",animation:i})){n.next=5;break}return n.abrupt("return");case 5:return this.markDestroyElement(c.drawData),n.next=8,u.simulate();case 8:if(l=n.sent,a&&this.alignLayoutResultToElement(l,t),s.updateData(l),d=this.computeChangesAndDrawData({stage:"collapse",animation:i})){n.next=14;break}return n.abrupt("return");case 14:return f=d.drawData,v=f.add,p=f.remove,g=f.update,this.markDestroyElement(f),y={animation:i,stage:"collapse",data:f},this.destroyElements(p,y),this.createElements(v,y),this.updateElements(g,y),n.next=23,null===(r=this.context.animation.animate(i,{beforeAnimate:function(t){return m.emit(new jN($c.BEFORE_ANIMATE,Hc.COLLAPSE,t,f),y)},afterAnimate:function(t){return m.emit(new jN($c.AFTER_ANIMATE,Hc.COLLAPSE,t,f),y)}},{collapse:{target:t,descendants:Array.from(p.nodes).map((function(t){return yh(h(t,2)[1])})),position:ed(g.nodes.get(t))}}))||void 0===r?void 0:r.finished;case 23:case"end":return n.stop()}}),n,this)})))}},{key:"expandNode",value:function(t,e){return nA(this,void 0,void 0,Tn().mark((function n(){var r,i,a,o,s,u,c,l,d,f,v,p,g,y,m=this;return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=this.context,a=i.model,o=i.layout,s=e.animation,u=e.align,c=ed(a.getNodeData([t])[0]),l=this.computeChangesAndDrawData({stage:"expand",animation:s})){n.next=6;break}return n.abrupt("return");case 6:return d=l.drawData.add,this.createElements(d,{animation:!1,stage:"expand",target:t}),this.context.animation.clear(),n.next=11,o.simulate();case 11:if(f=n.sent,u&&this.alignLayoutResultToElement(f,t),a.updateData(f),this.computeStyle("expand"),v=this.computeChangesAndDrawData({stage:"collapse",animation:s})){n.next=18;break}return n.abrupt("return");case 18:return p=v.drawData,g=p.update,y={animation:s,stage:"expand",data:p},d.edges.forEach((function(t){return g.edges.set(yh(t),t)})),d.nodes.forEach((function(t){return g.nodes.set(yh(t),t)})),this.updateElements(g,y),n.next=26,null===(r=this.context.animation.animate(s,{beforeAnimate:function(t){return m.emit(new jN($c.BEFORE_ANIMATE,Hc.EXPAND,t,p),y)},afterAnimate:function(t){return m.emit(new jN($c.AFTER_ANIMATE,Hc.EXPAND,t,p),y)}},{expand:{target:t,descendants:Array.from(d.nodes).map((function(t){return yh(h(t,2)[1])})),position:c}}))||void 0===r?void 0:r.finished;case 26:case"end":return n.stop()}}),n,this)})))}},{key:"collapseCombo",value:function(t,e){return nA(this,void 0,void 0,Tn().mark((function n(){var r,i,a,o,s,u,c,l,d,f,v,p,g,y=this;return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=this.context,a=i.model,o=i.element,!a.getAncestorsData(t,nl).some((function(t){return Td(t)}))){n.next=3;break}return n.abrupt("return");case 3:if(s=o.getElement(t),u=s.getComboPosition(Object.assign(Object.assign({},s.attributes),{collapsed:!0})),c=this.computeChangesAndDrawData({stage:"collapse",animation:e})){n.next=8;break}return n.abrupt("return");case 8:return l=c.dataChanges,d=c.drawData,this.markDestroyElement(d),f=d.update,v=d.remove,p={animation:e,stage:"collapse",data:d},this.destroyElements(v,p),this.updateElements(f,p),g=function(t){return Array.from(t).map((function(t){return yh(h(t,2)[1])}))},n.next=17,null===(r=this.context.animation.animate(e,{before:function(){return y.emit(new IN($c.BEFORE_DRAW,{dataChanges:l,animation:e}),p)},beforeAnimate:function(t){return y.emit(new jN($c.BEFORE_ANIMATE,Hc.COLLAPSE,t,d),p)},afterAnimate:function(t){return y.emit(new jN($c.AFTER_ANIMATE,Hc.COLLAPSE,t,d),p)},after:function(){return y.emit(new IN($c.AFTER_DRAW,{dataChanges:l,animation:e}),p)}},{collapse:{target:t,descendants:[].concat(w(g(v.nodes)),w(g(v.combos))),position:u}}))||void 0===r?void 0:r.finished;case 17:case"end":return n.stop()}}),n,this)})))}},{key:"expandCombo",value:function(t,e){return nA(this,void 0,void 0,Tn().mark((function n(){var r,i,a,o,s,u,c,l,d,f,v=this;return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=this.context.model,a=ed(i.getComboData([t])[0]),this.computeStyle("expand"),o=this.computeChangesAndDrawData({stage:"expand",animation:e})){n.next=6;break}return n.abrupt("return");case 6:return s=o.dataChanges,u=o.drawData,c=u.add,l=u.update,d={animation:e,stage:"expand",data:u,target:t},this.createElements(c,d),this.updateElements(l,d),f=function(t){return Array.from(t).map((function(t){return yh(h(t,2)[1])}))},n.next=14,null===(r=this.context.animation.animate(e,{before:function(){return v.emit(new IN($c.BEFORE_DRAW,{dataChanges:s,animation:e}),d)},beforeAnimate:function(t){return v.emit(new jN($c.BEFORE_ANIMATE,Hc.EXPAND,t,u),d)},afterAnimate:function(t){return v.emit(new jN($c.AFTER_ANIMATE,Hc.EXPAND,t,u),d)},after:function(){return v.emit(new IN($c.AFTER_DRAW,{dataChanges:s,animation:e}),d)}},{expand:{target:t,descendants:[].concat(w(f(c.nodes)),w(f(c.combos))),position:a}}))||void 0===r?void 0:r.finished;case 14:case"end":return n.stop()}}),n,this)})))}},{key:"clear",value:function(){this.container.destroy(),this.initContainer(),this.elementMap={},this.shapeTypeMap={},this.defaultStyle={},this.stateStyle={},this.paletteStyle={}}},{key:"destroy",value:function(){this.clear(),this.container.destroy(),this.context={}}}])}(),iA=Symbol("Comlink.proxy"),aA=Symbol("Comlink.endpoint"),oA=Symbol("Comlink.releaseProxy"),sA=Symbol("Comlink.finalizer"),uA=Symbol("Comlink.thrown"),cA=function(t){return"object"==typeof t&&null!==t||"function"==typeof t},lA={canHandle:function(t){return cA(t)&&uA in t},serialize:function(t){var e=t.value;return[e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[]]},deserialize:function(t){if(t.isError)throw Object.assign(new Error(t.value.message),t.value);throw t.value}},hA=new Map([["proxy",{canHandle:function(t){return cA(t)&&t[iA]},serialize:function(t){var e=new MessageChannel,n=e.port1,r=e.port2;return dA(t,n),[r,[r]]},deserialize:function(t){return t.start(),vA(t)}}],["throw",lA]]);function dA(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:globalThis,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["*"];e.addEventListener("message",(function r(i){if(i&&i.data)if(function(t,e){var n,r=Rn(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(e===i||"*"===i)return!0;if(i instanceof RegExp&&i.test(e))return!0}}catch(t){r.e(t)}finally{r.f()}return!1}(n,i.origin)){var a,o=Object.assign({path:[]},i.data),s=o.id,u=o.type,c=o.path,l=(i.data.argumentList||[]).map(kA);try{var d=c.slice(0,-1).reduce((function(t,e){return t[e]}),t),f=c.reduce((function(t,e){return t[e]}),t);switch(u){case"GET":a=f;break;case"SET":d[c.slice(-1)[0]]=kA(i.data.value),a=!0;break;case"APPLY":a=f.apply(d,l);break;case"CONSTRUCT":var p;a=function(t){return Object.assign(t,v({},iA,!0))}(RS(f,w(l)));break;case"ENDPOINT":var g=new MessageChannel,y=g.port1,m=g.port2;dA(t,m),a=function(t,e){return wA.set(t,e),t}(y,[y]);break;case"RELEASE":a=void 0;break;default:return}}catch(p){a=v({value:p},uA,0)}Promise.resolve(a).catch((function(t){return v({value:t},uA,0)})).then((function(n){var i=h(EA(n),2),a=i[0],o=i[1];e.postMessage(Object.assign(Object.assign({},a),{id:s}),o),"RELEASE"===u&&(e.removeEventListener("message",r),fA(e),sA in t&&"function"==typeof t[sA]&&t[sA]())})).catch((function(t){var n=h(EA(v({value:new TypeError("Unserializable return value")},uA,0)),2),r=n[0],i=n[1];e.postMessage(Object.assign(Object.assign({},r),{id:s}),i)}))}else console.warn("Invalid origin '".concat(i.origin,"' for comlink proxy"))})),e.start&&e.start()}function fA(t){(function(t){return"MessagePort"===t.constructor.name})(t)&&t.close()}function vA(t,e){var n=new Map;return t.addEventListener("message",(function(t){var e=t.data;if(e&&e.id){var r=n.get(e.id);if(r)try{r(e)}finally{n.delete(e.id)}}})),bA(t,n,[],e)}function pA(t){if(t)throw new Error("Proxy has been released and is not useable")}function gA(t){return MA(t,new Map,{type:"RELEASE"}).then((function(){fA(t)}))}var yA=new WeakMap,mA="FinalizationRegistry"in globalThis&&new FinalizationRegistry((function(t){var e=(yA.get(t)||0)-1;yA.set(t,e),0===e&&gA(t)}));function bA(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=!1,i=new Proxy(arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},{get:function(a,o){if(pA(r),o===oA)return function(){!function(t){mA&&mA.unregister(t)}(i),gA(t),e.clear(),r=!0};if("then"===o){if(0===n.length)return{then:function(){return i}};var s=MA(t,e,{type:"GET",path:n.map((function(t){return t.toString()}))}).then(kA);return s.then.bind(s)}return bA(t,e,[].concat(w(n),[o]))},set:function(i,a,o){pA(r);var s=h(EA(o),2),u=s[0],c=s[1];return MA(t,e,{type:"SET",path:[].concat(w(n),[a]).map((function(t){return t.toString()})),value:u},c).then(kA)},apply:function(i,a,o){pA(r);var s=n[n.length-1];if(s===aA)return MA(t,e,{type:"ENDPOINT"}).then(kA);if("bind"===s)return bA(t,e,n.slice(0,-1));var u=h(xA(o),2),c=u[0],l=u[1];return MA(t,e,{type:"APPLY",path:n.map((function(t){return t.toString()})),argumentList:c},l).then(kA)},construct:function(i,a){pA(r);var o=h(xA(a),2),s=o[0],u=o[1];return MA(t,e,{type:"CONSTRUCT",path:n.map((function(t){return t.toString()})),argumentList:s},u).then(kA)}});return function(t,e){var n=(yA.get(e)||0)+1;yA.set(e,n),mA&&mA.register(t,e,t)}(i,t),i}function xA(t){var e,n=t.map(EA);return[n.map((function(t){return t[0]})),(e=n.map((function(t){return t[1]})),Array.prototype.concat.apply([],e))]}var wA=new WeakMap;function EA(t){var e,n=Rn(hA);try{for(n.s();!(e=n.n()).done;){var r=h(e.value,2),i=r[0],a=r[1];if(a.canHandle(t)){var o=h(a.serialize(t),2);return[{type:"HANDLER",name:i,value:o[0]},o[1]]}}}catch(t){n.e(t)}finally{n.f()}return[{type:"RAW",value:t},wA.get(t)||[]]}function kA(t){switch(t.type){case"HANDLER":return hA.get(t.name).deserialize(t.value);case"RAW":return t.value}}function MA(t,e,n,r){return new Promise((function(i){var a=new Array(4).fill(0).map((function(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)})).join("-");e.set(a,i),t.start&&t.start(),t.postMessage(Object.assign({id:a},n),r)}))}var SA=function(t){function e(t,n,r){var i;return y(this,e),(i=S(this,e)).graph=t,i.layout=n,i.options=r,i.spawnWorker(),i}return N(e,t),b(e,[{key:"spawnWorker",value:function(){this.proxy=vA(new Worker(new URL(a.p+a.u(45),a.b),{type:void 0})),this.running&&(this.running=!1,this.execute())}},{key:"execute",value:function(){var t;return pe(this,void 0,void 0,Tn().mark((function e(){var n,r,i,a,o,s,u,c;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.running){e.next=2;break}return e.abrupt("return",this);case 2:return this.running=!0,(n=this.layout.options).onTick,r=ve(n,["onTick"]),i={},Object.keys(r).forEach((function(t){cn(r[t])||(i[t]=r[t])})),a={layout:{id:this.layout.id,options:i,iterations:null===(t=this.options)||void 0===t?void 0:t.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},o=new Float32Array([0]),e.next=10,this.proxy.calculateLayout(a,[o]);case 10:return s=e.sent,u=h(s,1),c=u[0],e.abrupt("return",c);case 14:case"end":return e.stop()}}),e,this)})))}},{key:"stop",value:function(){return this.running=!1,this.proxy.stopLayout(),this}},{key:"kill",value:function(){this.proxy[oA]()}},{key:"isRunning",value:function(){return this.running}}])}(Pg),OA=function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},NA=function(){return b((function t(e){y(this,t),this.instances=[],this.context=e}),[{key:"presetOptions",get:function(){return{animation:!!pl(this.context.options,!0)}}},{key:"options",get:function(){return this.context.options.layout}},{key:"getLayoutInstance",value:function(){return this.instances}},{key:"preLayout",value:function(t){return OA(this,void 0,void 0,Tn().mark((function e(){var n,r,i,a,o,s,u,c,l;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.context,s=o.graph,u=o.model,c=t.add,zN(s,new IN($c.BEFORE_LAYOUT,{type:"pre"})),e.next=5,null===(n=this.context.layout)||void 0===n?void 0:n.simulate();case 5:l=e.sent,null===(r=null==l?void 0:l.nodes)||void 0===r||r.forEach((function(t){var e=yh(t),n=c.nodes.get(e);u.syncNodeLikeDatum(t),n&&Object.assign(n.style,t.style)})),null===(i=null==l?void 0:l.edges)||void 0===i||i.forEach((function(t){var e=yh(t),n=c.edges.get(e);u.syncEdgeDatum(t),n&&Object.assign(n.style,t.style)})),null===(a=null==l?void 0:l.combos)||void 0===a||a.forEach((function(t){var e=yh(t),n=c.combos.get(e);u.syncNodeLikeDatum(t),n&&Object.assign(n.style,t.style)})),zN(s,new IN($c.AFTER_LAYOUT,{type:"pre"})),this.transformDataAfterLayout("pre",t);case 11:case"end":return e.stop()}}),e,this)})))}},{key:"postLayout",value:function(){return OA(this,arguments,void 0,(function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options;return Tn().mark((function n(){var r,i,a,o,s,u,c,l,h;return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return");case 2:r=Array.isArray(e)?e:[e],zN(i=t.context.graph,new IN($c.BEFORE_LAYOUT,{type:"post"})),a=Rn(r),n.prev=6,a.s();case 8:if((o=a.n()).done){n.next=21;break}return s=o.value,u=r.indexOf(s),c=t.getLayoutData(s),l=Object.assign(Object.assign({},t.presetOptions),s),zN(i,new IN($c.BEFORE_STAGE_LAYOUT,{options:l,index:u})),n.next=16,t.stepLayout(c,l,u);case 16:h=n.sent,zN(i,new IN($c.AFTER_STAGE_LAYOUT,{options:l,index:u})),s.animation||t.updateElementPosition(h,!1);case 19:n.next=8;break;case 21:n.next=26;break;case 23:n.prev=23,n.t0=n.catch(6),a.e(n.t0);case 26:return n.prev=26,a.f(),n.finish(26);case 29:zN(i,new IN($c.AFTER_LAYOUT,{type:"post"})),t.transformDataAfterLayout("post");case 31:case"end":return n.stop()}}),n,null,[[6,23,26,29]])}))()}))}},{key:"transformDataAfterLayout",value:function(t,e){var n=this.context.transform.getTransformInstance();Object.values(n).forEach((function(n){return n.afterLayout(t,e)}))}},{key:"simulate",value:function(){return OA(this,void 0,void 0,Tn().mark((function t(){var e,n,r,i,a,o,s,u;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.options){t.next=2;break}return t.abrupt("return",{});case 2:e=Array.isArray(this.options)?this.options:[this.options],n={},r=Rn(e),t.prev=5,r.s();case 7:if((i=r.n()).done){t.next=17;break}return a=i.value,o=e.indexOf(a),s=this.getLayoutData(a),t.next=13,this.stepLayout(s,Object.assign(Object.assign(Object.assign({},this.presetOptions),a),{animation:!1}),o);case 13:u=t.sent,n=u;case 15:t.next=7;break;case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(5),r.e(t.t0);case 22:return t.prev=22,r.f(),t.finish(22);case 25:return t.abrupt("return",n);case 26:case"end":return t.stop()}}),t,this,[[5,19,22,25]])})))}},{key:"stepLayout",value:function(t,e,n){return OA(this,void 0,void 0,Tn().mark((function r(){return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!jg(e)){r.next=4;break}return r.next=3,this.treeLayout(t,e,n);case 3:case 6:return r.abrupt("return",r.sent);case 4:return r.next=6,this.graphLayout(t,e,n);case 7:case"end":return r.stop()}}),r,this)})))}},{key:"graphLayout",value:function(t,e,n){return OA(this,void 0,void 0,Tn().mark((function r(){var i,a,o,s,u,c,l,h,d=this;return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=e.animation,a=e.enableWorker,o=e.iterations,s=void 0===o?300:o,u=this.initGraphLayout(e)){r.next=4;break}return r.abrupt("return",{});case 4:if(this.instances[n]=u,this.instance=u,!a){r.next=14;break}return c=u,this.supervisor=new SA(c.graphData2LayoutModel(t),c.instance,{iterations:s}),r.t0=Fg,r.next=12,this.supervisor.execute();case 12:return r.t1=r.sent,r.abrupt("return",(0,r.t0)(r.t1));case 14:if(!Ib(u)){r.next=22;break}if(!i){r.next=19;break}return r.next=18,u.execute(t,{onTick:function(t){d.updateElementPosition(t,!1)}});case 18:return r.abrupt("return",r.sent);case 19:return u.execute(t),u.stop(),r.abrupt("return",u.tick(s));case 22:return r.next=24,u.execute(t);case 24:if(l=r.sent,!i){r.next=29;break}return h=this.updateElementPosition(l,i),r.next=29,null==h?void 0:h.finished;case 29:return r.abrupt("return",l);case 30:case"end":return r.stop()}}),r,this)})))}},{key:"treeLayout",value:function(t,e,n){return OA(this,void 0,void 0,Tn().mark((function n(){var r,i,a,o,s,u,c,l,h,d,f,v;return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.type,i=e.animation,a=al("layout",r)){n.next=4;break}return n.abrupt("return",{});case 4:if(o=t.nodes,s=void 0===o?[]:o,u=t.edges,c=void 0===u?[]:u,l=new _g({nodes:s.map((function(t){return{id:yh(t),data:t.data||{}}})),edges:c.map((function(t){return{id:yh(t),source:t.source,target:t.target,data:t.data||{}}}))}),tA(l),h={nodes:[],edges:[]},d={nodes:[],edges:[]},l.getRoots(rl).forEach((function(t){kd(t,(function(t){t.children=l.getSuccessors(t.id)}),(function(t){return l.getSuccessors(t.id)}),"TB");var n=a(t,e),r=n.x,i=n.y,o=n.z,s=void 0===o?0:o;kd(n,(function(t){var e=t.id,n=t.x,a=t.y,o=t.z,u=void 0===o?0:o;h.nodes.push({id:e,style:{x:r,y:i,z:s}}),d.nodes.push({id:e,style:{x:n,y:a,z:u}})}),(function(t){return t.children}),"TB")})),f=this.inferTreeLayoutOffset(d),AA(d,f),!i){n.next=19;break}return AA(h,f),this.updateElementPosition(h,!1),v=this.updateElementPosition(d,i),n.next=19,null==v?void 0:v.finished;case 19:return n.abrupt("return",d);case 20:case"end":return n.stop()}}),n,this)})))}},{key:"inferTreeLayoutOffset",value:function(t){var e,n=1/0,r=-1/0,i=1/0,a=-1/0;null===(e=t.nodes)||void 0===e||e.forEach((function(t){var e=t.style||{},o=e.x,s=void 0===o?0:o,u=e.y,c=void 0===u?0:u;n=Math.min(n,s),r=Math.max(r,s),i=Math.min(i,c),a=Math.max(a,c)}));var o=this.context.canvas,s=o.getSize(),u=h(o.getCanvasByViewport([0,0]),2),c=u[0],l=u[1],d=h(o.getCanvasByViewport(s),2),f=d[0],v=d[1];return n>=c&&r<=f&&i>=l&&a<=v?[0,0]:[(c+f)/2-(n+r)/2,(l+v)/2-(i+a)/2]}},{key:"stopLayout",value:function(){this.instance&&Ib(this.instance)&&(this.instance.stop(),this.instance=void 0),this.supervisor&&(this.supervisor.stop(),this.supervisor=void 0),this.animationResult&&(this.animationResult.finish(),this.animationResult=void 0)}},{key:"getLayoutData",value:function(t){var e=t.nodeFilter,n=void 0===e?function(){return!0}:e,r=t.preLayout,i=void 0!==r&&r,a=t.isLayoutInvisibleNodes,o=void 0!==a&&a,s=this.context.model.getData(),u=s.nodes,c=s.edges,l=s.combos,h=this.context,d=h.element,f=h.model,v=function(t){return d.getElement(t)},p=i?function(t){var e;if(!o){if("hidden"===(null===(e=t.style)||void 0===e?void 0:e.visibility))return!1;if(f.getAncestorsData(t.id,rl).some(Td))return!1;if(f.getAncestorsData(t.id,nl).some(Td))return!1}return n(t)}:function(t){var e=yh(t),r=v(e);return!!r&&!bg(r)&&n(t)},g=u.filter(p),y=new Map(g.map((function(t){return[yh(t),t]})));return l.forEach((function(t){return y.set(yh(t),t)})),{nodes:g,edges:c.filter((function(t){var e=t.source,n=t.target;return y.has(e)&&y.has(n)})),combos:l}}},{key:"initGraphLayout",value:function(t){var e,n=this.context,r=n.element,i=n.viewport,a=t.type,o=(t.enableWorker,t.animation,t.iterations,function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(t,["type","enableWorker","animation","iterations"])),s=h(i.getCanvasSize(),2),u=s[0],c=s[1],l=[u/2,c/2],d=null!==(e=null==t?void 0:t.nodeSize)&&void 0!==e?e:function(t){var e=null==r?void 0:r.getElement(t.id);return e?e.attributes.size:null==r?void 0:r.getElementComputedStyle("node",t).size},f=al("layout",a);if(!f)return ll.warn("The layout of ".concat(a," is not registered."));var v=Object.getPrototypeOf(f.prototype)===Ig.prototype?f:function(t,e){var n=function(n){function r(e,n){var i;if(y(this,r),(i=S(this,r,[e,n])).instance=new t({}),i.id=i.instance.id,"stop"in i.instance&&"tick"in i.instance){var a=i.instance;i.stop=a.stop.bind(a),i.tick=function(t){return Fg(a.tick(t))}}return i}return N(r,n),b(r,[{key:"execute",value:function(t,e){return n=this,r=void 0,i=void 0,a=Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=Fg,n.next=3,this.instance.execute(this.graphData2LayoutModel(t),this.transformOptions(jh({},this.options,e)));case 3:return n.t1=n.sent,n.abrupt("return",(0,n.t0)(n.t1));case 5:case"end":return n.stop()}}),n,this)})),new(i||(i=Promise))((function(t,e){function o(t){try{u(a.next(t))}catch(t){e(t)}}function s(t){try{u(a.throw(t))}catch(t){e(t)}}function u(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(o,s)}u((a=a.apply(n,r||[])).next())}));var n,r,i,a}},{key:"transformOptions",value:function(t){var e=t.onTick;return e?(t.onTick=function(t){return e(Fg(t))},t):t}},{key:"graphData2LayoutModel",value:function(t){var n=t.nodes,r=void 0===n?[]:n,i=t.edges,a=void 0===i?[]:i,o=t.combos,s=void 0===o?[]:o,u=r.map((function(t){var e=yh(t),n=t.data,r=t.style,i=t.combo,a=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(t,["data","style","combo"]),o={id:e,data:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n),{data:n}),i?{parentId:i}:{}),{style:r}),a)};return(null==r?void 0:r.x)&&Object.assign(o.data,{x:r.x}),(null==r?void 0:r.y)&&Object.assign(o.data,{y:r.y}),(null==r?void 0:r.z)&&Object.assign(o.data,{z:r.z}),o})),c=new Map(u.map((function(t){return[t.id,t]}))),l=a.filter((function(t){var e=t.source,n=t.target;return c.has(e)&&c.has(n)})).map((function(t){var e=t.source,n=t.target,r=t.data,i=t.style;return{id:yh(t),source:e,target:n,data:Object.assign({},r),style:Object.assign({},i)}})),h=s.map((function(t){return{id:yh(t),data:Object.assign({_isCombo:!0},t.data),style:Object.assign({},t.style)}})),d=new _g({nodes:[].concat(w(u),w(h)),edges:l});return e.model.model.hasTreeStructure(nl)&&(d.attachTreeStructure(nl),u.forEach((function(t){var n=e.model.model.getParent(t.id,nl);n&&d.hasNode(n.id)&&d.setParent(t.id,n.id,nl)}))),d}}])}(Ig);return n}(f,this.context),p=new v(this.context),g={nodeSize:d,width:u,height:c,center:l};switch(p.id){case"d3-force":case"d3-force-3d":Object.assign(g,{center:{x:u/2,y:c/2,z:0}})}return jh(p.options,g,o),p}},{key:"updateElementPosition",value:function(t,e){var n=this.context,r=n.model,i=n.element;return i?(r.updateData(t),i.draw({animation:e,silence:!0})):null}},{key:"destroy",value:function(){var t;this.stopLayout(),this.context={},null===(t=this.supervisor)||void 0===t||t.kill(),this.supervisor=void 0,this.instance=void 0,this.instances=[],this.animationResult=void 0}}])}(),AA=function(t,e){var n,r=h(e,2),i=r[0],a=r[1];null===(n=t.nodes)||void 0===n||n.forEach((function(t){if(t.style){var e=t.style,n=e.x,r=void 0===n?0:n,o=e.y,s=void 0===o?0:o;t.style.x=r+i,t.style.y=s+a}else t.style={x:i,y:a}}))};function TA(t){return t.layout?(Array.isArray(t.layout)||"preLayout"in t.layout||["antv-dagre","combo-combined","compact-box","circular","concentric","dagre","fishbone","grid","indented","mds","radial","random","snake","dendrogram","mindmap"].includes(t.layout.type)&&(t.layout.preLayout=!0),t):t}var PA=function(t){function e(t){var n;return y(this,e),(n=S(this,e,[t])).category="plugin",n.setPlugins(n.context.options.plugins||[]),n}return N(e,t),b(e,[{key:"setPlugins",value:function(t){this.setExtensions(t)}},{key:"getPluginInstance",value:function(t){var e=this.extensionMap[t];if(e)return e;ll.warn("Cannot find the plugin ".concat(t,", will try to find it by type."));var n=this.extensions.find((function(e){return e.type===t}));return n?this.extensionMap[n.key]:void 0}}])}(Ph),CA=["update-related-edges","collapse-expand-node","collapse-expand-combo","get-edge-actual-ends","arrange-draw-order"],RA=function(t){function e(t){var n;return y(this,e),(n=S(this,e,[t])).category="transform",n.setTransforms(n.context.options.transforms||[]),n}return N(e,t),b(e,[{key:"getTransforms",value:function(){}},{key:"setTransforms",value:function(t){this.setExtensions([].concat(w(CA.slice(0,CA.length-1)),w(t),[CA[CA.length-1]]))}},{key:"getTransformInstance",value:function(t){return t?this.extensionMap[t]:this.extensionMap}}])}(Ph),LA=function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},DA=function(){return b((function t(e){y(this,t),this.landmarkCounter=0,this.context=e;var n=h(this.paddingOffset,2),r=n[0],i=n[1],a=e.options,o=a.zoom,s=a.rotation,u=a.x,c=void 0===u?r:u,l=a.y,d=void 0===l?i:l;this.transform({mode:"absolute",scale:o,translate:[c,d],rotate:s},!1)}),[{key:"padding",get:function(){return Cl(this.context.options.padding)}},{key:"paddingOffset",get:function(){var t=h(this.padding,4),e=t[0],n=t[1],r=t[2];return[(t[3]-n)/2,(e-r)/2,0]}},{key:"camera",get:function(){var t=this.context.canvas;return new Proxy(t.getCamera(),{get:function(e,n){var r=Object.entries(t.getLayers()).filter((function(t){var e=h(t,1)[0];return!["main"].includes(e)})),i=r.map((function(t){return h(t,2)[1].getCamera()})),a=e[n];if("function"==typeof a)return function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];var s=a.apply(e,r);return i.forEach((function(t){t[n].apply(t,r)})),s}}})}},{key:"createLandmark",value:function(t){return this.camera.createLandmark("landmark-".concat(this.landmarkCounter++),t)}},{key:"getAnimation",value:function(t){var e=pl(this.context.options,t);return!!e&&ep(Object.assign({},e),["easing","duration"])}},{key:"getCanvasSize",value:function(){var t=this.context.canvas.getConfig(),e=t.width,n=void 0===e?0:e,r=t.height;return[n,void 0===r?0:r]}},{key:"getCanvasCenter",value:function(){var t=this.context.canvas.getConfig(),e=t.width,n=void 0===e?0:e,r=t.height;return[n/2,(void 0===r?0:r)/2,0]}},{key:"getViewportCenter",value:function(){var t=h(this.camera.getPosition(),2);return[t[0],t[1],0]}},{key:"getGraphCenter",value:function(){return this.context.graph.getViewportByCanvas(this.getCanvasCenter())}},{key:"getZoom",value:function(){return this.camera.getZoom()}},{key:"getRotation",value:function(){return this.camera.getRoll()}},{key:"getTranslateOptions",value:function(t){var e=this.camera,n=t.mode,r=t.translate,i=void 0===r?[]:r,a=this.getZoom(),o=e.getPosition(),s=e.getFocalPoint(),u=h(this.getCanvasCenter(),2),c=u[0],l=u[1],d=h(i,3),f=d[0],v=void 0===f?0:f,p=d[1],g=void 0===p?0:p,y=d[2],m=Vh([-v,-g,-(void 0===y?0:y)],a);return"relative"===n?{position:Bh(o,m),focalPoint:Bh(s,m)}:{position:Bh([c,l,o[2]],m),focalPoint:Bh([c,l,s[2]],m)}}},{key:"getRotateOptions",value:function(t){var e=t.mode,n=t.rotate,r=void 0===n?0:n;return{roll:"relative"===e?this.camera.getRoll()+r:r}}},{key:"getZoomOptions",value:function(t){var e=this.context.options.zoomRange,n=this.camera.getZoom(),r=t.mode,i=t.scale,a=void 0===i?1:i;return le.apply(void 0,["relative"===r?n*a:a].concat(w(e)))}},{key:"transform",value:function(t,e){return LA(this,void 0,void 0,Tn().mark((function n(){var r,i,a,o,s,u,c,l=this;return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=this.context.graph,i=t.translate,a=t.rotate,o=t.scale,s=t.origin,this.cancelAnimation(),u=this.getAnimation(e),zN(r,new BN($c.BEFORE_TRANSFORM,t)),a||!o||i||!s||u){n.next=9;break}return this.camera.setZoomByViewportPoint(this.getZoomOptions(t),s),zN(r,new BN($c.AFTER_TRANSFORM,t)),n.abrupt("return");case 9:if(c={},i&&Object.assign(c,this.getTranslateOptions(t)),oe(a)&&Object.assign(c,this.getRotateOptions(t)),oe(o)&&Object.assign(c,{zoom:this.getZoomOptions(t)}),!u){n.next=18;break}return zN(r,new jN($c.BEFORE_ANIMATE,Hc.TRANSFORM,null,t)),n.abrupt("return",new Promise((function(e){l.transformResolver=e,l.camera.gotoLandmark(l.createLandmark(c),Object.assign(Object.assign({},u),{onfinish:function(){zN(r,new jN($c.AFTER_ANIMATE,Hc.TRANSFORM,null,t)),zN(r,new BN($c.AFTER_TRANSFORM,t)),l.transformResolver=void 0,e()}}))})));case 18:this.camera.gotoLandmark(this.createLandmark(c),{duration:0}),zN(r,new BN($c.AFTER_TRANSFORM,t));case 20:case"end":return n.stop()}}),n,this)})))}},{key:"fitView",value:function(t,e){return LA(this,void 0,void 0,Tn().mark((function n(){var r,i,a,o,s,u,c,l,d,f,v,p,g,y,m,b,x,w,E,k,M,S,O,N,A,T,P;return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=h(this.padding,4),i=r[0],a=r[1],o=r[2],s=r[3],c=(u=t||{}).when,l=void 0===c?"always":c,d=u.direction,f=void 0===d?"both":d,v=this.context.canvas.getSize(),p=h(v,2),g=p[0],y=p[1],m=g-s-a,b=y-i-o,x=this.context.canvas.getBounds(),w=this.getBBoxInViewport(x),E=_l(w),k=h(E,2),M=k[0],S=k[1],O="x"===f&&M>=m||"y"===f&&S>=b||"both"===f&&M>=m&&S>=b,"overflow"!==l||O){n.next=13;break}return n.next=12,this.fitCenter({animation:e});case 12:return n.abrupt("return",n.sent);case 13:return N=m/M,A=b/S,T="x"===f?N:"y"===f?A:Math.min(N,A),P=this.getAnimation(e),n.next=19,this.transform({mode:"relative",scale:T,translate:Bh(zh(this.getCanvasCenter(),this.getBBoxInViewport(x).center),Vh(this.paddingOffset,T))},P);case 19:case"end":return n.stop()}}),n,this)})))}},{key:"fitCenter",value:function(t){return LA(this,void 0,void 0,Tn().mark((function e(){var n;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.context.canvas.getBounds(),e.next=3,this.focus(n,t);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"focusElements",value:function(t){return LA(this,arguments,void 0,(function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Tn().mark((function r(){var i,a,o;return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=e.context.element){r.next=3;break}return r.abrupt("return");case 3:return a=function(t){return n.shapes?t.getShape(n.shapes).getRenderBounds():t.getRenderBounds()},o=Bl(t.map((function(t){return a(i.getElement(t))}))),r.next=7,e.focus(o,n);case 7:case"end":return r.stop()}}),r)}))()}))}},{key:"focus",value:function(t,e){return LA(this,void 0,void 0,Tn().mark((function n(){var r,i,a;return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=this.context.graph.getViewportByCanvas(t.center),i=e.position||this.getCanvasCenter(),a=zh(i,r),n.next=5,this.transform({mode:"relative",translate:Bh(a,this.paddingOffset)},e.animation);case 5:case"end":return n.stop()}}),n,this)})))}},{key:"getBBoxInViewport",value:function(t){var e=t.min,n=t.max,r=this.context.graph,i=h(r.getViewportByCanvas(e),2),a=i[0],o=i[1],s=h(r.getViewportByCanvas(n),2),u=s[0],c=s[1],l=new Hn;return l.setMinMax([a,o,0],[u,c,0]),l}},{key:"isInViewport",value:function(t){var e,n,r,i,a,o,s,u,c,l,d,f,v,p,g=arguments.length>1&&void 0!==arguments[1]&&arguments[1],y=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,m=this.context.graph,b=this.getCanvasSize(),x=h(m.getCanvasByViewport([0,0]),2),w=x[0],E=x[1],k=h(m.getCanvasByViewport(b),2),M=k[0],S=k[1],O=new Hn;return O.setMinMax([w,E,0],[M,S,0]),y&&(O=Fl(O,y)),Tl(t)?zl(t,O):g?(n=O,i=(r=h((e=t).min,2))[0],a=r[1],s=(o=h(e.max,2))[0],u=o[1],l=(c=h(n.min,2))[0],d=c[1],v=(f=h(n.max,2))[0],p=f[1],i>=l&&s<=v&&a>=d&&u<=p):O.intersects(t)}},{key:"cancelAnimation",value:function(){var t,e;(null===(t=this.camera.landmarks)||void 0===t?void 0:t.length)&&this.camera.cancelLandmarkAnimation(),null===(e=this.transformResolver)||void 0===e||e.call(this)}}])}(),_A=function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},IA=function(t){function e(t){var n,r;return y(this,e),(n=S(this,e)).options={},n.rendered=!1,n.destroyed=!1,n.context={model:new eA},n.isCollapsingExpanding=!1,n.onResize=Sg((function(){n.resize()}),300),n._setOptions(Object.assign({},e.defaultOptions,t),!0),n.context.graph=n,n.options.autoResize&&(null===(r=globalThis.addEventListener)||void 0===r||r.call(globalThis,"resize",n.onResize)),n}return N(e,t),b(e,[{key:"getOptions",value:function(){return this.options}},{key:"setOptions",value:function(t){this._setOptions(t,!1)}},{key:"_setOptions",value:function(t,e){if(this.updateCanvas(t),Object.assign(this.options,function(t){return[TA].reduce((function(t,e){return e(t)}),t)}(t)),e){var n=t.data;n&&this.addData(n)}else{var r=t.behaviors,i=t.combo,a=t.data,o=t.edge,s=t.layout,u=t.node,c=t.plugins,l=t.theme,h=t.transforms;r&&this.setBehaviors(r),a&&this.setData(a),u&&this.setNode(u),o&&this.setEdge(o),i&&this.setCombo(i),s&&this.setLayout(s),l&&this.setTheme(l),c&&this.setPlugins(c),h&&this.setTransforms(h)}}},{key:"getSize",value:function(){return this.context.canvas?this.context.canvas.getSize():[this.options.width||0,this.options.height||0]}},{key:"setSize",value:function(t,e){t&&(this.options.width=t),e&&(this.options.height=e),this.resize(t,e)}},{key:"setZoomRange",value:function(t){this.options.zoomRange=t}},{key:"getZoomRange",value:function(){return this.options.zoomRange}},{key:"setNode",value:function(t){this.options.node=t,this.context.model.refreshData()}},{key:"setEdge",value:function(t){this.options.edge=t,this.context.model.refreshData()}},{key:"setCombo",value:function(t){this.options.combo=t,this.context.model.refreshData()}},{key:"getTheme",value:function(){return this.options.theme}},{key:"setTheme",value:function(t){this.options.theme=cn(t)?t(this.getTheme()):t}},{key:"setLayout",value:function(t){this.options.layout=cn(t)?t(this.getLayout()):t}},{key:"getLayout",value:function(){return this.options.layout}},{key:"setBehaviors",value:function(t){var e;this.options.behaviors=cn(t)?t(this.getBehaviors()):t,null===(e=this.context.behavior)||void 0===e||e.setBehaviors(this.options.behaviors)}},{key:"updateBehavior",value:function(t){this.setBehaviors((function(e){return e.map((function(e){return"object"==typeof e&&e.key===t.key?Object.assign(Object.assign({},e),t):e}))}))}},{key:"getBehaviors",value:function(){return this.options.behaviors||[]}},{key:"setPlugins",value:function(t){var e;this.options.plugins=cn(t)?t(this.getPlugins()):t,null===(e=this.context.plugin)||void 0===e||e.setPlugins(this.options.plugins)}},{key:"updatePlugin",value:function(t){this.setPlugins((function(e){return e.map((function(e){return"object"==typeof e&&e.key===t.key?Object.assign(Object.assign({},e),t):e}))}))}},{key:"getPlugins",value:function(){return this.options.plugins||[]}},{key:"getPluginInstance",value:function(t){return this.context.plugin.getPluginInstance(t)}},{key:"setTransforms",value:function(t){var e;this.options.transforms=cn(t)?t(this.getTransforms()):t,null===(e=this.context.transform)||void 0===e||e.setTransforms(this.options.transforms)}},{key:"updateTransform",value:function(t){this.setTransforms((function(e){return e.map((function(e){return"object"==typeof e&&e.key===t.key?Object.assign(Object.assign({},e),t):e}))})),this.context.model.refreshData()}},{key:"getTransforms",value:function(){return this.options.transforms||[]}},{key:"getData",value:function(){return this.context.model.getData()}},{key:"getElementData",value:function(t){var e=this;return Array.isArray(t)?t.map((function(t){return e.context.model.getElementDataById(t)})):this.context.model.getElementDataById(t)}},{key:"getNodeData",value:function(t){return void 0===t?this.context.model.getNodeData():Array.isArray(t)?this.context.model.getNodeData(t):this.context.model.getNodeLikeDatum(t)}},{key:"getEdgeData",value:function(t){return void 0===t?this.context.model.getEdgeData():Array.isArray(t)?this.context.model.getEdgeData(t):this.context.model.getEdgeDatum(t)}},{key:"getComboData",value:function(t){return void 0===t?this.context.model.getComboData():Array.isArray(t)?this.context.model.getComboData(t):this.context.model.getNodeLikeDatum(t)}},{key:"setData",value:function(t){this.context.model.setData(cn(t)?t(this.getData()):t)}},{key:"addData",value:function(t){this.context.model.addData(cn(t)?t(this.getData()):t)}},{key:"addNodeData",value:function(t){this.context.model.addNodeData(cn(t)?t(this.getNodeData()):t)}},{key:"addEdgeData",value:function(t){this.context.model.addEdgeData(cn(t)?t(this.getEdgeData()):t)}},{key:"addComboData",value:function(t){this.context.model.addComboData(cn(t)?t(this.getComboData()):t)}},{key:"addChildrenData",value:function(t,e){this.context.model.addChildrenData(t,e)}},{key:"updateData",value:function(t){this.context.model.updateData(cn(t)?t(this.getData()):t)}},{key:"updateNodeData",value:function(t){this.context.model.updateNodeData(cn(t)?t(this.getNodeData()):t)}},{key:"updateEdgeData",value:function(t){this.context.model.updateEdgeData(cn(t)?t(this.getEdgeData()):t)}},{key:"updateComboData",value:function(t){this.context.model.updateComboData(cn(t)?t(this.getComboData()):t)}},{key:"removeData",value:function(t){this.context.model.removeData(cn(t)?t(this.getData()):t)}},{key:"removeNodeData",value:function(t){this.context.model.removeNodeData(cn(t)?t(this.getNodeData()):t)}},{key:"removeEdgeData",value:function(t){this.context.model.removeEdgeData(cn(t)?t(this.getEdgeData()):t)}},{key:"removeComboData",value:function(t){this.context.model.removeComboData(cn(t)?t(this.getComboData()):t)}},{key:"getElementType",value:function(t){return this.context.model.getElementType(t)}},{key:"getRelatedEdgesData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"both";return this.context.model.getRelatedEdgesData(t,e)}},{key:"getNeighborNodesData",value:function(t){return this.context.model.getNeighborNodesData(t)}},{key:"getAncestorsData",value:function(t,e){return this.context.model.getAncestorsData(t,e)}},{key:"getParentData",value:function(t,e){return this.context.model.getParentData(t,e)}},{key:"getChildrenData",value:function(t){return this.context.model.getChildrenData(t)}},{key:"getDescendantsData",value:function(t){return this.context.model.getDescendantsData(t)}},{key:"getElementDataByState",value:function(t,e){return this.context.model.getElementDataByState(t,e)}},{key:"initCanvas",value:function(){return _A(this,void 0,void 0,Tn().mark((function t(){var e,n,r,i,a,o,s,u,c,l,h,d,f,v,p,g;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.context.canvas){t.next=4;break}return t.next=3,this.context.canvas.ready;case 3:return t.abrupt("return",t.sent);case 4:if(n=this.options,r=n.container,i=void 0===r?"container":r,a=n.width,o=n.height,s=n.renderer,u=n.cursor,c=n.background,l=n.canvas,h=n.devicePixelRatio,d=void 0===h?null!==(e=globalThis.devicePixelRatio)&&void 0!==e?e:1:h,!(i instanceof PN)){t.next=13;break}return this.context.canvas=i,u&&i.setCursor(u),s&&i.setRenderer(s),t.next=11,i.ready;case 11:t.next=22;break;case 13:return f=ce(i)?document.getElementById(i):i,v=DN(f),this.emit($c.BEFORE_CANVAS_INIT,{container:f,width:a,height:o}),p=Object.assign(Object.assign({},l),{container:f,width:a||v[0],height:o||v[1],background:c,renderer:s,cursor:u,devicePixelRatio:d}),g=new PN(p),this.context.canvas=g,t.next=21,g.ready;case 21:this.emit($c.AFTER_CANVAS_INIT,{canvas:g});case 22:case"end":return t.stop()}}),t,this)})))}},{key:"updateCanvas",value:function(t){var e,n,r=t.renderer,i=t.cursor,a=t.height,o=t.width,s=this.context.canvas;s&&(r&&(this.emit($c.BEFORE_RENDERER_CHANGE,{renderer:this.options.renderer}),s.setRenderer(r),this.emit($c.AFTER_RENDERER_CHANGE,{renderer:r})),i&&s.setCursor(i),(oe(o)||oe(a))&&this.setSize(null!==(e=null!=o?o:this.options.width)&&void 0!==e?e:0,null!==(n=null!=a?a:this.options.height)&&void 0!==n?n:0))}},{key:"initRuntime",value:function(){this.context.options=this.options,this.context.batch||(this.context.batch=new UN(this.context)),this.context.plugin||(this.context.plugin=new PA(this.context)),this.context.viewport||(this.context.viewport=new DA(this.context)),this.context.transform||(this.context.transform=new RA(this.context)),this.context.element||(this.context.element=new rA(this.context)),this.context.animation||(this.context.animation=new YN(this.context)),this.context.layout||(this.context.layout=new NA(this.context)),this.context.behavior||(this.context.behavior=new qN(this.context))}},{key:"prepare",value:function(){return _A(this,void 0,void 0,Tn().mark((function t(){return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:if(!this.destroyed){t.next=4;break}throw new Error(cl("The graph instance has been destroyed"));case 4:return t.next=6,this.initCanvas();case 6:this.initRuntime();case 7:case"end":return t.stop()}}),t,this)})))}},{key:"render",value:function(){return _A(this,void 0,void 0,Tn().mark((function t(){var e,n,r;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.prepare();case 2:if(zN(this,new IN($c.BEFORE_RENDER)),this.options.layout){t.next=9;break}return e=this.context.element.draw({type:"render"}),t.next=7,Promise.all([null==e?void 0:e.finished,this.autoFit()]);case 7:t.next=22;break;case 9:if(this.rendered||(i=this.options.layout,Array.isArray(i)||!(null==i?void 0:i.preLayout))){t.next=17;break}return t.next=12,this.context.element.preLayoutDraw({type:"render"});case 12:return n=t.sent,t.next=15,Promise.all([null==n?void 0:n.finished,this.autoFit()]);case 15:t.next=22;break;case 17:return r=this.context.element.draw({type:"render"}),t.next=20,Promise.all([null==r?void 0:r.finished,this.context.layout.postLayout()]);case 20:return t.next=22,this.autoFit();case 22:this.rendered=!0,zN(this,new IN($c.AFTER_RENDER));case 24:case"end":return t.stop()}var i}),t,this)})))}},{key:"draw",value:function(){return _A(this,void 0,void 0,Tn().mark((function t(){var e;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.prepare();case 2:return t.next=4,null===(e=this.context.element.draw())||void 0===e?void 0:e.finished;case 4:case"end":return t.stop()}}),t,this)})))}},{key:"layout",value:function(t){return _A(this,void 0,void 0,Tn().mark((function e(){return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.context.layout.postLayout(t);case 2:case"end":return e.stop()}}),e,this)})))}},{key:"stopLayout",value:function(){this.context.layout.stopLayout()}},{key:"clear",value:function(){return _A(this,void 0,void 0,Tn().mark((function t(){var e,n,r;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.context,n=e.model,r=e.element,n.setData({}),n.clearChanges(),null==r||r.clear();case 4:case"end":return t.stop()}}),t,this)})))}},{key:"destroy",value:function(){var t;zN(this,new IN($c.BEFORE_DESTROY));var e=this.context,n=e.layout,r=e.animation,i=e.element,a=e.model,o=e.canvas,s=e.behavior,u=e.plugin;null==u||u.destroy(),null==s||s.destroy(),null==n||n.destroy(),null==r||r.destroy(),null==i||i.destroy(),a.destroy(),null==o||o.destroy(),this.options={},this.context={},this.off(),null===(t=globalThis.removeEventListener)||void 0===t||t.call(globalThis,"resize",this.onResize),this.destroyed=!0,zN(this,new IN($c.AFTER_DESTROY))}},{key:"getCanvas",value:function(){return this.context.canvas}},{key:"resize",value:function(t,e){var n,r,i=DN(null===(r=this.context.canvas)||void 0===r?void 0:r.getContainer()),a=[t||i[0],e||i[1]];if(this.context.canvas){var o=this.context.canvas.getSize();Vc(a,o)||(zN(this,new IN($c.BEFORE_SIZE_CHANGE,{size:a})),(n=this.context.canvas).resize.apply(n,a),zN(this,new IN($c.AFTER_SIZE_CHANGE,{size:a})))}}},{key:"fitView",value:function(t,e){return _A(this,void 0,void 0,Tn().mark((function n(){var r;return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,null===(r=this.context.viewport)||void 0===r?void 0:r.fitView(t,e);case 2:case"end":return n.stop()}}),n,this)})))}},{key:"fitCenter",value:function(t){return _A(this,void 0,void 0,Tn().mark((function e(){var n;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=this.context.viewport)||void 0===n?void 0:n.fitCenter({animation:t});case 2:case"end":return e.stop()}}),e,this)})))}},{key:"autoFit",value:function(){return _A(this,void 0,void 0,Tn().mark((function t(){var e,n,r;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.context.options.autoFit){t.next=3;break}return t.abrupt("return");case 3:if(!ce(e)){t.next=14;break}if("view"!==e){t.next=9;break}return t.next=7,this.fitView();case 7:t.next=12;break;case 9:if("center"!==e){t.next=12;break}return t.next=12,this.fitCenter();case 12:case 18:t.next=23;break;case 14:if(n=e.type,r=e.animation,"view"!==n){t.next=20;break}return t.next=18,this.fitView(e.options,r);case 20:if("center"!==n){t.next=23;break}return t.next=23,this.fitCenter(r);case 23:case"end":return t.stop()}}),t,this)})))}},{key:"focusElement",value:function(t,e){return _A(this,void 0,void 0,Tn().mark((function n(){var r;return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,null===(r=this.context.viewport)||void 0===r?void 0:r.focusElements(Array.isArray(t)?t:[t],{animation:e});case 2:case"end":return n.stop()}}),n,this)})))}},{key:"zoomBy",value:function(t,e,n){return _A(this,void 0,void 0,Tn().mark((function r(){return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.context.viewport.transform({mode:"relative",scale:t,origin:n},e);case 2:case"end":return r.stop()}}),r,this)})))}},{key:"zoomTo",value:function(t,e,n){return _A(this,void 0,void 0,Tn().mark((function r(){return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:this.context.viewport.transform({mode:"absolute",scale:t,origin:n},e);case 1:case"end":return r.stop()}}),r,this)})))}},{key:"getZoom",value:function(){return this.context.viewport.getZoom()}},{key:"rotateBy",value:function(t,e,n){return _A(this,void 0,void 0,Tn().mark((function r(){return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.context.viewport.transform({mode:"relative",rotate:t,origin:n},e);case 2:case"end":return r.stop()}}),r,this)})))}},{key:"rotateTo",value:function(t,e,n){return _A(this,void 0,void 0,Tn().mark((function r(){return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.context.viewport.transform({mode:"absolute",rotate:t,origin:n},e);case 2:case"end":return r.stop()}}),r,this)})))}},{key:"getRotation",value:function(){return this.context.viewport.getRotation()}},{key:"translateBy",value:function(t,e){return _A(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.context.viewport.transform({mode:"relative",translate:t},e);case 2:case"end":return n.stop()}}),n,this)})))}},{key:"translateTo",value:function(t,e){return _A(this,void 0,void 0,Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.context.viewport.transform({mode:"absolute",translate:t},e);case 2:case"end":return n.stop()}}),n,this)})))}},{key:"getPosition",value:function(){return zh([0,0],this.getCanvasByViewport([0,0]))}},{key:"translateElementBy",value:function(t,e){return _A(this,arguments,void 0,(function(t,e){var n=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return Tn().mark((function i(){var a,o,s,u,c,l;return Tn().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return s=ln(t)?[t,null===(a=e)||void 0===a||a]:[v({},t,e),r],u=h(s,2),c=u[0],l=u[1],Object.entries(c).forEach((function(t){var e=h(t,2),r=e[0],i=e[1];return n.context.model.translateNodeLikeBy(r,i)})),i.next=4,null===(o=n.context.element.draw({animation:l,stage:"translate"}))||void 0===o?void 0:o.finished;case 4:case"end":return i.stop()}}),i)}))()}))}},{key:"translateElementTo",value:function(t,e){return _A(this,arguments,void 0,(function(t,e){var n=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return Tn().mark((function i(){var a,o,s,u,c,l;return Tn().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return s=ln(t)?[t,null===(a=e)||void 0===a||a]:[v({},t,e),r],u=h(s,2),c=u[0],l=u[1],Object.entries(c).forEach((function(t){var e=h(t,2),r=e[0],i=e[1];return n.context.model.translateNodeLikeTo(r,i)})),i.next=4,null===(o=n.context.element.draw({animation:l,stage:"translate"}))||void 0===o?void 0:o.finished;case 4:case"end":return i.stop()}}),i)}))()}))}},{key:"getElementPosition",value:function(t){return this.context.model.getElementPosition(t)}},{key:"getElementRenderStyle",value:function(t){return pw(this.context.element.getElement(t).attributes,["context"])}},{key:"setElementVisibility",value:function(t,e){return _A(this,arguments,void 0,(function(t,e){var n=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return Tn().mark((function i(){var a,o,s,u,c,l,d,f,p,g;return Tn().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return s=ln(t)?[t,null===(a=e)||void 0===a||a]:[v({},t,e),r],u=h(s,2),c=u[0],l=u[1],d={nodes:[],edges:[],combos:[]},Object.entries(c).forEach((function(t){var e=h(t,2),r=e[0],i=e[1],a=n.getElementType(r);d["".concat(a,"s")].push({id:r,style:{visibility:i}})})),f=n.context,p=f.model,g=f.element,p.preventUpdateNodeLikeHierarchy((function(){p.updateData(d)})),i.next=7,null===(o=g.draw({animation:l,stage:"visibility"}))||void 0===o?void 0:o.finished;case 7:case"end":return i.stop()}}),i)}))()}))}},{key:"showElement",value:function(t,e){return _A(this,void 0,void 0,Tn().mark((function n(){var r;return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=Array.isArray(t)?t:[t],n.next=3,this.setElementVisibility(Object.fromEntries(r.map((function(t){return[t,"visible"]}))),e);case 3:case"end":return n.stop()}}),n,this)})))}},{key:"hideElement",value:function(t,e){return _A(this,void 0,void 0,Tn().mark((function n(){var r;return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=Array.isArray(t)?t:[t],n.next=3,this.setElementVisibility(Object.fromEntries(r.map((function(t){return[t,"hidden"]}))),e);case 3:case"end":return n.stop()}}),n,this)})))}},{key:"getElementVisibility",value:function(t){var e,n,r=this.context.element.getElement(t);return null!==(n=null===(e=null==r?void 0:r.style)||void 0===e?void 0:e.visibility)&&void 0!==n?n:"visible"}},{key:"setElementZIndex",value:function(t,e){return _A(this,void 0,void 0,Tn().mark((function n(){var r,i,a,o,s,u,c=this;return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i={nodes:[],edges:[],combos:[]},a=ln(t)?t:v({},t,e),Object.entries(a).forEach((function(t){var e=h(t,2),n=e[0],r=e[1],a=c.getElementType(n);i["".concat(a,"s")].push({id:n,style:{zIndex:r}})})),o=this.context,s=o.model,u=o.element,s.preventUpdateNodeLikeHierarchy((function(){return s.updateData(i)})),n.next=7,null===(r=u.draw({animation:!1,stage:"zIndex"}))||void 0===r?void 0:r.finished;case 7:case"end":return n.stop()}}),n,this)})))}},{key:"frontElement",value:function(t){return _A(this,void 0,void 0,Tn().mark((function e(){var n,r,i,a=this;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Array.isArray(t)?t:[t],r=this.context.model,i={},n.map((function(t){var e=r.getFrontZIndex(t);if("combo"===r.getElementType(t)){var n=r.getAncestorsData(t,nl).at(-1)||a.getComboData(t),o=[n].concat(w(r.getDescendantsData(yh(n)))),s=e-GN(n);o.forEach((function(t){i[yh(t)]=a.getElementZIndex(yh(t))+s}));var u=Cp(o.map(yh),(function(t){return r.getRelatedEdgesData(t)}));u.internal.forEach((function(t){var e=yh(t);i[e]=a.getElementZIndex(e)+s}))}else i[t]=e})),e.next=6,this.setElementZIndex(i);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"getElementZIndex",value:function(t){return GN(this.context.model.getElementDataById(t))}},{key:"setElementState",value:function(t,e){return _A(this,arguments,void 0,(function(t,e){var n=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return Tn().mark((function i(){var a,o,s,u,c,l,d,f;return Tn().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return s=ln(t)?[t,null===(a=e)||void 0===a||a]:[v({},t,e),r],u=h(s,2),c=u[0],l=u[1],d=function(t){return t?Array.isArray(t)?t:[t]:[]},f={nodes:[],edges:[],combos:[]},Object.entries(c).forEach((function(t){var e=h(t,2),r=e[0],i=e[1],a=n.getElementType(r);f["".concat(a,"s")].push({id:r,states:d(i)})})),n.updateData(f),i.next=7,null===(o=n.context.element.draw({animation:l,stage:"state"}))||void 0===o?void 0:o.finished;case 7:case"end":return i.stop()}}),i)}))()}))}},{key:"getElementState",value:function(t){return this.context.model.getElementState(t)}},{key:"getElementRenderBounds",value:function(t){return this.context.element.getElement(t).getRenderBounds()}},{key:"collapseElement",value:function(t){return _A(this,arguments,void 0,(function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Tn().mark((function r(){var i,a,o,s;return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=e.context,a=i.model,o=i.element,!Td(a.getNodeLikeData([t])[0])){r.next=3;break}return r.abrupt("return");case 3:if(!e.isCollapsingExpanding){r.next=5;break}return r.abrupt("return");case 5:return"boolean"==typeof n&&(n={animation:n,align:!0}),s=a.getElementType(t),r.next=9,e.frontElement(t);case 9:if(e.isCollapsingExpanding=!0,e.setElementCollapsibility(t,!0),"node"!==s){r.next=16;break}return r.next=14,o.collapseNode(t,n);case 14:r.next=19;break;case 16:if("combo"!==s){r.next=19;break}return r.next=19,o.collapseCombo(t,!!n.animation);case 19:e.isCollapsingExpanding=!1;case 20:case"end":return r.stop()}}),r)}))()}))}},{key:"expandElement",value:function(t){return _A(this,arguments,void 0,(function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Tn().mark((function r(){var i,a,o,s;return Tn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=e.context,a=i.model,o=i.element,Td(a.getNodeLikeData([t])[0])){r.next=3;break}return r.abrupt("return");case 3:if(!e.isCollapsingExpanding){r.next=5;break}return r.abrupt("return");case 5:if("boolean"==typeof n&&(n={animation:n,align:!0}),s=a.getElementType(t),e.isCollapsingExpanding=!0,e.setElementCollapsibility(t,!1),"node"!==s){r.next=14;break}return r.next=12,o.expandNode(t,n);case 12:r.next=17;break;case 14:if("combo"!==s){r.next=17;break}return r.next=17,o.expandCombo(t,!!n.animation);case 17:e.isCollapsingExpanding=!1;case 18:case"end":return r.stop()}}),r)}))()}))}},{key:"setElementCollapsibility",value:function(t,e){var n=this.getElementType(t);"node"===n?this.updateNodeData([{id:t,style:{collapsed:e}}]):"combo"===n&&this.updateComboData([{id:t,style:{collapsed:e}}])}},{key:"toDataURL",value:function(){return _A(this,arguments,void 0,(function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Tn().mark((function n(){return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.context.canvas.toDataURL(e));case 1:case"end":return n.stop()}}),n)}))()}))}},{key:"getCanvasByViewport",value:function(t){return this.context.canvas.getCanvasByViewport(t)}},{key:"getViewportByCanvas",value:function(t){return this.context.canvas.getViewportByCanvas(t)}},{key:"getClientByCanvas",value:function(t){return this.context.canvas.getClientByCanvas(t)}},{key:"getCanvasByClient",value:function(t){return this.context.canvas.getCanvasByClient(t)}},{key:"getViewportCenter",value:function(){return this.context.viewport.getViewportCenter()}},{key:"getCanvasCenter",value:function(){return this.context.viewport.getCanvasCenter()}},{key:"on",value:function(t,n,r){return dn(e,"on",this,3)([t,n,r])}},{key:"once",value:function(t,n){return dn(e,"once",this,3)([t,n])}},{key:"off",value:function(t,n){return dn(e,"off",this,3)([t,n])}}])}(Pg);IA.defaultOptions={autoResize:!1,theme:"light",rotation:0,zoom:1,zoomRange:[.01,10]};var jA=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function FA(t,e){var n=e||{},r=n.getNodeData,i=void 0===r?function(t,e){if(t.depth=e,!t.children)return t;var n=t.children,r=jA(t,["children"]);return Object.assign(Object.assign({},r),{children:n.map((function(t){return t.id}))})}:r,a=n.getEdgeData,o=void 0===a?function(t,e){return{source:t.id,target:e.id}}:a,s=n.getChildren,u=void 0===s?function(t){return t.children||[]}:s,c=[],l=[];return kd(t,(function(t,e){c.push(i(t,e));var n,r=Rn(u(t));try{for(r.s();!(n=r.n()).done;){var a=n.value;l.push(o(t,a))}}catch(t){r.e(t)}finally{r.f()}}),(function(t){return u(t)}),"TB"),{nodes:c,edges:l}}var BA=function(t){function e(){return y(this,e),S(this,e,arguments)}return N(e,t),b(e,[{key:"beforeDraw",value:function(t){var e=t.add,n=t.update,r=this.context.model;return[].concat(w(e.edges.entries()),w(n.edges.entries())).forEach((function(t){var e=h(t,2)[1];zA(r,e)})),t}}])}(fN),zA=function(t,e){var n=e.source,r=e.target,i=t.getElementDataById(n),a=t.getElementDataById(r),o=Rp(i,(function(e){return t.getParentData(e,nl)})),s=Rp(a,(function(e){return t.getParentData(e,nl)})),u={sourceNode:yh(o),targetNode:yh(s)};return e.style?Object.assign(e.style,u):e.style=u,e},GA=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,jh({},e.defaultOptions,n)])).assignSizeByCentrality=function(t,e,n,r,i,a){var o=[e,n],s=[r[0],i[0]],u=[r[1],i[1]],c=[r[2],i[2]],l=function(t,e){if("function"==typeof a)return a(t,o,e);switch(a){case"linear":return function(t,e,n){var r=h(e,2),i=r[0],a=r[1],o=h(n,2),s=o[0],u=o[1];return a===i?s:s+(t-i)/(a-i)*(u-s)}(t,o,e);case"log":return function(t,e,n){var r=h(e,2),i=r[0],a=r[1],o=h(n,2),s=o[0],u=o[1];return s+Math.log(t-i+1)/Math.log(a-i+1)*(u-s)}(t,o,e);case"pow":return function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=h(e,2),a=i[0],o=i[1],s=h(n,2),u=s[0],c=s[1];return u+Math.pow((t-a)/(o-a),r)*(c-u)}(t,o,e,2);case"sqrt":return function(t,e,n){var r=h(e,2),i=r[0],a=r[1],o=h(n,2),s=o[0],u=o[1];return s+Math.sqrt((t-i)/(a-i))*(u-s)}(t,o,e);default:return e[0]}};return[l(t,s),l(t,u),l(t,c)]},r}return N(e,t),b(e,[{key:"beforeDraw",value:function(t){var e=this,n=this.context.model.getNodeData(),r=jd(this.options.maxSize),i=jd(this.options.minSize),a=this.getCentralities(this.options.centrality),o=a.size>0?Math.max.apply(Math,w(a.values())):0,s=a.size>0?Math.min.apply(Math,w(a.values())):0;return n.forEach((function(n){var u,c=e.assignSizeByCentrality(a.get(yh(n))||0,s,o,i,r,e.options.scale),l=null===(u=e.context.element)||void 0===u?void 0:u.getElement(yh(n)),h={size:c};e.assignLabelStyle(h,c,n,l),l&&gN(h,l.attributes)||pN(t,l?"update":"add","node",jh(n,{style:h}),!0)})),t}},{key:"assignLabelStyle",value:function(t,e,n,r){var i,a=r?r.config.style:null===(i=this.context.element)||void 0===i?void 0:i.getElementComputedStyle("node",n);if(Object.assign(t,ep(a,["labelFontSize","labelLineHeight"])),this.options.mapLabelSize){var o=this.getLabelSizeByNodeSize(e,1/0,Number(t.labelFontSize));Object.assign(t,{labelFontSize:o,labelLineHeight:o+Rl(t.labelPadding)})}return t}},{key:"getLabelSizeByNodeSize",value:function(t,e,n){var r=Math.min.apply(Math,w(t))/2,i=h(Array.isArray(this.options.mapLabelSize)?this.options.mapLabelSize:[n,e],2),a=i[0],o=i[1];return Math.min(o,Math.max(r,a))}},{key:"getCentralities",value:function(t){var e=this.context.model,n=e.getData();if("function"==typeof t)return t(n);var r=e.getRelatedEdgesData.bind(e);return xh(n,r,t)}}])}(fN);GA.defaultOptions={centrality:{type:"degree"},maxSize:80,minSize:20,scale:"linear",mapLabelSize:!1};var VA=function(t){function e(t,n){return y(this,e),S(this,e,[t,Object.assign({},e.defaultOptions,n)])}return N(e,t),b(e,[{key:"ref",get:function(){return this.context.model.getRootsData()[0]}},{key:"afterLayout",value:function(){var t,e=this,n=ed(this.ref),r=this.context,i=r.graph,a=r.model;null===(t=a.getData().nodes)||void 0===t||t.forEach((function(t){var r;if(yh(t)!==yh(e.ref)){var o=Zh(zh(ed(t),n)),s=Math.abs(o)>Math.PI/2,u=!t.children||0===t.children.length,c=yh(t),l=null===(r=e.context.element)||void 0===r?void 0:r.getElement(c);if(l&&l.isVisible()){var h=(u?1:-1)*(jd(i.getElementRenderStyle(c).size)[0]/2+e.options.offset),d=[["translate",h*Math.cos(o),h*Math.sin(o)],["rotate",s?ir(o)+180:ir(o)]];a.updateNodeData([{id:yh(t),style:{labelTextAlign:s===u?"right":"left",labelTextBaseline:"middle",labelTransform:d}}])}}})),i.draw()}}])}(fN);VA.defaultOptions={offset:5};var WA=["top","top-right","right","right-bottom","bottom","bottom-left","left","left-top"],HA=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).cacheMergeStyle=new Map,r.getAffectedParallelEdges=function(t){var e=t.add.edges,n=t.update,i=n.nodes,a=n.edges,o=n.combos,s=t.remove.edges,u=r.context.model,c=new Map,l=function(t,e){u.getRelatedEdgesData(e).forEach((function(t){return!c.has(yh(t))&&c.set(yh(t),t)}))};i.forEach(l),o.forEach(l);var h=function(t){var e=u.getEdgeData().map((function(t){return zA(u,t)}));UA(t,e,!0).forEach((function(t){return!c.has(yh(t))&&c.set(yh(t),t)}))};if(s.size&&s.forEach(h),e.size&&e.forEach(h),a.size){var d=kE(EE(u.getChanges())).update.edges;a.forEach((function(t){var e;h(t);var n=null===(e=d.find((function(e){return yh(e.value)===yh(t)})))||void 0===e?void 0:e.original;n&&!qA(t,n)&&h(n)}))}qd(r.options.edges)||c.forEach((function(t,e){return!r.options.edges.includes(e)&&c.delete(e)}));var f=u.getEdgeData().map(yh);return new Map(w(c).sort((function(t,e){return f.indexOf(t[0])-f.indexOf(e[0])})))},r.applyBundlingStyle=function(t,e,n){var i=YA(e),a=i.edgeMap,o=i.reverses;a.forEach((function(e){e.forEach((function(e,i,a){var s,u=a.length,c=e.style||{};if(e.source===e.target){var l=WA.length;c.loopPlacement=WA[i%l],c.loopDist=Math.floor(i/l)*n+50}else if(1===u)c.curveOffset=0;else{var h=(i%2==0?1:-1)*(o["".concat(e.source,"|").concat(e.target,"|").concat(i)]?-1:1);c.curveOffset=u%2==1?h*Math.ceil(i/2)*n*2:h*(Math.floor(i/2)*n*2+n)}var d=Object.assign(e,{type:"quadratic",style:c}),f=null===(s=r.context.element)||void 0===s?void 0:s.getElement(yh(e));f&&gN(d.style,f.attributes)||pN(t,f?"update":"add","edge",d,!0)}))}))},r.resetEdgeStyle=function(t){var e=t.style||{},n=r.cacheMergeStyle.get(yh(t))||{};return Object.keys(n).forEach((function(r){Vc(e[r],n[r])&&(t[r]?e[r]=t[r]:delete e[r])})),Object.assign(t,{style:e})},r.applyMergingStyle=function(t,e){var n=YA(e),i=n.edgeMap,a=n.reverses;i.forEach((function(e){var n;if(1!==e.length){var i=e.map((function(t,e){var n=t.source,r=t.target,i=t.style,o=void 0===i?{}:i,s=o.startArrow,u=o.endArrow,c={},l=h(a["".concat(n,"|").concat(r,"|").concat(e)]?["endArrow","startArrow"]:["startArrow","endArrow"],2),d=l[0],f=l[1];return un(s)&&(c[d]=s),un(u)&&(c[f]=u),c})).reduce((function(t,e){return Object.assign(Object.assign({},t),e)}),{});e.forEach((function(e,n,a){var o;if(0===n){var s=Object.assign({},cn(r.options.style)?r.options.style(a):r.options.style,{childrenData:a});r.cacheMergeStyle.set(yh(e),s);var u=Object.assign(Object.assign({},e),{type:"line",style:Object.assign(Object.assign(Object.assign({},e.style),i),s)}),c=null===(o=r.context.element)||void 0===o?void 0:o.getElement(yh(e));c&&gN(u.style,c.attributes)||pN(t,c?"update":"add","edge",u,!0)}else pN(t,"remove","edge",e)}))}else{var o=e[0],s=null===(n=r.context.element)||void 0===n?void 0:n.getElement(yh(o)),u=r.resetEdgeStyle(o);s&&gN(u,s.attributes)||pN(t,s?"update":"add","edge",u)}}))},r}return N(e,t),b(e,[{key:"beforeDraw",value:function(t){var e=this.getAffectedParallelEdges(t);return 0===e.size||("bundle"===this.options.mode?this.applyBundlingStyle(t,e,this.options.distance):this.applyMergingStyle(t,e)),t}}])}(fN);HA.defaultOptions={mode:"bundle",distance:15};var YA=function(t){var e,n=new Map,r=new Set,i={},a=Rn(t);try{for(a.s();!(e=a.n()).done;){var o=h(e.value,2),s=o[0],u=o[1];if(!r.has(s)){var c=u.source,l=u.target,d="".concat(c,"-").concat(l);n.has(d)||n.set(d,[]),n.get(d).push(u),r.add(s);var f,v=Rn(t);try{for(v.s();!(f=v.n()).done;){var p=h(f.value,2),g=p[0],y=p[1];r.has(g)||qA(u,y)&&(n.get(d).push(y),r.add(g),c===y.target&&l===y.source&&(i["".concat(y.source,"|").concat(y.target,"|").concat(n.get(d).length-1)]=!0))}}catch(t){v.e(t)}finally{v.f()}}}}catch(t){a.e(t)}finally{a.f()}return{edgeMap:n,reverses:i}},UA=function(t,e,n){return e.filter((function(e){return(n||yh(e)!==yh(t))&&qA(e,t)}))},qA=function(t,e){var n=t.style||{},r=n.sourceNode,i=n.targetNode,a=e.style||{},o=a.sourceNode,s=a.targetNode;return r===o&&i===s||r===s&&i===o},XA=function(t){function e(){return y(this,e),S(this,e,arguments)}return N(e,t),b(e,[{key:"beforeDraw",value:function(t,e){if("visibility"===e.stage)return t;var n=this.context.model,r=t.update,i=r.nodes,a=r.edges,o=r.combos,s=function(t,e){n.getRelatedEdgesData(e).forEach((function(t){return!a.has(yh(t))&&a.set(yh(t),t)}))};return i.forEach(s),o.forEach(s),t}}])}(fN),KA={animation:{"combo-collapse":El,"combo-expand":kl,"node-collapse":ml,"node-expand":bl,"path-in":xl,"path-out":wl,fade:[{fields:["opacity"]}],translate:[{fields:["x","y"]}]},behavior:{"brush-select":bd,"click-select":Ad,"collapse-expand":xg,"create-edge":Mg,"drag-canvas":Ng,"drag-element-force":Gg,"drag-element":Tg,"fix-element-size":Wg,"focus-element":Hg,"hover-activate":Yg,"lasso-select":Ug,"auto-adapt-label":Lh,"optimize-viewport-transform":qg,"scroll-canvas":Kg,"zoom-canvas":Zg},combo:{circle:lp,rect:hp},edge:{cubic:Vp,line:Up,polyline:ng,quadratic:rg,"cubic-horizontal":Wp,"cubic-radial":Hp,"cubic-vertical":Yp},layout:{"antv-dagre":Bm,"combo-combined":Bb,"compact-box":Qg.compactBox,"d3-force":Nx,"force-atlas2":Ix,circular:Wm,concentric:Km,dagre:Cx,dendrogram:Qg.dendrogram,fishbone:cw,force:yb,fruchterman:Fx,grid:zx,indented:Qg.indented,mds:Lb,mindmap:Qg.mindmap,radial:Jx,random:ow,snake:fw},node:{circle:ff,diamond:pf,ellipse:bf,hexagon:xf,html:np,image:ip,rect:ap,star:op,donut:gf,triangle:sp},palette:{spectral:["rgb(158, 1, 66)","rgb(213, 62, 79)","rgb(244, 109, 67)","rgb(253, 174, 97)","rgb(254, 224, 139)","rgb(255, 255, 191)","rgb(230, 245, 152)","rgb(171, 221, 164)","rgb(102, 194, 165)","rgb(50, 136, 189)","rgb(94, 79, 162)"],tableau:["rgb(78, 121, 167)","rgb(242, 142, 44)","rgb(225, 87, 89)","rgb(118, 183, 178)","rgb(89, 161, 79)","rgb(237, 201, 73)","rgb(175, 122, 161)","rgb(255, 157, 167)","rgb(156, 117, 95)","rgb(186, 176, 171)"],oranges:["rgb(255, 245, 235)","rgb(254, 230, 206)","rgb(253, 208, 162)","rgb(253, 174, 107)","rgb(253, 141, 60)","rgb(241, 105, 19)","rgb(217, 72, 1)","rgb(166, 54, 3)","rgb(127, 39, 4)"],greens:["rgb(247, 252, 245)","rgb(229, 245, 224)","rgb(199, 233, 192)","rgb(161, 217, 155)","rgb(116, 196, 118)","rgb(65, 171, 93)","rgb(35, 139, 69)","rgb(0, 109, 44)","rgb(0, 68, 27)"],blues:["rgb(247, 251, 255)","rgb(222, 235, 247)","rgb(198, 219, 239)","rgb(158, 202, 225)","rgb(107, 174, 214)","rgb(66, 146, 198)","rgb(33, 113, 181)","rgb(8, 81, 156)","rgb(8, 48, 107)"]},theme:{dark:hN,light:dN},plugin:{"bubble-sets":eE,"edge-bundling":uE,"edge-filter-lens":yE,"grid-line":wE,background:bw,contextmenu:sE,fisheye:bE,fullscreen:xE,history:OE,hull:PE,legend:Vk,minimap:Wk,snapline:Xk,timebar:BO,toolbar:YO,tooltip:JO,watermark:oN},transform:{"arrange-draw-order":vN,"collapse-expand-combo":yN,"collapse-expand-node":bN,"get-edge-actual-ends":BA,"map-node-size":GA,"place-radial-labels":VA,"process-parallel-edges":HA,"update-related-edges":XA},shape:{circle:lu,ellipse:fu,group:vu,html:gu,image:rf,line:bu,path:wu,polygon:ku,polyline:Su,rect:Ou,text:Au,label:Zd,badge:Qd}};Object.entries(KA).forEach((function(t){var e=h(t,2),n=e[0],r=e[1];Object.entries(r).forEach((function(t){var e=h(t,2),r=e[0],i=e[1];kN(n,r,i)}))}));var $A,ZA={css:"//at.alicdn.com/t/a/font_470089_8hnbbf8n4u8.css",js:"//at.alicdn.com/t/a/font_470089_8hnbbf8n4u8.js"},QA=a(6003),JA=function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},tT=Object.assign({},QA),eT=tT.version,nT=tT.render,rT=tT.unmountComponentAtNode;try{Number((eT||"").split(".")[0])>=18&&tT.createRoot&&($A=tT.createRoot)}catch(t){}function iT(t){var e=tT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;e&&"object"==typeof e&&(e.usingClientEntryPoint=t)}var aT="__rc_react_root__";function oT(t,e){$A?function(t,e){iT(!0);var n=e[aT]||$A(e);iT(!1),n.render(t),e[aT]=n}(t,e):function(t,e){nT(t,e)}(t,e)}function sT(t){return JA(this,void 0,void 0,Tn().mark((function e(){return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve().then((function(){var e;null===(e=t[aT])||void 0===e||e.unmount(),delete t[aT]})));case 1:case"end":return e.stop()}}),e)})))}function uT(t){rT(t)}var cT=function(t){function e(t){return y(this,e),S(this,e,[t])}return N(e,t),b(e,[{key:"getKeyStyle",value:function(t){return Object.assign({},dn(e,"getKeyStyle",this,3)([t]))}},{key:"update",value:function(t){dn(e,"update",this,3)([t])}},{key:"connectedCallback",value:function(){dn(e,"connectedCallback",this,3)([]),oT(this.attributes.component,this.getDomElement())}},{key:"attributeChangedCallback",value:function(t,n,r){dn(e,"attributeChangedCallback",this,3)([t,n,r]),"component"===t&&n!==r&&oT(this.attributes.component,this.getDomElement())}},{key:"destroy",value:function(){!function(t){JA(this,void 0,void 0,Tn().mark((function e(){return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!$A){e.next=2;break}return e.abrupt("return",sT(t));case 2:uT(t);case 3:case"end":return e.stop()}}),e)})))}(this.getDomElement()),dn(e,"destroy",this,3)([])}}])}(np),lT=function(t){function e(){return y(this,e),S(this,e,arguments)}return N(e,t),b(e,[{key:"getActiveIds",value:function(t){var e=this.context,n=e.model,r=e.graph,i=t.target.id,a=r.getElementType(i),o=[i];if("edge"===a){var s=n.getEdgeDatum(i);this.collectChainNodes(s.source,"in",o),this.collectChainNodes(s.target,"out",o)}else"node"===a&&this.collectChainNodes(i,"both",o);return r.frontElement(o),o}},{key:"collectChainNodes",value:function(t,e,n){var r=this;this.context.model.getRelatedEdgesData(t,e).forEach((function(t){n.includes(yh(t))||n.push(yh(t)),n.includes(t.source)||(n.push(t.source),r.collectChainNodes(t.source,"in",n)),n.includes(t.target)||(n.push(t.target),r.collectChainNodes(t.target,"out",n))}))}}])}(Yg),hT=function(t){function e(){return y(this,e),S(this,e,arguments)}return N(e,t),b(e,[{key:"getActiveIds",value:function(t){var e=this.context,n=e.model,r=e.graph,i=t.target.id,a=r.getElementType(i),o=[i];if("edge"===a){var s=n.getEdgeDatum(i);o.push(s.source,s.target)}else"node"===a&&o.push.apply(o,w(n.getRelatedEdgesData(i).map(yh)));return r.frontElement(o),o}}])}(Yg),dT=function(t){function e(){return y(this,e),S(this,e,arguments)}return N(e,t),b(e,[{key:"getControlPoints",value:function(t){var e=h(this.getEndpoints(t,!1),2),n=e[0],r=e[1];return[[h(n,1)[0],h(r,2)[1]]]}}])}(ng),fT=function(t){function e(){return y(this,e),S(this,e,arguments)}return N(e,t),b(e,[{key:"beforeDraw",value:function(t){var e=this.context.model.getData(),n=e.nodes,r=e.edges,i=n.filter((function(t){return 1===t.depth})),a=i.map((function(t){return t.id}));return r.forEach((function(t){a.includes(t.target)&&(t.style||(t.style={}),t.style.zIndex=i.length-i.findIndex((function(e){return e.id===t.target})))})),t}}])}(fN),vT=function(t){function e(t,n){return y(this,e),S(this,e,[t,Object.assign({},e.defaultOptions,n)])}return N(e,t),b(e,[{key:"beforeDraw",value:function(t){var e=this,n=this.context.model.getNodeData();if(0===n.length)return t;var r=0,i=function(t,a){var o,s=n.find((function(e){return e.id==t}));s&&(s.style||(s.style={}),s.style.color=a||e.options.colors[r++%e.options.colors.length],null===(o=s.children)||void 0===o||o.forEach((function(t){var e;return i(t,null===(e=s.style)||void 0===e?void 0:e.color)})))};return n.filter((function(t){return 1===t.depth})).forEach((function(t){return i(t.id)})),t}}])}(fN);vT.defaultOptions={colors:["#1783FF","#F08F56","#D580FF","#00C9C9","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]};var pT=a(9276),gT=a(5442),yT=a.n(gT);function mT(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var bT=a(6278),xT=a.n(bT),wT="-ms-",ET="-moz-",kT="-webkit-",MT="comm",ST="rule",OT="decl",NT="@keyframes",AT=Math.abs,TT=String.fromCharCode,PT=Object.assign;function CT(t){return t.trim()}function RT(t,e){return(t=e.exec(t))?t[0]:t}function LT(t,e,n){return t.replace(e,n)}function DT(t,e,n){return t.indexOf(e,n)}function _T(t,e){return 0|t.charCodeAt(e)}function IT(t,e,n){return t.slice(e,n)}function jT(t){return t.length}function FT(t){return t.length}function BT(t,e){return e.push(t),t}function zT(t,e){return t.filter((function(t){return!RT(t,e)}))}var GT=1,VT=1,WT=0,HT=0,YT=0,UT="";function qT(t,e,n,r,i,a,o,s){return{value:t,root:e,parent:n,type:r,props:i,children:a,line:GT,column:VT,length:o,return:"",siblings:s}}function XT(t,e){return PT(qT("",null,null,"",null,null,0,t.siblings),t,{length:-t.length},e)}function KT(t){for(;t.root;)t=XT(t.root,{children:[t]});BT(t,t.siblings)}function $T(){return YT=HT>0?_T(UT,--HT):0,VT--,10===YT&&(VT=1,GT--),YT}function ZT(){return YT=HT<WT?_T(UT,HT++):0,VT++,10===YT&&(VT=1,GT++),YT}function QT(){return _T(UT,HT)}function JT(){return HT}function tP(t,e){return IT(UT,t,e)}function eP(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function nP(t){return CT(tP(HT-1,aP(91===t?t+2:40===t?t+1:t)))}function rP(t){for(;(YT=QT())&&YT<33;)ZT();return eP(t)>2||eP(YT)>3?"":" "}function iP(t,e){for(;--e&&ZT()&&!(YT<48||YT>102||YT>57&&YT<65||YT>70&&YT<97););return tP(t,JT()+(e<6&&32==QT()&&32==ZT()))}function aP(t){for(;ZT();)switch(YT){case t:return HT;case 34:case 39:34!==t&&39!==t&&aP(YT);break;case 40:41===t&&aP(t);break;case 92:ZT()}return HT}function oP(t,e){for(;ZT()&&t+YT!==57&&(t+YT!==84||47!==QT()););return"/*"+tP(e,HT-1)+"*"+TT(47===t?t:ZT())}function sP(t){for(;!eP(QT());)ZT();return tP(t,HT)}function uP(t,e){for(var n="",r=0;r<t.length;r++)n+=e(t[r],r,t,e)||"";return n}function cP(t,e,n,r){switch(t.type){case"@layer":if(t.children.length)break;case"@import":case OT:return t.return=t.return||t.value;case MT:return"";case NT:return t.return=t.value+"{"+uP(t.children,r)+"}";case ST:if(!jT(t.value=t.props.join(",")))return""}return jT(n=uP(t.children,r))?t.return=t.value+"{"+n+"}":""}function lP(t,e,n){switch(function(t,e){return 45^_T(t,0)?(((e<<2^_T(t,0))<<2^_T(t,1))<<2^_T(t,2))<<2^_T(t,3):0}(t,e)){case 5103:return kT+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return kT+t+t;case 4789:return ET+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return kT+t+ET+t+wT+t+t;case 5936:switch(_T(t,e+11)){case 114:return kT+t+wT+LT(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return kT+t+wT+LT(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return kT+t+wT+LT(t,/[svh]\w+-[tblr]{2}/,"lr")+t}case 6828:case 4268:case 2903:return kT+t+wT+t+t;case 6165:return kT+t+wT+"flex-"+t+t;case 5187:return kT+t+LT(t,/(\w+).+(:[^]+)/,kT+"box-$1$2"+wT+"flex-$1$2")+t;case 5443:return kT+t+wT+"flex-item-"+LT(t,/flex-|-self/g,"")+(RT(t,/flex-|baseline/)?"":wT+"grid-row-"+LT(t,/flex-|-self/g,""))+t;case 4675:return kT+t+wT+"flex-line-pack"+LT(t,/align-content|flex-|-self/g,"")+t;case 5548:return kT+t+wT+LT(t,"shrink","negative")+t;case 5292:return kT+t+wT+LT(t,"basis","preferred-size")+t;case 6060:return kT+"box-"+LT(t,"-grow","")+kT+t+wT+LT(t,"grow","positive")+t;case 4554:return kT+LT(t,/([^-])(transform)/g,"$1"+kT+"$2")+t;case 6187:return LT(LT(LT(t,/(zoom-|grab)/,kT+"$1"),/(image-set)/,kT+"$1"),t,"")+t;case 5495:case 3959:return LT(t,/(image-set\([^]*)/,kT+"$1$`$1");case 4968:return LT(LT(t,/(.+:)(flex-)?(.*)/,kT+"box-pack:$3"+wT+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+kT+t+t;case 4200:if(!RT(t,/flex-|baseline/))return wT+"grid-column-align"+IT(t,e)+t;break;case 2592:case 3360:return wT+LT(t,"template-","")+t;case 4384:case 3616:return n&&n.some((function(t,n){return e=n,RT(t.props,/grid-\w+-end/)}))?~DT(t+(n=n[e].value),"span",0)?t:wT+LT(t,"-start","")+t+wT+"grid-row-span:"+(~DT(n,"span",0)?RT(n,/\d+/):+RT(n,/\d+/)-+RT(t,/\d+/))+";":wT+LT(t,"-start","")+t;case 4896:case 4128:return n&&n.some((function(t){return RT(t.props,/grid-\w+-start/)}))?t:wT+LT(LT(t,"-end","-span"),"span ","")+t;case 4095:case 3583:case 4068:case 2532:return LT(t,/(.+)-inline(.+)/,kT+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(jT(t)-1-e>6)switch(_T(t,e+1)){case 109:if(45!==_T(t,e+4))break;case 102:return LT(t,/(.+:)(.+)-([^]+)/,"$1"+kT+"$2-$3$1"+ET+(108==_T(t,e+3)?"$3":"$2-$3"))+t;case 115:return~DT(t,"stretch",0)?lP(LT(t,"stretch","fill-available"),e,n)+t:t}break;case 5152:case 5920:return LT(t,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,(function(e,n,r,i,a,o,s){return wT+n+":"+r+s+(i?wT+n+"-span:"+(a?o:+o-+r)+s:"")+t}));case 4949:if(121===_T(t,e+6))return LT(t,":",":"+kT)+t;break;case 6444:switch(_T(t,45===_T(t,14)?18:11)){case 120:return LT(t,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+kT+(45===_T(t,14)?"inline-":"")+"box$3$1"+kT+"$2$3$1"+wT+"$2box$3")+t;case 100:return LT(t,":",":"+wT)+t}break;case 5719:case 2647:case 2135:case 3927:case 2391:return LT(t,"scroll-","scroll-snap-")+t}return t}function hP(t,e,n,r){if(t.length>-1&&!t.return)switch(t.type){case OT:return void(t.return=lP(t.value,t.length,n));case NT:return uP([XT(t,{value:LT(t.value,"@","@"+kT)})],r);case ST:if(t.length)return function(t,e){return t.map(e).join("")}(n=t.props,(function(e){switch(RT(e,r=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":KT(XT(t,{props:[LT(e,/:(read-\w+)/,":-moz-$1")]})),KT(XT(t,{props:[e]})),PT(t,{props:zT(n,r)});break;case"::placeholder":KT(XT(t,{props:[LT(e,/:(plac\w+)/,":"+kT+"input-$1")]})),KT(XT(t,{props:[LT(e,/:(plac\w+)/,":-moz-$1")]})),KT(XT(t,{props:[LT(e,/:(plac\w+)/,wT+"input-$1")]})),KT(XT(t,{props:[e]})),PT(t,{props:zT(n,r)})}return""}))}}function dP(t){return function(t){return UT="",t}(fP("",null,null,null,[""],t=function(t){return GT=VT=1,WT=jT(UT=t),HT=0,[]}(t),0,[0],t))}function fP(t,e,n,r,i,a,o,s,u){for(var c=0,l=0,h=o,d=0,f=0,v=0,p=1,g=1,y=1,m=0,b="",x=i,w=a,E=r,k=b;g;)switch(v=m,m=ZT()){case 40:if(108!=v&&58==_T(k,h-1)){-1!=DT(k+=LT(nP(m),"&","&\f"),"&\f",AT(c?s[c-1]:0))&&(y=-1);break}case 34:case 39:case 91:k+=nP(m);break;case 9:case 10:case 13:case 32:k+=rP(v);break;case 92:k+=iP(JT()-1,7);continue;case 47:switch(QT()){case 42:case 47:BT(pP(oP(ZT(),JT()),e,n,u),u);break;default:k+="/"}break;case 123*p:s[c++]=jT(k)*y;case 125*p:case 59:case 0:switch(m){case 0:case 125:g=0;case 59+l:-1==y&&(k=LT(k,/\f/g,"")),f>0&&jT(k)-h&&BT(f>32?gP(k+";",r,n,h-1,u):gP(LT(k," ","")+";",r,n,h-2,u),u);break;case 59:k+=";";default:if(BT(E=vP(k,e,n,c,l,i,s,b,x=[],w=[],h,a),a),123===m)if(0===l)fP(k,e,E,E,x,a,h,s,w);else switch(99===d&&110===_T(k,3)?100:d){case 100:case 108:case 109:case 115:fP(t,E,E,r&&BT(vP(t,E,E,0,0,i,s,b,i,x=[],h,w),w),i,w,h,s,r?x:w);break;default:fP(k,E,E,E,[""],w,0,s,w)}}c=l=f=0,p=y=1,b=k="",h=o;break;case 58:h=1+jT(k),f=v;default:if(p<1)if(123==m)--p;else if(125==m&&0==p++&&125==$T())continue;switch(k+=TT(m),m*p){case 38:y=l>0?1:(k+="\f",-1);break;case 44:s[c++]=(jT(k)-1)*y,y=1;break;case 64:45===QT()&&(k+=nP(ZT())),d=QT(),l=h=jT(b=k+=sP(JT())),m++;break;case 45:45===v&&2==jT(k)&&(p=0)}}return a}function vP(t,e,n,r,i,a,o,s,u,c,l,h){for(var d=i-1,f=0===i?a:[""],v=FT(f),p=0,g=0,y=0;p<r;++p)for(var m=0,b=IT(t,d+1,d=AT(g=o[p])),x=t;m<v;++m)(x=CT(g>0?f[m]+" "+b:LT(b,/&\f/g,f[m])))&&(u[y++]=x);return qT(t,e,n,0===i?ST:s,u,c,l,h)}function pP(t,e,n,r){return qT(t,e,n,MT,TT(YT),IT(t,2,-2),0,r)}function gP(t,e,n,r,i){return qT(t,e,n,OT,IT(t,0,r),IT(t,r+1,-1),r,i)}var yP={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},mP="undefined"!=typeof process&&void 0!==process.env&&(process.env.REACT_APP_SC_ATTR||process.env.SC_ATTR)||"data-styled",bP="active",xP="data-styled-version",wP="6.1.15",EP="/*!sc*/\n",kP="undefined"!=typeof window&&"HTMLElement"in window,MP=Boolean("boolean"==typeof SC_DISABLE_SPEEDY?SC_DISABLE_SPEEDY:"undefined"!=typeof process&&void 0!==process.env&&void 0!==process.env.REACT_APP_SC_DISABLE_SPEEDY&&""!==process.env.REACT_APP_SC_DISABLE_SPEEDY?"false"!==process.env.REACT_APP_SC_DISABLE_SPEEDY&&process.env.REACT_APP_SC_DISABLE_SPEEDY:"undefined"!=typeof process&&void 0!==process.env&&void 0!==process.env.SC_DISABLE_SPEEDY&&""!==process.env.SC_DISABLE_SPEEDY&&"false"!==process.env.SC_DISABLE_SPEEDY&&process.env.SC_DISABLE_SPEEDY),SP=(new Set,Object.freeze([])),OP=Object.freeze({});var NP=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),AP=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,TP=/(^-|-$)/g;function PP(t){return t.replace(AP,"-").replace(TP,"")}var CP=/(a)(d)/gi,RP=function(t){return String.fromCharCode(t+(t>25?39:97))};function LP(t){var e,n="";for(e=Math.abs(t);e>52;e=e/52|0)n=RP(e%52)+n;return(RP(e%52)+n).replace(CP,"$1-$2")}var DP,_P=function(t,e){for(var n=e.length;n;)t=33*t^e.charCodeAt(--n);return t},IP=function(t){return _P(5381,t)};function jP(t){return"string"==typeof t&&!0}var FP="function"==typeof Symbol&&Symbol.for,BP=FP?Symbol.for("react.memo"):60115,zP=FP?Symbol.for("react.forward_ref"):60112,GP={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},VP={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},WP={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},HP=((DP={})[zP]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},DP[BP]=WP,DP);function YP(t){return("type"in(e=t)&&e.type.$$typeof)===BP?WP:"$$typeof"in t?HP[t.$$typeof]:GP;var e}var UP=Object.defineProperty,qP=Object.getOwnPropertyNames,XP=Object.getOwnPropertySymbols,KP=Object.getOwnPropertyDescriptor,$P=Object.getPrototypeOf,ZP=Object.prototype;function QP(t,e,n){if("string"!=typeof e){if(ZP){var r=$P(e);r&&r!==ZP&&QP(t,r,n)}var i=qP(e);XP&&(i=i.concat(XP(e)));for(var a=YP(t),o=YP(e),s=0;s<i.length;++s){var u=i[s];if(!(u in VP||n&&n[u]||o&&u in o||a&&u in a)){var c=KP(e,u);try{UP(t,u,c)}catch(t){}}}}return t}function JP(t){return"function"==typeof t}function tC(t){return"object"==typeof t&&"styledComponentId"in t}function eC(t,e){return t&&e?"".concat(t," ").concat(e):t||e||""}function nC(t,e){if(0===t.length)return"";for(var n=t[0],r=1;r<t.length;r++)n+=e?e+t[r]:t[r];return n}function rC(t){return null!==t&&"object"==typeof t&&t.constructor.name===Object.name&&!("props"in t&&t.$$typeof)}function iC(t,e,n){if(void 0===n&&(n=!1),!n&&!rC(t)&&!Array.isArray(t))return e;if(Array.isArray(e))for(var r=0;r<e.length;r++)t[r]=iC(t[r],e[r]);else if(rC(e))for(var r in e)t[r]=iC(t[r],e[r]);return t}function aC(t,e){Object.defineProperty(t,"toString",{value:e})}function oC(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(t," for more information.").concat(e.length>0?" Args: ".concat(e.join(", ")):""))}var sC=function(){function t(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return t.prototype.indexOfGroup=function(t){for(var e=0,n=0;n<t;n++)e+=this.groupSizes[n];return e},t.prototype.insertRules=function(t,e){if(t>=this.groupSizes.length){for(var n=this.groupSizes,r=n.length,i=r;t>=i;)if((i<<=1)<0)throw oC(16,"".concat(t));this.groupSizes=new Uint32Array(i),this.groupSizes.set(n),this.length=i;for(var a=r;a<i;a++)this.groupSizes[a]=0}for(var o=this.indexOfGroup(t+1),s=(a=0,e.length);a<s;a++)this.tag.insertRule(o,e[a])&&(this.groupSizes[t]++,o++)},t.prototype.clearGroup=function(t){if(t<this.length){var e=this.groupSizes[t],n=this.indexOfGroup(t),r=n+e;this.groupSizes[t]=0;for(var i=n;i<r;i++)this.tag.deleteRule(n)}},t.prototype.getGroup=function(t){var e="";if(t>=this.length||0===this.groupSizes[t])return e;for(var n=this.groupSizes[t],r=this.indexOfGroup(t),i=r+n,a=r;a<i;a++)e+="".concat(this.tag.getRule(a)).concat(EP);return e},t}(),uC=new Map,cC=new Map,lC=1,hC=function(t){if(uC.has(t))return uC.get(t);for(;cC.has(lC);)lC++;var e=lC++;return uC.set(t,e),cC.set(e,t),e},dC=function(t,e){lC=e+1,uC.set(t,e),cC.set(e,t)},fC="style[".concat(mP,"][").concat(xP,'="').concat(wP,'"]'),vC=new RegExp("^".concat(mP,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),pC=function(t,e,n){for(var r,i=n.split(","),a=0,o=i.length;a<o;a++)(r=i[a])&&t.registerName(e,r)},gC=function(t,e){for(var n,r=(null!==(n=e.textContent)&&void 0!==n?n:"").split(EP),i=[],a=0,o=r.length;a<o;a++){var s=r[a].trim();if(s){var u=s.match(vC);if(u){var c=0|parseInt(u[1],10),l=u[2];0!==c&&(dC(l,c),pC(t,l,u[3]),t.getTag().insertRules(c,i)),i.length=0}else i.push(s)}}},yC=function(t){for(var e=document.querySelectorAll(fC),n=0,r=e.length;n<r;n++){var i=e[n];i&&i.getAttribute(mP)!==bP&&(gC(t,i),i.parentNode&&i.parentNode.removeChild(i))}};function mC(){return a.nc}var bC=function(t){var e=document.head,n=t||e,r=document.createElement("style"),i=function(t){var e=Array.from(t.querySelectorAll("style[".concat(mP,"]")));return e[e.length-1]}(n),a=void 0!==i?i.nextSibling:null;r.setAttribute(mP,bP),r.setAttribute(xP,wP);var o=mC();return o&&r.setAttribute("nonce",o),n.insertBefore(r,a),r},xC=function(){function t(t){this.element=bC(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(t){if(t.sheet)return t.sheet;for(var e=document.styleSheets,n=0,r=e.length;n<r;n++){var i=e[n];if(i.ownerNode===t)return i}throw oC(17)}(this.element),this.length=0}return t.prototype.insertRule=function(t,e){try{return this.sheet.insertRule(e,t),this.length++,!0}catch(t){return!1}},t.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},t.prototype.getRule=function(t){var e=this.sheet.cssRules[t];return e&&e.cssText?e.cssText:""},t}(),wC=function(){function t(t){this.element=bC(t),this.nodes=this.element.childNodes,this.length=0}return t.prototype.insertRule=function(t,e){if(t<=this.length&&t>=0){var n=document.createTextNode(e);return this.element.insertBefore(n,this.nodes[t]||null),this.length++,!0}return!1},t.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},t.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},t}(),EC=function(){function t(t){this.rules=[],this.length=0}return t.prototype.insertRule=function(t,e){return t<=this.length&&(this.rules.splice(t,0,e),this.length++,!0)},t.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},t.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},t}(),kC=kP,MC={isServer:!kP,useCSSOMInjection:!MP},SC=function(){function t(t,e,n){void 0===t&&(t=OP),void 0===e&&(e={});var r=this;this.options=fe(fe({},MC),t),this.gs=e,this.names=new Map(n),this.server=!!t.isServer,!this.server&&kP&&kC&&(kC=!1,yC(this)),aC(this,(function(){return function(t){for(var e=t.getTag(),n=e.length,r="",i=function(n){var i=function(t){return cC.get(t)}(n);if(void 0===i)return"continue";var a=t.names.get(i),o=e.getGroup(n);if(void 0===a||!a.size||0===o.length)return"continue";var s="".concat(mP,".g").concat(n,'[id="').concat(i,'"]'),u="";void 0!==a&&a.forEach((function(t){t.length>0&&(u+="".concat(t,","))})),r+="".concat(o).concat(s,'{content:"').concat(u,'"}').concat(EP)},a=0;a<n;a++)i(a);return r}(r)}))}return t.registerId=function(t){return hC(t)},t.prototype.rehydrate=function(){!this.server&&kP&&yC(this)},t.prototype.reconstructWithOptions=function(e,n){return void 0===n&&(n=!0),new t(fe(fe({},this.options),e),this.gs,n&&this.names||void 0)},t.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},t.prototype.getTag=function(){return this.tag||(this.tag=(t=function(t){var e=t.useCSSOMInjection,n=t.target;return t.isServer?new EC(n):e?new xC(n):new wC(n)}(this.options),new sC(t)));var t},t.prototype.hasNameForId=function(t,e){return this.names.has(t)&&this.names.get(t).has(e)},t.prototype.registerName=function(t,e){if(hC(t),this.names.has(t))this.names.get(t).add(e);else{var n=new Set;n.add(e),this.names.set(t,n)}},t.prototype.insertRules=function(t,e,n){this.registerName(t,e),this.getTag().insertRules(hC(t),n)},t.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},t.prototype.clearRules=function(t){this.getTag().clearGroup(hC(t)),this.clearNames(t)},t.prototype.clearTag=function(){this.tag=void 0},t}(),OC=/&/g,NC=/^\s*\/\/.*$/gm;function AC(t,e){return t.map((function(t){return"rule"===t.type&&(t.value="".concat(e," ").concat(t.value),t.value=t.value.replaceAll(",",",".concat(e," ")),t.props=t.props.map((function(t){return"".concat(e," ").concat(t)}))),Array.isArray(t.children)&&"@keyframes"!==t.type&&(t.children=AC(t.children,e)),t}))}function TC(t){var e,n,r,i=void 0===t?OP:t,a=i.options,o=void 0===a?OP:a,s=i.plugins,u=void 0===s?SP:s,c=function(t,r,i){return i.startsWith(n)&&i.endsWith(n)&&i.replaceAll(n,"").length>0?".".concat(e):t},l=u.slice();l.push((function(t){t.type===ST&&t.value.includes("&")&&(t.props[0]=t.props[0].replace(OC,n).replace(r,c))})),o.prefix&&l.push(hP),l.push(cP);var h=function(t,i,a,s){void 0===i&&(i=""),void 0===a&&(a=""),void 0===s&&(s="&"),e=s,n=i,r=new RegExp("\\".concat(n,"\\b"),"g");var u=t.replace(NC,""),c=dP(a||i?"".concat(a," ").concat(i," { ").concat(u," }"):u);o.namespace&&(c=AC(c,o.namespace));var h,d,f,v=[];return uP(c,(h=l.concat((f=function(t){return v.push(t)},function(t){t.root||(t=t.return)&&f(t)})),d=FT(h),function(t,e,n,r){for(var i="",a=0;a<d;a++)i+=h[a](t,e,n,r)||"";return i})),v};return h.hash=u.length?u.reduce((function(t,e){return e.name||oC(15),_P(t,e.name)}),5381).toString():"",h}var PC=new SC,CC=TC(),RC=yT().createContext({shouldForwardProp:void 0,styleSheet:PC,stylis:CC}),LC=(RC.Consumer,yT().createContext(void 0));function DC(){return(0,gT.useContext)(RC)}function _C(t){var e=(0,gT.useState)(t.stylisPlugins),n=e[0],r=e[1],i=DC().styleSheet,a=(0,gT.useMemo)((function(){var e=i;return t.sheet?e=t.sheet:t.target&&(e=e.reconstructWithOptions({target:t.target},!1)),t.disableCSSOMInjection&&(e=e.reconstructWithOptions({useCSSOMInjection:!1})),e}),[t.disableCSSOMInjection,t.sheet,t.target,i]),o=(0,gT.useMemo)((function(){return TC({options:{namespace:t.namespace,prefix:t.enableVendorPrefixes},plugins:n})}),[t.enableVendorPrefixes,t.namespace,n]);(0,gT.useEffect)((function(){xT()(n,t.stylisPlugins)||r(t.stylisPlugins)}),[t.stylisPlugins]);var s=(0,gT.useMemo)((function(){return{shouldForwardProp:t.shouldForwardProp,styleSheet:a,stylis:o}}),[t.shouldForwardProp,a,o]);return yT().createElement(RC.Provider,{value:s},yT().createElement(LC.Provider,{value:o},t.children))}var IC=function(){function t(t,e){var n=this;this.inject=function(t,e){void 0===e&&(e=CC);var r=n.name+e.hash;t.hasNameForId(n.id,r)||t.insertRules(n.id,r,e(n.rules,r,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=e,aC(this,(function(){throw oC(12,String(n.name))}))}return t.prototype.getName=function(t){return void 0===t&&(t=CC),this.name+t.hash},t}(),jC=function(t){return t>="A"&&t<="Z"};function FC(t){for(var e="",n=0;n<t.length;n++){var r=t[n];if(1===n&&"-"===r&&"-"===t[0])return t;jC(r)?e+="-"+r.toLowerCase():e+=r}return e.startsWith("ms-")?"-"+e:e}var BC=function(t){return null==t||!1===t||""===t},zC=function(t){var e,n,r=[];for(var i in t){var a=t[i];t.hasOwnProperty(i)&&!BC(a)&&(Array.isArray(a)&&a.isCss||JP(a)?r.push("".concat(FC(i),":"),a,";"):rC(a)?r.push.apply(r,me(me(["".concat(i," {")],zC(a),!1),["}"],!1)):r.push("".concat(FC(i),": ").concat((e=i,null==(n=a)||"boolean"==typeof n||""===n?"":"number"!=typeof n||0===n||e in yP||e.startsWith("--")?String(n).trim():"".concat(n,"px")),";")))}return r};function GC(t,e,n,r){return BC(t)?[]:tC(t)?[".".concat(t.styledComponentId)]:JP(t)?!JP(i=t)||i.prototype&&i.prototype.isReactComponent||!e?[t]:GC(t(e),e,n,r):t instanceof IC?n?(t.inject(n,r),[t.getName(r)]):[t]:rC(t)?zC(t):Array.isArray(t)?Array.prototype.concat.apply(SP,t.map((function(t){return GC(t,e,n,r)}))):[t.toString()];var i}function VC(t){for(var e=0;e<t.length;e+=1){var n=t[e];if(JP(n)&&!tC(n))return!1}return!0}var WC=IP(wP),HC=function(){function t(t,e,n){this.rules=t,this.staticRulesId="",this.isStatic=(void 0===n||n.isStatic)&&VC(t),this.componentId=e,this.baseHash=_P(WC,e),this.baseStyle=n,SC.registerId(e)}return t.prototype.generateAndInjectStyles=function(t,e,n){var r=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,e,n):"";if(this.isStatic&&!n.hash)if(this.staticRulesId&&e.hasNameForId(this.componentId,this.staticRulesId))r=eC(r,this.staticRulesId);else{var i=nC(GC(this.rules,t,e,n)),a=LP(_P(this.baseHash,i)>>>0);if(!e.hasNameForId(this.componentId,a)){var o=n(i,".".concat(a),void 0,this.componentId);e.insertRules(this.componentId,a,o)}r=eC(r,a),this.staticRulesId=a}else{for(var s=_P(this.baseHash,n.hash),u="",c=0;c<this.rules.length;c++){var l=this.rules[c];if("string"==typeof l)u+=l;else if(l){var h=nC(GC(l,t,e,n));s=_P(s,h+c),u+=h}}if(u){var d=LP(s>>>0);e.hasNameForId(this.componentId,d)||e.insertRules(this.componentId,d,n(u,".".concat(d),void 0,this.componentId)),r=eC(r,d)}}return r},t}(),YC=yT().createContext(void 0);YC.Consumer;var UC={};function qC(t,e,n){var r=tC(t),i=t,a=!jP(t),o=e.attrs,s=void 0===o?SP:o,u=e.componentId,c=void 0===u?function(t,e){var n="string"!=typeof t?"sc":PP(t);UC[n]=(UC[n]||0)+1;var r="".concat(n,"-").concat(function(t){return LP(IP(t)>>>0)}(wP+n+UC[n]));return e?"".concat(e,"-").concat(r):r}(e.displayName,e.parentComponentId):u,l=e.displayName,h=void 0===l?function(t){return jP(t)?"styled.".concat(t):"Styled(".concat(function(t){return t.displayName||t.name||"Component"}(t),")")}(t):l,d=e.displayName&&e.componentId?"".concat(PP(e.displayName),"-").concat(e.componentId):e.componentId||c,f=r&&i.attrs?i.attrs.concat(s).filter(Boolean):s,v=e.shouldForwardProp;if(r&&i.shouldForwardProp){var p=i.shouldForwardProp;if(e.shouldForwardProp){var g=e.shouldForwardProp;v=function(t,e){return p(t,e)&&g(t,e)}}else v=p}var y=new HC(n,d,r?i.componentStyle:void 0);function m(t,e){return function(t,e,n){var r=t.attrs,i=t.componentStyle,a=t.defaultProps,o=t.foldedComponentIds,s=t.styledComponentId,u=t.target,c=yT().useContext(YC),l=DC(),h=t.shouldForwardProp||l.shouldForwardProp,d=function(t,e,n){return void 0===n&&(n=OP),t.theme!==n.theme&&t.theme||e||n.theme}(e,c,a)||OP,f=function(t,e,n){for(var r,i=fe(fe({},e),{className:void 0,theme:n}),a=0;a<t.length;a+=1){var o=JP(r=t[a])?r(i):r;for(var s in o)i[s]="className"===s?eC(i[s],o[s]):"style"===s?fe(fe({},i[s]),o[s]):o[s]}return e.className&&(i.className=eC(i.className,e.className)),i}(r,e,d),v=f.as||u,p={};for(var g in f)void 0===f[g]||"$"===g[0]||"as"===g||"theme"===g&&f.theme===d||("forwardedAs"===g?p.as=f.forwardedAs:h&&!h(g,v)||(p[g]=f[g]));var y=function(t,e){var n=DC();return t.generateAndInjectStyles(e,n.styleSheet,n.stylis)}(i,f),m=eC(o,s);return y&&(m+=" "+y),f.className&&(m+=" "+f.className),p[jP(v)&&!NP.has(v)?"class":"className"]=m,n&&(p.ref=n),(0,gT.createElement)(v,p)}(b,t,e)}m.displayName=h;var b=yT().forwardRef(m);return b.attrs=f,b.componentStyle=y,b.displayName=h,b.shouldForwardProp=v,b.foldedComponentIds=r?eC(i.foldedComponentIds,i.styledComponentId):"",b.styledComponentId=d,b.target=r?i.target:t,Object.defineProperty(b,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(t){this._foldedDefaultProps=r?function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)iC(t,i[r],!0);return t}({},i.defaultProps,t):t}}),aC(b,(function(){return".".concat(b.styledComponentId)})),a&&QP(b,t,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),b}function XC(t,e){for(var n=[t[0]],r=0,i=e.length;r<i;r+=1)n.push(e[r],t[r+1]);return n}new Set;var KC=function(t){return Object.assign(t,{isCss:!0})};function $C(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(JP(t)||rC(t))return KC(GC(XC(SP,me([t],e,!0))));var r=t;return 0===e.length&&1===r.length&&"string"==typeof r[0]?GC(r):KC(GC(XC(r,e)))}function ZC(t,e,n){if(void 0===n&&(n=OP),!e)throw oC(1,e);var r=function(r){for(var i=[],a=1;a<arguments.length;a++)i[a-1]=arguments[a];return t(e,n,$C.apply(void 0,me([r],i,!1)))};return r.attrs=function(r){return ZC(t,e,fe(fe({},n),{attrs:Array.prototype.concat(n.attrs,r).filter(Boolean)}))},r.withConfig=function(r){return ZC(t,e,fe(fe({},n),r))},r}var QC=function(t){return ZC(qC,t)},JC=QC;NP.forEach((function(t){JC[t]=QC(t)})),function(){function t(t,e){this.rules=t,this.componentId=e,this.isStatic=VC(t),SC.registerId(this.componentId+1)}t.prototype.createStyles=function(t,e,n,r){var i=r(nC(GC(this.rules,e,n,r)),""),a=this.componentId+t;n.insertRules(a,a,i)},t.prototype.removeStyles=function(t,e){e.clearRules(this.componentId+t)},t.prototype.renderStyles=function(t,e,n,r){t>2&&SC.registerId(this.componentId+t),this.removeStyles(t,n),this.createStyles(t,e,n,r)}}(),function(){function t(){var t=this;this._emitSheetCSS=function(){var e=t.instance.toString();if(!e)return"";var n=mC(),r=nC([n&&'nonce="'.concat(n,'"'),"".concat(mP,'="true"'),"".concat(xP,'="').concat(wP,'"')].filter(Boolean)," ");return"<style ".concat(r,">").concat(e,"</style>")},this.getStyleTags=function(){if(t.sealed)throw oC(2);return t._emitSheetCSS()},this.getStyleElement=function(){var e;if(t.sealed)throw oC(2);var n=t.instance.toString();if(!n)return[];var r=((e={})[mP]="",e[xP]=wP,e.dangerouslySetInnerHTML={__html:n},e),i=mC();return i&&(r.nonce=i),[yT().createElement("style",fe({},r,{key:"sc-0-0"}))]},this.seal=function(){t.sealed=!0},this.instance=new SC({isServer:!0}),this.sealed=!1}t.prototype.collectStyles=function(t){if(this.sealed)throw oC(2);return yT().createElement(_C,{sheet:this.instance},t)},t.prototype.interleaveWithNodeStream=function(t){throw oC(3)}}(),"__sc-".concat(mP,"__");var tR,eR,nR,rR,iR=JC.div(tR||(tR=mT(["\n  ","\n\n  .arrow-count-icon-bar {\n    ","\n    background-color: ",";\n  }\n\n  .arrow-count-icon-circle {\n    width: 16px;\n    height: 16px;\n    color: #fff;\n    font-weight: 600;\n    font-size: 10px;\n    line-height: ",";\n    text-align: center;\n    background-color: ",";\n    border-radius: 50%;\n  }\n\n  .arrow-count-icon-circle-arrow {\n    width: 16px;\n    height: 16px;\n    transform: ",";\n  }\n\n  display: ",";\n\n  .collapsible-node-wrapper:hover & {\n    display: flex;\n  }\n"])),(function(t){switch(t.$placement){case"top":return"transform: translate(-50%, -100%); flex-direction: column-reverse;";case"right":return"transform: translate(0, -50%);";case"left":return"transform: translate(-100%, -50%); flex-direction: row-reverse;";default:return"transform: translate(-50%, 0); flex-direction: column;"}}),(function(t){var e=t.$placement;return"top"===e||"bottom"===e?"width: 3px; height: 8px; margin: 0 7px;":"width: 8px; height: 3px; margin: 7px 0;"}),(function(t){return t.$color}),(function(t){return t.$isCollapsed?"16px":"14px"}),(function(t){return t.$color}),(function(t){var e=t.$isCollapsed,n=t.$placement;if(e)return"none";switch(n){case"top":return"translateY(1px) rotate(-90deg)";case"right":return"translateX(-1px) rotate(0deg)";case"left":return"translateX(1px) rotate(180deg)";default:return"translateY(-1px) rotate(90deg)"}}),(function(t){return t.$isCollapsed?"flex":"none"})),aR=function(t){var e,n=t.className,r=t.style,i=t.graph,a=t.data,o=t.isCollapsed,s=t.countType,u=void 0===s?"descendant":s,c=t.placement,l=void 0===c?"bottom":c,h=(null===(e=i.getNodeData(a.id).style)||void 0===e?void 0:e.color)||"#99ADD1",d=("descendant"===u?i.getDescendantsData(a.id):i.getChildrenData(a.id)).length;return yT().createElement(iR,{$color:h,$isCollapsed:o,$placement:l,className:"arrow-count-icon ".concat(o?"arrow-count-icon-collapsed":""," ").concat(n||""),style:r},yT().createElement("div",{className:"arrow-count-icon-bar"}),yT().createElement("div",{className:"arrow-count-icon-circle"},o?d:yT().createElement("div",{className:"arrow-count-icon-circle-arrow"},yT().createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},yT().createElement("path",{d:"M11,4 L5.5,8 L11,12",stroke:"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})))))},oR=JC.div(eR||(eR=mT(["\n  height: 16px;\n  width: 16px;\n  transform: translate(-50%, -50%);\n  background: #fff;\n  border-radius: 50%;\n  border: 2px solid #99add1;\n  color: #99add1;\n  font-weight: 800;\n  line-height: 14px;\n  text-align: center;\n  box-sizing: content-box;\n"]))),sR=function(t){var e=t.isCollapsed,n=t.style,r=t.className;return yT().createElement(oR,{className:r,style:n},e?"+":"-")},uR=JC.div(nR||(nR=mT(["\n  height: inherit;\n  width: inherit;\n  border-radius: 8px;\n  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.12), 0 2px 4px 0 rgba(0, 0, 0, 0.1);\n  position: relative;\n  border: none;\n  background-color: #fff;\n  box-sizing: content-box;\n\n  ","\n\n  .org-chart-node-line {\n    width: 100%;\n    height: 6px;\n    background-color: ",";\n    border-radius: 8px 8px 0 0;\n  }\n\n  .org-chart-node-content {\n    height: calc(100% - 6px);\n    margin: 0 16px 3px;\n    display: flex;\n    align-items: center;\n\n    &-avatar {\n      width: 40px;\n      height: 40px;\n      border-radius: 50%;\n      margin-right: 16px;\n      background-color: ",";\n      font-weight: 600;\n      font-size: 18px;\n      text-align: center;\n      line-height: 40px;\n      color: #fff;\n    }\n\n    &-detail {\n      width: calc(100% - 56px);\n    }\n\n    &-name {\n      color: #242424;\n      font-weight: 600;\n      font-size: 18px;\n      margin-bottom: 5px;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n\n    &-post {\n      color: #616161;\n      font-size: 14px;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n  }\n"])),(function(t){return t.$isActive&&$C(rR||(rR=mT(["\n      transform: translate(-3px, -3px);\n      border: 2px solid #1783ff;\n    "])))}),(function(t){return t.$color}),(function(t){return t.$color})),cR=function(t){var e=t.name,n=t.position,r=t.status,i=void 0===r?"online":r,a=t.isActive,o=t.className,s=t.style;return yT().createElement(uR,{$color:{online:"#1783FF",busy:"#00C9C9",offline:"#F08F56"}[i],$isActive:a,className:o,style:s},yT().createElement("div",{className:"org-chart-node-line"}),yT().createElement("div",{className:"org-chart-node-content"},yT().createElement("div",{className:"org-chart-node-content-avatar"},e.slice(0,1)),yT().createElement("div",{className:"org-chart-node-content-detail"},yT().createElement("div",{className:"org-chart-node-content-name"},e),n&&yT().createElement("div",{className:"org-chart-node-content-post"},n))))},lR=function(){return lR=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},lR.apply(this,arguments)},hR=lR({},QA),dR=hR.version;hR.render,hR.unmountComponentAtNode;try{Number((dR||"").split(".")[0])>=18&&hR.createRoot}catch(t){}var fR=new Map;"undefined"!=typeof document&&fR.set("tooltip",document.createElement("div"));var vR,pR,gR,yR,mR,bR,xR,wR,ER,kR=function(t){var e=t.loadingTemplate,n=t.theme,r=void 0===n?"light":n,i=yT().useRef(null);return yT().useEffect((function(){!e&&i.current&&function(t){if("undefined"==typeof document)return"loading";var e=t.attachShadow({mode:"open"}),n=document.createElement("div"),r=document.createElement("style");r.innerHTML=".loading {\n    display: inline-block;\n    position: relative;\n    width: 80px;\n    height: 80px;\n  }\n  .loading div {\n    position: absolute;\n    top: 33px;\n    width: 13px;\n    height: 13px;\n    border-radius: 50%;\n    background: #ccc;\n    animation-timing-function: cubic-bezier(0, 1, 1, 0);\n  }\n  .loading div:nth-child(1) {\n    left: 8px;\n    animation: loading1 0.6s infinite;\n  }\n  .loading div:nth-child(2) {\n    left: 8px;\n    animation: loading2 0.6s infinite;\n  }\n  .loading div:nth-child(3) {\n    left: 32px;\n    animation: loading2 0.6s infinite;\n  }\n  .loading div:nth-child(4) {\n    left: 56px;\n    animation: loading3 0.6s infinite;\n  }\n  @keyframes loading1 {\n    0% {\n      transform: scale(0);\n    }\n    100% {\n      transform: scale(1);\n    }\n  }\n  @keyframes loading3 {\n    0% {\n      transform: scale(1);\n    }\n    100% {\n      transform: scale(0);\n    }\n  }\n  @keyframes loading2 {\n    0% {\n      transform: translate(0, 0);\n    }\n    100% {\n      transform: translate(24px, 0);\n    }\n  }\n  ",n.classList.add("loading"),n.innerHTML="<div></div><div></div><div></div><div></div>",e.appendChild(r),e.appendChild(n)}(i.current)}),[]),yT().createElement("div",{className:"charts-loading-container",style:{position:"absolute",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",left:0,top:0,zIndex:99,backgroundColor:"dark"===r?"rgb(20, 20, 20)":"rgb(255, 255, 255)"}},e||yT().createElement("div",{ref:i}))},MR=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),SR=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={hasError:!1},e.renderError=function(t){var n=e.props.errorTemplate;return"function"==typeof n?n(t):n||yT().createElement("h5",null,"组件出错了，请核查后重试： ",t.message)},e}return MR(e,t),e.getDerivedStateFromError=function(t){return{hasError:!0,error:t}},e.getDerivedStateFromProps=function(t,e){return e.children!==t.children?{children:t.children,hasError:!1,error:void 0}:null},e.prototype.render=function(){return this.state.hasError?this.renderError(this.state.error):yT().createElement(gT.Fragment,null,this.props.children)},e}(yT().Component),OR=(0,pT.memoize)((function(t,e){void 0===e&&(e={});var n=e.fontSize,r=e.fontFamily,i=void 0===r?"sans-serif":r,a=e.fontWeight,o=e.fontStyle,s=e.fontVariant,u=(vR||(vR=document.createElement("canvas").getContext("2d")),vR);return u.font=[o,a,s,"".concat(n,"px"),i].join(" "),u.measureText((0,pT.isString)(t)?t:"")}),(function(t,e){return void 0===e&&(e={}),function(t,e,n){if(n||2===arguments.length)for(var r,i=0,a=e.length;i<a;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}([t],(0,pT.values)(e),!0).join("")})),NR=function(t,e){return void 0===e&&(e={}),OR(t,e).width},AR=function(t,e){void 0===e&&(e={});var n=OR(t,e);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent},TR=JC.div(pR||(pR=mT(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  overflow-wrap: anywhere;\n  line-height: 1.5em;\n  text-align: center;\n  height: inherit;\n  width: inherit;\n  box-sizing: content-box;\n  font-size: 14px;\n\n  ","\n\n  ","\n"])),(function(t){var e=t.$type,n=t.$color,r=t.$borderWidth;switch(e){case"normal":return"\n          color: ".concat(n,";\n        ");case"filled":return $C(gR||(gR=mT(["\n          color: #fff;\n          background-color: ",";\n          border-radius: 8px;\n        "])),n);case"outlined":return $C(yR||(yR=mT(["\n          height: calc(100% - 2 * ","px);\n          width: calc(100% - 2 * ","px);\n          color: ",";\n          background-color: #fff;\n          border: ","px solid ",";\n          border-radius: 8px;\n        "])),r,r,n,r,n);case"underlined":return $C(mR||(mR=mT(["\n          height: calc(100% - ","px / 2);\n          width: inherit;\n          border-bottom: ","px solid ",";\n          background-color: #fff;\n          color: ",";\n        "])),r,r,n,n)}}),(function(t){var e=t.$isActive,n=t.$isSelected,r=t.$borderWidth,i=t.$color;return(e||n)&&$C(bR||(bR=mT(["\n      height: calc(100% - 2 * ","px);\n      width: calc(100% - 2 * ","px);\n      border: ","px solid ",";\n      ","\n    "])),r,r,r,function(t){var e=0,n=0,r=0;4===t.length?(e=parseInt(t[1]+t[1],16),n=parseInt(t[2]+t[2],16),r=parseInt(t[3]+t[3],16)):7===t.length&&(e=parseInt(t[1]+t[2],16),n=parseInt(t[3]+t[4],16),r=parseInt(t[5]+t[6],16)),e=Math.max(0,e-100),n=Math.max(0,n-100),r=Math.max(0,r-100);var i=function(t){return t.toString(16).padStart(2,"0")};return"#".concat(i(e)).concat(i(n)).concat(i(r))}(i),n&&"box-shadow: 0 0 0 2px ".concat(function(t){var e=0,n=0,r=0;return 4===t.length?(e=parseInt(t[1]+t[1],16),n=parseInt(t[2]+t[2],16),r=parseInt(t[3]+t[3],16)):7===t.length&&(e=parseInt(t[1]+t[2],16),n=parseInt(t[3]+t[4],16),r=parseInt(t[5]+t[6],16)),"rgba(".concat(e,", ").concat(n,", ").concat(r,", ").concat(.1,")")}(i),";"))})),PR=function(t){var e=t.className,n=t.style,r=void 0===n?{}:n,i=t.type,a=void 0===i?"normal":i,o=t.text,s=void 0===o?"":o,u=t.font,c=t.color,l=void 0===c?"#1783ff":c,h=t.borderWidth,d=void 0===h?3:h,f=t.maxWidth,v=void 0===f?1/0:f,p=t.isActive,y=void 0!==p&&p,m=t.isSelected,b=void 0!==m&&m,x=NR(s,u)>v;return yT().createElement(TR,{$type:a,$color:l,$borderWidth:d,$isActive:y,$isSelected:b,className:"text-node text-node-".concat(a," ").concat(e||""),style:g(g({},r),u)},yT().createElement("div",{style:x?{width:"calc(100% - 12px)"}:{}},s))},CR=JC.div(xR||(xR=mT(["\n  position: relative;\n  height: inherit;\n  width: inherit;\n"]))),RR=JC.div(wR||(wR=mT(["\n  position: absolute;\n  z-index: 10;\n\n  &:hover {\n    cursor: pointer;\n  }\n\n  ","\n"])),(function(t){var e=t.$placement,n=t.$offsetX,r=t.$offsetY,i={top:"left: calc(50% + ".concat(n,"px); top: ").concat(r,"px;"),bottom:"left: calc(50% + ".concat(n,"px); top: calc(100% + ").concat(r,"px);"),right:"left: calc(100% + ".concat(n,"px); top: calc(50% + ").concat(r,"px);"),left:"left: ".concat(n,"px; top: calc(50% + ").concat(r,"px);")};return $C(ER||(ER=mT(["\n      ","\n    "])),i[e])})),LR=["children"],DR={nodes:[],edges:[]};function _R(t){if("object"!==d(t)||null===t)return!1;if(!("id"in t))return!1;if("children"in t){if(!Array.isArray(t.children))return!1;var e,n=Rn(t.children);try{for(n.s();!(e=n.n()).done;)if(!_R(e.value))return!1}catch(t){n.e(t)}finally{n.f()}}return!0}function IR(t){if("object"!==d(t)||null===t)return!1;if(!Object.keys(t).every((function(t){return["nodes","edges","combos"].includes(t)})))return!1;var e=t.nodes,n=void 0===e?[]:e,r=t.edges,i=void 0===r?[]:r,a=t.combos,o=void 0===a?[]:a;if(!Array.isArray(n)||!Array.isArray(i)||!Array.isArray(o))return!1;var s=new Set(n.map((function(t){return t.id})));return!!n.every((function(t){return"object"===d(t)&&null!==t&&"id"in t}))&&!!i.every((function(t){return s.has(t.source)&&s.has(t.target)}))}function jR(t,e){return _R(t)?FA(t,{getNodeData:function(t,n){if(t.depth=n,t.style||(t.style={}),e&&(t.style.collapsed=n>=e),!t.children)return t;var r=t.children;return g(g({},Ln(t,LR)),{},{children:r.map((function(t){return t.id}))})}}):DR}function FR(t,e){if(!t)return DR;var n=IR(t)?function(t){if(IR(t)){var e,n=t.nodes,r=void 0===n?[]:n,i=t.edges,a=void 0===i?[]:i,o=Object.fromEntries(r.map((function(t){return[t.id,t]}))),s=Object.fromEntries(r.map((function(t){return[t.id,0]}))),u=Object.fromEntries(r.map((function(t){return[t.id,[]]}))),c=Rn(a);try{for(c.s();!(e=c.n()).done;){var l=e.value,d=l.source,f=l.target;u[d].push(f),s[f]=(s[f]||0)+1}}catch(t){c.e(t)}finally{c.f()}var v=Object.entries(s).filter((function(t){var e=h(t,2);return e[0],0===e[1]})).map((function(t){return h(t,1)[0]}));if(1===v.length){var p=function(t){return g(g({},o[t]),{},{children:u[t].map(p)})};return p(v[0])}}}(t):t;return n?jR(n,e):DR}var BR=["enable"],zR=sR,GR=function(t){function e(t,n){return y(this,e),S(this,e,[t,Object.assign({},e.defaultOptions,n)])}return N(e,t),b(e,[{key:"afterLayout",value:function(){var t=this,e=this.context,n=e.graph,r=e.element,i=e.model,a=n.getData(),o=a.nodes,s=void 0===o?[]:o,u=a.edges,c=void 0===u?[]:u,l=this.options,d=l.enable,f=Ln(l,BR);s.forEach((function(e){var n=yh(e);if(r.getElement(n)&&!(e.children&&e.children.length>0)){var a=function(t,e,n){var r=function(){var n=h(arguments.length>0&&void 0!==arguments[0]&&arguments[0]?["target","source"]:["source","target"],2),r=n[0],i=n[1];return e.filter((function(e){return e[r]===t})).map((function(t){return t[i]}))};return"out"===n?r():"in"===n?r(!0):r().concat(r(!0))}(n,c,t.options.direction);0!==a.length&&i.updateNodeData([{id:n,children:a}])}}));var v=n.getOptions().node;if((0,pT.has)(v,"style.component")){var p=(0,pT.get)(v,"style.component");(0,pT.set)(v,"style.component",(function(t){if(!("function"==typeof d?d(t):d))return p.call(n,t);var e,r=(e=p,function(t){var n=t,r=n.data,i=n.graph,a=n.trigger,o=n.iconRender,s=n.iconPlacement,u=n.iconOffsetX,c=n.iconOffsetY,l=n.iconClassName,d=n.iconStyle,f=n.refreshLayout,v=h((0,gT.useState)((0,pT.get)(r,"style.collapsed",!1)),2),p=v[0],g=v[1],y=(0,gT.useRef)(null),m=(0,gT.useRef)(null),b="icon"===a&&!(0,pT.isEmpty)(r.children),x=function(){var t=Cn(Tn().mark((function t(e){var n;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.stopPropagation(),n=p?"expandElement":"collapseElement",t.next=4,i[n](yh(r));case 4:if(g((function(t){return!t})),!f){t.next=8;break}return t.next=8,i.layout();case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();(0,gT.useEffect)((function(){var t="icon"===a?m.current:"node"===a?y.current:a;return null==t||t.addEventListener("click",x),function(){null==t||t.removeEventListener("click",x)}}),[a,p]);var w=function(t){return"function"==typeof t?t.call(i,r):t};return yT().createElement(CR,{ref:y,className:"collapsible-node-wrapper"},b&&yT().createElement(RR,{ref:m,$placement:w(s),$offsetX:w(u),$offsetY:w(c),className:l,style:d},null==o?void 0:o.call(i,p,r)),e.call(i,r))});return yT().createElement(r,Object.assign({data:t,graph:n},f))}))}n.setNode(v),n.draw()}}])}(fN);GR.defaultOptions={enable:!0,trigger:"icon",direction:"out",iconRender:function(t){return yT().createElement(zR,{isCollapsed:t})},iconPlacement:"bottom",iconOffsetX:0,iconOffsetY:0,iconClassName:"",iconStyle:{},refreshLayout:!1};var VR=function(t){function e(t,n){var r;return y(this,e),(r=S(this,e,[t,Object.assign({},e.defaultOptions,n)])).assignLineWidthByValue=function(t,e,n,r,i,a){var o=[e,n],s=[r,i];if(t<e||t>n||e===n)return s[0];if("function"==typeof a)return a(t,o,s);switch(a){case"linear":return function(t,e,n){var r=h(e,2),i=r[0],a=r[1],o=h(n,2),s=o[0],u=o[1];return a===i?s:s+(t-i)/(a-i)*(u-s)}(t,o,s);case"log":return function(t,e,n){var r=h(e,2),i=r[0],a=r[1],o=h(n,2),s=o[0],u=o[1];return s+Math.log(t-i+1)/Math.log(a-i+1)*(u-s)}(t,o,s);case"pow":return function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=h(e,2),a=i[0],o=i[1],s=h(n,2),u=s[0],c=s[1];return u+Math.pow((t-a)/(o-a),r)*(c-u)}(t,o,s,2);case"sqrt":return function(t,e,n){var r=h(e,2),i=r[0],a=r[1],o=h(n,2),s=o[0],u=o[1];return s+Math.sqrt((t-i)/(a-i))*(u-s)}(t,o,s);default:return s[0]}},r}return N(e,t),b(e,[{key:"beforeDraw",value:function(t){var e=this,n=this.options,r=n.maxValue,i=n.minValue,a=n.maxLineWidth,o=n.minLineWidth,s=n.scale,u=n.value,c=this.context.model.getEdgeData(),l="function"==typeof u?u:function(){return u},h=Object.fromEntries(c.map((function(t){return[yh(t),l(t)]}))),d=t.add.edges,f=t.update.edges;return[].concat(w(d.values()),w(f.values())).forEach((function(t){var n=e.assignLineWidthByValue(h[yh(t)]||0,"function"==typeof i?i(t,h):i,"function"==typeof r?r(t,h):r,"function"==typeof o?o(t):o,"function"==typeof a?a(t):a,s);t.style||(t.style={}),t.style.lineWidth=n})),t}}])}(fN);VR.defaultOptions={minValue:function(t,e){return Math.min.apply(Math,w(Object.values(e)))},maxValue:function(t,e){return Math.max.apply(Math,w(Object.values(e)))},minLineWidth:1,maxLineWidth:10,scale:"linear"};var WR=function(t){function e(){return y(this,e),S(this,e,arguments)}return N(e,t),b(e,[{key:"beforeDraw",value:function(t){var e=this.context,n=e.graph,r=e.element,i=t.add.nodes,a=t.update.nodes;return[].concat(w(i.values()),w(a.values())).forEach((function(t){r.computeElementDefaultStyle("node",{graph:n,datum:t});var e=h(jd(r.getDefaultStyle(t.id).size),2),i=e[0],a=e[1];t.style||(t.style={}),t.style.dx=-i/2,t.style.dy=-a/2})),t}}])}(fN),HR={node:{react:cT},edge:{indented:dT},behavior:{"hover-activate-neighbors":hT,"hover-activate-chain":lT},transform:{"translate-react-node-origin":WR,"collapse-expand-react-node":GR,"assign-color-by-branch":vT,"map-edge-line-width":VR,"arrange-edge-z-index":fT}};Object.entries(HR).forEach((function(t){var e=h(t,2),n=e[0],r=e[1];Object.entries(r).forEach((function(t){var e=h(t,2),r=e[0],i=e[1];kN(n,r,i)}))}));var YR=yT().createContext({graph:null,isReady:!1}),UR=function(){return UR=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},UR.apply(this,arguments)},qR=function(){return qR=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},qR.apply(this,arguments)},XR=(0,gT.forwardRef)((function(t,e){var n=t.style,r=t.children,i=function(t){var e=t.onInit,n=t.onReady,r=t.onDestroy,i=t.options,a=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,a=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}((0,gT.useState)(!1),2),o=a[0],s=a[1],u=(0,gT.useRef)(null),c=(0,gT.useRef)(null);return(0,gT.useEffect)((function(){if(!u.current&&c.current){var t=new IA(UR({container:c.current},i));return u.current=t,s(!0),null==e||e(u.current),function(){var t=u.current;t&&(t.destroy(),null==r||r(),u.current=null)}}}),[]),(0,gT.useEffect)((function(){var t=c.current,e=u.current;i&&t&&e&&!e.destroyed&&(e.setOptions(i),e.render().then((function(){return null==n?void 0:n(e)})))}),[i]),{graph:u.current,containerRef:c,isReady:o}}(function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(t,["style","children"])),a=i.graph,o=i.containerRef,s=i.isReady;(0,gT.useImperativeHandle)(e,(function(){return a}),[a]);var u=qR({height:"inherit",position:"relative"},n);return r?yT().createElement(YR.Provider,{value:{graph:a,isReady:s}},yT().createElement("div",{ref:o,style:u},s&&r)):yT().createElement("div",{ref:o,style:u})})),KR=(0,gT.memo)(XR),$R=["children"],ZR=["containerStyle","className","onInit","onReady","onDestroy","errorTemplate","loading","loadingTemplate"],QR=(0,gT.forwardRef)((function(t,e){var n=t.children,r=Ln(t,$R),i=r.containerStyle,a=r.className,o=r.onInit,s=r.onReady,u=r.onDestroy,c=r.errorTemplate,l=r.loading,h=r.loadingTemplate,d=Ln(r,ZR),f=(0,gT.useRef)(null);return(0,gT.useImperativeHandle)(e,(function(){return f.current})),yT().createElement(SR,{errorTemplate:c},l&&yT().createElement(kR,{loadingTemplate:h}),!(0,pT.isEmpty)(d.data)&&yT().createElement(KR,{ref:function(t){f.current=t},className:a,style:i,options:d,onInit:o,onReady:s,onDestroy:u},n))})),JR={autoResize:!0,behaviors:[{key:"zoom-canvas",type:"zoom-canvas"},{key:"drag-canvas",type:"drag-canvas"}]};function tL(){if(0===arguments.length)return{};for(var t=g({},arguments.length<=0?void 0:arguments[0]),e=1;e<arguments.length;e++){var n=e<0||arguments.length<=e?void 0:arguments[e],r=function(){if(n.hasOwnProperty(i)){var e=n[i],r=t[i];["component","data"].includes(i)?t[i]=e:"function"==typeof e?["plugins","behaviors","transforms"].includes(i)?t[i]=e(r||[]):t[i]=function(t){var n=e.call(this,t);return(0,pT.isPlainObject)(n)?tL(r,n):n}:(0,pT.isPlainObject)(e)&&(0,pT.isPlainObject)(r)?t[i]=tL(r,e):t[i]=e}};for(var i in n)r()}return t}var eL={node:{type:"circle",style:{labelText:function(t){return t.id}}}},nL=["children"],rL=["data","defaultExpandLevel","direction","compact"],iL=(0,gT.forwardRef)((function(t,e){var n=t.children,r=Ln(t,nL),i=(0,gT.useMemo)((function(){var t=r.data,e=r.defaultExpandLevel,n=r.direction,i=void 0===n?"horizontal":n,a=r.compact,o=void 0!==a&&a,s=Ln(r,rL);return tL(JR,eL,{data:FR(t,e)},function(t){var e=t.direction,n=function(t){return(0,pT.isEmpty)(t.children)},r=t.compact?"compact-box":"dendrogram";return"vertical"===e?{node:{style:{labelBackground:!0,labelPlacement:"right",labelTransform:function(t){return n(t)?"rotate(90deg) translate(18px)":"translate(18px)"},ports:[{placement:"top"},{placement:"bottom"}]}},edge:{type:"cubic-vertical"},layout:{type:r,direction:"TB",nodeSep:40,rankSep:140,getVGap:function(){return 80},getHGap:function(){return 20}}}:"horizontal"===e?{node:{style:{labelBackground:!0,labelPlacement:function(t){return n(t)?"right":"left"},ports:[{placement:"left"},{placement:"right"}]}},edge:{type:"cubic-horizontal"},layout:{type:r,direction:"LR",nodeSep:40,rankSep:200,getVGap:function(){return 5},getHGap:function(){return 100}}}:{node:{style:{labelBackground:!0}},edge:{type:"cubic-radial"},layout:{type:r,direction:"RL",radial:!0,nodeSep:40,rankSep:200,getVGap:function(){return 30},getHGap:function(){return 60}},transforms:function(t){return[].concat(w(t),["place-radial-labels"])}}}({direction:i,compact:o}),s)}),[r]);return yT().createElement(QR,Object.assign({},i,{ref:e}),n)}));function aL(t,e){var n=e?"function"==typeof e?e(t):(0,pT.get)(t,"data.".concat(e),t.id):t.id;return String(n)}function oL(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{fontSize:16,fontFamily:"PingFang SC"},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,a=AR(t,n),o=NR(t,n)+4,s=i===1/0?1:Math.ceil(o/i),u=h(e,2),c=u[0],l=u[1];return[Math.max(r,Math.min(i,o))+c,l+a+1.5*a*(s-1)]}var sL={node:{style:{size:10,labelPlacement:"center"}},edge:{type:"polyline"},layout:{type:"fishbone",hGap:40,vGap:60},animation:!1},uL="system-ui, sans-serif";var cL=["children"],lL=["data","defaultExpandLevel","type","labelField"],hL=(0,gT.forwardRef)((function(t,e){var n=t.children,r=Ln(t,cL),i=r.data,a=(r.defaultExpandLevel,r.type),o=void 0===a?"cause":a,s=r.labelField,u=Ln(r,lL),c=(0,gT.useMemo)((function(){return tL(JR,sL,{data:FR(i)},function(t){var e=t.type,n=t.labelField,r={node:{type:"rect",style:{fill:function(t){return function(t){var e,n=t.depth;return 0===n?"#EFF0F0":1===n?(null===(e=t.style)||void 0===e?void 0:e.color)||"#EFF0F0":"transparent"}(t)},labelFill:function(t){return 1===t.depth?"#fff":"#262626"},labelFillOpacity:1,labelFontSize:function(t){return 0===t.depth?24:1===t.depth?18:16},labelFontWeight:function(t){return 0===t.depth?600:400},labelLineHeight:function(t){return 0===t.depth?26:1===t.depth?20:18},labelText:function(t){return aL(t,n)},radius:8,size:function(t){return function(t,e){return 0===e?oL(t,[80,48],{fontSize:24,fontWeight:600,fontFamily:uL}):1===e?oL(t,[80,30],{fontSize:18,fontFamily:uL}):[2,30]}(t.id,t.depth)}}},edge:{type:"polyline",style:{lineWidth:3,stroke:function(t){var e=this.getNodeData(t.target);return(0,pT.get)(e,"style.color","#99ADD1")}}},transforms:function(t){return[].concat(w(t),[{type:"assign-color-by-branch",key:"assign-color-by-branch"},{type:"arrange-edge-z-index",key:"arrange-edge-z-index"}])}};return r.layout||(r.layout={}),"decision"===e?(r.node.style.labelPlacement=function(t){return 0===t.depth||1===t.depth?"center":"right"},Object.assign(r.layout,{direction:"LR"})):"cause"===e&&(r.node.style.labelPlacement=function(t){return 0===t.depth||1===t.depth?"center":"left"},Object.assign(r.layout,{direction:"RL"})),r}({type:o,labelField:s}),u)}),[r]);return yT().createElement(QR,Object.assign({},c,{ref:e}),n)})),dL=PR,fL={node:{type:"react",state:{active:{halo:!1},selected:{halo:!1}}},edge:{type:"cubic-horizontal",style:{strokeOpacity:.5},state:{active:{strokeOpacity:1}}},layout:{type:"dagre",rankdir:"LR",animation:!1},transforms:["translate-react-node-origin"]},vL=["children"],pL=["labelField"],gL=(0,gT.forwardRef)((function(t,e){var n=t.children,r=Ln(t,vL),i=r.labelField,a=Ln(r,pL),o=(0,gT.useMemo)((function(){return tL(JR,fL,function(t){var e=t.labelField,n={node:{style:{component:function(t){var n=aL(t,e);return yT().createElement(dL,{type:"filled",text:n})},size:[100,40],ports:[{placement:"left"},{placement:"right"}]}}};return n}({labelField:i}),a)}),[r]);return yT().createElement(QR,Object.assign({},o,{ref:e}),n)})),yL=PR,mL={node:{type:"react",state:{active:{halo:!1},selected:{halo:!1}}},edge:{type:"polyline",style:{lineWidth:2,endArrow:!0,radius:8,router:{type:"orth"}}},layout:{type:"dagre",animation:!1},transforms:["translate-react-node-origin"]},bL=["children"],xL=["direction","labelField"],wL=(0,gT.forwardRef)((function(t,e){var n=t.children,r=Ln(t,bL),i=(0,gT.useMemo)((function(){var t=r.direction,e=void 0===t?"horizontal":t,n=r.labelField,i=Ln(r,xL);return tL(JR,mL,function(t){var e=t.direction,n=t.labelField,r={node:{style:{component:function(t){var e=aL(t,n);return yT().createElement(yL,{type:"filled",text:e})},size:[100,40],ports:"vertical"===e?[{placement:"top"},{placement:"bottom"}]:[{placement:"left"},{placement:"right"}]}},layout:{type:"dagre",rankdir:"vertical"===e?"TB":"LR"}};return r}({direction:e,labelField:n}),i)}),[r]);return yT().createElement(QR,Object.assign({},i,{ref:e}),n)})),EL=(0,pT.memoize)((function(t,e){if(!e)return"center";var n=ed(t)[0];return ed(e)[0]>n?"left":"right"}),(function(t,e){return e?[ed(t),ed(e)].flat().join("-"):"center"})),kL=function(t,e){var n=t.getParentData(yh(e),"tree");return EL(e,n)},ML=(0,pT.memoize)((function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i={fontWeight:0===r?600:400,fontSize:0===r?24:16};return{font:i,size:oL(t,0===r?[64,30]:[12,12],i,e,n)}})),SL=(0,pT.memoize)((function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i={fontWeight:0===r||1===r?600:400,fontSize:0===r?24:16};return{font:i,size:oL(t,0===r?[64,30]:[36,24],i,e,n)}})),OL=aR,NL=PR,AL={node:{type:"react",state:{active:{halo:!1},selected:{halo:!1}}},edge:{type:"indented",style:{lineWidth:3}},transforms:function(t){return[].concat(w(t),[{type:"collapse-expand-react-node",key:"collapse-expand-react-node",enable:!1,trigger:"icon",iconRender:function(t,e){return yT().createElement(OL,{graph:this,data:e,isCollapsed:t})}}])},layout:{type:"indented",direction:"LR",indent:function(t){return TL(t,20)},getVGap:function(){return 14},preLayout:!1},animation:{duration:500}},TL=function(t,e){if(0===t.depth)return 0;for(var n=e,r=t.parent;r;)n+=r.width/2,r=r.parent;return n/t.depth},PL=function(t,e){var n=kL(t,e);return"left"===n?"right":"center"===n?"center":"left"},CL=["children"],RL=["data","defaultExpandLevel","type","nodeMinWidth","nodeMaxWidth","direction","labelField"],LL=(0,gT.forwardRef)((function(t,e){var n=t.children,r=Ln(t,CL),i=r.data,a=r.defaultExpandLevel,o=r.type,s=void 0===o?"default":o,u=r.nodeMinWidth,c=r.nodeMaxWidth,l=r.direction,d=void 0===l?"right":l,f=r.labelField,v=Ln(r,RL),p=(0,gT.useMemo)((function(){return tL(JR,AL,{data:FR(i,a)},function(t){var e,n=t.type,r=t.direction,i=t.labelField,a={},o=t.nodeMinWidth||0,s=t.nodeMaxWidth||300;if("boxed"===n)a={node:{style:{component:function(t){var e,n=t.depth,r=null===(e=t.style)||void 0===e?void 0:e.color,a=aL(t,i),u=SL(a,o,s,n).font,c={type:0===n||1===n?"filled":"outlined",text:a,color:0===n?"#f1f4f5":r,maxWidth:s,font:u,style:g({textAlign:PL(this,t)},0===n?{color:"#252525"}:{})};return yT().createElement(NL,c)},size:function(t){var e=aL(t,i);return SL(e,o,s,t.depth).size}}},edge:{style:{stroke:function(t){var e=this.getNodeData(t.source);return(0,pT.get)(e,"style.color","#99ADD1")},radius:16}},transforms:function(t){return[].concat(w(t),[{type:"assign-color-by-branch",key:"assign-color-by-branch"}])},layout:{type:"indented",getWidth:function(t){var e=aL(t,i);return h(SL(e,o,s,t.depth).size,1)[0]},getHeight:function(t){var e=aL(t,i);return h(SL(e,o,s,t.depth).size,2)[1]}}};else if("linear"===n)a={node:{style:{component:function(t){var e,n=t.depth,r=null===(e=t.style)||void 0===e?void 0:e.color,a=aL(t,i),u=ML(a,o,s,n).font,c={text:a,color:r,maxWidth:s,font:u};return Object.assign(c,0===n?{type:"filled",color:"#f1f4f5",style:{color:"#252525"}}:{type:"underlined",style:{textAlign:PL(this,t)}}),yT().createElement(NL,c)},size:function(t){var e=aL(t,i);return ML(e,o,s,t.depth).size},ports:function(t){var e=kL(this,t);return"left"===e?[{placement:"bottom"},{placement:"bottom-right"}]:"center"===e?[{placement:"bottom"}]:[{placement:"bottom"},{placement:"bottom-left"}]}}},edge:{style:{stroke:function(t){var e=this.getNodeData(t.target);return(0,pT.get)(e,"style.color","#99ADD1")},radius:24}},layout:{type:"indented",getWidth:function(t){var e=aL(t,i);return h(ML(e,o,s,t.depth).size,1)[0]},getHeight:function(t){var e=aL(t,i);return h(ML(e,o,s,t.depth).size,2)[1]},getVGap:function(){return 12}},transforms:function(t){return[].concat(w(t),[{type:"assign-color-by-branch",key:"assign-color-by-branch"},{type:"arrange-edge-z-index",key:"arrange-edge-z-index"}])}};else{var u=[24,16];a={node:{style:{component:function(t){var e=aL(t,i);return yT().createElement(NL,{type:"filled",text:e})},size:function(t){return oL(aL(t,i),u)}}},layout:{type:"indented",getWidth:function(t){return h(oL(aL(t,i),u),1)[0]},getHeight:function(t){return h(oL(aL(t,i),u),2)[1]}}}}return r&&((e=a).layout||(e.layout={}),Object.assign(a.layout,{direction:"alternate"===r?"H":"left"===r?"RL":"LR"})),a}({type:s,nodeMinWidth:u,nodeMaxWidth:c,direction:d,labelField:f}),v)}),[r]);return yT().createElement(QR,Object.assign({},p,{ref:e}),n)})),DL=aR,_L=PR,IL={node:{type:"react",state:{active:{halo:!1},selected:{halo:!1}}},edge:{type:"cubic-horizontal",style:{lineWidth:3}},transforms:function(t){return[].concat(w(t),[{type:"collapse-expand-react-node",key:"collapse-expand-react-node",enable:!1,trigger:"icon",iconRender:function(t,e){var n=kL(this,e);return yT().createElement(DL,{graph:this,data:e,isCollapsed:t,placement:"left"===n?"left":"right"})},iconPlacement:function(t){return"left"===kL(this,t)?"left":"right"}}])},layout:{type:"mindmap",direction:"H",preLayout:!1,getWidth:function(){return 120},getHGap:function(){return 64}},animation:{duration:500}},jL=["children"],FL=["data","type","nodeMinWidth","nodeMaxWidth","direction","labelField","defaultExpandLevel"],BL=(0,gT.forwardRef)((function(t,e){var n=t.children,r=Ln(t,jL),i=(0,gT.useMemo)((function(){var t=r.data,e=r.type,n=void 0===e?"default":e,i=r.nodeMinWidth,a=r.nodeMaxWidth,o=r.direction,s=void 0===o?"alternate":o,u=r.labelField,c=r.defaultExpandLevel,l=Ln(r,FL),d=tL(JR,IL,{data:FR(t,c)},function(t){var e,n=t.type,r=t.direction,i=t.nodeMinWidth,a=t.nodeMaxWidth,o=t.labelField,s={};if("boxed"===n){var u=i||120,c=a||300;s={node:{style:{component:function(t){var e,n=t.depth,r=null===(e=t.style)||void 0===e?void 0:e.color,i=aL(t,o),a=SL(i,u,c,n).font,s={text:i,color:r,maxWidth:c,font:a};return Object.assign(s,0===n?{type:"filled",color:"#f1f4f5",style:{color:"#252525"}}:1===n?{type:"filled"}:{type:"outlined"}),yT().createElement(_L,s)},size:function(t){var e=aL(t,o);return SL(e,u,c,t.depth).size},dx:function(t){var e=kL(this,t),n=aL(t,o),r=h(SL(n,u,c,t.depth).size,1)[0];return"left"===e?-r:"center"===e?-r/2:0},ports:[{placement:"left"},{placement:"right"}]}},edge:{style:{stroke:function(t){var e=this.getNodeData(t.source);return(0,pT.get)(e,"style.color","#99ADD1")}}},transforms:function(t){return[].concat(w(t),[{type:"assign-color-by-branch",key:"assign-color-by-branch"}])},layout:{type:"mindmap",getHeight:function(t){var e=aL(t,o);return h(SL(e,u,c,t.depth).size,2)[1]},getVGap:function(){return 14}}}}else if("linear"===n){var l=i||0,d=a||300;s={node:{style:{component:function(t){var e,n=kL(this,t),r=t.depth,i=null===(e=t.style)||void 0===e?void 0:e.color,a=aL(t,o),s=ML(a,l,d,r).font,u={text:a,color:i,maxWidth:d,font:s};return Object.assign(u,0===r?{type:"filled",color:"#f1f4f5",style:{color:"#252525"}}:{type:"underlined",style:"left"===n?{textAlign:"right"}:"center"===n?{textAlign:"center"}:{}}),yT().createElement(_L,u)},size:function(t){var e=aL(t,o);return ML(e,l,d,t.depth).size},dx:function(t){var e=kL(this,t),n=aL(t,o),r=h(ML(n,l,d,t.depth).size,1)[0];return"left"===e?-r:"center"===e?-r/2:0},dy:function(t){var e=aL(t,o);return h(ML(e,l,d,t.depth).size,2)[1]/2},ports:function(t){return"center"===kL(this,t)?[{placement:"left"},{placement:"right"}]:[{placement:"left-bottom"},{placement:"right-bottom"}]}}},edge:{style:{stroke:function(t){var e=this.getNodeData(t.target);return(0,pT.get)(e,"style.color","#99ADD1")}}},layout:{type:"mindmap",getHeight:function(t){var e=aL(t,o);return h(ML(e,l,d,t.depth).size,2)[1]},getVGap:function(){return 12}},transforms:function(t){return[].concat(w(t.filter((function(t){return"collapse-expand-react-node"!==t.key}))),[{type:"assign-color-by-branch",key:"assign-color-by-branch"},g(g({},t.find((function(t){return"collapse-expand-react-node"===t.key}))),{},{iconOffsetY:function(t){if(0===t.depth)return 0;var e=aL(t,o);return h(ML(e,l,d,t.depth).size,2)[1]/2}})])}}}else{var f=[24,16];s={node:{style:{component:function(t){var e=aL(t,o);return yT().createElement(_L,{type:"filled",text:e})},size:function(t){return oL(aL(t,o),f)},dx:function(t){var e=kL(this,t),n=h(oL(aL(t,o),f),1)[0];return"left"===e?-n:"center"===e?-n/2:0},ports:[{placement:"left"},{placement:"right"}]}},layout:{type:"mindmap",getHeight:function(t){return h(oL(aL(t,o),f),2)[1]}}}}return r&&((e=s).layout||(e.layout={}),s.layout.direction="alternate"===r?"H":"left"===r?"RL":"LR"),s}({type:n,nodeMinWidth:i,nodeMaxWidth:a,direction:s,labelField:u}),l);return d}),[r]);return yT().createElement(QR,Object.assign({},i,{ref:e}),n)})),zL={node:{type:"circle"},layout:{type:"d3-force",link:{distance:128},collide:{radius:32},manyBody:{strength:-704},x:{},y:{}}},GL=["children"],VL=(0,gT.forwardRef)((function(t,e){var n=t.children,r=Ln(t,GL),i=(0,gT.useMemo)((function(){return tL(JR,zL,r)}),[r]);return yT().createElement(QR,Object.assign({},i,{ref:e}),n)})),WL=PR,HL={node:{type:"react",state:{active:{halo:!1},selected:{halo:!1}}},edge:{type:"polyline",style:{lineWidth:2,router:{type:"orth"}}},layout:{type:"dagre",animation:!1},transforms:["translate-react-node-origin"]},YL=["children"],UL=["direction","labelField"],qL=(0,gT.forwardRef)((function(t,e){var n=t.children,r=Ln(t,YL),i=(0,gT.useMemo)((function(){var t=r.direction,e=void 0===t?"vertical":t,n=r.labelField,i=Ln(r,UL),a=tL(JR,HL,function(t){var e=t.direction,n=t.labelField,r={node:{style:{component:function(t){var e=aL(t,n);return yT().createElement(WL,{type:"filled",text:e})},size:[100,40],ports:"vertical"===e?[{placement:"top"},{placement:"bottom"}]:[{placement:"left"},{placement:"right"}]}},transforms:function(t){return[].concat(w(t),[{type:"collapse-expand-react-node",key:"collapse-expand-react-node",iconPlacement:"vertical"===e?"bottom":"right",enable:!1,refreshLayout:!0}])},layout:{type:"dagre",rankdir:"vertical"===e?"TB":"LR"}};return r}({direction:e,labelField:n}),i);return a}),[r]);return yT().createElement(QR,Object.assign({},i,{ref:e}),n)}))})(),o})()));
//# sourceMappingURL=graphs.min.js.map